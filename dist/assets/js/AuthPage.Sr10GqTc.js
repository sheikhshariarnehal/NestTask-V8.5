import{r as s,j as e,s as A}from"./index.C8UCKVJE.js";import{A as B,a as S,b as T,c as $}from"./AuthSubmitButton.DJItL-mT.js";import{v as I,a as F}from"./authErrors.D8KAnYp0.js";import{M as D}from"./mail.BMdP-e1n.js";import{L as H}from"./lock.0Ni9tN6U.js";import{E as Y}from"./eye-off.BuSBeJIe.js";import{E as G}from"./eye.LDhSBXni.js";import{L as _}from"./loader-2.DRlH7yWe.js";import{d as O,c as R}from"./dataCache.CcjqYMC_.js";import{U as Q}from"./user.BDgKbHbK.js";import{B as X}from"./book-open.yVzUmrXU.js";import{L as Z}from"./layers.Di5DKUQM.js";import{U as J}from"./users.9rK55cDN.js";import{c as ee}from"./createLucideIcon.D-Z7uXpu.js";import{C as te}from"./check-circle-2.B-DgQUE6.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=ee("MailCheck",[["path",{d:"M22 13V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v12c0 1.1.9 2 2 2h8",key:"12jkf8"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}],["path",{d:"m16 19 2 2 4-4",key:"1b14m6"}]]);function se({onSubmit:d,onSwitchToSignup:i,onForgotPassword:n,error:t}){const[l,m]=s.useState({email:"",password:""}),[u,x]=s.useState(!1),[r,o]=s.useState(null),[p,C]=s.useState({email:!1,password:!1}),[y,E]=s.useState(!1),[j,L]=s.useState(!0),g=()=>I(l.email)?F(l.password)?!0:(o("Password must be at least 6 characters long"),!1):(o("Please enter a valid email address"),!1),b=async h=>{if(h.preventDefault(),o(null),!!g()){x(!0);try{await d(l,j)}catch(w){o(w.message)}finally{x(!1)}}},P=(h,w)=>{m(v=>({...v,[h]:w})),C(v=>({...v,[h]:!0})),o(null)};return e.jsxs("div",{className:"w-full animate-in fade-in slide-in-from-bottom-4 duration-500",children:[e.jsxs("div",{className:"mb-10 text-center",children:[e.jsx("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 dark:text-white tracking-tight",children:"Welcome back"}),e.jsx("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:"Please enter your details to sign in."})]}),(t||r)&&e.jsx(B,{message:t||r||""}),e.jsxs("form",{onSubmit:b,className:"space-y-5",children:[e.jsx(S,{type:"email",value:l.email,onChange:h=>P("email",h),label:"Email",placeholder:"Enter your email",icon:D,error:p.email&&!I(l.email)?"Please enter a valid email":"",autocomplete:"username email",inputMode:"email"}),e.jsx(S,{type:y?"text":"password",value:l.password,onChange:h=>P("password",h),label:"Password",placeholder:"Enter your password",icon:H,error:p.password&&!F(l.password)?"Password must be at least 6 characters":"",autocomplete:"current-password",rightElement:e.jsx("button",{type:"button",className:"text-gray-400 hover:text-gray-500 transition-colors",onClick:()=>E(!y),tabIndex:-1,children:y?e.jsx(Y,{className:"w-4 h-4"}):e.jsx(G,{className:"w-4 h-4"})})}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("label",{className:"flex items-center cursor-pointer group",children:[e.jsxs("div",{className:"relative flex items-center",children:[e.jsx("input",{type:"checkbox",checked:j,onChange:h=>L(h.target.checked),className:"peer sr-only"}),e.jsx("div",{className:"w-5 h-5 border-2 border-gray-300 dark:border-gray-600 rounded transition-colors peer-checked:bg-blue-600 peer-checked:border-blue-600 peer-focus:ring-2 peer-focus:ring-blue-500/20"}),e.jsx("svg",{className:"absolute w-3 h-3 text-white left-1 top-1 opacity-0 peer-checked:opacity-100 transition-opacity pointer-events-none",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"3",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})})]}),e.jsx("span",{className:"ml-2 text-gray-600 dark:text-gray-400 group-hover:text-gray-900 dark:group-hover:text-gray-200 transition-colors",children:"Remember me"})]}),e.jsx("button",{type:"button",onClick:n,className:"text-blue-600 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-300 font-medium transition-colors",children:"Forgot password?"})]}),e.jsx(T,{label:u?"Signing in...":"Sign in",isLoading:u,icon:u?_:void 0})]}),e.jsxs("div",{className:"mt-6 flex items-center justify-center space-x-1 text-sm text-gray-600 dark:text-gray-400",children:[e.jsx("span",{children:"Don't have an account?"}),e.jsx("button",{type:"button",onClick:i,className:"text-blue-600 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-300 font-medium transition-colors",children:"Sign up"})]})]})}async function re(){return O.getOrFetch(R.departments(),async()=>{const{data:d,error:i}=await A.from("departments").select("*").order("name");if(i)throw console.error("Error fetching departments:",i),new Error("Failed to fetch departments");return(d||[]).map(n=>({id:n.id,name:n.name,createdAt:n.created_at}))},10*60*1e3)}async function ne(d){return O.getOrFetch(R.batches(d),async()=>{const{data:i,error:n}=await A.from("batches").select("*").eq("department_id",d).order("name");if(n)throw console.error("Error fetching batches:",n),new Error("Failed to fetch batches");return(i||[]).map(t=>({id:t.id,name:t.name,departmentId:t.department_id,createdAt:t.created_at}))},10*60*1e3)}async function le(d){return O.getOrFetch(R.sections(d),async()=>{try{const{data:i,error:n}=await A.from("sections").select("*").eq("batch_id",d).order("name");if(n)throw n;return(i||[]).map(t=>({id:t.id,name:t.name,batchId:t.batch_id,createdAt:t.created_at}))}catch(i){throw console.error("Error fetching sections:",i),new Error("Failed to fetch sections")}},10*60*1e3)}const M=({label:d,value:i,onChange:n,options:t,placeholder:l,icon:m,error:u,disabled:x})=>{const r=s.useMemo(()=>t.map(o=>e.jsx("option",{value:o.id,children:o.name},o.id)),[t]);return e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:d}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none z-10",children:e.jsx(m,{className:"h-5 w-5 text-gray-400 dark:text-gray-500"})}),e.jsxs("select",{value:i,onChange:o=>n(o.target.value),disabled:x,className:`block w-full pl-10 pr-8 py-2.5 rounded-lg border transition-all duration-200 ${u?"border-red-300 dark:border-red-500/50 bg-red-50/30 dark:bg-red-900/10 focus:ring-2 focus:ring-red-100 focus:border-red-500":"border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800/50 hover:border-gray-300 dark:hover:border-gray-600 focus:ring-2 focus:ring-blue-50 focus:border-blue-500 dark:focus:ring-blue-900/20"} text-gray-900 dark:text-gray-100 text-sm
          disabled:bg-gray-50 dark:disabled:bg-gray-800 disabled:text-gray-400 dark:disabled:text-gray-500 
          disabled:cursor-not-allowed cursor-pointer appearance-none`,children:[e.jsx("option",{value:"",disabled:!0,children:l}),r]}),e.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none",children:e.jsx("svg",{className:"h-5 w-5 text-gray-400",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})})]}),u&&e.jsx("p",{className:"mt-1 text-xs text-red-600 dark:text-red-400",children:u})]})};function oe({onSubmit:d,onSwitchToLogin:i,error:n}){var q,z,W;const[t,l]=s.useState({name:"",email:"",password:"",phone:"",studentId:"",departmentId:"",batchId:"",sectionId:""}),[m,u]=s.useState(!1),[x,r]=s.useState(null),[o,p]=s.useState({name:!1,email:!1,password:!1,phone:!1,studentId:!1,departmentId:!1,batchId:!1,sectionId:!1}),[C,y]=s.useState([]),[E,j]=s.useState([]),[L,g]=s.useState([]),[b,P]=s.useState(!1),[h,w]=s.useState(!1),[v,U]=s.useState(!1);s.useEffect(()=>{let a=!0;async function f(){P(!0);try{const c=await re();a&&y(c)}catch(c){console.error("Error loading departments:",c),a&&r("Failed to load departments. Please try again.")}finally{a&&P(!1)}}return f(),()=>{a=!1}},[]),s.useEffect(()=>{if(!t.departmentId){j([]);return}let a=!0;async function f(){w(!0);try{const c=await ne(t.departmentId||"");a&&j(c)}catch(c){console.error("Error loading batches:",c),a&&r("Failed to load batches. Please try again.")}finally{a&&w(!1)}}return f(),l(c=>({...c,batchId:"",sectionId:""})),g([]),()=>{a=!1}},[t.departmentId]),s.useEffect(()=>{if(!t.batchId){g([]);return}let a=!0;async function f(){U(!0);try{const c=await le(t.batchId||"");a&&g(c)}catch(c){console.error("Error loading sections:",c),a&&r("Failed to load sections. Please try again.")}finally{a&&U(!1)}}return f(),l(c=>({...c,sectionId:""})),()=>{a=!1}},[t.batchId]);const K=s.useCallback(()=>t.name.trim()?I(t.email)?F(t.password)?t.departmentId?t.batchId?t.sectionId?!0:(r("Please select your section"),!1):(r("Please select your batch"),!1):(r("Please select your department"),!1):(r("Password must be at least 6 characters long"),!1):(r("Please enter a valid email address"),!1):(r("Name is required"),!1),[t]),V=async a=>{if(a.preventDefault(),r(null),!!K()){u(!0);try{await d(t)}catch(f){r(f.message)}finally{u(!1)}}},k=s.useCallback((a,f)=>{l(c=>({...c,[a]:f})),p(c=>({...c,[a]:!0})),r(null)},[]),N=s.useMemo(()=>({name:o.name&&!t.name.trim()?"Name is required":"",email:o.email&&!I(t.email)?"Please enter a valid email":"",password:o.password&&!F(t.password)?"Password must be at least 6 characters":"",departmentId:o.departmentId&&!t.departmentId?"Please select your department":"",batchId:o.batchId&&!t.batchId&&t.departmentId?"Please select your batch":"",sectionId:o.sectionId&&!t.sectionId&&t.batchId?"Please select your section":""}),[o,t]);return e.jsxs("div",{className:"w-full animate-in fade-in slide-in-from-bottom-4 duration-500",children:[e.jsxs("div",{className:"mb-10 text-center",children:[e.jsx("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 dark:text-white tracking-tight",children:"Create Account"}),e.jsx("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:"Join our community and start managing your tasks"})]}),(n||x)&&e.jsx(B,{message:n||x||""}),e.jsxs("form",{onSubmit:V,className:"space-y-4",children:[e.jsx(S,{type:"text",value:t.name,onChange:a=>k("name",a),label:"Full Name",placeholder:"Enter your full name",icon:Q,error:N.name}),e.jsx(S,{type:"email",value:t.email,onChange:a=>k("email",a),label:"Email",placeholder:"Enter your email",icon:D,error:N.email,inputMode:"email"}),e.jsx(M,{label:"Department",value:(q=t.departmentId)!=null?q:"",onChange:a=>k("departmentId",a),options:C,placeholder:b?"Loading departments...":"Select your department",icon:X,disabled:b,error:N.departmentId}),t.departmentId&&e.jsx("div",{className:"animate-in fade-in slide-in-from-top-2 duration-300",children:e.jsx(M,{label:"Batch",value:(z=t.batchId)!=null?z:"",onChange:a=>k("batchId",a),options:E,placeholder:h?"Loading batches...":"Select your batch",icon:Z,disabled:h,error:N.batchId})}),t.batchId&&e.jsx("div",{className:"animate-in fade-in slide-in-from-top-2 duration-300",children:e.jsx(M,{label:"Section",value:(W=t.sectionId)!=null?W:"",onChange:a=>k("sectionId",a),options:L,placeholder:v?"Loading sections...":"Select your section",icon:J,disabled:v,error:N.sectionId})}),e.jsx(S,{type:"password",value:t.password,onChange:a=>k("password",a),label:"Password",placeholder:"Choose a password (min. 6 characters)",icon:H,error:N.password}),e.jsx("div",{className:"pt-2",children:e.jsx(T,{label:m?"Creating account...":"Create account",isLoading:m,icon:m?_:void 0})})]}),e.jsxs("div",{className:"mt-6 text-center text-sm",children:[e.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Already have an account? "}),e.jsx("button",{type:"button",onClick:i,className:"font-semibold text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 transition-colors",children:"Sign in"})]})]})}function ie({onSubmit:d,onBackToLogin:i,error:n}){const[t,l]=s.useState(""),[m,u]=s.useState(!1),[x,r]=s.useState(null),[o,p]=s.useState(null),[C,y]=s.useState({email:!1}),E=()=>I(t)?!0:(r("Please enter a valid email address"),!1),j=async g=>{if(g.preventDefault(),r(null),p(null),!!E()){u(!0);try{await d(t),p("Password reset link sent to your email"),l("")}catch(b){r(b.message)}finally{u(!1)}}},L=g=>{l(g),y(b=>({...b,email:!0})),r(null)};return e.jsx("div",{className:"w-full animate-in fade-in slide-in-from-bottom-4 duration-500",children:o?e.jsxs("div",{className:"text-center py-5",children:[e.jsx("div",{className:"inline-flex items-center justify-center p-4 bg-green-50 dark:bg-green-900/20 rounded-full mb-6 ring-8 ring-green-50/50 dark:ring-green-900/10",children:e.jsx(ae,{className:"w-12 h-12 text-green-600 dark:text-green-400"})}),e.jsx("h3",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Check your inbox"}),e.jsxs("p",{className:"mb-8 text-gray-600 dark:text-gray-400 leading-relaxed",children:["We've sent a password reset link to ",e.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:t||"your email"}),". Please check your inbox and follow the instructions."]}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsx("button",{type:"button",onClick:()=>window.open("mailto:","_blank"),className:"w-full inline-flex items-center justify-center px-4 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-semibold transition-colors",children:"Open Email App"}),e.jsx("button",{type:"button",onClick:()=>p(null),className:"w-full inline-flex items-center justify-center px-4 py-3 bg-gray-100 hover:bg-gray-200 dark:bg-gray-800 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg font-medium transition-colors",children:"Try another email"}),e.jsxs("button",{type:"button",onClick:i,className:"mt-4 inline-flex items-center justify-center text-sm text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 transition-colors",children:[e.jsx($,{className:"w-4 h-4 mr-1"}),"Back to Login"]})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-10 text-center",children:[e.jsxs("button",{type:"button",onClick:i,className:"inline-flex items-center text-sm text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 mb-6 transition-colors",children:[e.jsx($,{className:"w-4 h-4 mr-1"}),"Back"]}),e.jsx("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 dark:text-white tracking-tight",children:"Forgot Password?"}),e.jsx("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:"No worries, we'll send you reset instructions."})]}),(n||x)&&e.jsx(B,{message:n||x||""}),e.jsxs("form",{onSubmit:j,className:"space-y-5",children:[e.jsx(S,{type:"email",value:t,onChange:L,label:"Email",placeholder:"Enter your email",icon:D,error:C.email&&!I(t)?"Please enter a valid email":"",inputMode:"email"}),e.jsx(T,{label:m?"Sending...":"Send Reset Link",isLoading:m,icon:m?_:void 0})]})]})})}function ce({onLogin:d,onSignup:i,onForgotPassword:n,error:t}){const[l,m]=s.useState("login");return e.jsxs("div",{className:"h-screen w-full flex bg-gray-50 dark:bg-gray-900 overflow-hidden",children:[e.jsxs("div",{className:"hidden lg:flex lg:w-1/2 relative bg-blue-600 overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-600 to-indigo-900"}),e.jsx("div",{className:"absolute inset-0 opacity-10 mix-blend-overlay",children:e.jsxs("svg",{className:"w-full h-full",viewBox:"0 0 100 100",preserveAspectRatio:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("defs",{children:e.jsx("pattern",{id:"grid",width:"10",height:"10",patternUnits:"userSpaceOnUse",children:e.jsx("circle",{cx:"1",cy:"1",r:"1",fill:"white",opacity:"0.3"})})}),e.jsx("rect",{width:"100",height:"100",fill:"url(#grid)"})]})}),e.jsx("div",{className:"absolute top-0 left-0 -translate-x-1/2 -translate-y-1/2 w-96 h-96 bg-white/10 rounded-full blur-3xl"}),e.jsx("div",{className:"absolute bottom-0 right-0 translate-x-1/2 translate-y-1/2 w-96 h-96 bg-indigo-500/20 rounded-full blur-3xl"}),e.jsxs("div",{className:"relative z-10 flex flex-col justify-between h-full p-16 text-white",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-12",children:[e.jsx("img",{src:"/icons/icon-512x512.png",alt:"NestTask Logo",className:"w-[30px] h-[30px] rounded-lg shadow-lg shrink-0 object-contain"}),e.jsx("span",{className:"text-3xl font-bold tracking-tight text-white leading-none",children:"NestTask"})]}),e.jsxs("h1",{className:"text-5xl font-bold leading-tight mb-6 tracking-tight",children:["Manage your academic ",e.jsx("br",{}),e.jsx("span",{className:"text-blue-200",children:"journey with ease."})]}),e.jsx("p",{className:"text-lg text-blue-100 max-w-md leading-relaxed",children:"Streamline your tasks, track your progress, and collaborate with peers in one unified platform designed for students."})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[e.jsxs("div",{className:"flex items-center gap-4 p-4 rounded-2xl bg-white/8 border border-white/5 hover:bg-white/10 transition-colors duration-300",children:[e.jsx("div",{className:"p-2 bg-blue-500/20 rounded-lg",children:e.jsx(te,{className:"w-6 h-6 text-blue-200"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-white",children:"Task Tracking"}),e.jsx("p",{className:"text-sm text-blue-200",children:"Stay on top of assignments and deadlines"})]})]}),e.jsxs("div",{className:"flex items-center gap-4 p-4 rounded-2xl bg-white/8 border border-white/5 hover:bg-white/10 transition-colors duration-300",children:[e.jsx("div",{className:"p-2 bg-blue-500/20 rounded-lg",children:e.jsx(J,{className:"w-6 h-6 text-blue-200"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-white",children:"Collaboration"}),e.jsx("p",{className:"text-sm text-blue-200",children:"Work together with classmates seamlessly"})]})]})]}),e.jsxs("div",{className:"text-sm text-blue-200/60",children:["Â© ",new Date().getFullYear()," NestTask. All rights reserved."]})]})]}),e.jsx("div",{className:"flex-1 flex flex-col h-full bg-white dark:bg-gray-900 relative",children:e.jsx("div",{className:"absolute inset-0 overflow-y-auto safe-area-inset-bottom",children:e.jsx("div",{className:"min-h-full flex flex-col justify-center py-6 sm:py-12 px-4 sm:px-6 lg:px-20 xl:px-24",children:e.jsxs("div",{className:"mx-auto w-full max-w-md",children:[l==="login"&&e.jsx("div",{className:"lg:hidden flex flex-col items-center mb-8 sm:mb-10",children:e.jsxs("div",{className:"flex items-center justify-center gap-2 mb-2",children:[e.jsx("img",{src:"/icons/icon-512x512.png",alt:"NestTask Logo",className:"w-[30px] h-[30px] rounded-lg shrink-0 object-contain"}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white tracking-tight leading-none",children:"NestTask"})]})}),l==="login"&&e.jsx(se,{onSubmit:d,onSwitchToSignup:()=>m("signup"),onForgotPassword:()=>m("forgot-password"),error:t}),l==="signup"&&e.jsx(oe,{onSubmit:i,onSwitchToLogin:()=>m("login"),error:t}),l==="forgot-password"&&e.jsx(ie,{onSubmit:n,onBackToLogin:()=>m("login"),error:t})]})})})})]})}const Se=Object.freeze(Object.defineProperty({__proto__:null,AuthPage:ce},Symbol.toStringTag,{value:"Module"}));export{ce as A,ae as M,Se as a};
