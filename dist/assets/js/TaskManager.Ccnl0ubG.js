import{r as o,j as e,s as te}from"./index.YUbl_JYO.js";import{i as Ee,n as Se,g as Ce,E as me,P as Te}from"./googleDriveUtils.DrV1lqPz.js";import{L as ne}from"./list-todo.DNNX2cxL.js";import{T as ge}from"./tag.wecigsaa.js";import{C as xe}from"./calendar.gujie_UW.js";import{A as Le,S as oe,C as de,b as Re,a as $e,c as Fe,L as _e,R as Ue}from"./square.CrDCoIBB.js";import{U as pe}from"./upload.D56wjEE7.js";import{L as he}from"./link.CaSOM4yD.js";import{P as be}from"./plus.BnVEsf-Z.js";import{A as Pe}from"./alert-circle.BNj8ebFy.js";import{C as Y}from"./check-circle.DzzEzC-Y.js";import{X as re}from"./x.C5CONoCd.js";import{F as se}from"./file-text.Xy2c4BiB.js";import{T as J}from"./trash-2.B4JXrc-4.js";import{S as Ae}from"./save.C7a9Trby.js";import{i as ae,f as le}from"./dateUtils.CaLFIf6y.js";import{C as ee}from"./check-square.BY91zDvp.js";import{A as Oe}from"./alert-triangle.Cdt7JXTw.js";import{C as ce}from"./copy.9EOSYYmG.js";import{P as ue}from"./pen.8zc5p4eB.js";import{C as Ie}from"./clock.DKUXbPER.js";import{a as H,s as q}from"./notifications.4_bC7DbS.js";import{C as Me}from"./chevron-up.CtT_9TMW.js";import{F as Ge}from"./filter.BIofN-VG.js";import{D as ze}from"./download.Cb3a4PV-.js";import{R as Be}from"./refresh-cw.CggBjrEV.js";import{S as Ve}from"./search.BCCGNAVb.js";import{L as qe}from"./loader-2.Bs8VDZ4i.js";import"./createLucideIcon.CBBn_0RV.js";const fe=l=>({taskDetails:{name:"",category:"task",dueDate:"",description:"",status:"in-progress",sectionId:l||void 0,googleDriveLinks:[]},errors:{},files:[],fileUrls:[],googleDriveLinks:[],currentGoogleDriveLink:"",isSubmitting:!1,success:!1,uploadProgress:0});function Ke(l,u){switch(u.type){case"SET_TASK_FIELD":return{...l,taskDetails:{...l.taskDetails,[u.field]:u.value}};case"SET_ERRORS":return{...l,errors:u.errors};case"CLEAR_ERROR":const{[u.field]:k,...E}=l.errors;return{...l,errors:E};case"ADD_FILES":return{...l,files:[...l.files,...u.newFiles],fileUrls:[...l.fileUrls,...u.newUrls]};case"REMOVE_FILE":return{...l,files:l.files.filter((a,b)=>b!==u.index),fileUrls:l.fileUrls.filter((a,b)=>b!==u.index)};case"SET_CURRENT_GOOGLE_DRIVE_LINK":return{...l,currentGoogleDriveLink:u.link};case"ADD_GOOGLE_DRIVE_LINK":return{...l,googleDriveLinks:[...l.googleDriveLinks,u.link],currentGoogleDriveLink:"",taskDetails:{...l.taskDetails,googleDriveLinks:[...l.taskDetails.googleDriveLinks||[],u.link]}};case"REMOVE_GOOGLE_DRIVE_LINK":const w=l.googleDriveLinks.filter((a,b)=>b!==u.index);return{...l,googleDriveLinks:w,taskDetails:{...l.taskDetails,googleDriveLinks:w}};case"SET_SUBMITTING":return{...l,isSubmitting:u.isSubmitting};case"SET_SUCCESS":return{...l,success:u.success};case"SET_UPLOAD_PROGRESS":return{...l,uploadProgress:u.progress};case"RESET_FORM":return fe(u.sectionId);default:return l}}const Q=({id:l,label:u,required:k=!1,error:E,children:w})=>e.jsxs("div",{children:[e.jsxs("label",{htmlFor:l,className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[u," ",k&&e.jsx("span",{className:"text-red-500",children:"*"})]}),w,E&&e.jsxs("p",{id:`${l}-error`,className:"mt-1 text-xs text-red-500 flex items-center gap-1",role:"alert",children:[e.jsx(Pe,{className:"w-3 h-3"}),E]})]}),We=()=>e.jsxs("div",{className:"p-3 bg-green-50 dark:bg-green-900/20 rounded-lg mb-4 flex items-start gap-2 shadow-sm",role:"alert",children:[e.jsx(Y,{className:"w-5 h-5 text-green-600 dark:text-green-400 flex-shrink-0 mt-0.5"}),e.jsx("span",{className:"text-green-700 dark:text-green-300",children:"Task created successfully!"})]}),He=({progress:l})=>e.jsxs("div",{className:"mb-4","aria-live":"polite",children:[e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5 dark:bg-gray-700",children:e.jsx("div",{className:"bg-blue-600 h-2.5 rounded-full transition-all duration-300",style:{width:`${l}%`},role:"progressbar","aria-valuenow":l,"aria-valuemin":0,"aria-valuemax":100})}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:["Uploading files... ",l,"%"]})]}),Qe=({file:l,onRemove:u})=>{const k=w=>{var b;const a=(b=w.split(".").pop())==null?void 0:b.toLowerCase();return["jpg","jpeg","png","gif","svg","webp"].includes(a||"")?"ðŸ–¼ï¸":["pdf"].includes(a||"")?"ðŸ“„":["doc","docx"].includes(a||"")?"ðŸ“":["xls","xlsx"].includes(a||"")?"ðŸ“Š":["zip","rar","7z"].includes(a||"")?"ðŸ—œï¸":"ðŸ“Ž"},E=w=>w<1024?w+" B":w<1048576?(w/1024).toFixed(1)+" KB":(w/1048576).toFixed(1)+" MB";return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white dark:bg-gray-700 rounded-lg border border-gray-200 dark:border-gray-600 hover:border-blue-300 dark:hover:border-blue-500 transition-all duration-200 group",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[e.jsx("span",{className:"text-2xl flex-shrink-0",children:k(l.name)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-200 truncate",children:l.name}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:E(l.size)})]})]}),e.jsx("button",{type:"button",onClick:u,className:"flex-shrink-0 p-1.5 text-gray-400 hover:text-red-500 dark:hover:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-all duration-200 opacity-0 group-hover:opacity-100","aria-label":"Remove file",children:e.jsx(re,{className:"w-4 h-4"})})]})},Xe=({url:l,onRemove:u})=>e.jsxs("div",{className:"flex items-center justify-between py-2 px-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800",children:[e.jsxs("div",{className:"flex items-center gap-2 truncate max-w-[85%]",children:[e.jsx(he,{className:"w-4 h-4 text-blue-500 dark:text-blue-400 flex-shrink-0"}),e.jsxs("div",{className:"flex flex-col min-w-0",children:[e.jsx("span",{className:"text-sm text-blue-700 dark:text-blue-300 truncate",children:Ce(l)}),e.jsx("span",{className:"text-xs text-blue-600 dark:text-blue-400 truncate",children:l})]})]}),e.jsxs("div",{className:"flex items-center gap-1 ml-2",children:[e.jsx("button",{type:"button",onClick:()=>window.open(l,"_blank","noopener,noreferrer"),className:"text-blue-500 hover:text-blue-600 dark:text-blue-400 dark:hover:text-blue-300 p-1 rounded-full hover:bg-blue-100 dark:hover:bg-blue-800 touch-manipulation","aria-label":"Open Google Drive link",children:e.jsx(me,{className:"w-4 h-4"})}),e.jsx("button",{type:"button",onClick:u,className:"text-gray-500 hover:text-red-500 dark:text-gray-400 dark:hover:text-red-400 p-1 rounded-full hover:bg-gray-200 dark:hover:bg-gray-600 touch-manipulation","aria-label":"Remove Google Drive link",children:e.jsx(re,{className:"w-4 h-4"})})]})]});function Ze({onSubmit:l,sectionId:u,isSectionAdmin:k=!1,isSubmitting:E=!1}){const[w,a]=o.useReducer(Ke,fe(u)),{taskDetails:b,errors:g,files:L,fileUrls:y,googleDriveLinks:S,currentGoogleDriveLink:R,isSubmitting:v,success:O,uploadProgress:P}=w,D=o.useRef(),C=o.useRef(!0),I=o.useRef(),x=o.useRef(null);o.useEffect(()=>(C.current=!0,()=>{C.current=!1,a({type:"SET_SUBMITTING",isSubmitting:!1}),D.current&&clearTimeout(D.current),I.current&&I.current.abort(),y.forEach(d=>{d&&!d.startsWith("placeholder-")&&URL.revokeObjectURL(d)})}),[y,a]);const N=o.useCallback(()=>/iPhone|iPad|iPod|Android|webOS|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||window.innerWidth<768,[]);o.useEffect(()=>{if(N()&&x.current){const d=x.current;d.addEventListener("focus",()=>{d.classList.add("mobile-date-focused")}),d.addEventListener("blur",()=>{d.classList.remove("mobile-date-focused")})}},[N]);const _=o.useCallback(()=>{const d={};let r=!0;if(b.name.trim()||(d.name="Task name is required",r=!1),!b.dueDate)d.dueDate="Due date is required",r=!1;else{const s=new Date(b.dueDate),c=new Date;c.setHours(0,0,0,0),s<c&&(d.dueDate="Due date cannot be in the past",r=!1)}return b.description.trim()||(d.description="Description is required",r=!1),a({type:"SET_ERRORS",errors:d}),r},[b]),M=o.useCallback(d=>{const{name:r,value:s}=d.target;a({type:"SET_TASK_FIELD",field:r,value:s}),g[r]&&a({type:"CLEAR_ERROR",field:r})},[g]),T=o.useCallback(d=>{var h;if(!((h=d.target.files)!=null&&h.length))return;const r=Array.from(d.target.files),s=50*1024*1024,c=r.filter(i=>i.size>s);if(c.length>0){a({type:"SET_ERRORS",errors:{...g,files:`Some files exceed the 50MB size limit: ${c.map(i=>i.name).join(", ")}`}});return}if(N()){const i=r.map(j=>`placeholder-${j.name}-${Date.now()}`);a({type:"ADD_FILES",newFiles:r,newUrls:i})}else{const i=r.map(j=>URL.createObjectURL(j));a({type:"ADD_FILES",newFiles:r,newUrls:i})}g.files&&a({type:"CLEAR_ERROR",field:"files"})},[g,N]),A=o.useCallback(d=>{y[d]&&!y[d].startsWith("placeholder-")&&URL.revokeObjectURL(y[d]),a({type:"REMOVE_FILE",index:d})},[y]),t=o.useCallback(d=>{const r=d.target.value;a({type:"SET_CURRENT_GOOGLE_DRIVE_LINK",link:r}),g.googleDriveLinks&&a({type:"CLEAR_ERROR",field:"googleDriveLinks"})},[g.googleDriveLinks]),F=o.useCallback(()=>{const d=R.trim();if(!d){a({type:"SET_ERRORS",errors:{...g,googleDriveLinks:"Please enter a Google Drive link"}});return}if(!Ee(d)){a({type:"SET_ERRORS",errors:{...g,googleDriveLinks:"Please enter a valid Google Drive URL"}});return}const r=Se(d);if(S.includes(r)){a({type:"SET_ERRORS",errors:{...g,googleDriveLinks:"This Google Drive link has already been added"}});return}a({type:"ADD_GOOGLE_DRIVE_LINK",link:r})},[R,S,g]),z=o.useCallback(d=>{a({type:"REMOVE_GOOGLE_DRIVE_LINK",index:d})},[]),G=o.useCallback(d=>{d.key==="Enter"&&(d.preventDefault(),F())},[F]),W=o.useCallback(()=>new Date().toISOString().split("T")[0],[]),X=o.useCallback(async d=>{if(d.preventDefault(),v){console.log("[TaskForm] Already submitting, ignoring duplicate submission");return}if(console.log("[TaskForm] Starting task submission"),D.current&&clearTimeout(D.current),I.current=new AbortController,!!_()){a({type:"SET_SUBMITTING",isSubmitting:!0}),a({type:"SET_UPLOAD_PROGRESS",progress:0}),D.current=setTimeout(()=>{var r;C.current&&(console.error("[Error] Task submission timed out after 45 seconds"),a({type:"SET_SUBMITTING",isSubmitting:!1}),a({type:"SET_ERRORS",errors:{name:"Submission timed out. Please try again with smaller files or check your connection."}}),(r=I.current)==null||r.abort())},45e3);try{let s=b.description;const c=N();L.length>0&&(s+=`

**Attachments:**
`,c?(L.filter(i=>i.size>0&&i.name&&typeof i.name=="string").forEach(i=>{s+=`- [${i.name}](attachment:${i.name})
`}),s+=`
<!-- mobile-uploads -->
`):L.forEach(h=>{const i=URL.createObjectURL(h);s+=`- [${h.name}](${i})
`})),k&&u&&(s+=`

*This task is assigned to section ID: ${u}*`);const p={...b,description:s,sectionId:u};if(c&&L.length>0){const h=L.filter(i=>i.name&&i.size>0);p._mobileFiles=h,k&&u&&(console.log("[Debug] Setting section admin mobile flags:",{isSectionAdmin:k,sectionId:u}),p._isSectionAdminMobile=!0,p._sectionId=u,p.sectionId=u),p._mobileTimestamp=Date.now()}await l(p),console.log("[TaskForm] Task submitted successfully"),D.current&&clearTimeout(D.current),C.current&&(a({type:"SET_SUBMITTING",isSubmitting:!1}),a({type:"RESET_FORM",sectionId:u}),a({type:"SET_SUCCESS",success:!0}),setTimeout(()=>{C.current&&a({type:"SET_SUCCESS",success:!1})},3e3))}catch(r){console.error("[Error] Task creation failed:",r),D.current&&clearTimeout(D.current),C.current&&(a({type:"SET_ERRORS",errors:{name:`Failed to create task: ${r instanceof Error?r.message:"Unknown error"}`}}),a({type:"SET_SUBMITTING",isSubmitting:!1}),a({type:"SET_UPLOAD_PROGRESS",progress:0}))}}},[_,b,L,N,k,u,l]);return e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-md overflow-hidden border border-gray-100 dark:border-gray-700",children:[e.jsx("div",{className:"px-4 sm:px-6 py-4 border-b border-gray-200 dark:border-gray-700 flex items-center bg-gradient-to-r from-blue-50 to-white dark:from-gray-800 dark:to-gray-750",children:e.jsxs("h3",{className:"text-lg sm:text-xl font-semibold text-gray-800 dark:text-white flex items-center",children:[e.jsx(ne,{className:"w-5 h-5 mr-2 text-blue-600 dark:text-blue-400"}),"Create New Task",k&&u&&e.jsx("span",{className:"ml-2 text-xs sm:text-sm text-green-600 dark:text-green-400 font-normal px-2 py-0.5 bg-green-100 dark:bg-green-900/30 rounded-full",children:"Section Task"})]})}),e.jsxs("form",{onSubmit:X,className:"p-4 sm:p-6 space-y-5 sm:space-y-6",children:[O&&e.jsx(We,{}),v&&P>0&&P<100&&e.jsx(He,{progress:P}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-5",children:[e.jsx("div",{className:"col-span-1 sm:col-span-2",children:e.jsx(Q,{id:"name",label:"Task Name",required:!0,error:g.name,children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 pointer-events-none",children:e.jsx(ne,{className:"w-5 h-5"})}),e.jsx("input",{type:"text",id:"name",name:"name",value:b.name,onChange:M,className:`w-full pl-10 pr-4 py-3 border ${g.name?"border-red-500 dark:border-red-500":"border-gray-300 dark:border-gray-600"} rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white text-sm sm:text-base touch-manipulation`,placeholder:"Enter task name","aria-required":"true","aria-invalid":!!g.name,"aria-describedby":g.name?"name-error":void 0,autoComplete:"off"})]})})}),e.jsx("div",{children:e.jsx(Q,{id:"category",label:"Category",error:g.category,children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 pointer-events-none",children:e.jsx(ge,{className:"w-5 h-5"})}),e.jsxs("select",{id:"category",name:"category",value:b.category,onChange:M,className:"w-full pl-10 pr-4 py-3 border border-gray-300 dark:border-gray-600 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white appearance-none text-sm sm:text-base touch-manipulation",children:[e.jsx("option",{value:"task",children:"Task"}),e.jsx("option",{value:"assignment",children:"Assignment"}),e.jsx("option",{value:"project",children:"Project"}),e.jsx("option",{value:"quiz",children:"Quiz"}),e.jsx("option",{value:"midterm",children:"Midterm"}),e.jsx("option",{value:"final-exam",children:"Final Exam"}),e.jsx("option",{value:"lab-report",children:"Lab Report"}),e.jsx("option",{value:"lab-performance",children:"Lab Performance"}),e.jsx("option",{value:"lab-final",children:"Lab Final"}),e.jsx("option",{value:"presentation",children:"Presentation"}),e.jsx("option",{value:"blc",children:"BLC"}),e.jsx("option",{value:"documents",children:"Documents"}),e.jsx("option",{value:"groups",children:"Groups"}),e.jsx("option",{value:"others",children:"Others"})]})]})})}),e.jsx("div",{children:e.jsx(Q,{id:"dueDate",label:"Due Date",required:!0,error:g.dueDate,children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 pointer-events-none",children:e.jsx(xe,{className:"w-5 h-5"})}),e.jsx("input",{type:"date",id:"dueDate",name:"dueDate",ref:x,value:b.dueDate,onChange:M,min:W(),className:`w-full pl-10 pr-4 py-3 border ${g.dueDate?"border-red-500 dark:border-red-500":"border-gray-300 dark:border-gray-600"} rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white text-sm sm:text-base touch-manipulation mobile-date-input`,"aria-required":"true","aria-invalid":!!g.dueDate,"aria-describedby":g.dueDate?"dueDate-error":void 0})]})})}),e.jsx("div",{className:"col-span-1 sm:col-span-2",children:e.jsx(Q,{id:"description",label:"Description",required:!0,error:g.description,children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute left-3 top-3 text-gray-400 pointer-events-none",children:e.jsx(Le,{className:"w-5 h-5"})}),e.jsx("textarea",{id:"description",name:"description",value:b.description,onChange:M,rows:4,className:`w-full pl-10 pr-4 py-2 border ${g.description?"border-red-500 dark:border-red-500":"border-gray-300 dark:border-gray-600"} rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white text-sm sm:text-base touch-manipulation`,placeholder:"Enter task description","aria-required":"true","aria-invalid":!!g.description,"aria-describedby":g.description?"description-error":void 0})]})})}),e.jsx("div",{className:"col-span-1 sm:col-span-2",children:e.jsxs(Q,{id:"files",label:"Attachments",error:g.files,children:[e.jsx("div",{className:"flex items-center justify-center w-full",children:e.jsxs("label",{htmlFor:"file-upload",className:"w-full flex flex-col items-center justify-center px-6 py-8 bg-gradient-to-br from-white to-gray-50 dark:from-gray-800 dark:to-gray-750 text-gray-600 dark:text-gray-400 rounded-xl border-2 border-dashed border-gray-300 dark:border-gray-600 cursor-pointer hover:border-blue-400 dark:hover:border-blue-500 hover:bg-blue-50 dark:hover:bg-gray-700/50 transition-all duration-200 touch-manipulation group","aria-label":"Upload files - tap to select files",children:[e.jsxs("div",{className:"flex flex-col items-center space-y-3",children:[e.jsx("div",{className:"p-3 bg-blue-100 dark:bg-blue-900/30 rounded-full group-hover:scale-110 transition-transform duration-200",children:e.jsx(pe,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:N()?"Tap to select files":"Click to upload or drag & drop"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"PDF, DOC, Images, etc. (Max 50MB per file)"})]})]}),e.jsx("input",{id:"file-upload",type:"file",className:"hidden",onChange:T,multiple:!0,accept:"image/*,application/pdf,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,text/plain,application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","aria-label":"File upload"})]})}),y.length>0&&e.jsxs("div",{className:"mt-4 space-y-2 max-h-48 overflow-y-auto pr-1",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsxs("p",{className:"text-xs font-semibold text-gray-600 dark:text-gray-400",children:["Attached Files (",L.length,")"]})}),L.map((d,r)=>e.jsx(Qe,{file:d,onRemove:()=>A(r)},`${d.name}-${r}`))]})]})}),k&&e.jsx("div",{className:"col-span-1 sm:col-span-2",children:e.jsx(Q,{id:"googleDriveLinks",label:"Google Drive Links",error:g.googleDriveLinks,children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 pointer-events-none",children:e.jsx(he,{className:"w-5 h-5"})}),e.jsx("input",{type:"url",id:"googleDriveLink",value:R,onChange:t,onKeyPress:G,placeholder:"Paste Google Drive link here...",className:`w-full pl-10 pr-4 py-3 border ${g.googleDriveLinks?"border-red-500 dark:border-red-500":"border-gray-300 dark:border-gray-600"} rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white text-sm sm:text-base touch-manipulation`,"aria-describedby":g.googleDriveLinks?"googleDriveLinks-error":void 0})]}),e.jsx("button",{type:"button",onClick:F,disabled:!R.trim(),className:`px-4 py-3 rounded-xl font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-900 touch-manipulation ${R.trim()?"bg-blue-600 hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600 text-white":"bg-gray-300 dark:bg-gray-600 text-gray-500 dark:text-gray-400 cursor-not-allowed"}`,"aria-label":"Add Google Drive link",children:e.jsx(be,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[e.jsx("p",{children:"Supported: Google Drive files, folders, Docs, Sheets, Slides, and Forms"}),e.jsx("p",{children:"Only section administrators can attach Google Drive links"})]}),S.length>0&&e.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto pr-1",children:S.map((d,r)=>e.jsx(Xe,{url:d,onRemove:()=>z(r)},`${d}-${r}`))})]})})})]}),e.jsx("div",{className:"flex justify-end pt-2",children:e.jsx("button",{type:"submit",disabled:v||E,className:`px-4 py-2 rounded-md text-white font-medium shadow-sm 
              ${v||E?"bg-blue-400 dark:bg-blue-600 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600"}
              transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-900 w-full sm:w-auto`,children:v||E?"Creating...":"Create Task"})})]})]})}function Je({task:l,onClose:u,onUpdate:k}){const E=r=>{if(!r)return[];const s=[],c=/(?:^- |\n- )?\[([^\]]+)\]\(([^)]+)\)/g;let p;for(;(p=c.exec(r))!==null;){const[,h,i]=p;if(i.includes("supabase.co/storage")||i.includes("task-attachments")||h.match(/\.[a-zA-Z0-9]+$/)){const j=i.match(/task-files\/([^?]+)/),K=j?j[1]:void 0;s.push({name:h,url:i,path:K})}}return s},w=r=>{if(!r)return"";let s=r.replace(/(?:^- |\n- )?\[([^\]]+)\]\(([^)]+)\)/g,(c,p,h)=>h.includes("supabase.co/storage")||h.includes("task-attachments")||p.match(/\.[a-zA-Z0-9]+$/)?"":c);return s=s.replace(/\n*\*\*Attachments:\*\*\n*((?:- \[.*?\]\(.*?\)\n*)*)/g,""),s=s.replace(/\n*\*\*Links:\*\*\n*((?:- \[.*?\]\(.*?\)\n*)*)/g,""),s=s.replace(/\*This task is assigned to section ID: [a-f0-9-]+\*/g,""),s=s.replace(/\n{3,}/g,`

`).replace(/^\n+|\n+$/g,"").trim(),s},[a,b]=o.useState({name:l.name||"",category:l.category||"task",dueDate:l.dueDate||"",description:w(l.description||""),status:l.status||"my-tasks"}),[g,L]=o.useState(E(l.description||"")),[y,S]=o.useState([]),[R,v]=o.useState({}),[O,P]=o.useState(!1),D=o.useRef(null);o.useEffect(()=>{const r=s=>{s.key==="Escape"&&u()};return document.addEventListener("keydown",r),()=>document.removeEventListener("keydown",r)},[u]);const C=r=>{const{name:s,value:c}=r.target;b(p=>({...p,[s]:c}))},I=()=>typeof crypto!="undefined"&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){const s=Math.random()*16|0;return(r=="x"?s:s&3|8).toString(16)}),x=async r=>{const s=r.name.split(".").pop(),c=`${I()}.${s}`,p=`task-files/${c}`,{data:h,error:i}=await te.storage.from("task-attachments").upload(p,r,{cacheControl:"3600",upsert:!1,contentType:r.type});if(i)throw new Error(`Upload failed: ${i.message}`);if(!h)throw new Error("Upload completed but no data returned");const{data:{publicUrl:j}}=te.storage.from("task-attachments").getPublicUrl(p);return{url:j,path:c}},N=async r=>{if(!r)return;const{error:s}=await te.storage.from("task-attachments").remove([`task-files/${r}`]);if(s)throw console.error("Error deleting file:",s),s},_=r=>{const s=r.target.files;if(!s||s.length===0)return;const c=Array.from(s),p=10*1024*1024,h=c.filter(i=>i.size>p?(alert(`File "${i.name}" is too large. Maximum size is 10MB.`),!1):!0);if(h.length>0){S(j=>[...j,...h]);const i={};h.forEach(j=>{i[j.name]=0}),v(j=>({...j,...i}))}r.target.value=""},M=()=>{var r;(r=D.current)==null||r.click()},T=r=>{r.preventDefault(),r.stopPropagation()},A=r=>{r.preventDefault(),r.stopPropagation()},t=r=>{r.preventDefault(),r.stopPropagation()},F=r=>{r.preventDefault(),r.stopPropagation();const s=Array.from(r.dataTransfer.files);if(s.length===0)return;const c=10*1024*1024,p=s.filter(h=>h.size>c?(alert(`File "${h.name}" is too large. Maximum size is 10MB.`),!1):!0);if(p.length>0){S(i=>[...i,...p]);const h={};p.forEach(i=>{h[i.name]=0}),v(i=>({...i,...h}))}},z=r=>{S(s=>s.filter((c,p)=>p!==r))},G=async r=>{const s=g[r];if(s)try{s.path&&await N(s.path),L(c=>c.filter((p,h)=>h!==r))}catch(c){console.error("Error removing attachment:",c),L(p=>p.filter((h,i)=>i!==r))}},W=async r=>{if(r.preventDefault(),!(!a.name.trim()||!a.dueDate||!a.description.trim())){P(!0);try{const s=[];for(const i of y)try{v(Z=>({...Z,[i.name]:25}));const{url:j,path:K}=await x(i);s.push({name:i.name,url:j,path:K}),v(Z=>({...Z,[i.name]:100}))}catch(j){throw v(K=>({...K,[i.name]:0})),new Error(`Failed to upload ${i.name}: ${j instanceof Error?j.message:"Unknown error"}`)}let c=a.description.trim();const p=[...g,...s.map(i=>({name:i.name,url:i.url}))];p.length>0&&(c+=`

**Attachments:**
`,p.forEach(i=>{c+=`- [${i.name}](${i.url})
`})),l.sectionId&&(c+=`

*This task is assigned to section ID: ${l.sectionId}*`);const h={...a,description:c};await k(l.id,h),u()}catch(s){console.error("Failed to update task:",s),alert(`Error: ${s instanceof Error?s.message:"Unknown error occurred"}`)}finally{P(!1),v({})}}},X=[{value:"assignment",label:"Assignment"},{value:"blc",label:"BLC"},{value:"documents",label:"Documents"},{value:"final-exam",label:"Final Exam"},{value:"groups",label:"Groups"},{value:"lab-final",label:"Lab Final"},{value:"lab-performance",label:"Lab Performance"},{value:"lab-report",label:"Lab Report"},{value:"midterm",label:"Midterm"},{value:"presentation",label:"Presentation"},{value:"project",label:"Project"},{value:"quiz",label:"Quiz"},{value:"task",label:"Task"},{value:"others",label:"Others"}],d=[{value:"my-tasks",label:"To Do"},{value:"in-progress",label:"In Progress"},{value:"completed",label:"Completed"}];return e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto border border-gray-200 dark:border-gray-700",onClick:r=>r.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 dark:bg-blue-900/30 rounded-xl flex items-center justify-center",children:e.jsx(se,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Edit Task"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Update task information"})]})]}),e.jsx("button",{onClick:u,className:"w-8 h-8 rounded-lg bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 flex items-center justify-center transition-colors",children:e.jsx(re,{className:"w-4 h-4 text-gray-600 dark:text-gray-400"})})]}),e.jsxs("form",{onSubmit:W,className:"p-6 space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Task Name *"}),e.jsx("input",{type:"text",name:"name",value:a.name,onChange:C,className:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:"Enter task name",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Category *"}),e.jsxs("div",{className:"relative",children:[e.jsx(ge,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("select",{name:"category",value:a.category,onChange:C,className:"w-full pl-10 pr-4 py-3 bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all appearance-none",required:!0,children:X.map(r=>e.jsx("option",{value:r.value,children:r.label},r.value))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Due Date *"}),e.jsxs("div",{className:"relative",children:[e.jsx(xe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"date",name:"dueDate",value:a.dueDate,onChange:C,className:"w-full pl-10 pr-4 py-3 bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",required:!0})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Status"}),e.jsx("div",{className:"flex gap-2",children:d.map(r=>e.jsx("button",{type:"button",onClick:()=>b(s=>({...s,status:r.value})),className:`flex-1 py-2.5 px-4 rounded-lg text-sm font-medium transition-all ${a.status===r.value?"bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 border-2 border-blue-200 dark:border-blue-700":"bg-gray-50 dark:bg-gray-800 text-gray-600 dark:text-gray-400 border-2 border-gray-200 dark:border-gray-700 hover:bg-gray-100 dark:hover:bg-gray-700"}`,children:r.label},r.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Description *"}),e.jsx("textarea",{name:"description",value:a.description,onChange:C,rows:4,className:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all resize-none",placeholder:"Describe the task details...",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Te,{className:"w-4 h-4"}),"Attachments",g.length+y.length>0&&e.jsxs("span",{className:"text-xs bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 px-2 py-1 rounded-full",children:[g.length+y.length," file",g.length+y.length!==1?"s":""]})]})}),e.jsxs("div",{className:"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-xl p-6 text-center hover:border-blue-400 dark:hover:border-blue-500 transition-colors cursor-pointer",onClick:M,onDragOver:T,onDragEnter:A,onDragLeave:t,onDrop:F,children:[e.jsx("input",{ref:D,type:"file",multiple:!0,onChange:_,className:"hidden",accept:".pdf,.doc,.docx,.txt,.jpg,.jpeg,.png,.gif,.zip,.rar"}),e.jsx(pe,{className:"w-8 h-8 text-gray-400 mx-auto mb-2"}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:[e.jsx("span",{className:"text-blue-600 dark:text-blue-400 font-medium hover:underline",children:"Click to upload"})," or drag and drop"]}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500",children:"PDF, DOC, TXT, Images up to 10MB"}),y.length>0&&e.jsxs("div",{className:"mt-3 text-xs text-green-600 dark:text-green-400",children:[y.length," file",y.length!==1?"s":""," ready to upload"]})]}),g.length>0&&e.jsxs("div",{className:"mt-3 space-y-2",children:[e.jsx("h4",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Current Attachments"}),g.map((r,s)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-700",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-100 dark:bg-blue-900/30 rounded-lg flex items-center justify-center",children:e.jsx(se,{className:"w-4 h-4 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white truncate max-w-[200px]",children:r.name}),e.jsx("p",{className:"text-xs text-blue-600 dark:text-blue-400",children:"Existing file"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:()=>window.open(r.url,"_blank"),className:"w-8 h-8 rounded-lg bg-blue-100 dark:bg-blue-900/30 hover:bg-blue-200 dark:hover:bg-blue-900/50 flex items-center justify-center transition-colors",title:"View file",children:e.jsx(me,{className:"w-4 h-4 text-blue-600 dark:text-blue-400"})}),e.jsx("button",{type:"button",onClick:c=>{c.preventDefault(),c.stopPropagation(),G(s)},className:"w-8 h-8 rounded-lg bg-red-100 dark:bg-red-900/30 hover:bg-red-200 dark:hover:bg-red-900/50 flex items-center justify-center transition-colors",title:"Remove file",disabled:O,children:e.jsx(J,{className:"w-4 h-4 text-red-600 dark:text-red-400"})})]})]},`existing-${r.name}-${s}`))]}),y.length>0&&e.jsxs("div",{className:"mt-3 space-y-2",children:[e.jsx("h4",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"New Attachments"}),y.map((r,s)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 dark:bg-green-900/20 rounded-lg border border-green-200 dark:border-green-700",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-green-100 dark:bg-green-900/30 rounded-lg flex items-center justify-center",children:e.jsx(se,{className:"w-4 h-4 text-green-600 dark:text-green-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white truncate",children:r.name}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("p",{className:"text-xs text-green-600 dark:text-green-400",children:[(r.size/1024).toFixed(1)," KB â€¢ New"]}),R[r.name]!==void 0&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-16 h-1 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-green-500 transition-all duration-300",style:{width:`${R[r.name]||0}%`}})}),e.jsxs("span",{className:"text-xs text-green-600 dark:text-green-400",children:[Math.round(R[r.name]||0),"%"]})]})]})]})]}),e.jsx("button",{type:"button",onClick:c=>{c.preventDefault(),c.stopPropagation(),z(s)},className:"w-8 h-8 rounded-lg bg-red-100 dark:bg-red-900/30 hover:bg-red-200 dark:hover:bg-red-900/50 flex items-center justify-center transition-colors",disabled:O,children:e.jsx(J,{className:"w-4 h-4 text-red-600 dark:text-red-400"})})]},`new-${r.name}-${r.size}-${s}`))]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:u,className:"flex-1 py-3 px-4 bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300 rounded-xl hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors font-medium",disabled:O,children:"Cancel"}),e.jsx("button",{type:"submit",disabled:O||!a.name.trim()||!a.dueDate||!a.description.trim(),className:"flex-1 py-3 px-4 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-300 dark:disabled:bg-gray-700 text-white rounded-xl transition-colors font-medium flex items-center justify-center gap-2",children:O?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),y.length>0?"Uploading & Saving...":"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ae,{className:"w-4 h-4"}),"Save Changes"]})})]})]})]})})}function Ye({tasks:l,onDeleteTask:u,onUpdateTask:k,isSectionAdmin:E=!1,viewMode:w="table",selectedTaskIds:a=[],onToggleSelection:b=()=>{},onSelectAll:g=()=>{},sortBy:L="dueDate",sortOrder:y="asc",onSort:S=()=>{}}){const[R,v]=o.useState(null);o.useState(null);const[O,P]=o.useState(!1);o.useState(null),o.useState(null);const[D,C]=o.useState(null);o.useRef(null),o.useEffect(()=>{const t=()=>{P(window.innerWidth<768)};return t(),window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[]);const I=t=>{switch(t){case"completed":return"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400";case"in-progress":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400";default:return"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400"}},x=t=>{switch(t){case"completed":return e.jsx(Y,{className:"w-3 h-3"});case"in-progress":return e.jsx(Ie,{className:"w-3 h-3"});default:return e.jsx(ne,{className:"w-3 h-3"})}},N=t=>{switch(t){case"completed":return"Completed";case"in-progress":return"In Progress";default:return"To Do"}},_=t=>{switch(t){case"high":return e.jsx("span",{className:"px-2 py-0.5 text-xs rounded-full bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400",children:"High"});case"medium":return e.jsx("span",{className:"px-2 py-0.5 text-xs rounded-full bg-orange-100 text-orange-800 dark:bg-orange-900/30 dark:text-orange-400",children:"Medium"});case"low":return e.jsx("span",{className:"px-2 py-0.5 text-xs rounded-full bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400",children:"Low"});default:return null}},M=async(t,F)=>{try{await k(t,F),v(null)}catch(z){console.error("Error updating task:",z)}},T=t=>L!==t?null:y==="asc"?e.jsx(Re,{className:"w-3.5 h-3.5 ml-1 inline-block"}):e.jsx($e,{className:"w-3.5 h-3.5 ml-1 inline-block"}),A=async t=>{const F=t.description.replace(/\*\*Attachments:\*\*[\s\S]*?(?=\n\n|$)/g,"").trim(),z=`
ðŸ“‹ TASK: ${t.name}
ðŸ“… Due Date: ${le(t.dueDate)}
ðŸ·ï¸ Category: ${t.category}

ðŸ“ Description:
${F}

ðŸŒ View: https://nesttask.vercel.app/
    `.trim();try{await navigator.clipboard.writeText(z),C(t.id),setTimeout(()=>C(null),2e3)}catch(G){console.error("Failed to copy task details:",G)}};return l.length===0?e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm p-8 text-center",children:e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No tasks available"})}):e.jsxs(e.Fragment,{children:[w==="table"?e.jsx("div",{className:"relative overflow-hidden rounded-lg",children:e.jsx("div",{className:"overflow-x-auto -mx-4 sm:mx-0",children:e.jsx("div",{className:"inline-block min-w-full align-middle",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"w-12 sm:w-8 px-2 sm:px-4 py-3",children:e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("button",{onClick:g,className:"p-1 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-700","aria-label":"Select all tasks",children:a.length>0&&a.length===l.length?e.jsx(ee,{className:"w-4 h-4 sm:w-5 sm:h-5 text-blue-500 dark:text-blue-400"}):e.jsx(oe,{className:"w-4 h-4 sm:w-5 sm:h-5 text-gray-400 dark:text-gray-500"})})})}),e.jsx("th",{className:"px-2 sm:px-4 py-3 text-left",children:e.jsxs("button",{onClick:()=>S("name"),className:"flex items-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider hover:text-gray-700 dark:hover:text-gray-200",children:[e.jsx("span",{className:"hidden sm:inline",children:"Task "}),"Name",T("name")]})}),e.jsx("th",{className:"hidden sm:table-cell px-4 py-3 text-left",children:e.jsxs("button",{onClick:()=>S("category"),className:"flex items-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider hover:text-gray-700 dark:hover:text-gray-200",children:["Category",T("category")]})}),e.jsx("th",{className:"px-2 sm:px-4 py-3 text-left",children:e.jsxs("button",{onClick:()=>S("dueDate"),className:"flex items-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider hover:text-gray-700 dark:hover:text-gray-200",children:[e.jsx("span",{className:"hidden sm:inline",children:"Due "}),"Date",T("dueDate")]})}),e.jsx("th",{className:"px-2 sm:px-4 py-3 text-left",children:e.jsxs("button",{onClick:()=>S("status"),className:"flex items-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider hover:text-gray-700 dark:hover:text-gray-200",children:["Status",T("status")]})}),e.jsx("th",{className:"px-2 sm:px-4 py-3 text-right",children:e.jsx("span",{className:"sr-only",children:"Actions"})})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:l.map(t=>e.jsxs("tr",{className:`group hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors ${a.includes(t.id)?"bg-blue-50 dark:bg-blue-900/20":""}`,children:[e.jsx("td",{className:"w-12 sm:w-8 px-2 sm:px-4 py-2",children:e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("button",{onClick:()=>b(t.id),className:"p-1 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-700",children:a.includes(t.id)?e.jsx(ee,{className:"w-4 h-4 sm:w-5 sm:h-5 text-blue-500 dark:text-blue-400"}):e.jsx(oe,{className:"w-4 h-4 sm:w-5 sm:h-5 text-gray-400 dark:text-gray-500"})})})}),e.jsx("td",{className:"px-2 sm:px-4 py-2",children:e.jsxs("div",{className:"max-w-xs sm:max-w-sm",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white truncate",children:t.name}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 line-clamp-1 sm:hidden",children:t.category.replace(/-/g," ")})]})}),e.jsxs("td",{className:"hidden sm:table-cell px-4 py-2",children:[e.jsx("div",{className:"text-sm capitalize text-gray-900 dark:text-white",children:t.category.replace(/-/g," ")}),t.priority&&e.jsx("div",{className:"mt-1",children:_(t.priority)})]}),e.jsx("td",{className:"px-2 sm:px-4 py-2",children:e.jsxs("span",{className:`text-xs sm:text-sm flex items-center gap-1 ${ae(t.dueDate,t.status)?"text-red-600 dark:text-red-400":"text-gray-600 dark:text-gray-400"}`,children:[ae(t.dueDate,t.status)&&e.jsx(Oe,{className:"w-3 h-3 sm:w-3.5 sm:h-3.5"}),e.jsx("span",{className:"whitespace-nowrap",children:le(t.dueDate)})]})}),e.jsx("td",{className:"px-2 sm:px-4 py-2",children:e.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium ${I(t.status)}`,children:[x(t.status),e.jsx("span",{className:"hidden xs:inline",children:N(t.status)})]})}),e.jsx("td",{className:"px-2 sm:px-4 py-2 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-1 sm:gap-2",children:[e.jsx("button",{onClick:()=>A(t),className:`p-1 sm:p-1.5 rounded-lg transition-colors duration-200 ${D===t.id?"bg-green-100 text-green-600 dark:bg-green-900/30 dark:text-green-400":"hover:bg-gray-100 text-gray-500 dark:text-gray-400 dark:hover:bg-gray-700"}`,title:"Copy task details",children:D===t.id?e.jsx(de,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"}):e.jsx(ce,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"})}),e.jsx("button",{onClick:()=>v(t),className:"p-1 sm:p-1.5 rounded-lg transition-colors duration-200 hover:bg-blue-100 text-blue-600 dark:text-blue-400 dark:hover:bg-blue-900/30",title:"Edit task",children:e.jsx(ue,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"})}),e.jsx("button",{onClick:()=>k(t.id,{status:t.status==="completed"?"my-tasks":"completed"}),className:`p-1 sm:p-1.5 rounded-lg transition-colors duration-200 ${t.status==="completed"?"bg-green-100 text-green-600 dark:bg-green-900/30 dark:text-green-400":"hover:bg-gray-100 text-gray-500 dark:text-gray-400 dark:hover:bg-gray-700"}`,title:t.status==="completed"?"Mark as incomplete":"Mark as complete",children:e.jsx(Y,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"})}),e.jsx("button",{onClick:()=>u(t.id),className:"p-1 sm:p-1.5 hover:bg-red-100 text-red-600 dark:hover:bg-red-900/30 dark:text-red-400 rounded-lg transition-colors duration-200",title:"Delete task",children:e.jsx(J,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"})})]})})]},t.id))})]})})})}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 p-4",children:l.map(t=>e.jsxs("div",{className:`group bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4 hover:shadow-md transition-all ${a.includes(t.id)?"ring-2 ring-blue-500 dark:ring-blue-400":""}`,children:[e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-white line-clamp-2",children:t.name}),e.jsx("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400 line-clamp-2",children:t.description})]})}),e.jsxs("div",{className:"mt-4 flex flex-wrap items-center gap-2 text-xs",children:[e.jsx("span",{className:"px-2 py-1 rounded-md bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300",children:t.category}),e.jsx("span",{className:`px-2 py-1 rounded-md ${ae(t.dueDate)&&t.status!=="completed"?"bg-red-100 text-red-600 dark:bg-red-900/30 dark:text-red-400":"bg-gray-100 text-gray-600 dark:bg-gray-700 dark:text-gray-300"}`,children:le(t.dueDate)})]}),e.jsxs("div",{className:"mt-4 flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>A(t),className:`p-1 sm:p-1.5 rounded-lg transition-colors duration-200 ${D===t.id?"bg-green-100 text-green-600 dark:bg-green-900/30 dark:text-green-400":"hover:bg-gray-100 text-gray-500 dark:text-gray-400 dark:hover:bg-gray-700"}`,title:"Copy task details",children:D===t.id?e.jsx(de,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"}):e.jsx(ce,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"})}),e.jsx("button",{onClick:()=>v(t),className:"p-1 sm:p-1.5 rounded-lg transition-colors duration-200 hover:bg-blue-100 text-blue-600 dark:text-blue-400 dark:hover:bg-blue-900/30",title:"Edit task",children:e.jsx(ue,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"})}),e.jsx("button",{onClick:()=>k(t.id,{status:t.status==="completed"?"my-tasks":"completed"}),className:`p-1 sm:p-1.5 rounded-lg transition-colors duration-200 ${t.status==="completed"?"bg-green-100 text-green-600 dark:bg-green-900/30 dark:text-green-400":"hover:bg-gray-100 text-gray-500 dark:text-gray-400 dark:hover:bg-gray-700"}`,title:t.status==="completed"?"Mark as incomplete":"Mark as complete",children:e.jsx(Y,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"})}),e.jsx("button",{onClick:()=>u(t.id),className:"p-1 sm:p-1.5 hover:bg-red-100 text-red-600 dark:hover:bg-red-900/30 dark:text-red-400 rounded-lg transition-colors duration-200",title:"Delete task",children:e.jsx(J,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"})})]})]},t.id))}),R&&e.jsx(Je,{task:R,onClose:()=>v(null),onUpdate:M,isSectionAdmin:E})]})}function Tr({tasks:l,onCreateTask:u,onDeleteTask:k,onUpdateTask:E,showTaskForm:w=!1,sectionId:a,isSectionAdmin:b=!1,isLoading:g=!1,isCreatingTask:L=!1,onTaskCreateStart:y,onTaskCreateEnd:S,onRefresh:R}){const[v,O]=o.useState(!0),[P,D]=o.useState(!1),[C,I]=o.useState("table"),[x,N]=o.useState({category:"all",status:"all",search:"",startDate:"",endDate:""}),[_,M]=o.useState({by:"createdAt",order:"desc"}),[T,A]=o.useState([]),[t,F]=o.useState(!1),[z,G]=o.useState([]),[W,X]=o.useState(0),d=o.useRef(null),[r,s]=o.useState(""),c=o.useRef(!1),p=o.useRef([]);o.useEffect(()=>{O(!0)},[w]),o.useEffect(()=>{if(!c.current&&l!==p.current){const n=Date.now();n-W>100&&(G(l),X(n),p.current=l)}},[l,W]),o.useEffect(()=>(d.current&&window.clearTimeout(d.current),d.current=window.setTimeout(()=>{s(x.search)},300),()=>{d.current&&window.clearTimeout(d.current)}),[x.search]);const h=o.useMemo(()=>z.filter(n=>{if(x.category!=="all"&&n.category!==x.category||x.status!=="all"&&n.status!==x.status||x.startDate&&new Date(n.dueDate)<new Date(x.startDate))return!1;if(x.endDate){const m=new Date(x.endDate);if(m.setHours(23,59,59,999),new Date(n.dueDate)>m)return!1}if(r){const m=r.toLowerCase();return n.name.toLowerCase().includes(m)||n.description.toLowerCase().includes(m)||n.category.toLowerCase().includes(m)}return!0}),[z,x.category,x.status,x.startDate,x.endDate,r]),i=o.useMemo(()=>[...h].sort((n,m)=>{let f=0;switch(_.by){case"dueDate":f=new Date(n.dueDate).getTime()-new Date(m.dueDate).getTime();break;case"name":f=n.name.localeCompare(m.name);break;case"category":f=n.category.localeCompare(m.category);break;case"createdAt":const $=n.createdAt?new Date(n.createdAt).getTime():Date.now(),B=m.createdAt?new Date(m.createdAt).getTime():Date.now();f=$-B;break;case"priority":const U={high:3,medium:2,low:1},V=n.priority||"medium",De=m.priority||"medium";f=(U[V]||0)-(U[De]||0);break}return _.order==="asc"?f:-f}),[h,_.by,_.order]),j=o.useCallback(async n=>{if(c.current){console.log("Task creation already in progress");return}c.current=!0;try{y==null||y();const m={...n};if(b&&a){const f={...m,sectionId:a};await u(f,a)}else await u(m);N({category:"all",status:"all",startDate:"",endDate:"",search:""}),H("Task created successfully")}catch(m){console.error("Error creating task:",m),q(`Failed to create task: ${m.message||"Please try again."}`)}finally{c.current=!1,S==null||S()}},[b,u,a,y,S]),K=o.useCallback(async n=>{if(!c.current){c.current=!0;try{await k(n),G(m=>m.filter(f=>f.id!==n)),H("Task deleted successfully")}catch(m){console.error("Error deleting task:",m),q(`Error deleting task: ${m.message||"Please try again."}`)}finally{c.current=!1}}},[k]),Z=o.useCallback(async(n,m)=>{if(!c.current){c.current=!0;try{await E(n,m),G(f=>f.map($=>$.id===n?{...$,...m,updatedAt:new Date().toISOString()}:$)),H("Task updated successfully")}catch(f){console.error("Error updating task:",f),q(`Error updating task: ${f.message||"Please try again."}`)}finally{c.current=!1}}},[E]),ye=async()=>{if(!(!T.length||t))try{F(!0);let n=0;const m=[];for(const f of T)try{await k(f),n++,G($=>$.filter(B=>B.id!==f))}catch($){m.push(`Task ${f}: ${$.message}`)}n>0&&H(`${n} tasks deleted successfully`),m.length>0&&q(`Failed to delete ${m.length} tasks`),A([])}catch(n){q(`Error deleting tasks: ${n.message||"Please try again."}`)}finally{F(!1)}},ie=async n=>{if(!(T.length===0||t)){F(!0);try{let m=0;const f=[];for(const $ of T)try{await E($,{status:n,updatedAt:new Date().toISOString()}),m++,G(B=>B.map(U=>U.id===$?{...U,status:n,updatedAt:new Date().toISOString()}:U))}catch(B){f.push(`Task ${$}: ${B.message}`)}m>0&&H(`Updated ${m} tasks to ${n}`),f.length>0&&q(`Failed to update ${f.length} tasks`),A([])}catch(m){q(`Error updating task status: ${m.message||"Please try again."}`)}finally{F(!1)}}},ke=n=>{A(m=>m.includes(n)?m.filter(f=>f!==n):[...m,n])},ve=()=>{A(n=>n.length===i.length?[]:i.map(m=>m.id))},je=()=>{try{const n=["Name","Category","Due Date","Status","Description"],m=i.map(V=>[`"${V.name.replace(/"/g,'""')}"`,`"${V.category.replace(/"/g,'""')}"`,`"${new Date(V.dueDate).toLocaleDateString()}"`,`"${V.status==="my-tasks"?"To Do":V.status==="in-progress"?"In Progress":"Completed"}"`,`"${V.description.replace(/"/g,'""')}"`]),f=[n.join(","),...m.map(V=>V.join(","))].join(`
`),$=new Blob([f],{type:"text/csv;charset=utf-8;"}),B=URL.createObjectURL($),U=document.createElement("a");U.setAttribute("href",B),U.setAttribute("download",`tasks_export_${a?`section_${a}_`:""}${new Date().toISOString().split("T")[0]}.csv`),U.style.visibility="hidden",document.body.appendChild(U),U.click(),document.body.removeChild(U),URL.revokeObjectURL(B),H("Tasks exported successfully")}catch(n){q("Failed to export tasks. Please try again.")}},we=()=>{N({category:"all",status:"all",startDate:"",endDate:"",search:""}),s(""),M({by:"createdAt",order:"desc"})},Ne=n=>{(n==="createdAt"||n==="dueDate"||n==="name"||n==="category"||n==="priority")&&M(m=>({by:n,order:m.by===n&&m.order==="asc"?"desc":"asc"}))};return e.jsxs("div",{className:"space-y-4",children:[v&&e.jsx("div",{children:e.jsx(Ze,{onSubmit:j,sectionId:a,isSectionAdmin:b,isSubmitting:L})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm",children:e.jsx("div",{className:"p-3 sm:p-4 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex flex-col space-y-3 sm:space-y-0 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("button",{className:"inline-flex items-center justify-center px-3 sm:px-4 py-1.5 sm:py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors duration-200",onClick:()=>O(!v),disabled:g,children:v?e.jsxs(e.Fragment,{children:[e.jsx(Me,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4 mr-1"}),e.jsx("span",{className:"hidden xs:inline",children:"Hide Form"}),e.jsx("span",{className:"xs:hidden",children:"Hide"})]}):e.jsxs(e.Fragment,{children:[e.jsx(be,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4 mr-1"}),e.jsx("span",{className:"hidden xs:inline",children:"Create Task"}),e.jsx("span",{className:"xs:hidden",children:"Create"})]})}),e.jsxs("button",{className:`
                  inline-flex items-center justify-center px-3 sm:px-4 py-1.5 sm:py-2 text-sm font-medium rounded-lg transition-colors duration-200
                  ${g?"bg-gray-100 text-gray-400 cursor-not-allowed dark:bg-gray-700 dark:text-gray-500":P?"bg-blue-50 text-blue-600 dark:bg-blue-900/30 dark:text-blue-400":"bg-gray-100 text-gray-700 hover:bg-gray-200 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700"}
                `,onClick:()=>D(!P),disabled:g,children:[e.jsx(Ge,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4 mr-1"}),e.jsx("span",{className:"hidden xs:inline",children:"Filters"})]}),e.jsxs("div",{className:"inline-flex rounded-lg border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800",children:[e.jsx("button",{className:`px-2 sm:px-3 py-1.5 sm:py-2 rounded-l-lg transition-colors duration-200 ${C==="table"?"bg-blue-50 text-blue-600 dark:bg-blue-900/30 dark:text-blue-400":"text-gray-600 hover:bg-gray-50 dark:text-gray-400 dark:hover:bg-gray-700"}`,onClick:()=>I("table"),title:"Table view",children:e.jsx(Fe,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"})}),e.jsx("button",{className:`px-2 sm:px-3 py-1.5 sm:py-2 rounded-r-lg transition-colors duration-200 ${C==="grid"?"bg-blue-50 text-blue-600 dark:bg-blue-900/30 dark:text-blue-400":"text-gray-600 hover:bg-gray-50 dark:text-gray-400 dark:hover:bg-gray-700"}`,onClick:()=>I("grid"),title:"Grid view",children:e.jsx(_e,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"})})]}),e.jsxs("button",{className:"inline-flex items-center justify-center px-3 sm:px-4 py-1.5 sm:py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",onClick:je,disabled:g||i.length===0,title:"Export to CSV",children:[e.jsx(ze,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4 mr-1"}),e.jsx("span",{className:"hidden xs:inline",children:"Export"})]}),R&&e.jsxs("button",{className:"inline-flex items-center justify-center px-3 sm:px-4 py-1.5 sm:py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",onClick:R,disabled:g,title:"Refresh tasks",children:[e.jsx(Be,{className:`w-3.5 h-3.5 sm:w-4 sm:h-4 mr-1 ${g?"animate-spin":""}`}),e.jsx("span",{className:"hidden xs:inline",children:"Refresh"})]})]}),e.jsx("div",{className:"relative w-full sm:w-auto sm:min-w-[200px] md:min-w-[240px]",children:e.jsxs("div",{className:"flex items-center w-full px-3 py-1.5 sm:py-2 bg-gray-50 border border-gray-200 rounded-lg dark:bg-gray-800 dark:border-gray-700 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors duration-200",children:[e.jsx(Ve,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4 text-gray-400 dark:text-gray-500"}),e.jsx("input",{type:"text",placeholder:"Search tasks...",value:x.search,onChange:n=>N({...x,search:n.target.value}),className:"w-full ml-2 text-sm bg-transparent border-none outline-none focus:ring-0 text-gray-700 dark:text-gray-300 placeholder-gray-500 dark:placeholder-gray-400"}),x.search&&e.jsx("button",{onClick:()=>N({...x,search:""}),className:"p-0.5 sm:p-1 ml-1 text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200",children:e.jsx(re,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"})})]})})]})})}),P&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm p-3 sm:p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3 sm:mb-4",children:[e.jsx("h3",{className:"text-xs sm:text-sm font-medium text-gray-700 dark:text-gray-300",children:"Filter Tasks"}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("button",{onClick:we,className:"text-xs flex items-center gap-1 text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 py-1 px-2",children:[e.jsx(Ue,{className:"w-3 h-3 sm:w-3.5 sm:h-3.5"}),"Reset"]})})]}),e.jsxs("div",{className:"grid grid-cols-1 xs:grid-cols-2 md:grid-cols-4 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Status"}),e.jsxs("select",{value:x.status,onChange:n=>N({...x,status:n.target.value}),className:"w-full px-2 sm:px-3 py-1.5 sm:py-2 border dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white text-xs sm:text-sm",children:[e.jsx("option",{value:"all",children:"All Statuses"}),e.jsx("option",{value:"my-tasks",children:"To Do"}),e.jsx("option",{value:"in-progress",children:"In Progress"}),e.jsx("option",{value:"completed",children:"Completed"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Category"}),e.jsxs("select",{value:x.category,onChange:n=>N({...x,category:n.target.value}),className:"w-full px-2 sm:px-3 py-1.5 sm:py-2 border dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white text-xs sm:text-sm",children:[e.jsx("option",{value:"all",children:"All Categories"}),e.jsx("option",{value:"assignment",children:"Assignment"}),e.jsx("option",{value:"blc",children:"BLC"}),e.jsx("option",{value:"documents",children:"Documents"}),e.jsx("option",{value:"final-exam",children:"Final Exam"}),e.jsx("option",{value:"groups",children:"Groups"}),e.jsx("option",{value:"lab-final",children:"Lab Final"}),e.jsx("option",{value:"lab-performance",children:"Lab Performance"}),e.jsx("option",{value:"lab-report",children:"Lab Report"}),e.jsx("option",{value:"midterm",children:"Midterm"}),e.jsx("option",{value:"presentation",children:"Presentation"}),e.jsx("option",{value:"project",children:"Project"}),e.jsx("option",{value:"quiz",children:"Quiz"}),e.jsx("option",{value:"task",children:"Task"}),e.jsx("option",{value:"others",children:"Others"})]})]}),e.jsxs("div",{className:"xs:col-span-2",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Date Range"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("div",{children:e.jsx("input",{type:"date",value:x.startDate,onChange:n=>N({...x,startDate:n.target.value}),className:"w-full px-2 sm:px-3 py-1.5 sm:py-2 border dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white text-xs sm:text-sm",placeholder:"Start date"})}),e.jsx("div",{children:e.jsx("input",{type:"date",value:x.endDate,onChange:n=>N({...x,endDate:n.target.value}),className:"w-full px-2 sm:px-3 py-1.5 sm:py-2 border dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white text-xs sm:text-sm",placeholder:"End date"})})]})]})]})]}),T.length>0&&e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-xl p-2 sm:p-3 flex flex-wrap items-center justify-between gap-2 sm:gap-3",children:[e.jsx("div",{className:"flex items-center",children:e.jsxs("span",{className:"text-xs sm:text-sm font-medium text-blue-700 dark:text-blue-300",children:[T.length," ",T.length===1?"task":"tasks"," selected"]})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-1 sm:gap-2",children:[e.jsxs("button",{onClick:()=>ie("completed"),disabled:t,className:"px-2 py-1 sm:px-2.5 sm:py-1.5 text-xs bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:bg-green-300 disabled:cursor-not-allowed flex items-center gap-1",children:[e.jsx(ee,{className:"w-3 h-3 sm:w-3.5 sm:h-3.5"}),e.jsx("span",{className:"hidden xs:inline",children:"Complete"})]}),e.jsxs("button",{onClick:()=>ie("in-progress"),disabled:t,className:"px-2 py-1 sm:px-2.5 sm:py-1.5 text-xs bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 disabled:bg-yellow-300 disabled:cursor-not-allowed flex items-center gap-1",children:[e.jsx(ee,{className:"w-3 h-3 sm:w-3.5 sm:h-3.5"}),e.jsx("span",{className:"hidden xs:inline",children:"Progress"})]}),e.jsxs("button",{onClick:ye,disabled:t,className:"px-2 py-1 sm:px-2.5 sm:py-1.5 text-xs bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:bg-red-300 disabled:cursor-not-allowed flex items-center gap-1",children:[e.jsx(J,{className:"w-3 h-3 sm:w-3.5 sm:h-3.5"}),e.jsx("span",{className:"hidden xs:inline",children:"Delete"})]}),e.jsx("button",{onClick:()=>A([]),disabled:t,className:"px-2 py-1 sm:px-2.5 sm:py-1.5 text-xs bg-gray-600 text-white rounded-lg hover:bg-gray-700 disabled:bg-gray-300 disabled:cursor-not-allowed",children:"Cancel"})]})]}),g?e.jsx("div",{className:"p-8 flex justify-center items-center",children:e.jsx(qe,{className:"w-8 h-8 text-blue-500 animate-spin"})}):e.jsxs(e.Fragment,{children:[e.jsx(Ye,{tasks:i,onDeleteTask:K,onUpdateTask:Z,isSectionAdmin:b,viewMode:C,selectedTaskIds:T,onToggleSelection:ke,onSelectAll:ve,sortBy:_.by,sortOrder:_.order,onSort:Ne}),i.length===0&&!g&&e.jsx("div",{className:"p-8 text-center",children:e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No tasks found. Try adjusting your filters or create a new task."})})]})]})}export{Tr as TaskManager};
