const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/App.BbYfXFvD.js","assets/js/capacitor-vendor.WkpnXCg6.js","assets/js/react-vendor.2V4evweb.js","assets/js/charts.ixvsjPR7.js","assets/js/vendor.BFZKXrfJ.js","assets/js/useAuth.Bb42EurS.js","assets/js/dataCache.DP4PyhNH.js","assets/js/authErrors.BDay5vyW.js","assets/js/useUsers.CEWjooTn.js","assets/js/telegram.service.CKSqE0Xu.js","assets/js/dateUtils.8XYiGfWV.js","assets/js/AuthPage.CwAwnKLh.js","assets/js/AuthSubmitButton.DTqz8c2u.js","assets/js/icons.DID50SbB.js","assets/js/ionic-vendor.DB8jv2bB.js","assets/css/ionic-vendor.5aKpPXL6.css","assets/js/supabase-vendor.GZbxw4Q7.js","assets/js/useTheme.C_vj2EEw.js","assets/js/date-utils.CA8GdWm1.js","assets/js/ResetPasswordPage.BOD0sPMv.js","assets/js/linkParser.CRNpH1Sh.js","assets/js/googleDriveUtils.DgFtRDYK.js","assets/js/AdminLayout.79pLlM_Z.js","assets/js/LoadingScreen.sJMF5eww.js","assets/js/DashboardPage.0s8J56OI.js","assets/js/UsersPage.WsanjA59.js","assets/js/TasksPage.Czp-Nj4N.js","assets/js/TaskManagementPage.BdX-vLc2.js","assets/js/AnnouncementsPage.B0kcWRLV.js","assets/js/LectureSlidesPage.DlbN62_E.js","assets/js/SuperAdminPage.Cm6oSeRA.js"])))=>i.map(i=>d[i]);
import{C as e,P as t,_ as n}from"./capacitor-vendor.WkpnXCg6.js";import{j as s,r as a,d as i,e as r,f as o}from"./react-vendor.2V4evweb.js";import"./ionic-vendor.DB8jv2bB.js";import{c as l}from"./supabase-vendor.GZbxw4Q7.js";import"./charts.ixvsjPR7.js";import"./vendor.BFZKXrfJ.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const c=()=>s.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-white dark:bg-gray-900 z-50",children:s.jsxs("div",{className:"w-8 h-8 relative",children:[s.jsx("div",{className:"absolute inset-0 border-2 border-gray-200 dark:border-gray-700 rounded-full"}),s.jsx("div",{className:"absolute inset-0 border-t-2 border-blue-600 rounded-full animate-spin"})]})});Boolean("undefined"!=typeof window&&(window.location.hostname.includes("stackblitz.io")||window.location.hostname.includes(".webcontainer.io")));const d=l("https://ycuymjlcsvigorskvsdr.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InljdXltamxjc3ZpZ29yc2t2c2RyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI0MTY1NzksImV4cCI6MjA2Nzk5MjU3OX0.TzFx-CboTXkic_c3AKlHLFnhlX9IVxUQy6bKMZcmPNo",{auth:{persistSession:!0,detectSessionInUrl:!0,flowType:"pkce",storage:localStorage,storageKey:"nesttask_supabase_auth"},global:{headers:{"X-Client-Info":"nesttask@1.0.0","Cache-Control":"no-cache",Pragma:"no-cache"}},db:{schema:"public"},realtime:{params:{eventsPerSecond:10}}});let u=0,m=!1,p=null,h=0,f=Date.now(),j=!1;async function w(){if(!j){j=!0;try{const{data:{session:e},error:t}=await d.auth.getSession();if(t)return;if(!e)return;const n=e.expires_at;if(n){if(1e3*n-Date.now()<=3e5){const{error:e}=await d.auth.refreshSession()}}}catch(e){}finally{j=!1}}}async function _(e=!1){return f=Date.now(),Date.now()-h>3e5&&(e=!0),!(!m||e)||p||(p=(async()=>{try{if(u>=3)return!0;u++;const{data:e,error:t}=await d.auth.getSession();if(t)return!1;if(!e.session)return!0;const{error:n}=await d.from("tasks").select("count",{count:"exact",head:!0});return n?"PGRST301"!==n.code&&!n.message.includes("JWT")||(await d.auth.signOut(),!1):(m=!0,h=Date.now(),!0)}catch(e){return!0}finally{setTimeout((()=>{p=null}),2e3)}})(),p)}"undefined"!=typeof document&&(document.addEventListener("visibilitychange",(async()=>{if("visible"===document.visibilityState){const e=Date.now(),t=e-f;await w(),t>12e4&&(p=null,m=!1),f=e,window.dispatchEvent(new CustomEvent("supabase-visibility-refresh"))}})),window.addEventListener("online",(async()=>{await w(),window.dispatchEvent(new CustomEvent("supabase-network-reconnect"))}))),setTimeout((()=>{_().catch(console.error)}),1e3);let g=null,x=!1,v=[];function y(){const e=g;return g=null,e}function b(e){var t;const n=null==(t=e.notification)?void 0:t.data,s=null==n?void 0:n.taskId,a=function(e){return e&&e.route&&"string"==typeof e.route?e.route:null}(n);if(s&&"string"==typeof s)return g=s,window.dispatchEvent(new CustomEvent("open-task-from-notification",{detail:{taskId:s,data:n,actionId:e.actionId,notification:e.notification}})),void setTimeout((()=>{window.dispatchEvent(new CustomEvent("open-task-from-notification",{detail:{taskId:s,data:n,actionId:e.actionId,notification:e.notification}}))}),500);if(a){const e=document.getElementById("root");e&&e.children.length>0&&setTimeout((()=>{window.location.href=a}),150)}}function k(e){}"requestIdleCallback"in window&&requestIdleCallback((()=>{n((()=>import("./App.BbYfXFvD.js").then((e=>e.A))),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21])),n((()=>import("./AuthPage.CwAwnKLh.js")),__vite__mapDeps([11,2,3,4,12,13,7,6,1,14,15,16]))}));const P=a.lazy((()=>n((()=>import("./App.BbYfXFvD.js").then((e=>e.A))),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21])))),E=a.lazy((()=>n((()=>import("./ResetPasswordPage.BOD0sPMv.js")),__vite__mapDeps([19,2,3,4,12,13,7,1,14,15,16])).then((e=>({default:e.ResetPasswordPage}))))),I=a.lazy((()=>n((()=>import("./AuthPage.CwAwnKLh.js")),__vite__mapDeps([11,2,3,4,12,13,7,6,1,14,15,16])).then((e=>({default:e.AuthPage}))))),S=a.lazy((()=>n((()=>import("./AdminLayout.79pLlM_Z.js")),__vite__mapDeps([22,2,3,4,5,6,7,1,8,9,10,13,17,14,15,23,16])).then((e=>({default:e.AdminLayout}))))),L=a.lazy((()=>n((()=>import("./DashboardPage.0s8J56OI.js")),__vite__mapDeps([24,1,2,3,4,13,14,15,16])).then((e=>({default:e.DashboardPage}))))),A=a.lazy((()=>n((()=>import("./UsersPage.WsanjA59.js")),__vite__mapDeps([25,1,2,3,4])).then((e=>({default:e.UsersPage}))))),T=a.lazy((()=>n((()=>import("./TasksPage.Czp-Nj4N.js")),__vite__mapDeps([26,1,2,3,4])).then((e=>({default:e.TasksPage}))))),R=a.lazy((()=>n((()=>import("./TaskManagementPage.BdX-vLc2.js")),__vite__mapDeps([27,1,2,3,4,5,6,7,14,15,16])).then((e=>({default:e.TaskManagementPage}))))),D=a.lazy((()=>n((()=>import("./AnnouncementsPage.B0kcWRLV.js")),__vite__mapDeps([28,1,2,3,4,9,10,14,15,16])).then((e=>({default:e.AnnouncementsPage}))))),O=a.lazy((()=>n((()=>import("./LectureSlidesPage.DlbN62_E.js")),__vite__mapDeps([29,1,2,3,4])).then((e=>({default:e.LectureSlidesPage}))))),z=a.lazy((()=>n((()=>import("./SuperAdminPage.Cm6oSeRA.js")),__vite__mapDeps([30,1,2,3,4])).then((e=>({default:e.SuperAdminPage}))))),C=a.lazy((()=>n((()=>import("./vendor.BFZKXrfJ.js").then((e=>e.ad))),__vite__mapDeps([4,3,2])).then((e=>({default:e.Analytics}))))),N=!e.isNativePlatform(),V=({children:e})=>N?s.jsx(s.Fragment,{children:e}):null,W=i([{path:"/auth",loader:async()=>{const{data:{session:e}}=await d.auth.getSession();if(null==e?void 0:e.user){const{data:t}=await d.from("users").select("role").eq("id",e.user.id).single();return"super-admin"===(null==t?void 0:t.role)?Response.redirect("/superadmin/dashboard"):"admin"===(null==t?void 0:t.role)||"section_admin"===(null==t?void 0:t.role)?Response.redirect("/admin/dashboard"):Response.redirect("/")}return null},element:s.jsx(a.Suspense,{fallback:s.jsx(c,{}),children:s.jsx(I,{onLogin:async e=>{const{data:t,error:n}=await d.auth.signInWithPassword({email:e.email,password:e.password});if(n)throw n;if(t.user){const{data:e}=await d.from("users").select("role").eq("id",t.user.id).single();"super-admin"===(null==e?void 0:e.role)?window.location.href="/superadmin/dashboard":"admin"===(null==e?void 0:e.role)||"section_admin"===(null==e?void 0:e.role)?window.location.href="/admin/dashboard":window.location.href="/"}},onSignup:async e=>{const{error:t}=await d.auth.signUp({email:e.email,password:e.password,options:{data:{name:e.name}}});if(t)throw t},onForgotPassword:async e=>{const{error:t}=await d.auth.resetPasswordForEmail(e);if(t)throw t}})})},{path:"/reset-password",element:s.jsx(a.Suspense,{fallback:s.jsx(c,{}),children:s.jsx(E,{})})},{path:"/admin",element:s.jsx(a.Suspense,{fallback:s.jsx(c,{}),children:s.jsx(S,{})}),children:[{path:"dashboard",element:s.jsx(a.Suspense,{fallback:s.jsx(c,{}),children:s.jsx(L,{})})},{path:"users",element:s.jsx(a.Suspense,{fallback:s.jsx(c,{}),children:s.jsx(A,{})})},{path:"tasks",element:s.jsx(a.Suspense,{fallback:s.jsx(c,{}),children:s.jsx(T,{})})},{path:"task-management",element:s.jsx(a.Suspense,{fallback:s.jsx(c,{}),children:s.jsx(R,{})})},{path:"announcements",element:s.jsx(a.Suspense,{fallback:s.jsx(c,{}),children:s.jsx(D,{})})},{path:"lecture-slides",element:s.jsx(a.Suspense,{fallback:s.jsx(c,{}),children:s.jsx(O,{})})},{path:"super-admin",element:s.jsx(a.Suspense,{fallback:s.jsx(c,{}),children:s.jsx(z,{})})}]},{path:"/superadmin/dashboard",element:s.jsx(a.Suspense,{fallback:s.jsx(c,{}),children:s.jsx(z,{})})},{path:"/superadmin/overview",element:s.jsx(a.Suspense,{fallback:s.jsx(c,{}),children:s.jsx(z,{})})},{path:"/superadmin/admins",element:s.jsx(a.Suspense,{fallback:s.jsx(c,{}),children:s.jsx(z,{})})},{path:"/superadmin/sectionadmins",element:s.jsx(a.Suspense,{fallback:s.jsx(c,{}),children:s.jsx(z,{})})},{path:"/superadmin/analytics",element:s.jsx(a.Suspense,{fallback:s.jsx(c,{}),children:s.jsx(z,{})})},{path:"/superadmin/logs",element:s.jsx(a.Suspense,{fallback:s.jsx(c,{}),children:s.jsx(z,{})})},{path:"/superadmin/security",element:s.jsx(a.Suspense,{fallback:s.jsx(c,{}),children:s.jsx(z,{})})},{path:"*",element:s.jsx(a.Suspense,{fallback:s.jsx(c,{}),children:s.jsx(P,{})})}]);!async function(){if(!x&&e.isNativePlatform())try{const e=await t.addListener("pushNotificationActionPerformed",b);v.push((()=>e.remove()));const n=await t.addListener("pushNotificationReceived",k);v.push((()=>n.remove())),x=!0}catch(n){}}(),function(){try{const e=new URL("https://ycuymjlcsvigorskvsdr.supabase.co"),t=document.createElement("link");t.rel="dns-prefetch",t.href=e.origin,document.head.appendChild(t)}catch(n){}const t=document.getElementById("root");t&&(r(t).render(s.jsx(a.StrictMode,{children:s.jsxs(a.Suspense,{fallback:s.jsx(c,{}),children:[s.jsx(o,{router:W}),N&&s.jsx(V,{children:s.jsx(a.Suspense,{fallback:null,children:s.jsx(C,{})})})]})})),!e.isNativePlatform()&&"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((()=>{setTimeout((()=>{"undefined"!=typeof window&&window.Capacitor||("serviceWorker"in navigator&&navigator.serviceWorker.controller&&setInterval((()=>{navigator.serviceWorker.getRegistration().then((e=>{e&&e.update()}))}),36e5),window.addEventListener("beforeinstallprompt",(e=>{e.preventDefault()})),window.addEventListener("appinstalled",(()=>{})),"serviceWorker"in navigator&&navigator.serviceWorker.addEventListener("controllerchange",(()=>{navigator.serviceWorker.controller})))}),500)})).catch((()=>{})))}();export{y as g,d as s,_ as t};
