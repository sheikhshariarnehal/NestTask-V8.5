import{r as n,j as e}from"./index.BpmNoVIF.js";import{S as C}from"./search.BOu1-z47.js";import{A as S}from"./alert-triangle.DDHSR7Fg.js";import{T as L}from"./trash-2.1Ee77oCP.js";import"./createLucideIcon.Dlcj68ZK.js";function Y({users:o,onDeleteUser:b,onPromoteUser:I,onDemoteUser:U,isSectionAdmin:c=!1,isLoading:w=!1}){const[x,y]=n.useState(null),[k,m]=n.useState(!1),[a,g]=n.useState(null),[h,l]=n.useState(null),[i,j]=n.useState(""),d=t=>t==="section_admin",N=t=>{const r=o.find(s=>d(s.role));if(c&&t.sectionId!==(r==null?void 0:r.sectionId)){l("You can only delete users from your own section");return}if(t.role==="admin"||t.role==="super-admin"||d(t.role)){l("You cannot delete administrators");return}g(t),m(!0),l(null)},v=async()=>{if(a)try{y(a.id),l(null),await b(a.id)}catch(t){l(t.message||"Failed to delete user")}finally{y(null),m(!1),g(null)}},p=o.filter(t=>{var r,s,f;return((r=t.name)==null?void 0:r.toLowerCase().includes(i.toLowerCase()))||t.email.toLowerCase().includes(i.toLowerCase())||t.role.toLowerCase().includes(i.toLowerCase())||((s=t.sectionName)==null?void 0:s.toLowerCase().includes(i.toLowerCase()))||((f=t.sectionId)==null?void 0:f.toLowerCase().includes(i.toLowerCase()))}),u=c?p.filter(t=>{var r;return t.sectionId===((r=o.find(s=>d(s.role)))==null?void 0:r.sectionId)}):p;return w?e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-md p-8 text-center",children:e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Loading users..."})}):e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-md overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"relative",children:[e.jsx(C,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search users...",value:i,onChange:t=>j(t.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100"})]})}),h&&e.jsx("div",{className:"p-4 bg-red-50 dark:bg-red-900/20 border-l-4 border-red-500",children:e.jsxs("div",{className:"flex",children:[e.jsx(S,{className:"h-5 w-5 text-red-500 mr-2"}),e.jsx("p",{className:"text-sm text-red-700 dark:text-red-400",children:h})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-750",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Email"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Section"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Role"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:u.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-6 py-4 text-center text-sm text-gray-500 dark:text-gray-400",children:"No users found"})}):u.map(t=>{var r;return e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-750",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white",children:t.name||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:t.email}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:t.sectionName||(t.sectionId?`Section ${t.sectionId}`:"N/A")}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${t.role==="admin"?"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400":d(t.role)?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400":"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"}`,children:t.role==="admin"?"Admin":d(t.role)?"Section Admin":"User"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsx("button",{onClick:()=>N(t),disabled:x===t.id||t.role==="admin"||t.role==="super-admin"||d(t.role)||c&&t.sectionId!==((r=o.find(s=>d(s.role)))==null?void 0:r.sectionId),className:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(L,{className:"h-5 w-5"})})})]},t.id)})})]})}),k&&a&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg max-w-md w-full p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Delete User"}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-4",children:["Are you sure you want to delete ",a.name||a.email,"? This action cannot be undone."]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{onClick:()=>{m(!1),g(null),l(null)},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white dark:bg-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Cancel"}),e.jsx("button",{onClick:v,disabled:x===a.id,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50",children:x===a.id?"Deleting...":"Delete"})]})]})})]})}export{Y as UserList};
