const t=new class{constructor(){this.cache=new Map,this.defaultTTL=3e5}get(t,e){const s=this.cache.get(t);if(!s)return null;const a=null!=e?e:this.defaultTTL;return Date.now()-s.timestamp>a?(this.cache.delete(t),null):s.data}set(t,e){this.cache.set(t,{data:e,timestamp:Date.now()})}async getOrFetch(t,e,s){const a=this.get(t,s);if(null!==a)return a;const c=this.cache.get(t);if(null==c?void 0:c.promise)return c.promise;const n=e();this.cache.set(t,{data:null,timestamp:Date.now(),promise:n});try{const e=await n;return this.set(t,e),e}catch(i){throw this.cache.delete(t),i}}invalidate(t){this.cache.delete(t)}invalidatePattern(t){for(const e of this.cache.keys())t.test(e)&&this.cache.delete(e)}clear(){this.cache.clear()}getStats(){return{size:this.cache.size,keys:Array.from(this.cache.keys())}}cleanup(){const t=Date.now();for(const[e,s]of this.cache.entries())t-s.timestamp>this.defaultTTL&&this.cache.delete(e)}};"undefined"!=typeof window&&setInterval((()=>{t.cleanup()}),3e5);const e={user:t=>`user:${t}`,userWithFullInfo:t=>`user_full:${t}`,department:t=>`department:${t}`,departments:()=>"departments:all",batch:t=>`batch:${t}`,batches:t=>t?`batches:dept:${t}`:"batches:all",section:t=>`section:${t}`,sections:t=>t?`sections:batch:${t}`:"sections:all",tasks:t=>`tasks:${t}`,announcements:()=>"announcements:all",sectionUsers:t=>`section_users:${t}`};export{e as c,t as d};
