import{r as e,j as t}from"./react-vendor.BQ9wcLSU.js";import{i as r,n as a,g as s}from"./googleDriveUtils.DgFtRDYK.js";import{ListTodo as l,LucideTag as n,Calendar as i,AlignLeft as d,LucideUpload as o,Link as c,LucidePlus as u,AlertCircle as m,CheckCircle as x,LucideX as g,ExternalLink as p,FileText as b,LucidePaperclip as h,LucideTrash2 as y,LucideSave as f,CheckSquare as k,LucideSquare as v,AlertTriangle as j,CheckCheck as w,Copy as N,Edit2 as D,Clock as S,ArrowUpNarrowWide as C,ArrowDownWideNarrow as E,ChevronUp as T,Filter as L,List as R,LayoutGrid as $,Download as _,LucideRefreshCw as I,LucideSearch as A,LucideRotateCcw as U,Loader2 as O}from"./icons.B5_ZQj31.js";import{s as P}from"./index.OovSQwLB.js";import{i as F,f as G}from"./dateUtils.8XYiGfWV.js";import{s as M,a as z}from"./notifications.BFXTDsYM.js";import"./charts.DuHk9BWv.js";import"./vendor.Vy3uO1vB.js";import"./capacitor-vendor.WkpnXCg6.js";import"./ionic-vendor.ClmuHuJk.js";import"./supabase-vendor.nnmAzafq.js";const B=e=>({taskDetails:{name:"",category:"task",dueDate:"",description:"",status:"in-progress",sectionId:e||void 0,googleDriveLinks:[]},errors:{},files:[],fileUrls:[],googleDriveLinks:[],currentGoogleDriveLink:"",isSubmitting:!1,success:!1,uploadProgress:0});function q(e,t){switch(t.type){case"SET_TASK_FIELD":return{...e,taskDetails:{...e.taskDetails,[t.field]:t.value}};case"SET_ERRORS":return{...e,errors:t.errors};case"CLEAR_ERROR":const{[t.field]:r,...a}=e.errors;return{...e,errors:a};case"ADD_FILES":return{...e,files:[...e.files,...t.newFiles],fileUrls:[...e.fileUrls,...t.newUrls]};case"REMOVE_FILE":return{...e,files:e.files.filter(((e,r)=>r!==t.index)),fileUrls:e.fileUrls.filter(((e,r)=>r!==t.index))};case"SET_CURRENT_GOOGLE_DRIVE_LINK":return{...e,currentGoogleDriveLink:t.link};case"ADD_GOOGLE_DRIVE_LINK":return{...e,googleDriveLinks:[...e.googleDriveLinks,t.link],currentGoogleDriveLink:"",taskDetails:{...e.taskDetails,googleDriveLinks:[...e.taskDetails.googleDriveLinks||[],t.link]}};case"REMOVE_GOOGLE_DRIVE_LINK":const s=e.googleDriveLinks.filter(((e,r)=>r!==t.index));return{...e,googleDriveLinks:s,taskDetails:{...e.taskDetails,googleDriveLinks:s}};case"SET_SUBMITTING":return{...e,isSubmitting:t.isSubmitting};case"SET_SUCCESS":return{...e,success:t.success};case"SET_UPLOAD_PROGRESS":return{...e,uploadProgress:t.progress};case"RESET_FORM":return B(t.sectionId);default:return e}}const V=({id:e,label:r,required:a=!1,error:s,children:l})=>t.jsxs("div",{children:[t.jsxs("label",{htmlFor:e,className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[r," ",a&&t.jsx("span",{className:"text-red-500",children:"*"})]}),l,s&&t.jsxs("p",{id:`${e}-error`,className:"mt-1 text-xs text-red-500 flex items-center gap-1",role:"alert",children:[t.jsx(m,{className:"w-3 h-3"}),s]})]}),K=()=>t.jsxs("div",{className:"p-3 bg-green-50 dark:bg-green-900/20 rounded-lg mb-4 flex items-start gap-2 shadow-sm",role:"alert",children:[t.jsx(x,{className:"w-5 h-5 text-green-600 dark:text-green-400 flex-shrink-0 mt-0.5"}),t.jsx("span",{className:"text-green-700 dark:text-green-300",children:"Task created successfully!"})]}),H=({progress:e})=>t.jsxs("div",{className:"mb-4","aria-live":"polite",children:[t.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5 dark:bg-gray-700",children:t.jsx("div",{className:"bg-blue-600 h-2.5 rounded-full transition-all duration-300",style:{width:`${e}%`},role:"progressbar","aria-valuenow":e,"aria-valuemin":0,"aria-valuemax":100})}),t.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:["Uploading files... ",e,"%"]})]}),W=({file:e,onRemove:r})=>{return t.jsxs("div",{className:"flex items-center justify-between p-3 bg-white dark:bg-gray-700 rounded-lg border border-gray-200 dark:border-gray-600 hover:border-blue-300 dark:hover:border-blue-500 transition-all duration-200 group",children:[t.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[t.jsx("span",{className:"text-2xl flex-shrink-0",children:(e=>{var t;const r=null==(t=e.split(".").pop())?void 0:t.toLowerCase();return["jpg","jpeg","png","gif","svg","webp"].includes(r||"")?"ğŸ–¼ï¸":["pdf"].includes(r||"")?"ğŸ“„":["doc","docx"].includes(r||"")?"ğŸ“":["xls","xlsx"].includes(r||"")?"ğŸ“Š":["zip","rar","7z"].includes(r||"")?"ğŸ—œï¸":"ğŸ“"})(e.name)}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-200 truncate",children:e.name}),t.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:(a=e.size,a<1024?a+" B":a<1048576?(a/1024).toFixed(1)+" KB":(a/1048576).toFixed(1)+" MB")})]})]}),t.jsx("button",{type:"button",onClick:r,className:"flex-shrink-0 p-1.5 text-gray-400 hover:text-red-500 dark:hover:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-all duration-200 opacity-0 group-hover:opacity-100","aria-label":"Remove file",children:t.jsx(g,{className:"w-4 h-4"})})]});var a},Q=({url:e,onRemove:r})=>t.jsxs("div",{className:"flex items-center justify-between py-2 px-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800",children:[t.jsxs("div",{className:"flex items-center gap-2 truncate max-w-[85%]",children:[t.jsx(c,{className:"w-4 h-4 text-blue-500 dark:text-blue-400 flex-shrink-0"}),t.jsxs("div",{className:"flex flex-col min-w-0",children:[t.jsx("span",{className:"text-sm text-blue-700 dark:text-blue-300 truncate",children:s(e)}),t.jsx("span",{className:"text-xs text-blue-600 dark:text-blue-400 truncate",children:e})]})]}),t.jsxs("div",{className:"flex items-center gap-1 ml-2",children:[t.jsx("button",{type:"button",onClick:()=>window.open(e,"_blank","noopener,noreferrer"),className:"text-blue-500 hover:text-blue-600 dark:text-blue-400 dark:hover:text-blue-300 p-1 rounded-full hover:bg-blue-100 dark:hover:bg-blue-800 touch-manipulation","aria-label":"Open Google Drive link",children:t.jsx(p,{className:"w-4 h-4"})}),t.jsx("button",{type:"button",onClick:r,className:"text-gray-500 hover:text-red-500 dark:text-gray-400 dark:hover:text-red-400 p-1 rounded-full hover:bg-gray-200 dark:hover:bg-gray-600 touch-manipulation","aria-label":"Remove Google Drive link",children:t.jsx(g,{className:"w-4 h-4"})})]})]});function X({onSubmit:s,sectionId:m,isSectionAdmin:x=!1,isSubmitting:g=!1}){const[p,b]=e.useReducer(q,B(m)),{taskDetails:h,errors:y,files:f,fileUrls:k,googleDriveLinks:v,currentGoogleDriveLink:j,isSubmitting:w,success:N,uploadProgress:D}=p,S=e.useRef(),C=e.useRef(!0),E=e.useRef(),T=e.useRef(null);e.useEffect((()=>(C.current=!0,()=>{C.current=!1,b({type:"SET_SUBMITTING",isSubmitting:!1}),S.current&&clearTimeout(S.current),E.current&&E.current.abort(),k.forEach((e=>{e&&!e.startsWith("placeholder-")&&URL.revokeObjectURL(e)}))})),[k,b]);const L=e.useCallback((()=>/iPhone|iPad|iPod|Android|webOS|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||window.innerWidth<768),[]);e.useEffect((()=>{if(L()&&T.current){const e=T.current;e.addEventListener("focus",(()=>{e.classList.add("mobile-date-focused")})),e.addEventListener("blur",(()=>{e.classList.remove("mobile-date-focused")}))}}),[L]);const R=e.useCallback((()=>{const e={};let t=!0;if(h.name.trim()||(e.name="Task name is required",t=!1),h.dueDate){const r=new Date(h.dueDate),a=new Date;a.setHours(0,0,0,0),r<a&&(e.dueDate="Due date cannot be in the past",t=!1)}else e.dueDate="Due date is required",t=!1;return h.description.trim()||(e.description="Description is required",t=!1),b({type:"SET_ERRORS",errors:e}),t}),[h]),$=e.useCallback((e=>{const{name:t,value:r}=e.target;b({type:"SET_TASK_FIELD",field:t,value:r}),y[t]&&b({type:"CLEAR_ERROR",field:t})}),[y]),_=e.useCallback((e=>{var t;if(!(null==(t=e.target.files)?void 0:t.length))return;const r=Array.from(e.target.files),a=r.filter((e=>e.size>52428800));if(a.length>0)b({type:"SET_ERRORS",errors:{...y,files:`Some files exceed the 50MB size limit: ${a.map((e=>e.name)).join(", ")}`}});else{if(L()){const e=r.map((e=>`placeholder-${e.name}-${Date.now()}`));b({type:"ADD_FILES",newFiles:r,newUrls:e})}else{const e=r.map((e=>URL.createObjectURL(e)));b({type:"ADD_FILES",newFiles:r,newUrls:e})}y.files&&b({type:"CLEAR_ERROR",field:"files"})}}),[y,L]),I=e.useCallback((e=>{k[e]&&!k[e].startsWith("placeholder-")&&URL.revokeObjectURL(k[e]),b({type:"REMOVE_FILE",index:e})}),[k]),A=e.useCallback((e=>{const t=e.target.value;b({type:"SET_CURRENT_GOOGLE_DRIVE_LINK",link:t}),y.googleDriveLinks&&b({type:"CLEAR_ERROR",field:"googleDriveLinks"})}),[y.googleDriveLinks]),U=e.useCallback((()=>{const e=j.trim();if(!e)return void b({type:"SET_ERRORS",errors:{...y,googleDriveLinks:"Please enter a Google Drive link"}});if(!r(e))return void b({type:"SET_ERRORS",errors:{...y,googleDriveLinks:"Please enter a valid Google Drive URL"}});const t=a(e);v.includes(t)?b({type:"SET_ERRORS",errors:{...y,googleDriveLinks:"This Google Drive link has already been added"}}):b({type:"ADD_GOOGLE_DRIVE_LINK",link:t})}),[j,v,y]),O=e.useCallback((e=>{b({type:"REMOVE_GOOGLE_DRIVE_LINK",index:e})}),[]),P=e.useCallback((e=>{"Enter"===e.key&&(e.preventDefault(),U())}),[U]),F=e.useCallback((()=>(new Date).toISOString().split("T")[0]),[]),G=e.useCallback((async e=>{if(e.preventDefault(),!w&&(S.current&&clearTimeout(S.current),E.current=new AbortController,R())){b({type:"SET_SUBMITTING",isSubmitting:!0}),b({type:"SET_UPLOAD_PROGRESS",progress:0}),S.current=setTimeout((()=>{var e;C.current&&(b({type:"SET_SUBMITTING",isSubmitting:!1}),b({type:"SET_ERRORS",errors:{name:"Submission timed out. Please try again with smaller files or check your connection."}}),null==(e=E.current)||e.abort())}),45e3);try{let e=h.description;const t=L();f.length>0&&(e+="\n\n**Attachments:**\n",t?(f.filter((e=>e.size>0&&e.name&&"string"==typeof e.name)).forEach((t=>{e+=`- [${t.name}](attachment:${t.name})\n`})),e+="\n\x3c!-- mobile-uploads --\x3e\n"):f.forEach((t=>{const r=URL.createObjectURL(t);e+=`- [${t.name}](${r})\n`}))),x&&m&&(e+=`\n\n*This task is assigned to section ID: ${m}*`);const r={...h,description:e,sectionId:m};if(t&&f.length>0){const e=f.filter((e=>e.name&&e.size>0));r._mobileFiles=e,x&&m&&(r._isSectionAdminMobile=!0,r._sectionId=m,r.sectionId=m),r._mobileTimestamp=Date.now()}await s(r),S.current&&clearTimeout(S.current),C.current&&(b({type:"SET_SUBMITTING",isSubmitting:!1}),b({type:"RESET_FORM",sectionId:m}),b({type:"SET_SUCCESS",success:!0}),setTimeout((()=>{C.current&&b({type:"SET_SUCCESS",success:!1})}),3e3))}catch(t){S.current&&clearTimeout(S.current),C.current&&(b({type:"SET_ERRORS",errors:{name:`Failed to create task: ${t instanceof Error?t.message:"Unknown error"}`}}),b({type:"SET_SUBMITTING",isSubmitting:!1}),b({type:"SET_UPLOAD_PROGRESS",progress:0}))}}}),[R,h,f,L,x,m,s]);return t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-md overflow-hidden border border-gray-100 dark:border-gray-700",children:[t.jsx("div",{className:"px-4 sm:px-6 py-4 border-b border-gray-200 dark:border-gray-700 flex items-center bg-gradient-to-r from-blue-50 to-white dark:from-gray-800 dark:to-gray-750",children:t.jsxs("h3",{className:"text-lg sm:text-xl font-semibold text-gray-800 dark:text-white flex items-center",children:[t.jsx(l,{className:"w-5 h-5 mr-2 text-blue-600 dark:text-blue-400"}),"Create New Task",x&&m&&t.jsx("span",{className:"ml-2 text-xs sm:text-sm text-green-600 dark:text-green-400 font-normal px-2 py-0.5 bg-green-100 dark:bg-green-900/30 rounded-full",children:"Section Task"})]})}),t.jsxs("form",{onSubmit:G,className:"p-4 sm:p-6 space-y-5 sm:space-y-6",children:[N&&t.jsx(K,{}),w&&D>0&&D<100&&t.jsx(H,{progress:D}),t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-5",children:[t.jsx("div",{className:"col-span-1 sm:col-span-2",children:t.jsx(V,{id:"name",label:"Task Name",required:!0,error:y.name,children:t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 pointer-events-none",children:t.jsx(l,{className:"w-5 h-5"})}),t.jsx("input",{type:"text",id:"name",name:"name",value:h.name,onChange:$,className:`w-full pl-10 pr-4 py-3 border ${y.name?"border-red-500 dark:border-red-500":"border-gray-300 dark:border-gray-600"} rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white text-sm sm:text-base touch-manipulation`,placeholder:"Enter task name","aria-required":"true","aria-invalid":!!y.name,"aria-describedby":y.name?"name-error":void 0,autoComplete:"off"})]})})}),t.jsx("div",{children:t.jsx(V,{id:"category",label:"Category",error:y.category,children:t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 pointer-events-none",children:t.jsx(n,{className:"w-5 h-5"})}),t.jsxs("select",{id:"category",name:"category",value:h.category,onChange:$,className:"w-full pl-10 pr-4 py-3 border border-gray-300 dark:border-gray-600 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white appearance-none text-sm sm:text-base touch-manipulation",children:[t.jsx("option",{value:"task",children:"Task"}),t.jsx("option",{value:"assignment",children:"Assignment"}),t.jsx("option",{value:"project",children:"Project"}),t.jsx("option",{value:"quiz",children:"Quiz"}),t.jsx("option",{value:"midterm",children:"Midterm"}),t.jsx("option",{value:"final-exam",children:"Final Exam"}),t.jsx("option",{value:"lab-report",children:"Lab Report"}),t.jsx("option",{value:"lab-performance",children:"Lab Performance"}),t.jsx("option",{value:"lab-final",children:"Lab Final"}),t.jsx("option",{value:"presentation",children:"Presentation"}),t.jsx("option",{value:"blc",children:"BLC"}),t.jsx("option",{value:"documents",children:"Documents"}),t.jsx("option",{value:"groups",children:"Groups"}),t.jsx("option",{value:"others",children:"Others"})]})]})})}),t.jsx("div",{children:t.jsx(V,{id:"dueDate",label:"Due Date",required:!0,error:y.dueDate,children:t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 pointer-events-none",children:t.jsx(i,{className:"w-5 h-5"})}),t.jsx("input",{type:"date",id:"dueDate",name:"dueDate",ref:T,value:h.dueDate,onChange:$,min:F(),className:`w-full pl-10 pr-4 py-3 border ${y.dueDate?"border-red-500 dark:border-red-500":"border-gray-300 dark:border-gray-600"} rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white text-sm sm:text-base touch-manipulation mobile-date-input`,"aria-required":"true","aria-invalid":!!y.dueDate,"aria-describedby":y.dueDate?"dueDate-error":void 0})]})})}),t.jsx("div",{className:"col-span-1 sm:col-span-2",children:t.jsx(V,{id:"description",label:"Description",required:!0,error:y.description,children:t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute left-3 top-3 text-gray-400 pointer-events-none",children:t.jsx(d,{className:"w-5 h-5"})}),t.jsx("textarea",{id:"description",name:"description",value:h.description,onChange:$,rows:4,className:`w-full pl-10 pr-4 py-2 border ${y.description?"border-red-500 dark:border-red-500":"border-gray-300 dark:border-gray-600"} rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white text-sm sm:text-base touch-manipulation`,placeholder:"Enter task description","aria-required":"true","aria-invalid":!!y.description,"aria-describedby":y.description?"description-error":void 0})]})})}),t.jsx("div",{className:"col-span-1 sm:col-span-2",children:t.jsxs(V,{id:"files",label:"Attachments",error:y.files,children:[t.jsx("div",{className:"flex items-center justify-center w-full",children:t.jsxs("label",{htmlFor:"file-upload",className:"w-full flex flex-col items-center justify-center px-6 py-8 bg-gradient-to-br from-white to-gray-50 dark:from-gray-800 dark:to-gray-750 text-gray-600 dark:text-gray-400 rounded-xl border-2 border-dashed border-gray-300 dark:border-gray-600 cursor-pointer hover:border-blue-400 dark:hover:border-blue-500 hover:bg-blue-50 dark:hover:bg-gray-700/50 transition-all duration-200 touch-manipulation group","aria-label":"Upload files - tap to select files",children:[t.jsxs("div",{className:"flex flex-col items-center space-y-3",children:[t.jsx("div",{className:"p-3 bg-blue-100 dark:bg-blue-900/30 rounded-full group-hover:scale-110 transition-transform duration-200",children:t.jsx(o,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"})}),t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:L()?"Tap to select files":"Click to upload or drag & drop"}),t.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"PDF, DOC, Images, etc. (Max 50MB per file)"})]})]}),t.jsx("input",{id:"file-upload",type:"file",className:"hidden",onChange:_,multiple:!0,accept:"image/*,application/pdf,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,text/plain,application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","aria-label":"File upload"})]})}),k.length>0&&t.jsxs("div",{className:"mt-4 space-y-2 max-h-48 overflow-y-auto pr-1",children:[t.jsx("div",{className:"flex items-center justify-between mb-2",children:t.jsxs("p",{className:"text-xs font-semibold text-gray-600 dark:text-gray-400",children:["Attached Files (",f.length,")"]})}),f.map(((e,r)=>t.jsx(W,{file:e,onRemove:()=>I(r)},`${e.name}-${r}`)))]})]})}),x&&t.jsx("div",{className:"col-span-1 sm:col-span-2",children:t.jsx(V,{id:"googleDriveLinks",label:"Google Drive Links",error:y.googleDriveLinks,children:t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex gap-2",children:[t.jsxs("div",{className:"relative flex-1",children:[t.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 pointer-events-none",children:t.jsx(c,{className:"w-5 h-5"})}),t.jsx("input",{type:"url",id:"googleDriveLink",value:j,onChange:A,onKeyPress:P,placeholder:"Paste Google Drive link here...",className:`w-full pl-10 pr-4 py-3 border ${y.googleDriveLinks?"border-red-500 dark:border-red-500":"border-gray-300 dark:border-gray-600"} rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white text-sm sm:text-base touch-manipulation`,"aria-describedby":y.googleDriveLinks?"googleDriveLinks-error":void 0})]}),t.jsx("button",{type:"button",onClick:U,disabled:!j.trim(),className:"px-4 py-3 rounded-xl font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-900 touch-manipulation "+(j.trim()?"bg-blue-600 hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600 text-white":"bg-gray-300 dark:bg-gray-600 text-gray-500 dark:text-gray-400 cursor-not-allowed"),"aria-label":"Add Google Drive link",children:t.jsx(u,{className:"w-5 h-5"})})]}),t.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[t.jsx("p",{children:"Supported: Google Drive files, folders, Docs, Sheets, Slides, and Forms"}),t.jsx("p",{children:"Only section administrators can attach Google Drive links"})]}),v.length>0&&t.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto pr-1",children:v.map(((e,r)=>t.jsx(Q,{url:e,onRemove:()=>O(r)},`${e}-${r}`)))})]})})})]}),t.jsx("div",{className:"flex justify-end pt-2",children:t.jsx("button",{type:"submit",disabled:w||g,className:`px-4 py-2 rounded-md text-white font-medium shadow-sm \n              ${w||g?"bg-blue-400 dark:bg-blue-600 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600"}\n              transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-900 w-full sm:w-auto`,children:w||g?"Creating...":"Create Task"})})]})]})}function Z({task:r,onClose:a,onUpdate:s}){const[l,d]=e.useState({name:r.name||"",category:r.category||"task",dueDate:r.dueDate||"",description:(e=>{if(!e)return"";let t=e.replace(/(?:^- |\n- )?\[([^\]]+)\]\(([^)]+)\)/g,((e,t,r)=>r.includes("supabase.co/storage")||r.includes("task-attachments")||t.match(/\.[a-zA-Z0-9]+$/)?"":e));return t=t.replace(/\n*\*\*Attachments:\*\*\n*((?:- \[.*?\]\(.*?\)\n*)*)/g,""),t=t.replace(/\n*\*\*Links:\*\*\n*((?:- \[.*?\]\(.*?\)\n*)*)/g,""),t=t.replace(/\*This task is assigned to section ID: [a-f0-9-]+\*/g,""),t=t.replace(/\n{3,}/g,"\n\n").replace(/^\n+|\n+$/g,"").trim(),t})(r.description||""),status:r.status||"my-tasks"}),[c,u]=e.useState((e=>{if(!e)return[];const t=[],r=/(?:^- |\n- )?\[([^\]]+)\]\(([^)]+)\)/g;let a;for(;null!==(a=r.exec(e));){const[,e,r]=a;if(r.includes("supabase.co/storage")||r.includes("task-attachments")||e.match(/\.[a-zA-Z0-9]+$/)){const a=r.match(/task-files\/([^?]+)/),s=a?a[1]:void 0;t.push({name:e,url:r,path:s})}}return t})(r.description||"")),[m,x]=e.useState([]),[k,v]=e.useState({}),[j,w]=e.useState(!1),N=e.useRef(null);e.useEffect((()=>{const e=e=>{"Escape"===e.key&&a()};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)}),[a]);const D=e=>{const{name:t,value:r}=e.target;d((e=>({...e,[t]:r})))},S=async e=>{const t=e.name.split(".").pop(),r=`${"undefined"!=typeof crypto&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){const t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))}.${t}`,a=`task-files/${r}`,{data:s,error:l}=await P.storage.from("task-attachments").upload(a,e,{cacheControl:"3600",upsert:!1,contentType:e.type});if(l)throw new Error(`Upload failed: ${l.message}`);if(!s)throw new Error("Upload completed but no data returned");const{data:{publicUrl:n}}=P.storage.from("task-attachments").getPublicUrl(a);return{url:n,path:r}};return t.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:t.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto border border-gray-200 dark:border-gray-700",onClick:e=>e.stopPropagation(),children:[t.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-10 h-10 bg-blue-100 dark:bg-blue-900/30 rounded-xl flex items-center justify-center",children:t.jsx(b,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"})}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Edit Task"}),t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Update task information"})]})]}),t.jsx("button",{onClick:a,className:"w-8 h-8 rounded-lg bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 flex items-center justify-center transition-colors",children:t.jsx(g,{className:"w-4 h-4 text-gray-600 dark:text-gray-400"})})]}),t.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),l.name.trim()&&l.dueDate&&l.description.trim()){w(!0);try{const e=[];for(const r of m)try{v((e=>({...e,[r.name]:25})));const{url:t,path:a}=await S(r);e.push({name:r.name,url:t,path:a}),v((e=>({...e,[r.name]:100})))}catch(t){throw v((e=>({...e,[r.name]:0}))),new Error(`Failed to upload ${r.name}: ${t instanceof Error?t.message:"Unknown error"}`)}let n=l.description.trim();const i=[...c,...e.map((e=>({name:e.name,url:e.url})))];i.length>0&&(n+="\n\n**Attachments:**\n",i.forEach((e=>{n+=`- [${e.name}](${e.url})\n`}))),r.sectionId&&(n+=`\n\n*This task is assigned to section ID: ${r.sectionId}*`);const d={...l,description:n};await s(r.id,d),a()}catch(t){alert(`Error: ${t instanceof Error?t.message:"Unknown error occurred"}`)}finally{w(!1),v({})}}},className:"p-6 space-y-5",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Task Name *"}),t.jsx("input",{type:"text",name:"name",value:l.name,onChange:D,className:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:"Enter task name",required:!0})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Category *"}),t.jsxs("div",{className:"relative",children:[t.jsx(n,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),t.jsx("select",{name:"category",value:l.category,onChange:D,className:"w-full pl-10 pr-4 py-3 bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all appearance-none",required:!0,children:[{value:"assignment",label:"Assignment"},{value:"blc",label:"BLC"},{value:"documents",label:"Documents"},{value:"final-exam",label:"Final Exam"},{value:"groups",label:"Groups"},{value:"lab-final",label:"Lab Final"},{value:"lab-performance",label:"Lab Performance"},{value:"lab-report",label:"Lab Report"},{value:"midterm",label:"Midterm"},{value:"presentation",label:"Presentation"},{value:"project",label:"Project"},{value:"quiz",label:"Quiz"},{value:"task",label:"Task"},{value:"others",label:"Others"}].map((e=>t.jsx("option",{value:e.value,children:e.label},e.value)))})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Due Date *"}),t.jsxs("div",{className:"relative",children:[t.jsx(i,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),t.jsx("input",{type:"date",name:"dueDate",value:l.dueDate,onChange:D,className:"w-full pl-10 pr-4 py-3 bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",required:!0})]})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Status"}),t.jsx("div",{className:"flex gap-2",children:[{value:"my-tasks",label:"To Do"},{value:"in-progress",label:"In Progress"},{value:"completed",label:"Completed"}].map((e=>t.jsx("button",{type:"button",onClick:()=>d((t=>({...t,status:e.value}))),className:"flex-1 py-2.5 px-4 rounded-lg text-sm font-medium transition-all "+(l.status===e.value?"bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 border-2 border-blue-200 dark:border-blue-700":"bg-gray-50 dark:bg-gray-800 text-gray-600 dark:text-gray-400 border-2 border-gray-200 dark:border-gray-700 hover:bg-gray-100 dark:hover:bg-gray-700"),children:e.label},e.value)))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Description *"}),t.jsx("textarea",{name:"description",value:l.description,onChange:D,rows:4,className:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all resize-none",placeholder:"Describe the task details...",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(h,{className:"w-4 h-4"}),"Attachments",c.length+m.length>0&&t.jsxs("span",{className:"text-xs bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 px-2 py-1 rounded-full",children:[c.length+m.length," file",c.length+m.length!==1?"s":""]})]})}),t.jsxs("div",{className:"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-xl p-6 text-center hover:border-blue-400 dark:hover:border-blue-500 transition-colors cursor-pointer",onClick:()=>{var e;null==(e=N.current)||e.click()},onDragOver:e=>{e.preventDefault(),e.stopPropagation()},onDragEnter:e=>{e.preventDefault(),e.stopPropagation()},onDragLeave:e=>{e.preventDefault(),e.stopPropagation()},onDrop:e=>{e.preventDefault(),e.stopPropagation();const t=Array.from(e.dataTransfer.files);if(0===t.length)return;const r=t.filter((e=>!(e.size>10485760&&(alert(`File "${e.name}" is too large. Maximum size is 10MB.`),1))));if(r.length>0){x((e=>[...e,...r]));const e={};r.forEach((t=>{e[t.name]=0})),v((t=>({...t,...e})))}},children:[t.jsx("input",{ref:N,type:"file",multiple:!0,onChange:e=>{const t=e.target.files;if(!t||0===t.length)return;const r=Array.from(t).filter((e=>!(e.size>10485760&&(alert(`File "${e.name}" is too large. Maximum size is 10MB.`),1))));if(r.length>0){x((e=>[...e,...r]));const e={};r.forEach((t=>{e[t.name]=0})),v((t=>({...t,...e})))}e.target.value=""},className:"hidden",accept:".pdf,.doc,.docx,.txt,.jpg,.jpeg,.png,.gif,.zip,.rar"}),t.jsx(o,{className:"w-8 h-8 text-gray-400 mx-auto mb-2"}),t.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:[t.jsx("span",{className:"text-blue-600 dark:text-blue-400 font-medium hover:underline",children:"Click to upload"})," or drag and drop"]}),t.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500",children:"PDF, DOC, TXT, Images up to 10MB"}),m.length>0&&t.jsxs("div",{className:"mt-3 text-xs text-green-600 dark:text-green-400",children:[m.length," file",1!==m.length?"s":""," ready to upload"]})]}),c.length>0&&t.jsxs("div",{className:"mt-3 space-y-2",children:[t.jsx("h4",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Current Attachments"}),c.map(((e,r)=>t.jsxs("div",{className:"flex items-center justify-between p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-700",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-8 h-8 bg-blue-100 dark:bg-blue-900/30 rounded-lg flex items-center justify-center",children:t.jsx(b,{className:"w-4 h-4 text-blue-600 dark:text-blue-400"})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white truncate max-w-[200px]",children:e.name}),t.jsx("p",{className:"text-xs text-blue-600 dark:text-blue-400",children:"Existing file"})]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{type:"button",onClick:()=>window.open(e.url,"_blank"),className:"w-8 h-8 rounded-lg bg-blue-100 dark:bg-blue-900/30 hover:bg-blue-200 dark:hover:bg-blue-900/50 flex items-center justify-center transition-colors",title:"View file",children:t.jsx(p,{className:"w-4 h-4 text-blue-600 dark:text-blue-400"})}),t.jsx("button",{type:"button",onClick:e=>{e.preventDefault(),e.stopPropagation(),(async e=>{const t=c[e];if(t)try{t.path&&await(async e=>{if(!e)return;const{error:t}=await P.storage.from("task-attachments").remove([`task-files/${e}`]);if(t)throw t})(t.path),u((t=>t.filter(((t,r)=>r!==e))))}catch(r){u((t=>t.filter(((t,r)=>r!==e))))}})(r)},className:"w-8 h-8 rounded-lg bg-red-100 dark:bg-red-900/30 hover:bg-red-200 dark:hover:bg-red-900/50 flex items-center justify-center transition-colors",title:"Remove file",disabled:j,children:t.jsx(y,{className:"w-4 h-4 text-red-600 dark:text-red-400"})})]})]},`existing-${e.name}-${r}`)))]}),m.length>0&&t.jsxs("div",{className:"mt-3 space-y-2",children:[t.jsx("h4",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"New Attachments"}),m.map(((e,r)=>t.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 dark:bg-green-900/20 rounded-lg border border-green-200 dark:border-green-700",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-8 h-8 bg-green-100 dark:bg-green-900/30 rounded-lg flex items-center justify-center",children:t.jsx(b,{className:"w-4 h-4 text-green-600 dark:text-green-400"})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white truncate",children:e.name}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("p",{className:"text-xs text-green-600 dark:text-green-400",children:[(e.size/1024).toFixed(1)," KB â€¢ New"]}),void 0!==k[e.name]&&t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("div",{className:"w-16 h-1 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:t.jsx("div",{className:"h-full bg-green-500 transition-all duration-300",style:{width:`${k[e.name]||0}%`}})}),t.jsxs("span",{className:"text-xs text-green-600 dark:text-green-400",children:[Math.round(k[e.name]||0),"%"]})]})]})]})]}),t.jsx("button",{type:"button",onClick:e=>{var t;e.preventDefault(),e.stopPropagation(),t=r,x((e=>e.filter(((e,r)=>r!==t))))},className:"w-8 h-8 rounded-lg bg-red-100 dark:bg-red-900/30 hover:bg-red-200 dark:hover:bg-red-900/50 flex items-center justify-center transition-colors",disabled:j,children:t.jsx(y,{className:"w-4 h-4 text-red-600 dark:text-red-400"})})]},`new-${e.name}-${e.size}-${r}`)))]})]}),t.jsxs("div",{className:"flex gap-3 pt-4",children:[t.jsx("button",{type:"button",onClick:a,className:"flex-1 py-3 px-4 bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300 rounded-xl hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors font-medium",disabled:j,children:"Cancel"}),t.jsx("button",{type:"submit",disabled:j||!l.name.trim()||!l.dueDate||!l.description.trim(),className:"flex-1 py-3 px-4 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-300 dark:disabled:bg-gray-700 text-white rounded-xl transition-colors font-medium flex items-center justify-center gap-2",children:j?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),m.length>0?"Uploading & Saving...":"Saving..."]}):t.jsxs(t.Fragment,{children:[t.jsx(f,{className:"w-4 h-4"}),"Save Changes"]})})]})]})]})})}function J({tasks:r,onDeleteTask:a,onUpdateTask:s,isSectionAdmin:n=!1,viewMode:i="table",selectedTaskIds:d=[],onToggleSelection:o=()=>{},onSelectAll:c=()=>{},sortBy:u="dueDate",sortOrder:m="asc",onSort:g=()=>{}}){const[p,b]=e.useState(null);e.useState(null);const[h,f]=e.useState(!1);e.useState(null),e.useState(null);const[T,L]=e.useState(null);e.useRef(null),e.useEffect((()=>{const e=()=>{f(window.innerWidth<768)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]);const R=e=>{switch(e){case"completed":return"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400";case"in-progress":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400";default:return"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400"}},$=e=>{switch(e){case"completed":return t.jsx(x,{className:"w-3 h-3"});case"in-progress":return t.jsx(S,{className:"w-3 h-3"});default:return t.jsx(l,{className:"w-3 h-3"})}},_=e=>{switch(e){case"completed":return"Completed";case"in-progress":return"In Progress";default:return"To Do"}},I=e=>{switch(e){case"high":return t.jsx("span",{className:"px-2 py-0.5 text-xs rounded-full bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400",children:"High"});case"medium":return t.jsx("span",{className:"px-2 py-0.5 text-xs rounded-full bg-orange-100 text-orange-800 dark:bg-orange-900/30 dark:text-orange-400",children:"Medium"});case"low":return t.jsx("span",{className:"px-2 py-0.5 text-xs rounded-full bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400",children:"Low"});default:return null}},A=e=>u!==e?null:"asc"===m?t.jsx(C,{className:"w-3.5 h-3.5 ml-1 inline-block"}):t.jsx(E,{className:"w-3.5 h-3.5 ml-1 inline-block"}),U=async e=>{const t=e.description.replace(/\*\*Attachments:\*\*[\s\S]*?(?=\n\n|$)/g,"").trim(),r=`\nğŸ“‹ TASK: ${e.name}\nğŸ“… Due Date: ${G(e.dueDate)}\nğŸ·ï¸ Category: ${e.category}\n\nğŸ“ Description:\n${t}\n\nğŸŒ View: https://nesttask.vercel.app/\n    `.trim();try{await navigator.clipboard.writeText(r),L(e.id),setTimeout((()=>L(null)),2e3)}catch(a){}};return 0===r.length?t.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm p-8 text-center",children:t.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No tasks available"})}):t.jsxs(t.Fragment,{children:["table"===i?t.jsx("div",{className:"relative overflow-hidden rounded-lg",children:t.jsx("div",{className:"overflow-x-auto -mx-4 sm:mx-0",children:t.jsx("div",{className:"inline-block min-w-full align-middle",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[t.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800/50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"w-12 sm:w-8 px-2 sm:px-4 py-3",children:t.jsx("div",{className:"flex items-center justify-center",children:t.jsx("button",{onClick:c,className:"p-1 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-700","aria-label":"Select all tasks",children:d.length>0&&d.length===r.length?t.jsx(k,{className:"w-4 h-4 sm:w-5 sm:h-5 text-blue-500 dark:text-blue-400"}):t.jsx(v,{className:"w-4 h-4 sm:w-5 sm:h-5 text-gray-400 dark:text-gray-500"})})})}),t.jsx("th",{className:"px-2 sm:px-4 py-3 text-left",children:t.jsxs("button",{onClick:()=>g("name"),className:"flex items-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider hover:text-gray-700 dark:hover:text-gray-200",children:[t.jsx("span",{className:"hidden sm:inline",children:"Task "}),"Name",A("name")]})}),t.jsx("th",{className:"hidden sm:table-cell px-4 py-3 text-left",children:t.jsxs("button",{onClick:()=>g("category"),className:"flex items-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider hover:text-gray-700 dark:hover:text-gray-200",children:["Category",A("category")]})}),t.jsx("th",{className:"px-2 sm:px-4 py-3 text-left",children:t.jsxs("button",{onClick:()=>g("dueDate"),className:"flex items-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider hover:text-gray-700 dark:hover:text-gray-200",children:[t.jsx("span",{className:"hidden sm:inline",children:"Due "}),"Date",A("dueDate")]})}),t.jsx("th",{className:"px-2 sm:px-4 py-3 text-left",children:t.jsxs("button",{onClick:()=>g("status"),className:"flex items-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider hover:text-gray-700 dark:hover:text-gray-200",children:["Status",A("status")]})}),t.jsx("th",{className:"px-2 sm:px-4 py-3 text-right",children:t.jsx("span",{className:"sr-only",children:"Actions"})})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:r.map((e=>t.jsxs("tr",{className:"group hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors "+(d.includes(e.id)?"bg-blue-50 dark:bg-blue-900/20":""),children:[t.jsx("td",{className:"w-12 sm:w-8 px-2 sm:px-4 py-2",children:t.jsx("div",{className:"flex items-center justify-center",children:t.jsx("button",{onClick:()=>o(e.id),className:"p-1 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-700",children:d.includes(e.id)?t.jsx(k,{className:"w-4 h-4 sm:w-5 sm:h-5 text-blue-500 dark:text-blue-400"}):t.jsx(v,{className:"w-4 h-4 sm:w-5 sm:h-5 text-gray-400 dark:text-gray-500"})})})}),t.jsx("td",{className:"px-2 sm:px-4 py-2",children:t.jsxs("div",{className:"max-w-xs sm:max-w-sm",children:[t.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white truncate",children:e.name}),t.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 line-clamp-1 sm:hidden",children:e.category.replace(/-/g," ")})]})}),t.jsxs("td",{className:"hidden sm:table-cell px-4 py-2",children:[t.jsx("div",{className:"text-sm capitalize text-gray-900 dark:text-white",children:e.category.replace(/-/g," ")}),e.priority&&t.jsx("div",{className:"mt-1",children:I(e.priority)})]}),t.jsx("td",{className:"px-2 sm:px-4 py-2",children:t.jsxs("span",{className:"text-xs sm:text-sm flex items-center gap-1 "+(F(e.dueDate,e.status)?"text-red-600 dark:text-red-400":"text-gray-600 dark:text-gray-400"),children:[F(e.dueDate,e.status)&&t.jsx(j,{className:"w-3 h-3 sm:w-3.5 sm:h-3.5"}),t.jsx("span",{className:"whitespace-nowrap",children:G(e.dueDate)})]})}),t.jsx("td",{className:"px-2 sm:px-4 py-2",children:t.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium ${R(e.status)}`,children:[$(e.status),t.jsx("span",{className:"hidden xs:inline",children:_(e.status)})]})}),t.jsx("td",{className:"px-2 sm:px-4 py-2 text-right",children:t.jsxs("div",{className:"flex items-center justify-end gap-1 sm:gap-2",children:[t.jsx("button",{onClick:()=>U(e),className:"p-1 sm:p-1.5 rounded-lg transition-colors duration-200 "+(T===e.id?"bg-green-100 text-green-600 dark:bg-green-900/30 dark:text-green-400":"hover:bg-gray-100 text-gray-500 dark:text-gray-400 dark:hover:bg-gray-700"),title:"Copy task details",children:T===e.id?t.jsx(w,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"}):t.jsx(N,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"})}),t.jsx("button",{onClick:()=>b(e),className:"p-1 sm:p-1.5 rounded-lg transition-colors duration-200 hover:bg-blue-100 text-blue-600 dark:text-blue-400 dark:hover:bg-blue-900/30",title:"Edit task",children:t.jsx(D,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"})}),t.jsx("button",{onClick:()=>s(e.id,{status:"completed"===e.status?"my-tasks":"completed"}),className:"p-1 sm:p-1.5 rounded-lg transition-colors duration-200 "+("completed"===e.status?"bg-green-100 text-green-600 dark:bg-green-900/30 dark:text-green-400":"hover:bg-gray-100 text-gray-500 dark:text-gray-400 dark:hover:bg-gray-700"),title:"completed"===e.status?"Mark as incomplete":"Mark as complete",children:t.jsx(x,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"})}),t.jsx("button",{onClick:()=>a(e.id),className:"p-1 sm:p-1.5 hover:bg-red-100 text-red-600 dark:hover:bg-red-900/30 dark:text-red-400 rounded-lg transition-colors duration-200",title:"Delete task",children:t.jsx(y,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"})})]})})]},e.id)))})]})})})}):t.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 p-4",children:r.map((e=>t.jsxs("div",{className:"group bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4 hover:shadow-md transition-all "+(d.includes(e.id)?"ring-2 ring-blue-500 dark:ring-blue-400":""),children:[t.jsx("div",{className:"flex items-start justify-between",children:t.jsxs("div",{className:"flex-1",children:[t.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-white line-clamp-2",children:e.name}),t.jsx("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400 line-clamp-2",children:e.description})]})}),t.jsxs("div",{className:"mt-4 flex flex-wrap items-center gap-2 text-xs",children:[t.jsx("span",{className:"px-2 py-1 rounded-md bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300",children:e.category}),t.jsx("span",{className:"px-2 py-1 rounded-md "+(F(e.dueDate)&&"completed"!==e.status?"bg-red-100 text-red-600 dark:bg-red-900/30 dark:text-red-400":"bg-gray-100 text-gray-600 dark:bg-gray-700 dark:text-gray-300"),children:G(e.dueDate)})]}),t.jsxs("div",{className:"mt-4 flex items-center justify-end gap-2",children:[t.jsx("button",{onClick:()=>U(e),className:"p-1 sm:p-1.5 rounded-lg transition-colors duration-200 "+(T===e.id?"bg-green-100 text-green-600 dark:bg-green-900/30 dark:text-green-400":"hover:bg-gray-100 text-gray-500 dark:text-gray-400 dark:hover:bg-gray-700"),title:"Copy task details",children:T===e.id?t.jsx(w,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"}):t.jsx(N,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"})}),t.jsx("button",{onClick:()=>b(e),className:"p-1 sm:p-1.5 rounded-lg transition-colors duration-200 hover:bg-blue-100 text-blue-600 dark:text-blue-400 dark:hover:bg-blue-900/30",title:"Edit task",children:t.jsx(D,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"})}),t.jsx("button",{onClick:()=>s(e.id,{status:"completed"===e.status?"my-tasks":"completed"}),className:"p-1 sm:p-1.5 rounded-lg transition-colors duration-200 "+("completed"===e.status?"bg-green-100 text-green-600 dark:bg-green-900/30 dark:text-green-400":"hover:bg-gray-100 text-gray-500 dark:text-gray-400 dark:hover:bg-gray-700"),title:"completed"===e.status?"Mark as incomplete":"Mark as complete",children:t.jsx(x,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"})}),t.jsx("button",{onClick:()=>a(e.id),className:"p-1 sm:p-1.5 hover:bg-red-100 text-red-600 dark:hover:bg-red-900/30 dark:text-red-400 rounded-lg transition-colors duration-200",title:"Delete task",children:t.jsx(y,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"})})]})]},e.id)))}),p&&t.jsx(Z,{task:p,onClose:()=>b(null),onUpdate:async(e,t)=>{try{await s(e,t),b(null)}catch(r){}},isSectionAdmin:n})]})}function Y({tasks:r,onCreateTask:a,onDeleteTask:s,onUpdateTask:l,showTaskForm:n=!1,sectionId:i,isSectionAdmin:d=!1,isLoading:o=!1,isCreatingTask:c=!1,onTaskCreateStart:m,onTaskCreateEnd:x,onRefresh:p}){const[b,h]=e.useState(!0),[f,v]=e.useState(!1),[j,w]=e.useState("table"),[N,D]=e.useState({category:"all",status:"all",search:"",startDate:"",endDate:""}),[S,C]=e.useState({by:"createdAt",order:"desc"}),[E,P]=e.useState([]),[F,G]=e.useState(!1),[B,q]=e.useState([]),[V,K]=e.useState(0),H=e.useRef(null),[W,Q]=e.useState(""),Z=e.useRef(!1),Y=e.useRef([]);e.useEffect((()=>{h(!0)}),[n]),e.useEffect((()=>{if(!Z.current&&r!==Y.current){const e=Date.now();e-V>100&&(q(r),K(e),Y.current=r)}}),[r,V]),e.useEffect((()=>(H.current&&window.clearTimeout(H.current),H.current=window.setTimeout((()=>{Q(N.search)}),300),()=>{H.current&&window.clearTimeout(H.current)})),[N.search]);const ee=e.useMemo((()=>B.filter((e=>{if("all"!==N.category&&e.category!==N.category)return!1;if("all"!==N.status&&e.status!==N.status)return!1;if(N.startDate&&new Date(e.dueDate)<new Date(N.startDate))return!1;if(N.endDate){const t=new Date(N.endDate);if(t.setHours(23,59,59,999),new Date(e.dueDate)>t)return!1}if(W){const t=W.toLowerCase();return e.name.toLowerCase().includes(t)||e.description.toLowerCase().includes(t)||e.category.toLowerCase().includes(t)}return!0}))),[B,N.category,N.status,N.startDate,N.endDate,W]),te=e.useMemo((()=>[...ee].sort(((e,t)=>{let r=0;switch(S.by){case"dueDate":r=new Date(e.dueDate).getTime()-new Date(t.dueDate).getTime();break;case"name":r=e.name.localeCompare(t.name);break;case"category":r=e.category.localeCompare(t.category);break;case"createdAt":r=(e.createdAt?new Date(e.createdAt).getTime():Date.now())-(t.createdAt?new Date(t.createdAt).getTime():Date.now());break;case"priority":const a={high:3,medium:2,low:1},s=e.priority||"medium",l=t.priority||"medium";r=(a[s]||0)-(a[l]||0)}return"asc"===S.order?r:-r}))),[ee,S.by,S.order]),re=e.useCallback((async e=>{if(!Z.current){Z.current=!0;try{null==m||m();const t={...e};if(d&&i){const e={...t,sectionId:i};await a(e,i)}else await a(t);D({category:"all",status:"all",startDate:"",endDate:"",search:""}),M("Task created successfully")}catch(t){z(`Failed to create task: ${t.message||"Please try again."}`)}finally{Z.current=!1,null==x||x()}}}),[d,a,i,m,x]),ae=e.useCallback((async e=>{if(!Z.current){Z.current=!0;try{await s(e),q((t=>t.filter((t=>t.id!==e)))),M("Task deleted successfully")}catch(t){z(`Error deleting task: ${t.message||"Please try again."}`)}finally{Z.current=!1}}}),[s]),se=e.useCallback((async(e,t)=>{if(!Z.current){Z.current=!0;try{await l(e,t),q((r=>r.map((r=>r.id===e?{...r,...t,updatedAt:(new Date).toISOString()}:r)))),M("Task updated successfully")}catch(r){z(`Error updating task: ${r.message||"Please try again."}`)}finally{Z.current=!1}}}),[l]),le=async e=>{if(0!==E.length&&!F){G(!0);try{let r=0;const a=[];for(const s of E)try{await l(s,{status:e,updatedAt:(new Date).toISOString()}),r++,q((t=>t.map((t=>t.id===s?{...t,status:e,updatedAt:(new Date).toISOString()}:t))))}catch(t){a.push(`Task ${s}: ${t.message}`)}r>0&&M(`Updated ${r} tasks to ${e}`),a.length>0&&z(`Failed to update ${a.length} tasks`),P([])}catch(t){z(`Error updating task status: ${t.message||"Please try again."}`)}finally{G(!1)}}};return t.jsxs("div",{className:"space-y-4",children:[b&&t.jsx("div",{children:t.jsx(X,{onSubmit:re,sectionId:i,isSectionAdmin:d,isSubmitting:c})}),t.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm",children:t.jsx("div",{className:"p-3 sm:p-4 border-b border-gray-200 dark:border-gray-700",children:t.jsxs("div",{className:"flex flex-col space-y-3 sm:space-y-0 sm:flex-row sm:items-center sm:justify-between",children:[t.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[t.jsx("button",{className:"inline-flex items-center justify-center px-3 sm:px-4 py-1.5 sm:py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors duration-200",onClick:()=>h(!b),disabled:o,children:b?t.jsxs(t.Fragment,{children:[t.jsx(T,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4 mr-1"}),t.jsx("span",{className:"hidden xs:inline",children:"Hide Form"}),t.jsx("span",{className:"xs:hidden",children:"Hide"})]}):t.jsxs(t.Fragment,{children:[t.jsx(u,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4 mr-1"}),t.jsx("span",{className:"hidden xs:inline",children:"Create Task"}),t.jsx("span",{className:"xs:hidden",children:"Create"})]})}),t.jsxs("button",{className:`\n                  inline-flex items-center justify-center px-3 sm:px-4 py-1.5 sm:py-2 text-sm font-medium rounded-lg transition-colors duration-200\n                  ${o?"bg-gray-100 text-gray-400 cursor-not-allowed dark:bg-gray-700 dark:text-gray-500":f?"bg-blue-50 text-blue-600 dark:bg-blue-900/30 dark:text-blue-400":"bg-gray-100 text-gray-700 hover:bg-gray-200 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700"}\n                `,onClick:()=>v(!f),disabled:o,children:[t.jsx(L,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4 mr-1"}),t.jsx("span",{className:"hidden xs:inline",children:"Filters"})]}),t.jsxs("div",{className:"inline-flex rounded-lg border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800",children:[t.jsx("button",{className:"px-2 sm:px-3 py-1.5 sm:py-2 rounded-l-lg transition-colors duration-200 "+("table"===j?"bg-blue-50 text-blue-600 dark:bg-blue-900/30 dark:text-blue-400":"text-gray-600 hover:bg-gray-50 dark:text-gray-400 dark:hover:bg-gray-700"),onClick:()=>w("table"),title:"Table view",children:t.jsx(R,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"})}),t.jsx("button",{className:"px-2 sm:px-3 py-1.5 sm:py-2 rounded-r-lg transition-colors duration-200 "+("grid"===j?"bg-blue-50 text-blue-600 dark:bg-blue-900/30 dark:text-blue-400":"text-gray-600 hover:bg-gray-50 dark:text-gray-400 dark:hover:bg-gray-700"),onClick:()=>w("grid"),title:"Grid view",children:t.jsx($,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"})})]}),t.jsxs("button",{className:"inline-flex items-center justify-center px-3 sm:px-4 py-1.5 sm:py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",onClick:()=>{try{const e=["Name","Category","Due Date","Status","Description"],t=te.map((e=>[`"${e.name.replace(/"/g,'""')}"`,`"${e.category.replace(/"/g,'""')}"`,`"${new Date(e.dueDate).toLocaleDateString()}"`,`"${"my-tasks"===e.status?"To Do":"in-progress"===e.status?"In Progress":"Completed"}"`,`"${e.description.replace(/"/g,'""')}"`])),r=[e.join(","),...t.map((e=>e.join(",")))].join("\n"),a=new Blob([r],{type:"text/csv;charset=utf-8;"}),s=URL.createObjectURL(a),l=document.createElement("a");l.setAttribute("href",s),l.setAttribute("download",`tasks_export_${i?`section_${i}_`:""}${(new Date).toISOString().split("T")[0]}.csv`),l.style.visibility="hidden",document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(s),M("Tasks exported successfully")}catch(e){z("Failed to export tasks. Please try again.")}},disabled:o||0===te.length,title:"Export to CSV",children:[t.jsx(_,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4 mr-1"}),t.jsx("span",{className:"hidden xs:inline",children:"Export"})]}),p&&t.jsxs("button",{className:"inline-flex items-center justify-center px-3 sm:px-4 py-1.5 sm:py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",onClick:p,disabled:o,title:"Refresh tasks",children:[t.jsx(I,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4 mr-1 "+(o?"animate-spin":"")}),t.jsx("span",{className:"hidden xs:inline",children:"Refresh"})]})]}),t.jsx("div",{className:"relative w-full sm:w-auto sm:min-w-[200px] md:min-w-[240px]",children:t.jsxs("div",{className:"flex items-center w-full px-3 py-1.5 sm:py-2 bg-gray-50 border border-gray-200 rounded-lg dark:bg-gray-800 dark:border-gray-700 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors duration-200",children:[t.jsx(A,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4 text-gray-400 dark:text-gray-500"}),t.jsx("input",{type:"text",placeholder:"Search tasks...",value:N.search,onChange:e=>D({...N,search:e.target.value}),className:"w-full ml-2 text-sm bg-transparent border-none outline-none focus:ring-0 text-gray-700 dark:text-gray-300 placeholder-gray-500 dark:placeholder-gray-400"}),N.search&&t.jsx("button",{onClick:()=>D({...N,search:""}),className:"p-0.5 sm:p-1 ml-1 text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200",children:t.jsx(g,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"})})]})})]})})}),f&&t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm p-3 sm:p-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3 sm:mb-4",children:[t.jsx("h3",{className:"text-xs sm:text-sm font-medium text-gray-700 dark:text-gray-300",children:"Filter Tasks"}),t.jsx("div",{className:"flex items-center gap-2",children:t.jsxs("button",{onClick:()=>{D({category:"all",status:"all",startDate:"",endDate:"",search:""}),Q(""),C({by:"createdAt",order:"desc"})},className:"text-xs flex items-center gap-1 text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 py-1 px-2",children:[t.jsx(U,{className:"w-3 h-3 sm:w-3.5 sm:h-3.5"}),"Reset"]})})]}),t.jsxs("div",{className:"grid grid-cols-1 xs:grid-cols-2 md:grid-cols-4 gap-3 text-sm",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Status"}),t.jsxs("select",{value:N.status,onChange:e=>D({...N,status:e.target.value}),className:"w-full px-2 sm:px-3 py-1.5 sm:py-2 border dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white text-xs sm:text-sm",children:[t.jsx("option",{value:"all",children:"All Statuses"}),t.jsx("option",{value:"my-tasks",children:"To Do"}),t.jsx("option",{value:"in-progress",children:"In Progress"}),t.jsx("option",{value:"completed",children:"Completed"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Category"}),t.jsxs("select",{value:N.category,onChange:e=>D({...N,category:e.target.value}),className:"w-full px-2 sm:px-3 py-1.5 sm:py-2 border dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white text-xs sm:text-sm",children:[t.jsx("option",{value:"all",children:"All Categories"}),t.jsx("option",{value:"assignment",children:"Assignment"}),t.jsx("option",{value:"blc",children:"BLC"}),t.jsx("option",{value:"documents",children:"Documents"}),t.jsx("option",{value:"final-exam",children:"Final Exam"}),t.jsx("option",{value:"groups",children:"Groups"}),t.jsx("option",{value:"lab-final",children:"Lab Final"}),t.jsx("option",{value:"lab-performance",children:"Lab Performance"}),t.jsx("option",{value:"lab-report",children:"Lab Report"}),t.jsx("option",{value:"midterm",children:"Midterm"}),t.jsx("option",{value:"presentation",children:"Presentation"}),t.jsx("option",{value:"project",children:"Project"}),t.jsx("option",{value:"quiz",children:"Quiz"}),t.jsx("option",{value:"task",children:"Task"}),t.jsx("option",{value:"others",children:"Others"})]})]}),t.jsxs("div",{className:"xs:col-span-2",children:[t.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Date Range"}),t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.jsx("div",{children:t.jsx("input",{type:"date",value:N.startDate,onChange:e=>D({...N,startDate:e.target.value}),className:"w-full px-2 sm:px-3 py-1.5 sm:py-2 border dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white text-xs sm:text-sm",placeholder:"Start date"})}),t.jsx("div",{children:t.jsx("input",{type:"date",value:N.endDate,onChange:e=>D({...N,endDate:e.target.value}),className:"w-full px-2 sm:px-3 py-1.5 sm:py-2 border dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white text-xs sm:text-sm",placeholder:"End date"})})]})]})]})]}),E.length>0&&t.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-xl p-2 sm:p-3 flex flex-wrap items-center justify-between gap-2 sm:gap-3",children:[t.jsx("div",{className:"flex items-center",children:t.jsxs("span",{className:"text-xs sm:text-sm font-medium text-blue-700 dark:text-blue-300",children:[E.length," ",1===E.length?"task":"tasks"," selected"]})}),t.jsxs("div",{className:"flex flex-wrap items-center gap-1 sm:gap-2",children:[t.jsxs("button",{onClick:()=>le("completed"),disabled:F,className:"px-2 py-1 sm:px-2.5 sm:py-1.5 text-xs bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:bg-green-300 disabled:cursor-not-allowed flex items-center gap-1",children:[t.jsx(k,{className:"w-3 h-3 sm:w-3.5 sm:h-3.5"}),t.jsx("span",{className:"hidden xs:inline",children:"Complete"})]}),t.jsxs("button",{onClick:()=>le("in-progress"),disabled:F,className:"px-2 py-1 sm:px-2.5 sm:py-1.5 text-xs bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 disabled:bg-yellow-300 disabled:cursor-not-allowed flex items-center gap-1",children:[t.jsx(k,{className:"w-3 h-3 sm:w-3.5 sm:h-3.5"}),t.jsx("span",{className:"hidden xs:inline",children:"Progress"})]}),t.jsxs("button",{onClick:async()=>{if(E.length&&!F)try{G(!0);let t=0;const r=[];for(const a of E)try{await s(a),t++,q((e=>e.filter((e=>e.id!==a))))}catch(e){r.push(`Task ${a}: ${e.message}`)}t>0&&M(`${t} tasks deleted successfully`),r.length>0&&z(`Failed to delete ${r.length} tasks`),P([])}catch(e){z(`Error deleting tasks: ${e.message||"Please try again."}`)}finally{G(!1)}},disabled:F,className:"px-2 py-1 sm:px-2.5 sm:py-1.5 text-xs bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:bg-red-300 disabled:cursor-not-allowed flex items-center gap-1",children:[t.jsx(y,{className:"w-3 h-3 sm:w-3.5 sm:h-3.5"}),t.jsx("span",{className:"hidden xs:inline",children:"Delete"})]}),t.jsx("button",{onClick:()=>P([]),disabled:F,className:"px-2 py-1 sm:px-2.5 sm:py-1.5 text-xs bg-gray-600 text-white rounded-lg hover:bg-gray-700 disabled:bg-gray-300 disabled:cursor-not-allowed",children:"Cancel"})]})]}),o?t.jsx("div",{className:"p-8 flex justify-center items-center",children:t.jsx(O,{className:"w-8 h-8 text-blue-500 animate-spin"})}):t.jsxs(t.Fragment,{children:[t.jsx(J,{tasks:te,onDeleteTask:ae,onUpdateTask:se,isSectionAdmin:d,viewMode:j,selectedTaskIds:E,onToggleSelection:e=>{P((t=>t.includes(e)?t.filter((t=>t!==e)):[...t,e]))},onSelectAll:()=>{P((e=>e.length===te.length?[]:te.map((e=>e.id))))},sortBy:S.by,sortOrder:S.order,onSort:e=>{"createdAt"!==e&&"dueDate"!==e&&"name"!==e&&"category"!==e&&"priority"!==e||C((t=>({by:e,order:t.by===e&&"asc"===t.order?"desc":"asc"})))}}),0===te.length&&!o&&t.jsx("div",{className:"p-8 text-center",children:t.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No tasks found. Try adjusting your filters or create a new task."})})]})]})}export{Y as TaskManager};
