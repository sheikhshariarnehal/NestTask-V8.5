import{j as e,r as c,s as y,i as dt,u as ct,a as mt}from"./index.C_acLESD.js";import{c as _r}from"./clsx.B-dksMZM.js";import{X as ge}from"./x.EQqBnDVm.js";import{C as gt}from"./chevron-right.CxCyoZnO.js";import{C as ut}from"./chevron-left.DB7bm0Fx.js";import{L as ht,M as xt}from"./menu.DjqFCE7R.js";import{S as K,B as pt}from"./shield.DJTHJk-L.js";import{U as Se}from"./users.Au5Rmc_G.js";import{A as ue}from"./activity.BdFVh8VG.js";import{F as ft}from"./file-text.DUSoxLOK.js";import{S as bt,u as yt,a as wt,M as vt,L as jt}from"./sun.C0BuOcI6.js";import{C as Ke}from"./check-circle.CQfjgXaw.js";import{D as ur,K as Er,c as Ne,a as Te,e as kt,C as Xe,A as Nt,b as At,U as St,d as Rr,P as Ct}from"./user-x.uqV4-rSx.js";import{L as hr,M as _t}from"./mail.DC2UCBYC.js";import{T as Et,P as Rt,B as Ut}from"./trending-up.B3xRllJd.js";import{s as he,a as W}from"./notifications.Cxon97EE.js";import{R as xe,P as Ur}from"./refresh-cw.-jskVr_o.js";import{P as Mt}from"./plus.7dqlE_AI.js";import{S as ar}from"./search.CPh8H5iB.js";import{D as ze}from"./download.5h7xx-gb.js";import{S as Lt}from"./square-pen.BN_UO3br.js";import{M as Mr}from"./more-vertical.Cj4nCbu7.js";import{U as xr}from"./user-check.D_AVCX8J.js";import{C as pr}from"./chevron-down.WA8twjSc.js";import{F as Lr}from"./filter.DqCeAUk2.js";import{C as Ft}from"./chevron-up.Bat5zoYu.js";import{B as Tt}from"./building.DxlbKc0Y.js";import{C as Fr}from"./clock.7qrk36aN.js";import{U as $e}from"./user.D0EJMNgj.js";import{E as Pt}from"./eye-off.BYoefIRx.js";import{E as Dt}from"./eye.Bhgy5N19.js";import{C as zt,S as Tr}from"./shield-check.BFo2NFw-.js";import{C as $t}from"./copy.BPpwAQe5.js";import{A as It}from"./alert-triangle.CZfjjxRt.js";import{C as Ot}from"./calendar.BsI68CSu.js";import{A as Bt}from"./alert-circle.DhOw_PQ_.js";import{T as Pr}from"./trash-2.CU3aGJ4a.js";import{u as Vt}from"./useAuth.CMlLUe7_.js";import"./createLucideIcon.CKymOnwz.js";import"./dataCache.z_cl_fNt.js";import"./authErrors.D8KAnYp0.js";const qt=(r,a)=>{const t=new Array(r.length+a.length);for(let s=0;s<r.length;s++)t[s]=r[s];for(let s=0;s<a.length;s++)t[r.length+s]=a[s];return t},Gt=(r,a)=>({classGroupId:r,validator:a}),Dr=(r=new Map,a=null,t)=>({nextPart:r,validators:a,classGroupId:t}),Ie="-",fr=[],Wt="arbitrary..",Ht=r=>{const a=Jt(r),{conflictingClassGroups:t,conflictingClassGroupModifiers:s}=r;return{getClassGroupId:i=>{if(i.startsWith("[")&&i.endsWith("]"))return Yt(i);const d=i.split(Ie),l=d[0]===""&&d.length>1?1:0;return zr(d,l,a)},getConflictingClassGroupIds:(i,d)=>{if(d){const l=s[i],m=t[i];return l?m?qt(m,l):l:m||fr}return t[i]||fr}}},zr=(r,a,t)=>{if(r.length-a===0)return t.classGroupId;const n=r[a],o=t.nextPart.get(n);if(o){const m=zr(r,a+1,o);if(m)return m}const i=t.validators;if(i===null)return;const d=a===0?r.join(Ie):r.slice(a).join(Ie),l=i.length;for(let m=0;m<l;m++){const h=i[m];if(h.validator(d))return h.classGroupId}},Yt=r=>r.slice(1,-1).indexOf(":")===-1?void 0:(()=>{const a=r.slice(1,-1),t=a.indexOf(":"),s=a.slice(0,t);return s?Wt+s:void 0})(),Jt=r=>{const{theme:a,classGroups:t}=r;return Kt(t,a)},Kt=(r,a)=>{const t=Dr();for(const s in r){const n=r[s];sr(n,t,s,a)}return t},sr=(r,a,t,s)=>{const n=r.length;for(let o=0;o<n;o++){const i=r[o];Xt(i,a,t,s)}},Xt=(r,a,t,s)=>{if(typeof r=="string"){Zt(r,a,t);return}if(typeof r=="function"){Qt(r,a,t,s);return}ea(r,a,t,s)},Zt=(r,a,t)=>{const s=r===""?a:$r(a,r);s.classGroupId=t},Qt=(r,a,t,s)=>{if(ra(r)){sr(r(s),a,t,s);return}a.validators===null&&(a.validators=[]),a.validators.push(Gt(t,r))},ea=(r,a,t,s)=>{const n=Object.entries(r),o=n.length;for(let i=0;i<o;i++){const[d,l]=n[i];sr(l,$r(a,d),t,s)}},$r=(r,a)=>{let t=r;const s=a.split(Ie),n=s.length;for(let o=0;o<n;o++){const i=s[o];let d=t.nextPart.get(i);d||(d=Dr(),t.nextPart.set(i,d)),t=d}return t},ra=r=>"isThemeGetter"in r&&r.isThemeGetter===!0,ta=r=>{if(r<1)return{get:()=>{},set:()=>{}};let a=0,t=Object.create(null),s=Object.create(null);const n=(o,i)=>{t[o]=i,a++,a>r&&(a=0,s=t,t=Object.create(null))};return{get(o){let i=t[o];if(i!==void 0)return i;if((i=s[o])!==void 0)return n(o,i),i},set(o,i){o in t?t[o]=i:n(o,i)}}},rr="!",br=":",aa=[],yr=(r,a,t,s,n)=>({modifiers:r,hasImportantModifier:a,baseClassName:t,maybePostfixModifierPosition:s,isExternal:n}),sa=r=>{const{prefix:a,experimentalParseClassName:t}=r;let s=n=>{const o=[];let i=0,d=0,l=0,m;const h=n.length;for(let b=0;b<h;b++){const f=n[b];if(i===0&&d===0){if(f===br){o.push(n.slice(l,b)),l=b+1;continue}if(f==="/"){m=b;continue}}f==="["?i++:f==="]"?i--:f==="("?d++:f===")"&&d--}const x=o.length===0?n:n.slice(l);let S=x,k=!1;x.endsWith(rr)?(S=x.slice(0,-1),k=!0):x.startsWith(rr)&&(S=x.slice(1),k=!0);const p=m&&m>l?m-l:void 0;return yr(o,k,S,p)};if(a){const n=a+br,o=s;s=i=>i.startsWith(n)?o(i.slice(n.length)):yr(aa,!1,i,void 0,!0)}if(t){const n=s;s=o=>t({className:o,parseClassName:n})}return s},na=r=>{const a=new Map;return r.orderSensitiveModifiers.forEach((t,s)=>{a.set(t,1e6+s)}),t=>{const s=[];let n=[];for(let o=0;o<t.length;o++){const i=t[o],d=i[0]==="[",l=a.has(i);d||l?(n.length>0&&(n.sort(),s.push(...n),n=[]),s.push(i)):n.push(i)}return n.length>0&&(n.sort(),s.push(...n)),s}},oa=r=>({cache:ta(r.cacheSize),parseClassName:sa(r),sortModifiers:na(r),...Ht(r)}),ia=/\s+/,la=(r,a)=>{const{parseClassName:t,getClassGroupId:s,getConflictingClassGroupIds:n,sortModifiers:o}=a,i=[],d=r.trim().split(ia);let l="";for(let m=d.length-1;m>=0;m-=1){const h=d[m],{isExternal:x,modifiers:S,hasImportantModifier:k,baseClassName:p,maybePostfixModifierPosition:b}=t(h);if(x){l=h+(l.length>0?" "+l:l);continue}let f=!!b,g=s(f?p.substring(0,b):p);if(!g){if(!f){l=h+(l.length>0?" "+l:l);continue}if(g=s(p),!g){l=h+(l.length>0?" "+l:l);continue}f=!1}const u=S.length===0?"":S.length===1?S[0]:o(S).join(":"),M=k?u+rr:u,w=M+g;if(i.indexOf(w)>-1)continue;i.push(w);const E=n(g,f);for(let R=0;R<E.length;++R){const _=E[R];i.push(M+_)}l=h+(l.length>0?" "+l:l)}return l},da=(...r)=>{let a=0,t,s,n="";for(;a<r.length;)(t=r[a++])&&(s=Ir(t))&&(n&&(n+=" "),n+=s);return n},Ir=r=>{if(typeof r=="string")return r;let a,t="";for(let s=0;s<r.length;s++)r[s]&&(a=Ir(r[s]))&&(t&&(t+=" "),t+=a);return t},ca=(r,...a)=>{let t,s,n,o;const i=l=>{const m=a.reduce((h,x)=>x(h),r());return t=oa(m),s=t.cache.get,n=t.cache.set,o=d,d(l)},d=l=>{const m=s(l);if(m)return m;const h=la(l,t);return n(l,h),h};return o=i,(...l)=>o(da(...l))},ma=[],z=r=>{const a=t=>t[r]||ma;return a.isThemeGetter=!0,a},Or=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,Br=/^\((?:(\w[\w-]*):)?(.+)\)$/i,ga=/^\d+\/\d+$/,ua=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,ha=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,xa=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,pa=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,fa=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,ce=r=>ga.test(r),U=r=>!!r&&!Number.isNaN(Number(r)),oe=r=>!!r&&Number.isInteger(Number(r)),Ze=r=>r.endsWith("%")&&U(r.slice(0,-1)),te=r=>ua.test(r),ba=()=>!0,ya=r=>ha.test(r)&&!xa.test(r),Vr=()=>!1,wa=r=>pa.test(r),va=r=>fa.test(r),ja=r=>!v(r)&&!j(r),ka=r=>fe(r,Wr,Vr),v=r=>Or.test(r),le=r=>fe(r,Hr,ya),Qe=r=>fe(r,_a,U),wr=r=>fe(r,qr,Vr),Na=r=>fe(r,Gr,va),Pe=r=>fe(r,Yr,wa),j=r=>Br.test(r),Ae=r=>be(r,Hr),Aa=r=>be(r,Ea),vr=r=>be(r,qr),Sa=r=>be(r,Wr),Ca=r=>be(r,Gr),De=r=>be(r,Yr,!0),fe=(r,a,t)=>{const s=Or.exec(r);return s?s[1]?a(s[1]):t(s[2]):!1},be=(r,a,t=!1)=>{const s=Br.exec(r);return s?s[1]?a(s[1]):t:!1},qr=r=>r==="position"||r==="percentage",Gr=r=>r==="image"||r==="url",Wr=r=>r==="length"||r==="size"||r==="bg-size",Hr=r=>r==="length",_a=r=>r==="number",Ea=r=>r==="family-name",Yr=r=>r==="shadow",Ra=()=>{const r=z("color"),a=z("font"),t=z("text"),s=z("font-weight"),n=z("tracking"),o=z("leading"),i=z("breakpoint"),d=z("container"),l=z("spacing"),m=z("radius"),h=z("shadow"),x=z("inset-shadow"),S=z("text-shadow"),k=z("drop-shadow"),p=z("blur"),b=z("perspective"),f=z("aspect"),g=z("ease"),u=z("animate"),M=()=>["auto","avoid","all","avoid-page","page","left","right","column"],w=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],E=()=>[...w(),j,v],R=()=>["auto","hidden","clip","visible","scroll"],_=()=>["auto","contain","none"],N=()=>[j,v,l],T=()=>[ce,"full","auto",...N()],se=()=>[oe,"none","subgrid",j,v],re=()=>["auto",{span:["full",oe,j,v]},oe,j,v],de=()=>[oe,"auto",j,v],Ee=()=>["auto","min","max","fr",j,v],ve=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],ne=()=>["start","end","center","stretch","center-safe","end-safe"],H=()=>["auto",...N()],X=()=>[ce,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...N()],C=()=>[r,j,v],Re=()=>[...w(),vr,wr,{position:[j,v]}],Ue=()=>["no-repeat",{repeat:["","x","y","space","round"]}],A=()=>["auto","cover","contain",Sa,ka,{size:[j,v]}],O=()=>[Ze,Ae,le],F=()=>["","none","full",m,j,v],$=()=>["",U,Ae,le],ie=()=>["solid","dashed","dotted","double"],je=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],P=()=>[U,Ze,vr,wr],ke=()=>["","none",p,j,v],Me=()=>["none",U,j,v],Le=()=>["none",U,j,v],Je=()=>[U,j,v],Fe=()=>[ce,"full",...N()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[te],breakpoint:[te],color:[ba],container:[te],"drop-shadow":[te],ease:["in","out","in-out"],font:[ja],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[te],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[te],shadow:[te],spacing:["px",U],text:[te],"text-shadow":[te],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",ce,v,j,f]}],container:["container"],columns:[{columns:[U,v,j,d]}],"break-after":[{"break-after":M()}],"break-before":[{"break-before":M()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:E()}],overflow:[{overflow:R()}],"overflow-x":[{"overflow-x":R()}],"overflow-y":[{"overflow-y":R()}],overscroll:[{overscroll:_()}],"overscroll-x":[{"overscroll-x":_()}],"overscroll-y":[{"overscroll-y":_()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:T()}],"inset-x":[{"inset-x":T()}],"inset-y":[{"inset-y":T()}],start:[{start:T()}],end:[{end:T()}],top:[{top:T()}],right:[{right:T()}],bottom:[{bottom:T()}],left:[{left:T()}],visibility:["visible","invisible","collapse"],z:[{z:[oe,"auto",j,v]}],basis:[{basis:[ce,"full","auto",d,...N()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[U,ce,"auto","initial","none",v]}],grow:[{grow:["",U,j,v]}],shrink:[{shrink:["",U,j,v]}],order:[{order:[oe,"first","last","none",j,v]}],"grid-cols":[{"grid-cols":se()}],"col-start-end":[{col:re()}],"col-start":[{"col-start":de()}],"col-end":[{"col-end":de()}],"grid-rows":[{"grid-rows":se()}],"row-start-end":[{row:re()}],"row-start":[{"row-start":de()}],"row-end":[{"row-end":de()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":Ee()}],"auto-rows":[{"auto-rows":Ee()}],gap:[{gap:N()}],"gap-x":[{"gap-x":N()}],"gap-y":[{"gap-y":N()}],"justify-content":[{justify:[...ve(),"normal"]}],"justify-items":[{"justify-items":[...ne(),"normal"]}],"justify-self":[{"justify-self":["auto",...ne()]}],"align-content":[{content:["normal",...ve()]}],"align-items":[{items:[...ne(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...ne(),{baseline:["","last"]}]}],"place-content":[{"place-content":ve()}],"place-items":[{"place-items":[...ne(),"baseline"]}],"place-self":[{"place-self":["auto",...ne()]}],p:[{p:N()}],px:[{px:N()}],py:[{py:N()}],ps:[{ps:N()}],pe:[{pe:N()}],pt:[{pt:N()}],pr:[{pr:N()}],pb:[{pb:N()}],pl:[{pl:N()}],m:[{m:H()}],mx:[{mx:H()}],my:[{my:H()}],ms:[{ms:H()}],me:[{me:H()}],mt:[{mt:H()}],mr:[{mr:H()}],mb:[{mb:H()}],ml:[{ml:H()}],"space-x":[{"space-x":N()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":N()}],"space-y-reverse":["space-y-reverse"],size:[{size:X()}],w:[{w:[d,"screen",...X()]}],"min-w":[{"min-w":[d,"screen","none",...X()]}],"max-w":[{"max-w":[d,"screen","none","prose",{screen:[i]},...X()]}],h:[{h:["screen","lh",...X()]}],"min-h":[{"min-h":["screen","lh","none",...X()]}],"max-h":[{"max-h":["screen","lh",...X()]}],"font-size":[{text:["base",t,Ae,le]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[s,j,Qe]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",Ze,v]}],"font-family":[{font:[Aa,v,a]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[n,j,v]}],"line-clamp":[{"line-clamp":[U,"none",j,Qe]}],leading:[{leading:[o,...N()]}],"list-image":[{"list-image":["none",j,v]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",j,v]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:C()}],"text-color":[{text:C()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...ie(),"wavy"]}],"text-decoration-thickness":[{decoration:[U,"from-font","auto",j,le]}],"text-decoration-color":[{decoration:C()}],"underline-offset":[{"underline-offset":[U,"auto",j,v]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:N()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",j,v]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",j,v]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:Re()}],"bg-repeat":[{bg:Ue()}],"bg-size":[{bg:A()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},oe,j,v],radial:["",j,v],conic:[oe,j,v]},Ca,Na]}],"bg-color":[{bg:C()}],"gradient-from-pos":[{from:O()}],"gradient-via-pos":[{via:O()}],"gradient-to-pos":[{to:O()}],"gradient-from":[{from:C()}],"gradient-via":[{via:C()}],"gradient-to":[{to:C()}],rounded:[{rounded:F()}],"rounded-s":[{"rounded-s":F()}],"rounded-e":[{"rounded-e":F()}],"rounded-t":[{"rounded-t":F()}],"rounded-r":[{"rounded-r":F()}],"rounded-b":[{"rounded-b":F()}],"rounded-l":[{"rounded-l":F()}],"rounded-ss":[{"rounded-ss":F()}],"rounded-se":[{"rounded-se":F()}],"rounded-ee":[{"rounded-ee":F()}],"rounded-es":[{"rounded-es":F()}],"rounded-tl":[{"rounded-tl":F()}],"rounded-tr":[{"rounded-tr":F()}],"rounded-br":[{"rounded-br":F()}],"rounded-bl":[{"rounded-bl":F()}],"border-w":[{border:$()}],"border-w-x":[{"border-x":$()}],"border-w-y":[{"border-y":$()}],"border-w-s":[{"border-s":$()}],"border-w-e":[{"border-e":$()}],"border-w-t":[{"border-t":$()}],"border-w-r":[{"border-r":$()}],"border-w-b":[{"border-b":$()}],"border-w-l":[{"border-l":$()}],"divide-x":[{"divide-x":$()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":$()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...ie(),"hidden","none"]}],"divide-style":[{divide:[...ie(),"hidden","none"]}],"border-color":[{border:C()}],"border-color-x":[{"border-x":C()}],"border-color-y":[{"border-y":C()}],"border-color-s":[{"border-s":C()}],"border-color-e":[{"border-e":C()}],"border-color-t":[{"border-t":C()}],"border-color-r":[{"border-r":C()}],"border-color-b":[{"border-b":C()}],"border-color-l":[{"border-l":C()}],"divide-color":[{divide:C()}],"outline-style":[{outline:[...ie(),"none","hidden"]}],"outline-offset":[{"outline-offset":[U,j,v]}],"outline-w":[{outline:["",U,Ae,le]}],"outline-color":[{outline:C()}],shadow:[{shadow:["","none",h,De,Pe]}],"shadow-color":[{shadow:C()}],"inset-shadow":[{"inset-shadow":["none",x,De,Pe]}],"inset-shadow-color":[{"inset-shadow":C()}],"ring-w":[{ring:$()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:C()}],"ring-offset-w":[{"ring-offset":[U,le]}],"ring-offset-color":[{"ring-offset":C()}],"inset-ring-w":[{"inset-ring":$()}],"inset-ring-color":[{"inset-ring":C()}],"text-shadow":[{"text-shadow":["none",S,De,Pe]}],"text-shadow-color":[{"text-shadow":C()}],opacity:[{opacity:[U,j,v]}],"mix-blend":[{"mix-blend":[...je(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":je()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[U]}],"mask-image-linear-from-pos":[{"mask-linear-from":P()}],"mask-image-linear-to-pos":[{"mask-linear-to":P()}],"mask-image-linear-from-color":[{"mask-linear-from":C()}],"mask-image-linear-to-color":[{"mask-linear-to":C()}],"mask-image-t-from-pos":[{"mask-t-from":P()}],"mask-image-t-to-pos":[{"mask-t-to":P()}],"mask-image-t-from-color":[{"mask-t-from":C()}],"mask-image-t-to-color":[{"mask-t-to":C()}],"mask-image-r-from-pos":[{"mask-r-from":P()}],"mask-image-r-to-pos":[{"mask-r-to":P()}],"mask-image-r-from-color":[{"mask-r-from":C()}],"mask-image-r-to-color":[{"mask-r-to":C()}],"mask-image-b-from-pos":[{"mask-b-from":P()}],"mask-image-b-to-pos":[{"mask-b-to":P()}],"mask-image-b-from-color":[{"mask-b-from":C()}],"mask-image-b-to-color":[{"mask-b-to":C()}],"mask-image-l-from-pos":[{"mask-l-from":P()}],"mask-image-l-to-pos":[{"mask-l-to":P()}],"mask-image-l-from-color":[{"mask-l-from":C()}],"mask-image-l-to-color":[{"mask-l-to":C()}],"mask-image-x-from-pos":[{"mask-x-from":P()}],"mask-image-x-to-pos":[{"mask-x-to":P()}],"mask-image-x-from-color":[{"mask-x-from":C()}],"mask-image-x-to-color":[{"mask-x-to":C()}],"mask-image-y-from-pos":[{"mask-y-from":P()}],"mask-image-y-to-pos":[{"mask-y-to":P()}],"mask-image-y-from-color":[{"mask-y-from":C()}],"mask-image-y-to-color":[{"mask-y-to":C()}],"mask-image-radial":[{"mask-radial":[j,v]}],"mask-image-radial-from-pos":[{"mask-radial-from":P()}],"mask-image-radial-to-pos":[{"mask-radial-to":P()}],"mask-image-radial-from-color":[{"mask-radial-from":C()}],"mask-image-radial-to-color":[{"mask-radial-to":C()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":w()}],"mask-image-conic-pos":[{"mask-conic":[U]}],"mask-image-conic-from-pos":[{"mask-conic-from":P()}],"mask-image-conic-to-pos":[{"mask-conic-to":P()}],"mask-image-conic-from-color":[{"mask-conic-from":C()}],"mask-image-conic-to-color":[{"mask-conic-to":C()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:Re()}],"mask-repeat":[{mask:Ue()}],"mask-size":[{mask:A()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",j,v]}],filter:[{filter:["","none",j,v]}],blur:[{blur:ke()}],brightness:[{brightness:[U,j,v]}],contrast:[{contrast:[U,j,v]}],"drop-shadow":[{"drop-shadow":["","none",k,De,Pe]}],"drop-shadow-color":[{"drop-shadow":C()}],grayscale:[{grayscale:["",U,j,v]}],"hue-rotate":[{"hue-rotate":[U,j,v]}],invert:[{invert:["",U,j,v]}],saturate:[{saturate:[U,j,v]}],sepia:[{sepia:["",U,j,v]}],"backdrop-filter":[{"backdrop-filter":["","none",j,v]}],"backdrop-blur":[{"backdrop-blur":ke()}],"backdrop-brightness":[{"backdrop-brightness":[U,j,v]}],"backdrop-contrast":[{"backdrop-contrast":[U,j,v]}],"backdrop-grayscale":[{"backdrop-grayscale":["",U,j,v]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[U,j,v]}],"backdrop-invert":[{"backdrop-invert":["",U,j,v]}],"backdrop-opacity":[{"backdrop-opacity":[U,j,v]}],"backdrop-saturate":[{"backdrop-saturate":[U,j,v]}],"backdrop-sepia":[{"backdrop-sepia":["",U,j,v]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":N()}],"border-spacing-x":[{"border-spacing-x":N()}],"border-spacing-y":[{"border-spacing-y":N()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",j,v]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[U,"initial",j,v]}],ease:[{ease:["linear","initial",g,j,v]}],delay:[{delay:[U,j,v]}],animate:[{animate:["none",u,j,v]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[b,j,v]}],"perspective-origin":[{"perspective-origin":E()}],rotate:[{rotate:Me()}],"rotate-x":[{"rotate-x":Me()}],"rotate-y":[{"rotate-y":Me()}],"rotate-z":[{"rotate-z":Me()}],scale:[{scale:Le()}],"scale-x":[{"scale-x":Le()}],"scale-y":[{"scale-y":Le()}],"scale-z":[{"scale-z":Le()}],"scale-3d":["scale-3d"],skew:[{skew:Je()}],"skew-x":[{"skew-x":Je()}],"skew-y":[{"skew-y":Je()}],transform:[{transform:[j,v,"","none","gpu","cpu"]}],"transform-origin":[{origin:E()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:Fe()}],"translate-x":[{"translate-x":Fe()}],"translate-y":[{"translate-y":Fe()}],"translate-z":[{"translate-z":Fe()}],"translate-none":["translate-none"],accent:[{accent:C()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:C()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",j,v]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":N()}],"scroll-mx":[{"scroll-mx":N()}],"scroll-my":[{"scroll-my":N()}],"scroll-ms":[{"scroll-ms":N()}],"scroll-me":[{"scroll-me":N()}],"scroll-mt":[{"scroll-mt":N()}],"scroll-mr":[{"scroll-mr":N()}],"scroll-mb":[{"scroll-mb":N()}],"scroll-ml":[{"scroll-ml":N()}],"scroll-p":[{"scroll-p":N()}],"scroll-px":[{"scroll-px":N()}],"scroll-py":[{"scroll-py":N()}],"scroll-ps":[{"scroll-ps":N()}],"scroll-pe":[{"scroll-pe":N()}],"scroll-pt":[{"scroll-pt":N()}],"scroll-pr":[{"scroll-pr":N()}],"scroll-pb":[{"scroll-pb":N()}],"scroll-pl":[{"scroll-pl":N()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",j,v]}],fill:[{fill:["none",...C()]}],"stroke-w":[{stroke:[U,Ae,le,Qe]}],stroke:[{stroke:["none",...C()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},Ua=ca(Ra);function L(...r){return Ua(_r(r))}const jr=[{id:"overview",label:"Overview",icon:ht},{id:"admins",label:"Admin Management",icon:K},{id:"section-admins",label:"Section Admins",icon:Se},{id:"analytics",label:"Analytics",icon:ue},{id:"logs",label:"System Logs",icon:ft},{id:"security",label:"Security Settings",icon:bt}];function Ma({activeTab:r,onTabChange:a,isCollapsed:t,onToggleCollapse:s,isMobile:n=!1,isOpen:o=!1,onClose:i}){return n?e.jsxs(e.Fragment,{children:[o&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-40 lg:hidden",onClick:i}),e.jsxs("div",{className:L("fixed inset-y-0 left-0 z-50 w-64 bg-white dark:bg-gray-900 border-r border-gray-200 dark:border-gray-800 transform transition-transform duration-300 lg:hidden",o?"translate-x-0":"-translate-x-full"),children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-800",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Super Admin"}),e.jsx("button",{onClick:i,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg",children:e.jsx(ge,{className:"w-5 h-5"})})]}),e.jsx("nav",{className:"p-4 space-y-2",children:jr.map(d=>{const l=d.icon,m=r===d.id;return e.jsxs("button",{onClick:()=>{a(d.id),i==null||i()},className:L("w-full flex items-center gap-3 px-3 py-2 rounded-lg transition-colors",m?"bg-blue-50 text-blue-600 dark:bg-blue-900/30 dark:text-blue-400":"text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800"),children:[e.jsx(l,{className:"w-5 h-5"}),e.jsx("span",{className:"font-medium",children:d.label})]},d.id)})})]})]}):e.jsxs("div",{className:L("hidden lg:flex flex-col bg-white dark:bg-gray-900 border-r border-gray-200 dark:border-gray-800 transition-all duration-300",t?"w-20":"w-64"),children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-800",children:[!t&&e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Super Admin"}),e.jsx("button",{onClick:s,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg ml-auto",children:t?e.jsx(gt,{className:"w-5 h-5"}):e.jsx(ut,{className:"w-5 h-5"})})]}),e.jsx("nav",{className:"flex-1 p-4 space-y-2",children:jr.map(d=>{const l=d.icon,m=r===d.id;return e.jsxs("button",{onClick:()=>a(d.id),className:L("w-full flex items-center gap-3 px-3 py-2 rounded-lg transition-colors",m?"bg-blue-50 text-blue-600 dark:bg-blue-900/30 dark:text-blue-400":"text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800",t&&"justify-center"),title:t?d.label:void 0,children:[e.jsx(l,{className:"w-5 h-5 flex-shrink-0"}),!t&&e.jsx("span",{className:"font-medium",children:d.label})]},d.id)})})]})}const B=c.forwardRef(({className:r,...a},t)=>e.jsx("div",{ref:t,className:L("rounded-xl border border-gray-200 bg-white text-gray-950 shadow-sm dark:border-gray-800 dark:bg-gray-900 dark:text-gray-50",r),...a}));B.displayName="Card";const Y=c.forwardRef(({className:r,...a},t)=>e.jsx("div",{ref:t,className:L("flex flex-col space-y-1.5 p-6",r),...a}));Y.displayName="CardHeader";const J=c.forwardRef(({className:r,...a},t)=>e.jsx("h3",{ref:t,className:L("font-semibold leading-none tracking-tight",r),...a}));J.displayName="CardTitle";const Z=c.forwardRef(({className:r,...a},t)=>e.jsx("p",{ref:t,className:L("text-sm text-gray-500 dark:text-gray-400",r),...a}));Z.displayName="CardDescription";const Q=c.forwardRef(({className:r,...a},t)=>e.jsx("div",{ref:t,className:L("p-6 pt-0",r),...a}));Q.displayName="CardContent";const La=c.forwardRef(({className:r,...a},t)=>e.jsx("div",{ref:t,className:L("flex items-center p-6 pt-0",r),...a}));La.displayName="CardFooter";const kr=r=>typeof r=="boolean"?`${r}`:r===0?"0":r,Nr=_r,nr=(r,a)=>t=>{var s;if((a==null?void 0:a.variants)==null)return Nr(r,t==null?void 0:t.class,t==null?void 0:t.className);const{variants:n,defaultVariants:o}=a,i=Object.keys(n).map(m=>{const h=t==null?void 0:t[m],x=o==null?void 0:o[m];if(h===null)return null;const S=kr(h)||kr(x);return n[m][S]}),d=t&&Object.entries(t).reduce((m,h)=>{let[x,S]=h;return S===void 0||(m[x]=S),m},{}),l=a==null||(s=a.compoundVariants)===null||s===void 0?void 0:s.reduce((m,h)=>{let{class:x,className:S,...k}=h;return Object.entries(k).every(p=>{let[b,f]=p;return Array.isArray(f)?f.includes({...o,...d}[b]):{...o,...d}[b]===f})?[...m,x,S]:m},[]);return Nr(r,i,l,t==null?void 0:t.class,t==null?void 0:t.className)},Fa=nr("inline-flex items-center rounded-md border border-gray-200 px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-gray-950 focus:ring-offset-2 dark:border-gray-800 dark:focus:ring-gray-300",{variants:{variant:{default:"border-transparent bg-gray-900 text-gray-50 shadow hover:bg-gray-900/80 dark:bg-gray-50 dark:text-gray-900 dark:hover:bg-gray-50/80",secondary:"border-transparent bg-gray-100 text-gray-900 hover:bg-gray-100/80 dark:bg-gray-800 dark:text-gray-50 dark:hover:bg-gray-800/80",destructive:"border-transparent bg-red-500 text-gray-50 shadow hover:bg-red-500/80 dark:bg-red-900 dark:text-gray-50 dark:hover:bg-red-900/80",outline:"text-gray-950 dark:text-gray-50",success:"border-transparent bg-green-500 text-white shadow hover:bg-green-600 dark:bg-green-600 dark:hover:bg-green-700",warning:"border-transparent bg-yellow-500 text-white shadow hover:bg-yellow-600 dark:bg-yellow-600 dark:hover:bg-yellow-700",info:"border-transparent bg-blue-500 text-white shadow hover:bg-blue-600 dark:bg-blue-600 dark:hover:bg-blue-700"}},defaultVariants:{variant:"default"}});function I({className:r,variant:a,...t}){return e.jsx("div",{className:L(Fa({variant:a}),r),...t})}function Ar(){const[r,a]=c.useState(null),[t,s]=c.useState([]),[n,o]=c.useState(!0);c.useEffect(()=>{i()},[]);const i=async()=>{try{o(!0);const{data:l,error:m}=await y.rpc("get_dashboard_stats",{});if(m){const[x,S,k,p,b,f,g,u]=await Promise.all([y.from("users").select("*",{count:"exact",head:!0}),y.from("users").select("*",{count:"exact",head:!0}).eq("role","admin"),y.from("users").select("*",{count:"exact",head:!0}).eq("role","section_admin"),y.from("tasks").select("*",{count:"exact",head:!0}),y.from("tasks").select("*",{count:"exact",head:!0}).eq("status","completed"),y.from("departments").select("*",{count:"exact",head:!0}),y.from("batches").select("*",{count:"exact",head:!0}),y.from("sections").select("*",{count:"exact",head:!0})]);a({total_users:x.count||0,total_admins:S.count||0,total_section_admins:k.count||0,total_tasks:p.count||0,completed_tasks:b.count||0,total_departments:f.count||0,total_batches:g.count||0,total_sections:u.count||0})}else a(l);const{data:h}=await y.from("activities").select(`
          id,
          type,
          title,
          metadata,
          created_at,
          user:users(name, email)
        `).order("created_at",{ascending:!1}).limit(10);h&&s(h.map(x=>({...x,user:Array.isArray(x.user)?x.user[0]:x.user})))}catch(l){console.error("Error fetching dashboard data:",l)}finally{o(!1)}},d=r?[{title:"Total Users",value:r.total_users,change:"+12%",icon:Se,color:"text-blue-600",bgColor:"bg-blue-50 dark:bg-blue-900/20"},{title:"Admins",value:r.total_admins,change:"+3%",icon:K,color:"text-purple-600",bgColor:"bg-purple-50 dark:bg-purple-900/20"},{title:"Section Admins",value:r.total_section_admins,change:"+8%",icon:Se,color:"text-green-600",bgColor:"bg-green-50 dark:bg-green-900/20"},{title:"Total Tasks",value:r.total_tasks,change:"+24%",icon:Ke,color:"text-orange-600",bgColor:"bg-orange-50 dark:bg-orange-900/20"},{title:"Completed Tasks",value:r.completed_tasks,change:`${r.total_tasks>0?Math.round(r.completed_tasks/r.total_tasks*100):0}%`,icon:Ke,color:"text-emerald-600",bgColor:"bg-emerald-50 dark:bg-emerald-900/20"},{title:"Departments",value:r.total_departments,change:"",icon:ur,color:"text-indigo-600",bgColor:"bg-indigo-50 dark:bg-indigo-900/20"},{title:"Batches",value:r.total_batches,change:"",icon:hr,color:"text-pink-600",bgColor:"bg-pink-50 dark:bg-pink-900/20"},{title:"Sections",value:r.total_sections,change:"",icon:hr,color:"text-teal-600",bgColor:"bg-teal-50 dark:bg-teal-900/20"}]:[];return n?e.jsx("div",{className:"space-y-6 animate-pulse",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[1,2,3,4].map(l=>e.jsx("div",{className:"h-32 bg-gray-200 dark:bg-gray-800 rounded-xl"},l))})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:d.map((l,m)=>{var x;const h=l.icon;return e.jsxs(B,{className:"hover:shadow-lg transition-shadow",children:[e.jsxs(Y,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(J,{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:l.title}),e.jsx("div",{className:`p-2 rounded-lg ${l.bgColor}`,children:e.jsx(h,{className:`w-5 h-5 ${l.color}`})})]}),e.jsxs(Q,{children:[e.jsx("div",{className:"text-2xl font-bold",children:Number((x=l.value)!=null?x:0).toLocaleString()}),l.change&&e.jsxs("p",{className:"text-xs text-green-600 dark:text-green-400 flex items-center gap-1 mt-1",children:[e.jsx(Et,{className:"w-3 h-3"}),l.change," from last month"]})]})]},m)})}),e.jsxs(B,{children:[e.jsxs(Y,{children:[e.jsxs(J,{className:"flex items-center gap-2",children:[e.jsx(ue,{className:"w-5 h-5"}),"Recent Activity"]}),e.jsx(Z,{children:"Latest system activities and updates"})]}),e.jsx(Q,{children:t.length===0?e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 text-center py-8",children:"No recent activities to display"}):e.jsx("div",{className:"space-y-4",children:t.map(l=>e.jsxs("div",{className:"flex items-start justify-between p-3 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 rounded-full bg-blue-50 dark:bg-blue-900/20",children:e.jsx(ue,{className:"w-4 h-4 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:l.title}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:l.user&&typeof l.user=="object"&&!Array.isArray(l.user)?l.user.name||l.user.email:"System"})]})]}),e.jsxs("div",{className:"flex flex-col items-end gap-1",children:[e.jsx(I,{variant:"secondary",className:"text-xs",children:l.type}),e.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:new Date(l.created_at).toLocaleDateString()})]})]},l.id))})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs(B,{children:[e.jsxs(Y,{children:[e.jsxs(J,{className:"flex items-center gap-2",children:[e.jsx(ur,{className:"w-5 h-5"}),"Organization Structure"]}),e.jsx(Z,{children:"Hierarchical breakdown"})]}),e.jsx(Q,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsx("span",{className:"text-sm font-medium",children:"Departments"}),e.jsx(I,{variant:"info",children:(r==null?void 0:r.total_departments)||0})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsx("span",{className:"text-sm font-medium",children:"Batches"}),e.jsx(I,{variant:"info",children:(r==null?void 0:r.total_batches)||0})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsx("span",{className:"text-sm font-medium",children:"Sections"}),e.jsx(I,{variant:"info",children:(r==null?void 0:r.total_sections)||0})]})]})})]}),e.jsxs(B,{children:[e.jsxs(Y,{children:[e.jsxs(J,{className:"flex items-center gap-2",children:[e.jsx(Ke,{className:"w-5 h-5"}),"Task Overview"]}),e.jsx(Z,{children:"Current task statistics"})]}),e.jsx(Q,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsx("span",{className:"text-sm font-medium",children:"Total Tasks"}),e.jsx(I,{variant:"info",children:(r==null?void 0:r.total_tasks)||0})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsx("span",{className:"text-sm font-medium",children:"Completed"}),e.jsx(I,{variant:"success",children:(r==null?void 0:r.completed_tasks)||0})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsx("span",{className:"text-sm font-medium",children:"Pending"}),e.jsx(I,{variant:"warning",children:((r==null?void 0:r.total_tasks)||0)-((r==null?void 0:r.completed_tasks)||0)})]})]})})]})]})]})}function Sr(r,a){if(typeof r=="function")return r(a);r!=null&&(r.current=a)}function Ta(...r){return a=>{let t=!1;const s=r.map(n=>{const o=Sr(n,a);return!t&&typeof o=="function"&&(t=!0),o});if(t)return()=>{for(let n=0;n<s.length;n++){const o=s[n];typeof o=="function"?o():Sr(r[n],null)}}}}var Pa=Symbol.for("react.lazy"),Oe=dt[" use ".trim().toString()];function Da(r){return typeof r=="object"&&r!==null&&"then"in r}function Jr(r){return r!=null&&typeof r=="object"&&"$$typeof"in r&&r.$$typeof===Pa&&"_payload"in r&&Da(r._payload)}function or(r){const a=$a(r),t=c.forwardRef((s,n)=>{let{children:o,...i}=s;Jr(o)&&typeof Oe=="function"&&(o=Oe(o._payload));const d=c.Children.toArray(o),l=d.find(Oa);if(l){const m=l.props.children,h=d.map(x=>x===l?c.Children.count(m)>1?c.Children.only(null):c.isValidElement(m)?m.props.children:null:x);return e.jsx(a,{...i,ref:n,children:c.isValidElement(m)?c.cloneElement(m,void 0,h):null})}return e.jsx(a,{...i,ref:n,children:o})});return t.displayName=`${r}.Slot`,t}var za=or("Slot");function $a(r){const a=c.forwardRef((t,s)=>{let{children:n,...o}=t;if(Jr(n)&&typeof Oe=="function"&&(n=Oe(n._payload)),c.isValidElement(n)){const i=Va(n),d=Ba(o,n.props);return n.type!==c.Fragment&&(d.ref=s?Ta(s,i):i),c.cloneElement(n,d)}return c.Children.count(n)>1?c.Children.only(null):null});return a.displayName=`${r}.SlotClone`,a}var Ia=Symbol("radix.slottable");function Oa(r){return c.isValidElement(r)&&typeof r.type=="function"&&"__radixId"in r.type&&r.type.__radixId===Ia}function Ba(r,a){const t={...a};for(const s in a){const n=r[s],o=a[s];/^on[A-Z]/.test(s)?n&&o?t[s]=(...d)=>{const l=o(...d);return n(...d),l}:n&&(t[s]=n):s==="style"?t[s]={...n,...o}:s==="className"&&(t[s]=[n,o].filter(Boolean).join(" "))}return{...r,...t}}function Va(r){var s,n;let a=(s=Object.getOwnPropertyDescriptor(r.props,"ref"))==null?void 0:s.get,t=a&&"isReactWarning"in a&&a.isReactWarning;return t?r.ref:(a=(n=Object.getOwnPropertyDescriptor(r,"ref"))==null?void 0:n.get,t=a&&"isReactWarning"in a&&a.isReactWarning,t?r.props.ref:r.props.ref||r.ref)}const qa=nr("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-gray-950 disabled:pointer-events-none disabled:opacity-50 dark:focus-visible:ring-gray-300",{variants:{variant:{default:"bg-gray-900 text-gray-50 shadow hover:bg-gray-900/90 dark:bg-gray-50 dark:text-gray-900 dark:hover:bg-gray-50/90",destructive:"bg-red-500 text-gray-50 shadow-sm hover:bg-red-500/90 dark:bg-red-900 dark:text-gray-50 dark:hover:bg-red-900/90",outline:"border border-gray-200 bg-white shadow-sm hover:bg-gray-100 hover:text-gray-900 dark:border-gray-800 dark:bg-gray-950 dark:hover:bg-gray-800 dark:hover:text-gray-50",secondary:"bg-gray-100 text-gray-900 shadow-sm hover:bg-gray-100/80 dark:bg-gray-800 dark:text-gray-50 dark:hover:bg-gray-800/80",ghost:"hover:bg-gray-100 hover:text-gray-900 dark:hover:bg-gray-800 dark:hover:text-gray-50",link:"text-gray-900 underline-offset-4 hover:underline dark:text-gray-50"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),D=c.forwardRef(({className:r,variant:a,size:t,asChild:s=!1,...n},o)=>{const i=s?za:"button";return e.jsx(i,{className:L(qa({variant:a,size:t,className:r})),ref:o,...n})});D.displayName="Button";const ae=c.forwardRef(({className:r,type:a,...t},s)=>e.jsx("input",{type:a,className:L("flex h-9 w-full rounded-md border border-gray-200 bg-white px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-gray-500 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-gray-950 disabled:cursor-not-allowed disabled:opacity-50 dark:border-gray-800 dark:bg-gray-950 dark:placeholder:text-gray-400 dark:focus-visible:ring-gray-300",r),ref:s,...t}));ae.displayName="Input";const ir=c.forwardRef(({className:r,...a},t)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:t,className:L("w-full caption-bottom text-sm",r),...a})}));ir.displayName="Table";const lr=c.forwardRef(({className:r,...a},t)=>e.jsx("thead",{ref:t,className:L("[&_tr]:border-b",r),...a}));lr.displayName="TableHeader";const dr=c.forwardRef(({className:r,...a},t)=>e.jsx("tbody",{ref:t,className:L("[&_tr:last-child]:border-0",r),...a}));dr.displayName="TableBody";const Ga=c.forwardRef(({className:r,...a},t)=>e.jsx("tfoot",{ref:t,className:L("border-t bg-gray-100/50 font-medium [&>tr]:last:border-b-0 dark:bg-gray-800/50",r),...a}));Ga.displayName="TableFooter";const Ce=c.forwardRef(({className:r,...a},t)=>e.jsx("tr",{ref:t,className:L("border-b transition-colors hover:bg-gray-100/50 data-[state=selected]:bg-gray-100 dark:hover:bg-gray-800/50 dark:data-[state=selected]:bg-gray-800",r),...a}));Ce.displayName="TableRow";const q=c.forwardRef(({className:r,...a},t)=>e.jsx("th",{ref:t,className:L("h-10 px-2 text-left align-middle font-medium text-gray-500 [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px] dark:text-gray-400",r),...a}));q.displayName="TableHead";const G=c.forwardRef(({className:r,...a},t)=>e.jsx("td",{ref:t,className:L("p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",r),...a}));G.displayName="TableCell";const Wa=c.forwardRef(({className:r,...a},t)=>e.jsx("caption",{ref:t,className:L("mt-4 text-sm text-gray-500 dark:text-gray-400",r),...a}));Wa.displayName="TableCaption";function Ha(r,a=[]){let t=[];function s(o,i){const d=c.createContext(i);d.displayName=o+"Context";const l=t.length;t=[...t,i];const m=x=>{var g;const{scope:S,children:k,...p}=x,b=((g=S==null?void 0:S[r])==null?void 0:g[l])||d,f=c.useMemo(()=>p,Object.values(p));return e.jsx(b.Provider,{value:f,children:k})};m.displayName=o+"Provider";function h(x,S){var b;const k=((b=S==null?void 0:S[r])==null?void 0:b[l])||d,p=c.useContext(k);if(p)return p;if(i!==void 0)return i;throw new Error(`\`${x}\` must be used within \`${o}\``)}return[m,h]}const n=()=>{const o=t.map(i=>c.createContext(i));return function(d){const l=(d==null?void 0:d[r])||o;return c.useMemo(()=>({[`__scope${r}`]:{...d,[r]:l}}),[d,l])}};return n.scopeName=r,[s,Ya(n,...a)]}function Ya(...r){const a=r[0];if(r.length===1)return a;const t=()=>{const s=r.map(n=>({useScope:n(),scopeName:n.scopeName}));return function(o){const i=s.reduce((d,{useScope:l,scopeName:m})=>{const x=l(o)[`__scope${m}`];return{...d,...x}},{});return c.useMemo(()=>({[`__scope${a.scopeName}`]:i}),[i])}};return t.scopeName=a.scopeName,t}function Ja(r){const a=c.useRef(r);return c.useEffect(()=>{a.current=r}),c.useMemo(()=>(...t)=>{var s;return(s=a.current)==null?void 0:s.call(a,...t)},[])}var tr=globalThis!=null&&globalThis.document?c.useLayoutEffect:()=>{},Ka=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],cr=Ka.reduce((r,a)=>{const t=or(`Primitive.${a}`),s=c.forwardRef((n,o)=>{const{asChild:i,...d}=n,l=i?t:a;return typeof window!="undefined"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(l,{...d,ref:o})});return s.displayName=`Primitive.${a}`,{...r,[a]:s}},{}),Kr={exports:{}},Xr={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pe=c;function Xa(r,a){return r===a&&(r!==0||1/r===1/a)||r!==r&&a!==a}var Za=typeof Object.is=="function"?Object.is:Xa,Qa=pe.useState,es=pe.useEffect,rs=pe.useLayoutEffect,ts=pe.useDebugValue;function as(r,a){var t=a(),s=Qa({inst:{value:t,getSnapshot:a}}),n=s[0].inst,o=s[1];return rs(function(){n.value=t,n.getSnapshot=a,er(n)&&o({inst:n})},[r,t,a]),es(function(){return er(n)&&o({inst:n}),r(function(){er(n)&&o({inst:n})})},[r]),ts(t),t}function er(r){var a=r.getSnapshot;r=r.value;try{var t=a();return!Za(r,t)}catch(s){return!0}}function ss(r,a){return a()}var ns=typeof window=="undefined"||typeof window.document=="undefined"||typeof window.document.createElement=="undefined"?ss:as;Xr.useSyncExternalStore=pe.useSyncExternalStore!==void 0?pe.useSyncExternalStore:ns;Kr.exports=Xr;var os=Kr.exports;function is(){return os.useSyncExternalStore(ls,()=>!0,()=>!1)}function ls(){return()=>{}}var mr="Avatar",[ds,$n]=Ha(mr),[cs,Zr]=ds(mr),Qr=c.forwardRef((r,a)=>{const{__scopeAvatar:t,...s}=r,[n,o]=c.useState("idle");return e.jsx(cs,{scope:t,imageLoadingStatus:n,onImageLoadingStatusChange:o,children:e.jsx(cr.span,{...s,ref:a})})});Qr.displayName=mr;var et="AvatarImage",rt=c.forwardRef((r,a)=>{const{__scopeAvatar:t,src:s,onLoadingStatusChange:n=()=>{},...o}=r,i=Zr(et,t),d=ms(s,o),l=Ja(m=>{n(m),i.onImageLoadingStatusChange(m)});return tr(()=>{d!=="idle"&&l(d)},[d,l]),d==="loaded"?e.jsx(cr.img,{...o,ref:a,src:s}):null});rt.displayName=et;var tt="AvatarFallback",at=c.forwardRef((r,a)=>{const{__scopeAvatar:t,delayMs:s,...n}=r,o=Zr(tt,t),[i,d]=c.useState(s===void 0);return c.useEffect(()=>{if(s!==void 0){const l=window.setTimeout(()=>d(!0),s);return()=>window.clearTimeout(l)}},[s]),i&&o.imageLoadingStatus!=="loaded"?e.jsx(cr.span,{...n,ref:a}):null});at.displayName=tt;function Cr(r,a){return r?a?(r.src!==a&&(r.src=a),r.complete&&r.naturalWidth>0?"loaded":"loading"):"error":"idle"}function ms(r,{referrerPolicy:a,crossOrigin:t}){const s=is(),n=c.useRef(null),o=s?(n.current||(n.current=new window.Image),n.current):null,[i,d]=c.useState(()=>Cr(o,r));return tr(()=>{d(Cr(o,r))},[o,r]),tr(()=>{const l=x=>()=>{d(x)};if(!o)return;const m=l("loaded"),h=l("error");return o.addEventListener("load",m),o.addEventListener("error",h),a&&(o.referrerPolicy=a),typeof t=="string"&&(o.crossOrigin=t),()=>{o.removeEventListener("load",m),o.removeEventListener("error",h)}},[o,t,a]),i}var st=Qr,nt=rt,ot=at;const ye=c.forwardRef(({className:r,...a},t)=>e.jsx(st,{ref:t,className:L("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",r),...a}));ye.displayName=st.displayName;const gs=c.forwardRef(({className:r,...a},t)=>e.jsx(nt,{ref:t,className:L("aspect-square h-full w-full",r),...a}));gs.displayName=nt.displayName;const we=c.forwardRef(({className:r,...a},t)=>e.jsx(ot,{ref:t,className:L("flex h-full w-full items-center justify-center rounded-full bg-gray-100 dark:bg-gray-800",r),...a}));we.displayName=ot.displayName;async function us(){var r;try{console.log("Fetching admin users...");const{data:{user:a}}=await y.auth.getUser();console.log("Current user:",a),console.log("User metadata:",a==null?void 0:a.user_metadata),console.log("User role:",(r=a==null?void 0:a.user_metadata)==null?void 0:r.role);const{data:t,error:s}=await y.from("users").select("id, email, name, role, phone, student_id, last_active, created_at, department_id, batch_id, section_id").order("created_at",{ascending:!1});if(s)throw console.error("Error fetching admin users:",s),new Error(s.message||"Failed to fetch admin users");console.log("User data from database:",t),console.log("Number of users retrieved:",(t==null?void 0:t.length)||0);const{data:n}=await y.from("departments").select("id, name"),{data:o}=await y.from("batches").select("id, name"),{data:i}=await y.from("sections").select("id, name"),d=new Map((n==null?void 0:n.map(x=>[x.id,x.name]))||[]),l=new Map((o==null?void 0:o.map(x=>[x.id,x.name]))||[]),m=new Map((i==null?void 0:i.map(x=>[x.id,x.name]))||[]),h=(t==null?void 0:t.map(x=>({id:x.id,username:x.name||"",email:x.email||"",role:x.role||"user",department:d.get(x.department_id)||"",departmentId:x.department_id,batch:l.get(x.batch_id)||"",batchId:x.batch_id,section:m.get(x.section_id)||"",sectionId:x.section_id,permissions:[],status:"active",isActive:!0,lastLogin:x.last_active,createdAt:x.created_at,phone:x.phone||"",studentId:x.student_id||""})))||[];return console.log("Mapped admin users:",h),console.log("Number of mapped users:",h.length),h}catch(a){throw console.error("Error fetching admin users:",a),new Error(a.message||"Failed to fetch admin users")}}async function hs(r,a){try{const{data:{user:t}}=await y.auth.getUser();console.log("Current user in createAdminUser:",t),console.log("User metadata:",t==null?void 0:t.user_metadata);const{data:s,error:n}=await y.auth.admin.createUser({email:r.email,password:a,email_confirm:!0,user_metadata:{name:r.username,role:r.role,department:r.department||null}});if(n||!s.user)throw console.error("Error creating auth user:",n),new Error((n==null?void 0:n.message)||"Failed to create admin user");const{data:o,error:i}=await y.from("users").update({permissions:r.permissions,status:r.status,department:r.department}).eq("id",s.user.id).select();if(i)throw console.error("Error updating admin user data:",i),new Error(i.message||"Failed to create admin user");return t?await _e(t.id,"create_admin",`Created admin user: ${r.email}`):console.log("Skipping log admin action - no user available"),{id:s.user.id,username:r.username,email:r.email,role:r.role,department:r.department,permissions:r.permissions,status:r.status,isActive:r.status==="active",createdAt:new Date().toISOString(),phone:r.phone,studentId:r.studentId}}catch(t){throw console.error("Error creating admin user:",t),new Error(t.message||"Failed to create admin user")}}async function xs(r,a){try{const{data:{user:t}}=await y.auth.getUser();if(console.log("Current user in updateAdminUser:",t),console.log("User metadata:",t==null?void 0:t.user_metadata),a.email||a.role||a.username){const{error:d}=await y.auth.admin.updateUserById(r,{email:a.email,user_metadata:{name:a.username,role:a.role,department:a.department}});if(d)throw console.error("Error updating auth user:",d),new Error(d.message||"Failed to update admin user")}const s={};a.permissions&&(s.permissions=a.permissions),a.status&&(s.status=a.status),a.department&&(s.department=a.department);const{data:n,error:o}=await y.from("users").update(s).eq("id",r).select();if(o)throw console.error("Error updating admin user data:",o),new Error(o.message||"Failed to update admin user");t?await _e(t.id,"update_admin",`Updated admin user: ${r}`):console.log("Skipping log admin action - no user available");const i=n==null?void 0:n[0];return{id:i.id,username:i.name||"",email:i.email||"",role:i.role||"admin",department:i.department,permissions:i.permissions||[],status:i.status||"active",isActive:i.status==="active",lastLogin:i.last_active,createdAt:i.created_at,updatedAt:i.updated_at,phone:i.phone||"",studentId:i.student_id||""}}catch(t){throw console.error("Error updating admin user:",t),new Error(t.message||"Failed to update admin user")}}async function ps(r,a){try{const{data:{user:t}}=await y.auth.getUser();console.log("Current user in resetAdminPassword:",t),console.log("User metadata:",t==null?void 0:t.user_metadata);const{error:s}=await y.auth.admin.updateUserById(r,{password:a});if(s)throw console.error("Error resetting admin password:",s),new Error(s.message||"Failed to reset admin password");try{t?await _e(t.id,"reset_password",`Reset password for admin: ${r}`):console.log("Skipping log admin action - no user available")}catch(n){console.error("Error logging password reset action:",n)}return!0}catch(t){throw console.error("Error resetting admin password:",t),new Error(t.message||"Failed to reset admin password")}}async function fs(r){try{const{data:{user:a}}=await y.auth.getUser();console.log("Current user in deleteAdminUser:",a),console.log("User metadata:",a==null?void 0:a.user_metadata);const{data:t,error:s}=await y.from("users").select("*").eq("id",r).single();if(s)throw console.error("Error fetching admin data for archiving:",s),new Error(s.message||"Failed to delete admin user");try{const{error:o}=await y.from("admin_archives").insert([{admin_id:r,admin_data:t,archived_by:(a==null?void 0:a.id)||"system",archived_at:new Date().toISOString()}]);o&&console.warn("Error archiving admin data (table might not exist):",o)}catch(o){console.warn("Failed to archive admin, table might not exist:",o)}const{error:n}=await y.auth.admin.deleteUser(r);if(n)throw console.error("Error deleting admin user:",n),new Error(n.message||"Failed to delete admin user");a?await _e(a.id,"delete_admin",`Deleted admin user: ${r}`):console.log("Skipping log admin action - no user available")}catch(a){throw console.error("Error deleting admin user:",a),new Error(a.message||"Failed to delete admin user")}}async function _e(r,a,t,s,n){try{const{data:o,error:i}=await y.from("users").select("name").eq("id",r).single();if(i){console.error("Error fetching admin name for logging:",i);return}const{error:d}=await y.from("admin_logs").insert([{admin_id:r,admin_name:(o==null?void 0:o.name)||"Unknown",action:a,details:t,timestamp:new Date().toISOString(),resource:s,resource_id:n}]);d&&console.error("Error logging admin action:",d)}catch(o){console.error("Error logging admin action:",o)}}async function bs(r){var a,t;try{const{data:{user:s}}=await y.auth.getUser();console.log("Current user in promoteUserToAdmin:",s),console.log("User metadata:",s==null?void 0:s.user_metadata),console.log("User role from metadata:",(a=s==null?void 0:s.user_metadata)==null?void 0:a.role);let n=((t=s==null?void 0:s.user_metadata)==null?void 0:t.role)==="super-admin";if(!n){const{data:i,error:d}=await y.from("users").select("role").eq("id",s==null?void 0:s.id).single();!d&&i&&(console.log("User role from database:",i.role),n=i.role==="super-admin")}if(!n)throw console.error("User is not a super-admin:",s==null?void 0:s.id),new Error("Unauthorized: Only super admins can promote users to admin");const{error:o}=await y.from("users").update({role:"admin"}).eq("id",r);if(o)throw console.error("Error updating user role in database:",o),new Error(o.message||"Failed to promote user to admin");console.log("Successfully updated user role in database"),s?await _e(s.id,"promote_to_admin",`Promoted user ${r} to admin role`):console.warn("Could not log admin action - user is null"),console.log("Successfully promoted user to admin role - user will need to log out and log back in for changes to take effect")}catch(s){throw console.error("Error promoting user to admin:",s),new Error(s.message||"Failed to promote user to admin")}}async function ys(r){try{console.log("Promoting user to section admin via database function:",r);const{data:a,error:t}=await y.rpc("promote_user_to_section_admin",{input_user_id:r});if(t)throw console.error("Error updating user role in database:",t),new Error(t.message||"Failed to promote user to section admin");console.log("Successfully updated user role to section_admin:",a)}catch(a){throw console.error("Error promoting user to section admin:",a),new Error(a.message||"Failed to promote user to section admin")}}async function ws(r){try{console.log("Demoting user via database function:",r);const{data:a,error:t}=await y.rpc("demote_user_to_regular",{user_id:r});if(t)throw console.error("Error updating user role in database:",t),new Error(t.message||"Failed to demote user");console.log("Successfully demoted user:",a)}catch(a){throw console.error("Error demoting user:",a),new Error(a.message||"Failed to demote user")}}async function vs(r){try{console.log("------- FETCH SECTION USERS SERVICE -------"),console.log("Fetching section users for section ID:",r);const{data:{user:a}}=await y.auth.getUser();if(console.log("Current user:",a==null?void 0:a.id,a==null?void 0:a.email),!r)throw console.error("No section ID provided"),new Error("No section ID provided");const{data:t,error:s}=await y.from("sections").select("id, name, batch_id").eq("id",r).single();s?(console.error("Error fetching section:",s),console.log("Section may not exist with ID:",r)):console.log("Found section:",t),console.log("Running query to fetch users with section_id =",r);const{data:n,error:o}=await y.from("users").select("id, email, name, role, phone, student_id, last_active, created_at, department_id, batch_id, section_id").eq("section_id",r).order("created_at",{ascending:!1});if(o)throw console.error("Error fetching section users:",o),new Error(o.message||"Failed to fetch section users");console.log("Raw section user data from database:",n),console.log("Number of section users retrieved:",(n==null?void 0:n.length)||0);const{data:i}=await y.from("departments").select("id, name"),{data:d}=await y.from("batches").select("id, name"),{data:l}=await y.from("sections").select("id, name");console.log("Departments:",i),console.log("Batches:",d),console.log("Sections:",l);const m=new Map((i==null?void 0:i.map(k=>[k.id,k.name]))||[]),h=new Map((d==null?void 0:d.map(k=>[k.id,k.name]))||[]),x=new Map((l==null?void 0:l.map(k=>[k.id,k.name]))||[]),S=(n==null?void 0:n.map(k=>({id:k.id,username:k.name||"",email:k.email||"",role:k.role||"user",department:m.get(k.department_id)||"",departmentId:k.department_id,batch:h.get(k.batch_id)||"",batchId:k.batch_id,section:x.get(k.section_id)||"",sectionId:k.section_id,permissions:[],status:"active",isActive:!0,lastLogin:k.last_active,createdAt:k.created_at,phone:k.phone||"",studentId:k.student_id||""})))||[];if(console.log("Mapped section users:",S),S.length===0){console.log("No users found for section ID:",r);const{data:k,error:p}=await y.from("users").select("id, email, section_id").not("section_id","is",null).limit(5);p?console.error("Error checking for any users with sections:",p):(console.log("Users with any section assignment:",k),k.length===0&&console.log("No users have any section assignment in the database"))}return S}catch(a){throw console.error("Error fetching section users:",a),new Error(a.message||"Failed to fetch section users")}}async function js(r,a){try{let t=y.from("sections").select("id, name, batch_id");r&&(t=t.eq("batch_id",r));const{data:s,error:n}=await t.order("name");if(n)throw console.error("Error fetching sections:",n),new Error(n.message||"Failed to fetch sections");if(a&&!r){const{data:o,error:i}=await y.from("batches").select("id").eq("department_id",a);if(i)throw console.error("Error fetching batches:",i),new Error(i.message||"Failed to fetch batches");const d=o.map(l=>l.id);return s.filter(l=>d.includes(l.batch_id))}return s||[]}catch(t){throw console.error("Error fetching sections:",t),new Error(t.message||"Failed to fetch sections")}}function Be(){const[r,a]=c.useState([]),[t,s]=c.useState(!0),[n,o]=c.useState(null),i=c.useCallback(async()=>{s(!0),o(null);try{const f=await us();a(f)}catch(f){console.error("Error fetching admin users:",f),o(f.message||"Failed to fetch admin users")}finally{s(!1)}},[]);return c.useEffect(()=>{i()},[i]),{admins:r,loading:t,error:n,createAdmin:async f=>{s(!0),o(null);try{const g=Math.random().toString(36).slice(-8)+Math.random().toString(36).slice(-8).toUpperCase()+"!1",u=await hs(f,g);return await i(),u}catch(g){throw console.error("Error creating admin user:",g),o(g.message||"Failed to create admin user"),g}finally{s(!1)}},updateAdmin:async(f,g)=>{s(!0),o(null);try{await xs(f,g),await i()}catch(u){throw console.error("Error updating admin user:",u),o(u.message||"Failed to update admin user"),u}finally{s(!1)}},deleteAdmin:async f=>{s(!0),o(null);try{await fs(f),await i()}catch(g){throw console.error("Error deleting admin user:",g),o(g.message||"Failed to delete admin user"),g}finally{s(!1)}},resetPassword:async(f,g)=>{s(!0),o(null);try{const u=await ps(f,g);return await i(),u}catch(u){return console.error("Error resetting admin password:",u),o(u.message||"Failed to reset admin password"),!1}finally{s(!1)}},promoteToAdmin:async f=>{s(!0),o(null);try{await bs(f),await i()}catch(g){throw console.error("Error promoting user to admin:",g),o(g.message||"Failed to promote user to admin"),g}finally{s(!1)}},promoteToSectionAdmin:async f=>{s(!0),o(null);try{console.log(`Attempting to promote user ${f} to section admin`);const g=r.find(u=>u.id===f);if(!g)throw new Error("User not found");if(!g.sectionId)throw new Error("User does not have a section assigned. Please assign a section first.");await ys(f),console.log(`Successfully promoted user ${f} to section admin`),await i()}catch(g){throw console.error("Error promoting user to section admin:",g),o(g.message||"Failed to promote user to section admin"),g}finally{s(!1)}},demoteUser:async f=>{s(!0),o(null);try{console.log(`Attempting to demote user ${f}`);const g=r.find(u=>u.id===f);if(!g)throw new Error("User not found");if(g.role==="super-admin")throw new Error("Super admins cannot be demoted through this interface");await ws(f),console.log(`Successfully demoted user ${f}`),await i()}catch(g){throw console.error("Error demoting user:",g),o(g.message||"Failed to demote user"),g}finally{s(!1)}},getSectionUsers:async f=>{s(!0),o(null);try{const g=await vs(f);return console.log("getSectionUsers result:",g),g}catch(g){throw console.error("Error fetching section users:",g),o(g.message||"Failed to fetch section users"),g}finally{s(!1)}},getSections:async(f,g)=>{s(!0),o(null);try{return await js(f,g)}catch(u){throw console.error("Error fetching sections:",u),o(u.message||"Failed to fetch sections"),u}finally{s(!1)}},refreshAdmins:i}}function ks(){const[r,a]=c.useState(""),[t,s]=c.useState("all"),[n,o]=c.useState("all"),{admins:i,loading:d,error:l,refreshAdmins:m}=Be(),h=i.filter(p=>{var u,M,w;const b=((u=p.username)==null?void 0:u.toLowerCase().includes(r.toLowerCase()))||((M=p.email)==null?void 0:M.toLowerCase().includes(r.toLowerCase()))||((w=p.department)==null?void 0:w.toLowerCase().includes(r.toLowerCase())),f=t==="all"||p.role===t,g=n==="all"||(n==="active"?p.isActive:!p.isActive);return b&&f&&g}),x=p=>{switch(p){case"super-admin":return e.jsx(I,{variant:"destructive",children:"Super Admin"});case"admin":return e.jsx(I,{variant:"info",children:"Admin"});case"section_admin":return e.jsx(I,{variant:"warning",children:"Section Admin"});default:return e.jsx(I,{variant:"secondary",children:"User"})}},S=p=>p?e.jsx(I,{variant:"success",children:"Active"}):e.jsx(I,{variant:"secondary",children:"Inactive"}),k=async()=>{try{await m(),he("Admins refreshed successfully")}catch(p){W("Failed to refresh admins")}};return d&&i.length===0?e.jsxs("div",{className:"space-y-4 animate-pulse",children:[e.jsx("div",{className:"h-32 bg-gray-200 dark:bg-gray-800 rounded-xl"}),e.jsx("div",{className:"h-96 bg-gray-200 dark:bg-gray-800 rounded-xl"})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(B,{children:[e.jsx(Y,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(J,{className:"text-2xl",children:"Admin Management"}),e.jsx(Z,{children:"Manage system administrators and their permissions"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(D,{variant:"outline",size:"sm",onClick:k,disabled:d,children:[e.jsx(xe,{className:`w-4 h-4 mr-2 ${d?"animate-spin":""}`}),"Refresh"]}),e.jsxs(D,{size:"sm",children:[e.jsx(Mt,{className:"w-4 h-4 mr-2"}),"Add Admin"]})]})]})}),e.jsx(Q,{children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(ar,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(ae,{placeholder:"Search by name, email, or department...",value:r,onChange:p=>a(p.target.value),className:"pl-10"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("select",{value:t,onChange:p=>s(p.target.value),className:"px-3 py-2 border border-gray-200 dark:border-gray-800 rounded-md bg-white dark:bg-gray-950 text-sm",children:[e.jsx("option",{value:"all",children:"All Roles"}),e.jsx("option",{value:"super-admin",children:"Super Admin"}),e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"section_admin",children:"Section Admin"}),e.jsx("option",{value:"user",children:"User"})]}),e.jsxs("select",{value:n,onChange:p=>o(p.target.value),className:"px-3 py-2 border border-gray-200 dark:border-gray-800 rounded-md bg-white dark:bg-gray-950 text-sm",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]}),e.jsxs(D,{variant:"outline",size:"sm",children:[e.jsx(ze,{className:"w-4 h-4 mr-2"}),"Export"]})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(B,{children:e.jsxs(Y,{className:"pb-2",children:[e.jsx(Z,{children:"Total Admins"}),e.jsx(J,{className:"text-3xl",children:i.length})]})}),e.jsx(B,{children:e.jsxs(Y,{className:"pb-2",children:[e.jsx(Z,{children:"Active"}),e.jsx(J,{className:"text-3xl text-green-600",children:i.filter(p=>p.isActive).length})]})}),e.jsx(B,{children:e.jsxs(Y,{className:"pb-2",children:[e.jsx(Z,{children:"Super Admins"}),e.jsx(J,{className:"text-3xl text-purple-600",children:i.filter(p=>p.role==="super-admin").length})]})}),e.jsx(B,{children:e.jsxs(Y,{className:"pb-2",children:[e.jsx(Z,{children:"Section Admins"}),e.jsx(J,{className:"text-3xl text-blue-600",children:i.filter(p=>p.role==="section_admin").length})]})})]}),e.jsxs(B,{children:[e.jsxs(Y,{children:[e.jsxs(J,{children:["Administrators (",h.length,")"]}),e.jsx(Z,{children:r||t!=="all"||n!=="all"?`Showing ${h.length} of ${i.length} admins`:"All system administrators"})]}),e.jsxs(Q,{children:[l&&e.jsx("div",{className:"mb-4 p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg text-red-600 dark:text-red-400",children:l}),h.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:[e.jsx(K,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{className:"text-lg font-medium",children:"No admins found"}),e.jsx("p",{className:"text-sm",children:"Try adjusting your search or filters"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(ir,{children:[e.jsx(lr,{children:e.jsxs(Ce,{children:[e.jsx(q,{children:"Admin"}),e.jsx(q,{children:"Role"}),e.jsx(q,{children:"Department"}),e.jsx(q,{children:"Status"}),e.jsx(q,{children:"Joined"}),e.jsx(q,{className:"text-right",children:"Actions"})]})}),e.jsx(dr,{children:h.map(p=>{var b,f;return e.jsxs(Ce,{children:[e.jsx(G,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ye,{className:"h-10 w-10",children:e.jsx(we,{className:"bg-blue-100 dark:bg-blue-900 text-blue-600 dark:text-blue-400",children:((b=p.username)==null?void 0:b.charAt(0).toUpperCase())||((f=p.email)==null?void 0:f.charAt(0).toUpperCase())})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:p.username||"N/A"}),e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:p.email})]})]})}),e.jsx(G,{children:x(p.role||"user")}),e.jsx(G,{className:"text-gray-600 dark:text-gray-400",children:p.department||"N/A"}),e.jsx(G,{children:S(p.isActive)}),e.jsx(G,{className:"text-gray-600 dark:text-gray-400",children:p.createdAt?new Date(p.createdAt).toLocaleDateString():"N/A"}),e.jsx(G,{className:"text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(D,{variant:"ghost",size:"sm",children:e.jsx(Lt,{className:"w-4 h-4"})}),e.jsx(D,{variant:"ghost",size:"sm",children:e.jsx(Er,{className:"w-4 h-4"})}),e.jsx(D,{variant:"ghost",size:"sm",children:e.jsx(Mr,{className:"w-4 h-4"})})]})})]},p.id)})})]})})]})]})]})}function Ns({stats:r,loading:a}){const[t,s]=c.useState("30d"),[n,o]=c.useState("all"),[i,d]=c.useState(!1),[l,m]=c.useState(!1),[h,x]=c.useState({admins:0,active:0,disabled:0,permissions:0}),S=r!=null&&r.departmentDistribution?["all",...r.departmentDistribution.map(w=>w.department)]:["all"];c.useEffect(()=>{r&&x({admins:Math.floor(Math.random()*20)-10,active:Math.floor(Math.random()*15),disabled:Math.floor(Math.random()*10)-7,permissions:Math.floor(Math.random()*30)-10})},[r]);const k=c.useCallback(()=>{m(!0),setTimeout(()=>{m(!1)},1500)},[]),p=c.useCallback(()=>{const w=(r==null?void 0:r.departmentDistribution)||[],E=Math.max(...w.map(R=>R.count),1);return e.jsx("div",{className:"space-y-3",children:w.map(R=>e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex justify-between mb-1",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 truncate max-w-[70%]",children:R.department}),e.jsxs("div",{className:"flex items-center text-sm",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400 font-medium",children:R.count}),e.jsx("span",{className:"text-xs text-gray-400 dark:text-gray-500 ml-1",children:"admins"})]})]}),e.jsx("div",{className:"overflow-hidden h-2.5 text-xs flex rounded-full bg-gray-200 dark:bg-gray-700",children:e.jsx("div",{style:{width:`${R.count/E*100}%`},className:"shadow-none flex flex-col text-center whitespace-nowrap text-white justify-center bg-blue-500 dark:bg-blue-600 rounded-full transition-all duration-500"})})]},R.department))})},[r==null?void 0:r.departmentDistribution]),b=c.useCallback(()=>{const w=(r==null?void 0:r.totalAdmins)||0,E=(r==null?void 0:r.activeAdmins)||0,R=(r==null?void 0:r.disabledAdmins)||0,_=w>0?Math.round(E/w*100):0,N=2*Math.PI*16,T=_/100*N;return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"relative h-32 w-32",children:e.jsxs("svg",{className:"w-full h-full",viewBox:"0 0 36 36",children:[e.jsx("circle",{cx:"18",cy:"18",r:"16",fill:"none",stroke:"#E5E7EB",strokeWidth:"3.6",className:"dark:stroke-gray-700"}),e.jsx("circle",{cx:"18",cy:"18",r:"16",fill:"none",stroke:"#3B82F6",strokeWidth:"3.6",strokeDasharray:`${T} ${N}`,strokeDashoffset:"0",strokeLinecap:"round",className:"dark:stroke-blue-500 transition-all duration-1000 ease-in-out",transform:"rotate(-90 18 18)"}),e.jsxs("text",{x:"18",y:"18",dy:".35em",dominantBaseline:"middle",textAnchor:"middle",fill:"#4B5563",className:"dark:fill-white text-3xl font-bold",children:[_,"%"]})]})}),e.jsx("div",{className:"flex-1 pl-5",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-3 w-3 rounded-full bg-blue-500 dark:bg-blue-500 mr-2"}),e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-300",children:"Active"})]}),e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx("p",{className:"text-xl font-bold text-gray-800 dark:text-white",children:E}),h.active>0&&e.jsxs("div",{className:"flex items-center ml-2 text-xs text-green-500",children:[e.jsx(Ne,{className:"h-3 w-3"}),e.jsxs("span",{children:[h.active,"%"]})]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-3 w-3 rounded-full bg-gray-300 dark:bg-gray-600 mr-2"}),e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-300",children:"Disabled"})]}),e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx("p",{className:"text-xl font-bold text-gray-800 dark:text-white",children:R}),h.disabled<0&&e.jsxs("div",{className:"flex items-center ml-2 text-xs text-red-500",children:[e.jsx(Te,{className:"h-3 w-3"}),e.jsxs("span",{children:[Math.abs(h.disabled),"%"]})]})]})]})]})})]})},[r==null?void 0:r.totalAdmins,r==null?void 0:r.activeAdmins,r==null?void 0:r.disabledAdmins,h]),f=c.useCallback(()=>{const w=(r==null?void 0:r.permissionUsage)||[];return e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:w.map(E=>{const R=Math.min(100,Math.round(E.count/((r==null?void 0:r.totalAdmins)||1)*100));return e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex justify-between mb-1.5",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 truncate max-w-[80%]",children:E.permission}),e.jsxs("div",{className:"flex space-x-1",children:[e.jsxs("span",{className:"text-xs font-semibold text-gray-900 dark:text-white",children:[R,"%"]}),e.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["(",E.count,")"]})]})]}),e.jsx("div",{className:"overflow-hidden h-2 text-xs flex rounded-full bg-gray-200 dark:bg-gray-700",children:e.jsx("div",{style:{width:`${R}%`},className:`shadow-none flex flex-col text-center whitespace-nowrap text-white justify-center rounded-full transition-all duration-500 ${R>75?"bg-green-500 dark:bg-green-600":R>50?"bg-blue-500 dark:bg-blue-600":R>25?"bg-amber-500 dark:bg-amber-600":"bg-red-500 dark:bg-red-600"}`})})]},E.permission)})})},[r==null?void 0:r.permissionUsage,r==null?void 0:r.totalAdmins]),g=c.useCallback(()=>{if(!(r!=null&&r.monthlyActivity)||r.monthlyActivity.length===0)return e.jsx("div",{className:"flex items-center justify-center h-40 text-gray-500 dark:text-gray-400",children:"No activity data available"});const w=r.monthlyActivity,E=Math.max(...w.map(_=>_.logins)),R=Math.max(...w.map(_=>_.actions));return e.jsxs("div",{className:"pt-5",children:[e.jsx("div",{className:"flex items-end justify-between space-x-1 h-[180px]",children:w.map(_=>e.jsxs("div",{className:"flex-1 flex flex-col items-center group",children:[e.jsxs("div",{className:"relative w-full flex justify-center",children:[e.jsxs("div",{className:"absolute bottom-full mb-2 opacity-0 group-hover:opacity-100 transition-opacity bg-gray-900 text-white text-xs rounded py-1 px-2 pointer-events-none z-10 whitespace-nowrap",children:[e.jsx("div",{className:"font-medium",children:_.month}),e.jsxs("div",{className:"flex justify-between gap-2",children:[e.jsx("span",{children:"Logins:"}),e.jsx("span",{children:_.logins})]}),e.jsxs("div",{className:"flex justify-between gap-2",children:[e.jsx("span",{children:"Actions:"}),e.jsx("span",{children:_.actions})]})]}),e.jsxs("div",{className:"flex space-x-1",children:[e.jsx("div",{className:"w-3 bg-blue-500 dark:bg-blue-600 rounded-t hover:bg-blue-600 dark:hover:bg-blue-700 transition-all cursor-pointer group-hover:opacity-90",style:{height:`${_.logins/E*100}%`}}),e.jsx("div",{className:"w-3 bg-purple-500 dark:bg-purple-600 rounded-t hover:bg-purple-600 dark:hover:bg-purple-700 transition-all cursor-pointer group-hover:opacity-90",style:{height:`${_.actions/R*100}%`}})]})]}),e.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2",children:_.month.substring(0,3)})]},_.month))}),e.jsxs("div",{className:"flex justify-center mt-4 space-x-8",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-3 w-3 rounded bg-blue-500 dark:bg-blue-600 mr-2"}),e.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Logins"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-3 w-3 rounded bg-purple-500 dark:bg-purple-600 mr-2"}),e.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Actions"})]})]})]})},[r==null?void 0:r.monthlyActivity]),u=c.useCallback(()=>!(r!=null&&r.mostActiveAdmins)||r.mostActiveAdmins.length===0?e.jsx("div",{className:"text-center text-gray-500 dark:text-gray-400 py-8",children:"No activity data available"}):e.jsx("div",{className:"space-y-3",children:r.mostActiveAdmins.map((w,E)=>e.jsxs("div",{className:"flex items-center justify-between p-2 hover:bg-gray-50 dark:hover:bg-gray-750 rounded-lg transition-colors",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400 mr-3 font-semibold",children:E+1}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-800 dark:text-white",children:w.adminName}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:w.adminId.substring(0,8)})]})]}),e.jsxs("div",{className:"flex items-center bg-blue-50 dark:bg-blue-900/20 px-2 py-1 rounded-full",children:[e.jsx(ue,{className:"h-3.5 w-3.5 text-blue-600 dark:text-blue-400 mr-1.5"}),e.jsx("span",{className:"text-sm font-medium text-blue-600 dark:text-blue-400",children:w.actionsCount})]})]},w.adminId))}),[r==null?void 0:r.mostActiveAdmins]),M=c.useCallback(()=>!(r!=null&&r.recentLogins)||r.recentLogins.length===0?e.jsx("div",{className:"text-center text-gray-500 dark:text-gray-400 py-8",children:"No recent login data available"}):e.jsx("div",{className:"space-y-3",children:r.recentLogins.map(w=>{const E=new Date(w.timestamp),_=new Date().getTime()-E.getTime(),N=Math.floor(_/(1e3*60*60*24)),T=Math.floor(_/(1e3*60*60)),se=Math.floor(_/(1e3*60));let re;return N>0?re=`${N}d ago`:T>0?re=`${T}h ago`:re=`${se}m ago`,e.jsxs("div",{className:"flex items-center justify-between p-2 hover:bg-gray-50 dark:hover:bg-gray-750 rounded-lg transition-colors",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center text-green-600 dark:text-green-400 mr-3",children:e.jsx(xr,{className:"h-4 w-4"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-800 dark:text-white",children:w.adminName}),e.jsxs("div",{className:"flex items-center text-xs",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:w.ipAddress}),e.jsx("span",{className:"mx-1.5 h-1 w-1 rounded-full bg-gray-300 dark:bg-gray-700"}),e.jsx("span",{className:"text-gray-400 dark:text-gray-500",children:re})]})]})]}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 whitespace-nowrap",children:E.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]},w.adminId)})}),[r==null?void 0:r.recentLogins]);return e.jsxs("div",{children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-5 mb-6 shadow-sm",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between mb-6 gap-4",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 dark:text-white flex items-center",children:[e.jsx(ue,{className:"h-5 w-5 text-blue-600 dark:text-blue-400 mr-2"}),"Admin Analytics Dashboard"]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm mt-1",children:"Comprehensive analytics for monitoring admin activity and usage patterns."})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:t,onChange:w=>s(w.target.value),className:"appearance-none bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 text-gray-700 dark:text-gray-300 py-2 px-3 pr-8 rounded-lg text-sm font-medium focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"7d",children:"Last 7 days"}),e.jsx("option",{value:"30d",children:"Last 30 days"}),e.jsx("option",{value:"90d",children:"Last 90 days"}),e.jsx("option",{value:"1y",children:"Last year"})]}),e.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700 dark:text-gray-300",children:e.jsx(pr,{className:"h-4 w-4"})})]}),e.jsxs("button",{onClick:()=>d(!i),className:"flex items-center justify-center gap-1.5 bg-gray-50 hover:bg-gray-100 dark:bg-gray-700 dark:hover:bg-gray-650 border border-gray-200 dark:border-gray-600 text-gray-700 dark:text-gray-300 py-2 px-3 rounded-lg text-sm font-medium transition-colors",children:[e.jsx(Lr,{className:"h-4 w-4"}),e.jsx("span",{children:"Filters"}),i?e.jsx(Ft,{className:"h-4 w-4"}):e.jsx(pr,{className:"h-4 w-4"})]}),e.jsxs("button",{onClick:k,disabled:l,className:`flex items-center justify-center gap-1.5 bg-blue-50 hover:bg-blue-100 dark:bg-blue-900/20 dark:hover:bg-blue-900/30 border border-blue-200 dark:border-blue-800 text-blue-700 dark:text-blue-400 py-2 px-3 rounded-lg text-sm font-medium transition-colors ${l?"opacity-70 cursor-not-allowed":""}`,children:[e.jsx(xe,{className:`h-4 w-4 ${l?"animate-spin":""}`}),e.jsx("span",{children:l?"Refreshing...":"Refresh Data"})]})]})]}),i&&e.jsx("div",{className:"bg-gray-50 dark:bg-gray-750 border border-gray-200 dark:border-gray-700 rounded-lg p-4 mb-6",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Department"}),e.jsx("select",{value:n,onChange:w=>o(w.target.value),className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 text-gray-700 dark:text-gray-300 py-2 px-3 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:S.map(w=>e.jsx("option",{value:w,children:w==="all"?"All Departments":w},w))})]})})}),a?e.jsxs("div",{className:"animate-pulse space-y-6",children:[e.jsx("div",{className:"h-20 bg-gray-200 dark:bg-gray-700 rounded-lg"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[...Array(4)].map((w,E)=>e.jsx("div",{className:"h-24 bg-gray-200 dark:bg-gray-700 rounded-lg"},E))}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[...Array(4)].map((w,E)=>e.jsx("div",{className:"h-64 bg-gray-200 dark:bg-gray-700 rounded-lg"},E))})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[e.jsx("div",{className:"bg-white dark:bg-gray-800 border border-gray-100 dark:border-gray-700 p-4 rounded-lg shadow-sm hover:shadow-md transition-all",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Total Admins"}),e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:(r==null?void 0:r.totalAdmins)||0}),e.jsxs("div",{className:`flex items-center ml-2 text-xs ${h.admins>0?"text-green-500":h.admins<0?"text-red-500":"text-gray-500"}`,children:[h.admins>0?e.jsx(Ne,{className:"h-3 w-3 mr-0.5"}):h.admins<0?e.jsx(Te,{className:"h-3 w-3 mr-0.5"}):null,e.jsxs("span",{children:[Math.abs(h.admins),"%"]})]})]})]}),e.jsx("div",{className:"h-12 w-12 rounded-full bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center text-blue-600 dark:text-blue-400",children:e.jsx(Se,{className:"h-6 w-6"})})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 border border-gray-100 dark:border-gray-700 p-4 rounded-lg shadow-sm hover:shadow-md transition-all",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Active Admins"}),e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:(r==null?void 0:r.activeAdmins)||0}),e.jsxs("div",{className:"flex items-center ml-2 text-xs text-green-500",children:[e.jsx(Ne,{className:"h-3 w-3 mr-0.5"}),e.jsxs("span",{children:[h.active,"%"]})]})]})]}),e.jsx("div",{className:"h-12 w-12 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center text-green-600 dark:text-green-400",children:e.jsx(xr,{className:"h-6 w-6"})})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 border border-gray-100 dark:border-gray-700 p-4 rounded-lg shadow-sm hover:shadow-md transition-all",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Disabled Admins"}),e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:(r==null?void 0:r.disabledAdmins)||0}),h.disabled!==0&&e.jsxs("div",{className:`flex items-center ml-2 text-xs ${h.disabled<0?"text-green-500":"text-red-500"}`,children:[h.disabled<0?e.jsx(Te,{className:"h-3 w-3 mr-0.5"}):e.jsx(Ne,{className:"h-3 w-3 mr-0.5"}),e.jsxs("span",{children:[Math.abs(h.disabled),"%"]})]})]})]}),e.jsx("div",{className:"h-12 w-12 rounded-full bg-red-100 dark:bg-red-900/30 flex items-center justify-center text-red-600 dark:text-red-400",children:e.jsx(kt,{className:"h-6 w-6"})})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 border border-gray-100 dark:border-gray-700 p-4 rounded-lg shadow-sm hover:shadow-md transition-all",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Permission Changes"}),e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:(r==null?void 0:r.permissionChanges)||0}),e.jsx("div",{className:`flex items-center ml-2 text-xs ${h.permissions>0?"text-amber-500":h.permissions<0?"text-blue-500":"text-gray-500"}`,children:h.permissions!==0&&e.jsxs(e.Fragment,{children:[h.permissions>0?e.jsx(Ne,{className:"h-3 w-3 mr-0.5"}):e.jsx(Te,{className:"h-3 w-3 mr-0.5"}),e.jsxs("span",{children:[Math.abs(h.permissions),"%"]})]})})]})]}),e.jsx("div",{className:"h-12 w-12 rounded-full bg-amber-100 dark:bg-amber-900/30 flex items-center justify-center text-amber-600 dark:text-amber-400",children:e.jsx(K,{className:"h-6 w-6"})})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 border border-gray-100 dark:border-gray-700 p-5 rounded-lg shadow-sm hover:shadow-md transition-all",children:[e.jsxs("div",{className:"flex items-center justify-between mb-5",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-900 dark:text-white",children:"Active vs Disabled Admins"}),e.jsx(Rt,{className:"h-5 w-5 text-gray-500 dark:text-gray-400"})]}),b()]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 border border-gray-100 dark:border-gray-700 p-5 rounded-lg shadow-sm hover:shadow-md transition-all",children:[e.jsxs("div",{className:"flex items-center justify-between mb-5",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-900 dark:text-white",children:"Admin Distribution by Department"}),e.jsx(Tt,{className:"h-5 w-5 text-gray-500 dark:text-gray-400"})]}),p()]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 border border-gray-100 dark:border-gray-700 p-5 rounded-lg shadow-sm hover:shadow-md transition-all",children:[e.jsxs("div",{className:"flex items-center justify-between mb-5",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-900 dark:text-white",children:"Monthly Admin Activity"}),e.jsx(Ut,{className:"h-5 w-5 text-gray-500 dark:text-gray-400"})]}),g()]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 border border-gray-100 dark:border-gray-700 p-5 rounded-lg shadow-sm hover:shadow-md transition-all",children:[e.jsxs("div",{className:"flex items-center justify-between mb-5",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-900 dark:text-white",children:"Permission Usage Patterns"}),e.jsx(K,{className:"h-5 w-5 text-gray-500 dark:text-gray-400"})]}),f()]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 border border-gray-100 dark:border-gray-700 p-5 rounded-lg shadow-sm hover:shadow-md transition-all",children:[e.jsxs("div",{className:"flex items-center justify-between mb-5",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-900 dark:text-white",children:"Most Active Admins"}),e.jsx(ue,{className:"h-5 w-5 text-gray-500 dark:text-gray-400"})]}),u(),(r==null?void 0:r.mostActiveAdmins)&&r.mostActiveAdmins.length>0&&e.jsx("div",{className:"mt-4 pt-3 border-t border-gray-200 dark:border-gray-700",children:e.jsxs("button",{className:"text-sm text-blue-600 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-500 font-medium flex items-center justify-center w-full",children:[e.jsx(ze,{className:"h-4 w-4 mr-1.5"}),"Export Activity Report"]})})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 border border-gray-100 dark:border-gray-700 p-5 rounded-lg shadow-sm hover:shadow-md transition-all",children:[e.jsxs("div",{className:"flex items-center justify-between mb-5",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-900 dark:text-white",children:"Recent Admin Logins"}),e.jsx(Fr,{className:"h-5 w-5 text-gray-500 dark:text-gray-400"})]}),M(),(r==null?void 0:r.recentLogins)&&r.recentLogins.length>0&&e.jsx("div",{className:"mt-4 pt-3 border-t border-gray-200 dark:border-gray-700",children:e.jsxs("button",{className:"text-sm text-blue-600 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-500 font-medium flex items-center justify-center w-full",children:[e.jsx(ze,{className:"h-4 w-4 mr-1.5"}),"Export Login Report"]})})]})]})]})]}),e.jsxs("div",{className:"flex items-center justify-center text-sm text-gray-500 dark:text-gray-400 gap-2 mb-6",children:[e.jsx(xe,{className:`h-3.5 w-3.5 ${l?"animate-spin text-blue-500":""}`}),e.jsx("span",{className:"flex items-center",children:l?"Refreshing data...":`Last updated: ${new Date().toLocaleString()}`})]})]})}function As({logs:r,loading:a}){const[t,s]=c.useState(""),[n,o]=c.useState([]),[i,d]=c.useState("all"),[l,m]=c.useState({from:"",to:""}),[h,x]=c.useState("desc"),S=["all","create_admin","update_admin","delete_admin","reset_password","login","logout"];c.useEffect(()=>{let u=[...r];if(t){const M=t.toLowerCase();u=u.filter(w=>w.adminName.toLowerCase().includes(M)||w.action.toLowerCase().includes(M)||w.details.toLowerCase().includes(M))}if(i!=="all"&&(u=u.filter(M=>M.action===i)),l.from){const M=new Date(l.from);u=u.filter(w=>new Date(w.timestamp)>=M)}if(l.to){const M=new Date(l.to);M.setHours(23,59,59,999),u=u.filter(w=>new Date(w.timestamp)<=M)}u.sort((M,w)=>{const E=new Date(M.timestamp),R=new Date(w.timestamp);return h==="desc"?+R-+E:+E-+R}),o(u)},[r,t,i,l,h]);const k=u=>{const{name:M,value:w}=u.target;m(E=>({...E,[M]:w}))},p=()=>{s(""),d("all"),m({from:"",to:""})},b=()=>{if(n.length===0)return;const M=[["Admin","Action","Details","Timestamp","IP Address"].join(","),...n.map(_=>[`"${_.adminName}"`,`"${_.action}"`,`"${_.details.replace(/"/g,'""')}"`,`"${new Date(_.timestamp).toLocaleString()}"`,`"${_.ipAddress||""}"`].join(","))].join(`
`),w=new Blob([M],{type:"text/csv;charset=utf-8;"}),E=URL.createObjectURL(w),R=document.createElement("a");R.setAttribute("href",E),R.setAttribute("download",`admin-logs-${new Date().toISOString().split("T")[0]}.csv`),R.style.visibility="hidden",document.body.appendChild(R),R.click(),document.body.removeChild(R)},f=u=>{switch(u){case"create_admin":return"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-300";case"update_admin":return"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-300";case"delete_admin":return"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-300";case"reset_password":return"bg-amber-100 text-amber-800 dark:bg-amber-900/20 dark:text-amber-300";case"login":return"bg-purple-100 text-purple-800 dark:bg-purple-900/20 dark:text-purple-300";case"logout":return"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300";default:return"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"}},g=u=>u.split("_").map(M=>M.charAt(0).toUpperCase()+M.slice(1)).join(" ");return e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-750 rounded-lg border border-gray-200 dark:border-gray-700 p-4 space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between gap-3",children:[e.jsxs("h2",{className:"text-lg font-bold text-gray-900 dark:text-white flex items-center",children:[e.jsx(Xe,{className:"h-5 w-5 text-indigo-600 dark:text-indigo-400 mr-2"}),"Admin Activity Logs"]}),e.jsxs("button",{onClick:b,disabled:n.length===0,className:"inline-flex items-center px-3 py-1.5 text-sm font-medium text-indigo-700 bg-indigo-100 border border-transparent rounded-lg hover:bg-indigo-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 dark:bg-indigo-900/20 dark:text-indigo-300 dark:hover:bg-indigo-900/30 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(ze,{className:"h-4 w-4 mr-1.5"}),"Export CSV"]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:"Search logs...",value:t,onChange:u=>s(u.target.value),className:"w-full px-3 py-2 pl-9 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:text-white"}),e.jsx(ar,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("select",{value:i,onChange:u=>d(u.target.value),className:"w-full px-3 py-2 pl-9 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:text-white appearance-none",children:S.map(u=>e.jsx("option",{value:u,children:u==="all"?"All Actions":g(u)},u))}),e.jsx(Lr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"date",name:"from",value:l.from,onChange:k,className:"w-full px-3 py-2 pl-9 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:text-white",placeholder:"From date"}),e.jsx(Xe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"date",name:"to",value:l.to,onChange:k,className:"w-full px-3 py-2 pl-9 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:text-white",placeholder:"To date"}),e.jsx(Xe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2 pt-2",children:[e.jsx("div",{className:"flex flex-wrap items-center gap-2",children:(t||i!=="all"||l.from||l.to)&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Active filters:"}),t&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300",children:["Search: ",t,e.jsx(ge,{size:14,className:"ml-1 cursor-pointer",onClick:()=>s("")})]}),i!=="all"&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300",children:["Action: ",g(i),e.jsx(ge,{size:14,className:"ml-1 cursor-pointer",onClick:()=>d("all")})]}),l.from&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300",children:["From: ",l.from,e.jsx(ge,{size:14,className:"ml-1 cursor-pointer",onClick:()=>m(u=>({...u,from:""}))})]}),l.to&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300",children:["To: ",l.to,e.jsx(ge,{size:14,className:"ml-1 cursor-pointer",onClick:()=>m(u=>({...u,to:""}))})]}),e.jsx("button",{onClick:p,className:"text-sm text-indigo-600 dark:text-indigo-400 hover:text-indigo-800 dark:hover:text-indigo-300",children:"Clear all"})]})}),e.jsxs("button",{onClick:()=>x(u=>u==="desc"?"asc":"desc"),className:"inline-flex items-center px-2 py-1 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors",children:[e.jsx(Fr,{className:"h-4 w-4 mr-1"}),h==="desc"?e.jsxs(e.Fragment,{children:["Newest first ",e.jsx(Nt,{className:"h-3 w-3 ml-1"})]}):e.jsxs(e.Fragment,{children:["Oldest first ",e.jsx(At,{className:"h-3 w-3 ml-1"})]})]})]})]}),e.jsx("div",{className:"bg-white dark:bg-gray-750 rounded-lg border border-gray-200 dark:border-gray-700 overflow-hidden",children:a?e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"animate-pulse space-y-4",children:[e.jsx("div",{className:"h-8 bg-gray-200 dark:bg-gray-700 rounded"}),[...Array(5)].map((u,M)=>e.jsx("div",{className:"h-20 bg-gray-200 dark:bg-gray-700 rounded"},M))]})}):n.length===0?e.jsx("div",{className:"p-8 text-center text-gray-500 dark:text-gray-400",children:r.length===0?"No activity logs found in the system.":"No logs match your current filters."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Admin"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Action"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Details"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Timestamp"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"IP Address"})]})}),e.jsx("tbody",{className:"bg-white dark:bg-gray-750 divide-y divide-gray-200 dark:divide-gray-700",children:n.map(u=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/40 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-8 w-8 rounded-full bg-indigo-100 dark:bg-indigo-900/30 flex items-center justify-center text-indigo-600 dark:text-indigo-400",children:e.jsx($e,{className:"h-4 w-4"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:u.adminName}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:u.adminId.substring(0,8)})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2.5 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${f(u.action)}`,children:g(u.action)})}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"text-sm text-gray-900 dark:text-white max-w-xs truncate",children:u.details}),u.resource&&e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:["Resource: ",u.resource," ",u.resourceId&&`#${u.resourceId.substring(0,8)}`]})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:new Date(u.timestamp).toLocaleString()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:u.ipAddress||"-"})]},u.id))})]})})}),!a&&r.length>0&&e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400 text-right",children:["Showing ",n.length," of ",r.length," logs"]})]})}function Ss({admins:r,onResetPassword:a}){const[t,s]=c.useState(""),[n,o]=c.useState(""),[i,d]=c.useState(!1),[l,m]=c.useState(!1),[h,x]=c.useState(!1),S=()=>{const f="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*()_+";let g="";g+="ABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(Math.random()*26)],g+="abcdefghijklmnopqrstuvwxyz"[Math.floor(Math.random()*26)],g+="0123456789"[Math.floor(Math.random()*10)],g+="!@#$%^&*()_+"[Math.floor(Math.random()*12)];for(let u=4;u<12;u++)g+=f[Math.floor(Math.random()*f.length)];g=g.split("").sort(()=>Math.random()-.5).join(""),o(g)},k=()=>{navigator.clipboard.writeText(n).then(()=>{x(!0),setTimeout(()=>x(!1),2e3)}).catch(b=>{console.error("Failed to copy:",b),W("Failed to copy password to clipboard")})},p=async()=>{if(!t){W("Please select an admin");return}if(!n||n.length<8){W("Please generate a secure password");return}m(!0);try{await a(t,n)?(he("Password reset successfully"),s(""),o("")):W("Failed to reset password")}catch(b){W(b.message||"Failed to reset password")}finally{m(!1)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-1",children:"Security Settings"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Manage security settings and reset passwords"})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Password Reset"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"admin-select",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Select User"}),e.jsxs("select",{id:"admin-select",value:t,onChange:b=>s(b.target.value),className:"w-full rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Select a user"}),r.filter(b=>b.role!=="super-admin").map(b=>e.jsxs("option",{value:b.id,children:[b.username," (",b.email,") - ",b.role]},b.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"New Password"}),e.jsx("div",{className:"relative",children:e.jsxs("div",{className:"flex",children:[e.jsx("input",{id:"password",type:i?"text":"password",value:n,onChange:b=>o(b.target.value),className:"flex-1 rounded-l-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Generate a secure password",readOnly:!0}),e.jsx("button",{type:"button",onClick:()=>d(!i),className:"bg-gray-100 dark:bg-gray-600 border-y border-r border-gray-300 dark:border-gray-600 rounded-r-lg px-3",children:i?e.jsx(Pt,{className:"h-5 w-5 text-gray-500 dark:text-gray-400"}):e.jsx(Dt,{className:"h-5 w-5 text-gray-500 dark:text-gray-400"})})]})})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{type:"button",onClick:S,className:"flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors",children:[e.jsx(Er,{className:"h-4 w-4"}),e.jsx("span",{children:"Generate Password"})]}),n&&e.jsx("button",{type:"button",onClick:k,className:"flex items-center gap-2 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600 px-4 py-2 rounded-lg transition-colors",children:h?e.jsxs(e.Fragment,{children:[e.jsx(zt,{className:"h-4 w-4 text-green-500"}),e.jsx("span",{children:"Copied!"})]}):e.jsxs(e.Fragment,{children:[e.jsx($t,{className:"h-4 w-4"}),e.jsx("span",{children:"Copy"})]})})]}),e.jsx("div",{className:"mt-6",children:e.jsxs("button",{type:"button",onClick:p,disabled:!t||!n||l,className:"flex items-center gap-2 bg-red-600 hover:bg-red-700 text-white px-6 py-2 rounded-lg transition-colors disabled:bg-red-300 dark:disabled:bg-red-800/50 disabled:cursor-not-allowed",children:[l?e.jsx(xe,{className:"h-4 w-4 animate-spin"}):e.jsx(K,{className:"h-4 w-4"}),e.jsx("span",{children:"Reset Password"})]})}),t&&n&&e.jsxs("div",{className:"mt-4 p-3 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800/50 rounded-lg flex items-start gap-2 text-sm",children:[e.jsx(It,{className:"h-5 w-5 text-yellow-500 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-yellow-800 dark:text-yellow-400",children:"Important:"}),e.jsx("p",{className:"text-yellow-700 dark:text-yellow-300",children:"You are about to reset the password for this user. Make sure to share the new password with them securely. They should change their password after logging in."})]})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Security Policies"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between pb-4 border-b border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"Two-factor Authentication"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Require 2FA for all admin accounts"})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"sr-only peer",defaultChecked:!0}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"})]})]}),e.jsxs("div",{className:"flex items-center justify-between py-4 border-b border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"Password Expiry"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Force password change every 90 days"})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"sr-only peer",defaultChecked:!0}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"})]})]}),e.jsxs("div",{className:"flex items-center justify-between py-4 border-b border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"Session Timeout"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Auto logout after 30 minutes of inactivity"})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"})]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"Failed Login Lockout"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Lock account after 5 failed login attempts"})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"sr-only peer",defaultChecked:!0}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"})]})]})]}),e.jsx("div",{className:"mt-6",children:e.jsxs("button",{type:"button",className:"flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors",children:[e.jsx(K,{className:"h-4 w-4"}),e.jsx("span",{children:"Save Security Settings"})]})})]})]})}var Cs=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],_s=Cs.reduce((r,a)=>{const t=or(`Primitive.${a}`),s=c.forwardRef((n,o)=>{const{asChild:i,...d}=n,l=i?t:a;return typeof window!="undefined"&&(window[Symbol.for("radix-ui")]=!0),e.jsx(l,{...d,ref:o})});return s.displayName=`Primitive.${a}`,{...r,[a]:s}},{}),Es="Label",it=c.forwardRef((r,a)=>e.jsx(_s.label,{...r,ref:a,onMouseDown:t=>{var n;t.target.closest("button, input, select, textarea")||((n=r.onMouseDown)==null||n.call(r,t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));it.displayName=Es;var lt=it;const Rs=nr("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),V=c.forwardRef(({className:r,...a},t)=>e.jsx(lt,{ref:t,className:L(Rs(),r),...a}));V.displayName=lt.displayName;const gr=({open:r,onOpenChange:a,children:t})=>r?e.jsxs("div",{className:"fixed inset-0 z-50",children:[e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm",onClick:()=>a(!1)}),e.jsx("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:t})]}):null,Ve=c.forwardRef(({className:r,children:a,onClose:t,...s},n)=>e.jsxs("div",{ref:n,className:L("relative bg-white dark:bg-gray-950 rounded-lg shadow-xl border border-gray-200 dark:border-gray-800 w-full max-w-lg max-h-[90vh] overflow-y-auto",r),onClick:o=>o.stopPropagation(),...s,children:[t&&e.jsxs("button",{onClick:t,className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-white transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-gray-950 focus:ring-offset-2 disabled:pointer-events-none dark:ring-offset-gray-950 dark:focus:ring-gray-300",children:[e.jsx(ge,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]}),a]}));Ve.displayName="DialogContent";const qe=({className:r,...a})=>e.jsx("div",{className:L("flex flex-col space-y-1.5 p-6 pb-4",r),...a});qe.displayName="DialogHeader";const Ge=({className:r,...a})=>e.jsx("div",{className:L("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2 p-6 pt-4",r),...a});Ge.displayName="DialogFooter";const We=c.forwardRef(({className:r,...a},t)=>e.jsx("h2",{ref:t,className:L("text-lg font-semibold leading-none tracking-tight text-gray-900 dark:text-white",r),...a}));We.displayName="DialogTitle";const He=c.forwardRef(({className:r,...a},t)=>e.jsx("p",{ref:t,className:L("text-sm text-gray-500 dark:text-gray-400",r),...a}));He.displayName="DialogDescription";const Ye=({className:r,...a})=>e.jsx("div",{className:L("px-6 py-2",r),...a});Ye.displayName="DialogBody";async function Us(){try{const{data:r,error:a}=await y.from("users").select("*").order("created_at",{ascending:!1});if(a)throw console.error("Error fetching users:",a),new Error(a.message);return r||[]}catch(r){throw console.error("Error in fetchAllUsers:",r),r}}async function Ms(){try{const{data:r,error:a}=await y.from("departments").select("*").order("name");if(a)throw console.error("Error fetching departments:",a),new Error(a.message);return r||[]}catch(r){throw console.error("Error in fetchDepartments:",r),r}}async function Ls(r){try{let a=y.from("batches").select("*").order("name");const{data:t,error:s}=await a;if(s)throw console.error("Error fetching batches:",s),new Error(s.message);return t||[]}catch(a){throw console.error("Error in fetchBatches:",a),a}}async function Fs(r){try{let a=y.from("sections").select("*").order("name");const{data:t,error:s}=await a;if(s)throw console.error("Error fetching sections:",s),new Error(s.message);return t||[]}catch(a){throw console.error("Error in fetchSections:",a),a}}async function Ts(r){try{const{data:a}=await y.auth.getUser();if(!a.user)throw new Error("You must be logged in to create users");const{data:t,error:s}=await y.auth.signUp({email:r.email,password:r.password,options:{data:{name:r.name,role:r.role}}});if(s)throw console.error("Error creating auth user:",s),new Error(s.message);if(!t.user)throw new Error("Failed to create user account");const{data:n,error:o}=await y.from("users").upsert({id:t.user.id,email:r.email,name:r.name,role:r.role,phone:r.phone||null,student_id:r.student_id||null,department_id:r.department_id||null,batch_id:r.batch_id||null,section_id:r.section_id||null}).select().single();if(o)throw console.error("Error updating user record:",o),new Error(o.message);return await y.from("activities").insert({type:"user_created",title:`New user created: ${r.name}`,user_id:a.user.id,metadata:{target_user_id:t.user.id,email:r.email,role:r.role}}),n}catch(a){throw console.error("Error in createUser:",a),a}}async function Ps(r,a){try{const{data:t}=await y.auth.getUser();if(!t.user)throw new Error("You must be logged in to update users");const{data:s}=await y.from("users").select("*").eq("id",r).single(),{data:n,error:o}=await y.from("users").update({name:a.name,role:a.role,phone:a.phone,student_id:a.student_id,department_id:a.department_id,batch_id:a.batch_id,section_id:a.section_id}).eq("id",r).select().single();if(o)throw console.error("Error updating user:",o),new Error(o.message);return a.role==="section_admin"&&a.section_id&&(s==null?void 0:s.role)!=="section_admin"&&await y.from("section_admins").upsert({user_id:r,section_id:a.section_id,assigned_by:t.user.id}),(s==null?void 0:s.role)==="section_admin"&&a.role!=="section_admin"&&await y.from("section_admins").delete().eq("user_id",r),await y.from("activities").insert({type:"user_updated",title:`User updated: ${n.name}`,user_id:t.user.id,metadata:{target_user_id:r,changes:a,previous:s}}),n}catch(t){throw console.error("Error in updateUser:",t),t}}async function Ds(r){try{const{data:a}=await y.auth.getUser();if(!a.user)throw new Error("You must be logged in to delete users");const{data:t}=await y.from("users").select("*").eq("id",r).single();await y.from("section_admins").delete().eq("user_id",r);const{error:s}=await y.from("users").delete().eq("id",r);if(s)throw console.error("Error deleting user:",s),new Error(s.message);await y.from("activities").insert({type:"user_deleted",title:`User deleted: ${(t==null?void 0:t.name)||(t==null?void 0:t.email)}`,user_id:a.user.id,metadata:{deleted_user:t}})}catch(a){throw console.error("Error in deleteUserById:",a),a}}async function zs(r,a,t){try{const{data:s}=await y.auth.getUser();if(!s.user)throw new Error("You must be logged in to change user roles");const{data:n}=await y.from("users").select("*").eq("id",r).single(),o={role:a};t&&(o.section_id=t);const{data:i,error:d}=await y.from("users").update(o).eq("id",r).select().single();if(d)throw console.error("Error changing user role:",d),new Error(d.message);return a==="section_admin"&&t?(await y.from("section_admins").delete().eq("user_id",r),await y.from("section_admins").insert({user_id:r,section_id:t,assigned_by:s.user.id})):(n==null?void 0:n.role)==="section_admin"&&a!=="section_admin"&&await y.from("section_admins").delete().eq("user_id",r),await y.from("activities").insert({type:"role_change",title:`User role changed: ${n==null?void 0:n.role}  ${a}`,user_id:s.user.id,metadata:{target_user_id:r,previous_role:n==null?void 0:n.role,new_role:a,section_id:t}}),i}catch(s){throw console.error("Error in changeUserRole:",s),s}}function $s(r){const a=r.length,t=r.filter(m=>m.role==="super-admin").length,s=r.filter(m=>m.role==="admin").length,n=r.filter(m=>m.role==="section_admin").length,o=r.filter(m=>m.role==="user").length,i=new Date;i.setDate(i.getDate()-7);const d=r.filter(m=>m.last_active&&new Date(m.last_active)>i).length,l=r.filter(m=>m.created_at&&new Date(m.created_at)>i).length;return{totalUsers:a,superAdmins:t,admins:s,sectionAdmins:n,regularUsers:o,activeUsers:d,newUsersThisWeek:l}}function Is(r,a){if(!a)return r;const t=a.toLowerCase();return r.filter(s=>{var n,o,i,d;return((n=s.name)==null?void 0:n.toLowerCase().includes(t))||((o=s.email)==null?void 0:o.toLowerCase().includes(t))||((i=s.student_id)==null?void 0:i.toLowerCase().includes(t))||((d=s.phone)==null?void 0:d.toLowerCase().includes(t))})}function Os(r,a){return a==="all"?r:r.filter(t=>t.role===a)}const ee={"super-admin":{label:"Super Admin",color:"text-red-600 dark:text-red-400",icon:Rr,badgeVariant:"destructive"},admin:{label:"Admin",color:"text-blue-600 dark:text-blue-400",icon:Tr,badgeVariant:"info"},section_admin:{label:"Section Admin",color:"text-orange-600 dark:text-orange-400",icon:K,badgeVariant:"warning"},user:{label:"User",color:"text-gray-600 dark:text-gray-400",icon:$e,badgeVariant:"secondary"}};function Bs({open:r,onClose:a,user:t,departments:s,batches:n,sections:o,onSubmit:i,mode:d}){const[l,m]=c.useState({email:"",password:"",name:"",role:"user",phone:"",student_id:"",department_id:"",batch_id:"",section_id:""}),[h,x]=c.useState(!1),[S,k]=c.useState([]),[p,b]=c.useState([]);c.useEffect(()=>{m(d==="edit"&&t?{email:t.email||"",password:"",name:t.name||"",role:t.role,phone:t.phone||"",student_id:t.student_id||"",department_id:t.department_id||"",batch_id:t.batch_id||"",section_id:t.section_id||""}:{email:"",password:"",name:"",role:"user",phone:"",student_id:"",department_id:"",batch_id:"",section_id:""})},[t,d,r]),c.useEffect(()=>{l.department_id?k(n.filter(g=>g.department_id===l.department_id)):k(n)},[l.department_id,n]),c.useEffect(()=>{l.batch_id?b(o.filter(g=>g.batch_id===l.batch_id)):b(o)},[l.batch_id,o]);const f=async g=>{if(g.preventDefault(),d==="create"&&(!l.email||!l.password)){W("Email and password are required");return}if(!l.name){W("Name is required");return}x(!0);try{const u=d==="create"?l:{name:l.name,role:l.role,phone:l.phone||void 0,student_id:l.student_id||void 0,department_id:l.department_id||void 0,batch_id:l.batch_id||void 0,section_id:l.section_id||void 0};await i(u),a()}catch(u){W(u.message||"Failed to save user")}finally{x(!1)}};return e.jsx(gr,{open:r,onOpenChange:a,children:e.jsxs(Ve,{onClose:a,className:"max-w-2xl",children:[e.jsxs(qe,{children:[e.jsx(We,{children:d==="create"?"Create New User":"Edit User"}),e.jsx(He,{children:d==="create"?"Add a new user to the system with specified role and details.":`Update user information for ${(t==null?void 0:t.name)||(t==null?void 0:t.email)}`})]}),e.jsxs("form",{onSubmit:f,children:[e.jsxs(Ye,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[d==="create"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(V,{htmlFor:"email",children:"Email *"}),e.jsx(ae,{id:"email",type:"email",placeholder:"user@example.com",value:l.email,onChange:g=>m(u=>({...u,email:g.target.value})),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(V,{htmlFor:"password",children:"Password *"}),e.jsx(ae,{id:"password",type:"password",placeholder:"",value:l.password,onChange:g=>m(u=>({...u,password:g.target.value})),required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(V,{htmlFor:"name",children:"Full Name *"}),e.jsx(ae,{id:"name",placeholder:"John Doe",value:l.name,onChange:g=>m(u=>({...u,name:g.target.value})),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(V,{htmlFor:"role",children:"Role *"}),e.jsxs("select",{id:"role",value:l.role,onChange:g=>m(u=>({...u,role:g.target.value})),className:"w-full h-9 px-3 border border-gray-200 dark:border-gray-800 rounded-md bg-white dark:bg-gray-950 text-sm",children:[e.jsx("option",{value:"user",children:"User"}),e.jsx("option",{value:"section_admin",children:"Section Admin"}),e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"super-admin",children:"Super Admin"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(V,{htmlFor:"phone",children:"Phone"}),e.jsx(ae,{id:"phone",placeholder:"+1234567890",value:l.phone,onChange:g=>m(u=>({...u,phone:g.target.value}))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(V,{htmlFor:"student_id",children:"Student ID"}),e.jsx(ae,{id:"student_id",placeholder:"STU-123456",value:l.student_id,onChange:g=>m(u=>({...u,student_id:g.target.value}))})]})]}),e.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-800 pt-4 mt-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 dark:text-white mb-4",children:"Organization"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(V,{htmlFor:"department",children:"Department"}),e.jsxs("select",{id:"department",value:l.department_id,onChange:g=>m(u=>({...u,department_id:g.target.value,batch_id:"",section_id:""})),className:"w-full h-9 px-3 border border-gray-200 dark:border-gray-800 rounded-md bg-white dark:bg-gray-950 text-sm",children:[e.jsx("option",{value:"",children:"Select Department"}),s.map(g=>e.jsx("option",{value:g.id,children:g.name},g.id))]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(V,{htmlFor:"batch",children:"Batch"}),e.jsxs("select",{id:"batch",value:l.batch_id,onChange:g=>m(u=>({...u,batch_id:g.target.value,section_id:""})),className:"w-full h-9 px-3 border border-gray-200 dark:border-gray-800 rounded-md bg-white dark:bg-gray-950 text-sm",disabled:!l.department_id,children:[e.jsx("option",{value:"",children:"Select Batch"}),S.map(g=>e.jsx("option",{value:g.id,children:g.name},g.id))]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(V,{htmlFor:"section",children:"Section"}),e.jsxs("select",{id:"section",value:l.section_id,onChange:g=>m(u=>({...u,section_id:g.target.value})),className:"w-full h-9 px-3 border border-gray-200 dark:border-gray-800 rounded-md bg-white dark:bg-gray-950 text-sm",disabled:!l.batch_id,children:[e.jsx("option",{value:"",children:"Select Section"}),p.map(g=>e.jsx("option",{value:g.id,children:g.name},g.id))]})]})]})]})]}),e.jsxs(Ge,{children:[e.jsx(D,{type:"button",variant:"outline",onClick:a,disabled:h,children:"Cancel"}),e.jsx(D,{type:"submit",disabled:h,children:h?"Saving...":d==="create"?"Create User":"Update User"})]})]})]})})}function Vs({open:r,onClose:a,user:t,sections:s,onRoleChange:n}){var S,k;const[o,i]=c.useState("user"),[d,l]=c.useState(""),[m,h]=c.useState(!1);c.useEffect(()=>{t&&(i(t.role),l(t.section_id||""))},[t,r]);const x=async()=>{if(t){if(o==="section_admin"&&!d){W("Please select a section for section admin");return}h(!0);try{await n(t.id,o,d||void 0),he(`Role changed to ${ee[o].label}`),a()}catch(p){W(p.message||"Failed to change role")}finally{h(!1)}}};return t?e.jsx(gr,{open:r,onOpenChange:a,children:e.jsxs(Ve,{onClose:a,children:[e.jsxs(qe,{children:[e.jsx(We,{children:"Change User Role"}),e.jsxs(He,{children:["Change the role for ",t.name||t.email]})]}),e.jsxs(Ye,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-900 rounded-lg",children:[e.jsx(ye,{className:"h-12 w-12",children:e.jsx(we,{className:"bg-blue-100 dark:bg-blue-900 text-blue-600 dark:text-blue-400 text-lg",children:((S=t.name)==null?void 0:S.charAt(0).toUpperCase())||((k=t.email)==null?void 0:k.charAt(0).toUpperCase())})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:t.name}),e.jsx("div",{className:"text-sm text-gray-500",children:t.email}),e.jsxs(I,{variant:ee[t.role].badgeVariant,className:"mt-1",children:["Current: ",ee[t.role].label]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(V,{children:"New Role"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:Object.entries(ee).map(([p,b])=>{const f=b.icon;return e.jsxs("button",{type:"button",onClick:()=>i(p),className:`flex items-center gap-2 p-3 border rounded-lg transition-all ${o===p?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-800 hover:border-gray-300"}`,children:[e.jsx(f,{className:`w-4 h-4 ${b.color}`}),e.jsx("span",{className:"text-sm font-medium",children:b.label})]},p)})})]}),o==="section_admin"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(V,{children:"Assign to Section *"}),e.jsxs("select",{value:d,onChange:p=>l(p.target.value),className:"w-full h-9 px-3 border border-gray-200 dark:border-gray-800 rounded-md bg-white dark:bg-gray-950 text-sm",children:[e.jsx("option",{value:"",children:"Select Section"}),s.map(p=>e.jsx("option",{value:p.id,children:p.name},p.id))]})]})]}),e.jsxs(Ge,{children:[e.jsx(D,{variant:"outline",onClick:a,disabled:m,children:"Cancel"}),e.jsx(D,{onClick:x,disabled:m||o===t.role,children:m?"Updating...":"Change Role"})]})]})}):null}function qs({open:r,onClose:a,user:t,onDelete:s}){var h,x;const[n,o]=c.useState(!1),[i,d]=c.useState("");c.useEffect(()=>{r||d("")},[r]);const l=async()=>{if(t){o(!0);try{await s(t.id),he("User deleted successfully"),a()}catch(S){W(S.message||"Failed to delete user")}finally{o(!1)}}};if(!t)return null;const m=i.toLowerCase()==="delete";return e.jsx(gr,{open:r,onOpenChange:a,children:e.jsxs(Ve,{onClose:a,children:[e.jsxs(qe,{children:[e.jsx(We,{className:"text-red-600",children:"Delete User"}),e.jsx(He,{children:"This action cannot be undone. This will permanently delete the user account."})]}),e.jsxs(Ye,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-red-50 dark:bg-red-900/20 rounded-lg border border-red-200 dark:border-red-800",children:[e.jsx(ye,{className:"h-12 w-12",children:e.jsx(we,{className:"bg-red-100 dark:bg-red-900 text-red-600 dark:text-red-400 text-lg",children:((h=t.name)==null?void 0:h.charAt(0).toUpperCase())||((x=t.email)==null?void 0:x.charAt(0).toUpperCase())})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:t.name}),e.jsx("div",{className:"text-sm text-gray-500",children:t.email}),e.jsx(I,{variant:ee[t.role].badgeVariant,className:"mt-1",children:ee[t.role].label})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(V,{children:'Type "delete" to confirm'}),e.jsx(ae,{value:i,onChange:S=>d(S.target.value),placeholder:"delete",className:"border-red-200 dark:border-red-800 focus:border-red-500"})]})]}),e.jsxs(Ge,{children:[e.jsx(D,{variant:"outline",onClick:a,disabled:n,children:"Cancel"}),e.jsx(D,{variant:"destructive",onClick:l,disabled:n||!m,children:n?"Deleting...":"Delete User"})]})]})})}function Gs({onEdit:r,onChangeRole:a,onDelete:t}){const[s,n]=c.useState(!1);return e.jsxs("div",{className:"relative",children:[e.jsx(D,{variant:"ghost",size:"icon",onClick:()=>n(!s),children:e.jsx(Mr,{className:"w-4 h-4"})}),s&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>n(!1)}),e.jsxs("div",{className:"absolute right-0 mt-1 w-48 py-1 bg-white dark:bg-gray-950 border border-gray-200 dark:border-gray-800 rounded-lg shadow-lg z-50",children:[e.jsxs("button",{onClick:()=>{r(),n(!1)},className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-100 dark:hover:bg-gray-800 flex items-center gap-2",children:[e.jsx(Ur,{className:"w-4 h-4"}),"Edit User"]}),e.jsxs("button",{onClick:()=>{a(),n(!1)},className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-100 dark:hover:bg-gray-800 flex items-center gap-2",children:[e.jsx(K,{className:"w-4 h-4"}),"Change Role"]}),e.jsx("div",{className:"border-t border-gray-200 dark:border-gray-800 my-1"}),e.jsxs("button",{onClick:()=>{t(),n(!1)},className:"w-full px-4 py-2 text-left text-sm text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 flex items-center gap-2",children:[e.jsx(Pr,{className:"w-4 h-4"}),"Delete User"]})]})]})]})}function me({title:r,value:a,icon:t,color:s,bgColor:n}){return e.jsx(B,{children:e.jsx(Q,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:r}),e.jsx("p",{className:`text-2xl font-bold ${s}`,children:a})]}),e.jsx("div",{className:`p-3 rounded-full ${n}`,children:e.jsx(t,{className:`w-5 h-5 ${s}`})})]})})})}function Ws(){const[r,a]=c.useState([]),[t,s]=c.useState([]),[n,o]=c.useState([]),[i,d]=c.useState([]),[l,m]=c.useState(!0),[h,x]=c.useState(""),[S,k]=c.useState("all"),[p,b]=c.useState(!1),[f,g]=c.useState(!1),[u,M]=c.useState(!1),[w,E]=c.useState(null),[R,_]=c.useState("create"),N=c.useCallback(async()=>{try{m(!0);const[A,O,F,$]=await Promise.all([Us(),Ms(),Ls(),Fs()]);a(A),s(O),o(F),d($)}catch(A){console.error("Error fetching data:",A),W(A.message||"Failed to load data")}finally{m(!1)}},[]);c.useEffect(()=>{N()},[N]);const T=c.useMemo(()=>$s(r),[r]),se=c.useMemo(()=>{let A=Is(r,h);return A=Os(A,S),A},[r,h,S]),re=async A=>{await Ts(A),he("User created successfully"),await N()},de=async A=>{w&&(await Ps(w.id,A),he("User updated successfully"),await N())},Ee=async(A,O,F)=>{await zs(A,O,F),await N()},ve=async A=>{await Ds(A),await N()},ne=()=>{E(null),_("create"),b(!0)},H=A=>{E(A),_("edit"),b(!0)},X=A=>{E(A),g(!0)},C=A=>{E(A),M(!0)},Re=A=>{var O;return A&&((O=t.find(F=>F.id===A))==null?void 0:O.name)||""},Ue=A=>{var O;return A&&((O=i.find(F=>F.id===A))==null?void 0:O.name)||""};return l?e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsxs("div",{className:"text-center",children:[e.jsx(xe,{className:"w-8 h-8 animate-spin text-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Loading users..."})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"User Management"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Manage all users, roles and permissions"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(D,{variant:"outline",onClick:N,children:[e.jsx(xe,{className:"w-4 h-4 mr-2"}),"Refresh"]}),e.jsxs(D,{onClick:ne,children:[e.jsx(St,{className:"w-4 h-4 mr-2"}),"Add User"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4",children:[e.jsx(me,{title:"Total Users",value:T.totalUsers,icon:Se,color:"text-gray-700 dark:text-gray-300",bgColor:"bg-gray-100 dark:bg-gray-800"}),e.jsx(me,{title:"Super Admins",value:T.superAdmins,icon:Rr,color:"text-red-600 dark:text-red-400",bgColor:"bg-red-100 dark:bg-red-900/30"}),e.jsx(me,{title:"Admins",value:T.admins,icon:Tr,color:"text-blue-600 dark:text-blue-400",bgColor:"bg-blue-100 dark:bg-blue-900/30"}),e.jsx(me,{title:"Section Admins",value:T.sectionAdmins,icon:K,color:"text-orange-600 dark:text-orange-400",bgColor:"bg-orange-100 dark:bg-orange-900/30"}),e.jsx(me,{title:"Regular Users",value:T.regularUsers,icon:$e,color:"text-green-600 dark:text-green-400",bgColor:"bg-green-100 dark:bg-green-900/30"}),e.jsx(me,{title:"Active (7d)",value:T.activeUsers,icon:Ot,color:"text-purple-600 dark:text-purple-400",bgColor:"bg-purple-100 dark:bg-purple-900/30"})]}),e.jsx(B,{children:e.jsx(Q,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(ar,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(ae,{placeholder:"Search by name, email, student ID or phone...",value:h,onChange:A=>x(A.target.value),className:"pl-10"})]}),e.jsxs("select",{value:S,onChange:A=>k(A.target.value),className:"h-9 px-3 border border-gray-200 dark:border-gray-800 rounded-md bg-white dark:bg-gray-950 text-sm min-w-[150px]",children:[e.jsx("option",{value:"all",children:"All Roles"}),e.jsx("option",{value:"super-admin",children:"Super Admins"}),e.jsx("option",{value:"admin",children:"Admins"}),e.jsx("option",{value:"section_admin",children:"Section Admins"}),e.jsx("option",{value:"user",children:"Users"})]})]})})}),e.jsxs(B,{children:[e.jsx(Y,{children:e.jsx(J,{className:"flex items-center justify-between",children:e.jsxs("span",{children:["Users (",se.length,")"]})})}),e.jsx(Q,{children:se.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:[e.jsx(Bt,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{className:"text-lg font-medium",children:"No users found"}),e.jsx("p",{className:"text-sm",children:"Try adjusting your search or filters"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(ir,{children:[e.jsx(lr,{children:e.jsxs(Ce,{children:[e.jsx(q,{children:"User"}),e.jsx(q,{children:"Role"}),e.jsx(q,{className:"hidden lg:table-cell",children:"Department"}),e.jsx(q,{className:"hidden md:table-cell",children:"Section"}),e.jsx(q,{className:"hidden lg:table-cell",children:"Joined"}),e.jsx(q,{className:"text-right",children:"Actions"})]})}),e.jsx(dr,{children:se.map(A=>{var F,$,ie,je,P,ke;const O=((F=ee[A.role])==null?void 0:F.icon)||$e;return e.jsxs(Ce,{children:[e.jsx(G,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ye,{className:"h-10 w-10",children:e.jsx(we,{className:"bg-blue-100 dark:bg-blue-900 text-blue-600 dark:text-blue-400",children:(($=A.name)==null?void 0:$.charAt(0).toUpperCase())||((ie=A.email)==null?void 0:ie.charAt(0).toUpperCase())})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:A.name||""}),e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400 flex items-center gap-1",children:[e.jsx(_t,{className:"w-3 h-3"}),A.email]}),A.phone&&e.jsxs("div",{className:"text-xs text-gray-400 flex items-center gap-1",children:[e.jsx(Ct,{className:"w-3 h-3"}),A.phone]})]})]})}),e.jsx(G,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(O,{className:`w-4 h-4 ${((je=ee[A.role])==null?void 0:je.color)||""}`}),e.jsx(I,{variant:((P=ee[A.role])==null?void 0:P.badgeVariant)||"secondary",children:((ke=ee[A.role])==null?void 0:ke.label)||A.role})]})}),e.jsx(G,{className:"hidden lg:table-cell text-gray-600 dark:text-gray-400",children:Re(A.department_id)}),e.jsx(G,{className:"hidden md:table-cell text-gray-600 dark:text-gray-400",children:Ue(A.section_id)}),e.jsx(G,{className:"hidden lg:table-cell text-gray-600 dark:text-gray-400",children:A.created_at?new Date(A.created_at).toLocaleDateString():""}),e.jsx(G,{className:"text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-1",children:[e.jsxs(D,{variant:"ghost",size:"sm",onClick:()=>X(A),className:"hidden sm:inline-flex",children:[e.jsx(K,{className:"w-4 h-4 mr-1"}),"Role"]}),e.jsx(D,{variant:"ghost",size:"sm",onClick:()=>H(A),className:"hidden sm:inline-flex",children:e.jsx(Ur,{className:"w-4 h-4"})}),e.jsx(D,{variant:"ghost",size:"sm",onClick:()=>C(A),className:"hidden sm:inline-flex text-red-600 hover:text-red-700 hover:bg-red-50 dark:hover:bg-red-900/20",children:e.jsx(Pr,{className:"w-4 h-4"})}),e.jsx("div",{className:"sm:hidden",children:e.jsx(Gs,{user:A,onEdit:()=>H(A),onChangeRole:()=>X(A),onDelete:()=>C(A)})})]})})]},A.id)})})]})})})]}),e.jsx(Bs,{open:p,onClose:()=>b(!1),user:w,departments:t,batches:n,sections:i,onSubmit:R==="create"?re:de,mode:R}),e.jsx(Vs,{open:f,onClose:()=>g(!1),user:w,sections:i,onRoleChange:Ee}),e.jsx(qs,{open:u,onClose:()=>M(!1),user:w,onDelete:ve})]})}function Hs(){return e.jsx(Ws,{})}function Ys(){const{admins:r,loading:a}=Be(),[t,s]=c.useState(null),[n,o]=c.useState(!0);return c.useEffect(()=>{const i=async()=>{try{o(!0);const d={totalAdmins:r.length,activeAdmins:r.filter(l=>l.isActive).length,disabledAdmins:r.filter(l=>!l.isActive).length,permissionChanges:Math.floor(Math.random()*15)+5,departmentDistribution:[],roleDistribution:[],monthlyActivity:[],permissionUsage:[],recentLogins:[],mostActiveAdmins:[],adminsByDepartment:{}};s(d)}catch(d){console.error("Error fetching stats:",d)}finally{o(!1)}};!a&&r.length>0&&i()},[r,a]),e.jsx(Ns,{stats:t,loading:n})}function Js(){const[r,a]=c.useState([]),[t,s]=c.useState(!0);return c.useEffect(()=>{(async()=>{try{s(!0);const{data:o}=await y.from("activities").select("*").order("created_at",{ascending:!1}).limit(100);if(o){const i=o.map(d=>({id:d.id,timestamp:d.created_at,adminId:d.user_id||"",adminName:"Admin",action:d.type,target:d.title,details:{description:d.title,metadata:d.metadata},ipAddress:"0.0.0.0",userAgent:"N/A",status:"success"}));a(i)}}catch(o){console.error("Error fetching logs:",o)}finally{s(!1)}})()},[]),e.jsx(As,{logs:r,loading:t})}function Ks(){const{admins:r,resetPassword:a}=Be();return e.jsx(Ss,{admins:r,onResetPassword:a})}function In(){var R;const r=ct(),a=mt(),[t,s]=c.useState("overview"),[n,o]=c.useState(!1),[i,d]=c.useState(!1),[l,m]=c.useState(!1),[h,x]=c.useState(!1),{isDark:S,toggle:k}=yt(),{logout:p,user:b}=Vt(),{refreshAdmins:f}=Be(),g=async()=>{if(!h)try{x(!0),await p(),r("/auth",{replace:!0})}catch(_){console.error("Logout failed:",_),x(!1)}};c.useEffect(()=>{const _=a.pathname,T={"/superadmin/dashboard":"overview","/superadmin/overview":"overview","/superadmin/admins":"admins","/superadmin/sectionadmins":"section-admins","/superadmin/analytics":"analytics","/superadmin/logs":"logs","/superadmin/security":"security"}[_]||"overview";s(T)},[a.pathname]);const u=_=>{s(_),r({overview:"/superadmin/dashboard",admins:"/superadmin/admins","section-admins":"/superadmin/sectionadmins",analytics:"/superadmin/analytics",logs:"/superadmin/logs",security:"/superadmin/security"}[_]||"/superadmin/dashboard",{replace:!0})};c.useEffect(()=>{const _=()=>{const N=window.innerWidth<1024;m(N),!N&&i&&d(!1)};return _(),window.addEventListener("resize",_),()=>{window.removeEventListener("resize",_)}},[i]),c.useEffect(()=>{localStorage.setItem("is_super_admin","true"),sessionStorage.setItem("is_super_admin","true"),f()},[f]);const M=()=>{switch(t){case"overview":return e.jsx(Ar,{});case"admins":return e.jsx(ks,{});case"section-admins":return e.jsx(Hs,{});case"analytics":return e.jsx(Ys,{});case"logs":return e.jsx(Js,{});case"security":return e.jsx(Ks,{});default:return e.jsx(Ar,{})}},w=()=>({overview:"Dashboard Overview",admins:"Admin Management","section-admins":"Section Admin Management",analytics:"Analytics & Reports",logs:"System Logs",security:"Security Settings"})[t]||"Dashboard",E=()=>({overview:"Monitor your system at a glance",admins:"Manage system administrators and their permissions","section-admins":"Manage section-level administrators",analytics:"View detailed analytics and performance metrics",logs:"Monitor system activities and audit logs",security:"Configure security settings and permissions"})[t]||"";return e.jsxs("div",{className:"flex h-screen bg-gray-50 dark:bg-gray-950",children:[e.jsx(Ma,{activeTab:t,onTabChange:u,isCollapsed:n,onToggleCollapse:()=>o(!n),isMobile:l,isOpen:i,onClose:()=>d(!1)}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsx("header",{className:"bg-white dark:bg-gray-900 border-b border-gray-200 dark:border-gray-800 px-4 lg:px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>d(!0),className:"lg:hidden p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg",children:e.jsx(xt,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl lg:text-2xl font-bold text-gray-900 dark:text-white",children:w()}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 hidden sm:block",children:E()})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg relative",children:[e.jsx(pt,{className:"w-5 h-5"}),e.jsx(I,{variant:"destructive",className:"absolute -top-1 -right-1 h-5 w-5 flex items-center justify-center p-0 text-[10px]",children:"3"})]}),e.jsx("button",{onClick:k,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg",children:S?e.jsx(wt,{className:"w-5 h-5"}):e.jsx(vt,{className:"w-5 h-5"})}),e.jsxs("div",{className:"hidden sm:flex items-center gap-2 pl-2 border-l border-gray-200 dark:border-gray-800",children:[e.jsx(ye,{className:"h-8 w-8",children:e.jsx(we,{className:"bg-blue-600 text-white text-sm",children:((R=b==null?void 0:b.name)==null?void 0:R.charAt(0).toUpperCase())||"SA"})}),e.jsxs("div",{className:"hidden lg:block",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:(b==null?void 0:b.name)||"Super Admin"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:b==null?void 0:b.email})]})]}),e.jsxs(D,{variant:"ghost",size:"sm",onClick:g,disabled:h,className:"gap-2",children:[e.jsx(jt,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:h?"Logging out...":"Logout"})]})]})]})}),e.jsx("main",{className:"flex-1 overflow-auto p-4 lg:p-6",children:e.jsx("div",{className:"max-w-[1600px] mx-auto",children:M()})})]})]})}export{In as SuperAdminDashboard};
