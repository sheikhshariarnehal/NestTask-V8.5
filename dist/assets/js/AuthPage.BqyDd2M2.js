import{r as e,j as t,s as a}from"./index.DUyEzeY1.js";import{A as s,a as r,b as n,c as l}from"./AuthSubmitButton.DpV3lCqU.js";import{v as o,a as i}from"./authErrors.BDay5vyW.js";import{M as d}from"./mail.BEbYoid7.js";import{L as c}from"./lock.B2p1fgFl.js";import{E as m}from"./eye-off.ChzVFykr.js";import{E as x}from"./eye.dTywk0Pb.js";import{L as u}from"./loader-2.UbVyf9s8.js";import{d as h,c as g}from"./dataCache.jSzv44up.js";import{U as b}from"./user.gx3VniMa.js";import{B as p}from"./book-open.oE9o7jYw.js";import{L as f}from"./layers.DtnpIf-b.js";import{U as y}from"./users.BxhcDxnH.js";import{c as j}from"./createLucideIcon.DoJe9V_e.js";import{C as w}from"./check-circle-2.BXqMUJ7E.js";const v=j("MailCheck",[["path",{d:"M22 13V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v12c0 1.1.9 2 2 2h8",key:"12jkf8"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}],["path",{d:"m16 19 2 2 4-4",key:"1b14m6"}]]);function k({onSubmit:a,onSwitchToSignup:l,onForgotPassword:h,error:g}){const[b,p]=e.useState({email:"",password:""}),[f,y]=e.useState(!1),[j,w]=e.useState(null),[v,k]=e.useState({email:!1,password:!1}),[N,S]=e.useState(!1),[I,C]=e.useState(!0),P=(e,t)=>{p((a=>({...a,[e]:t}))),k((t=>({...t,[e]:!0}))),w(null)};return t.jsxs("div",{className:"w-full animate-in fade-in slide-in-from-bottom-4 duration-500",children:[t.jsxs("div",{className:"mb-10 text-center",children:[t.jsx("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 dark:text-white tracking-tight",children:"Welcome back"}),t.jsx("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:"Please enter your details to sign in."})]}),(g||j)&&t.jsx(s,{message:g||j||""}),t.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),w(null),o(b.email)?i(b.password)||(w("Password must be at least 6 characters long"),0):(w("Please enter a valid email address"),0)){y(!0);try{await a(b,I)}catch(t){w(t.message)}finally{y(!1)}}},className:"space-y-5",children:[t.jsx(r,{type:"email",value:b.email,onChange:e=>P("email",e),label:"Email",placeholder:"Enter your email",icon:d,error:v.email&&!o(b.email)?"Please enter a valid email":"",autocomplete:"username email",inputMode:"email"}),t.jsx(r,{type:N?"text":"password",value:b.password,onChange:e=>P("password",e),label:"Password",placeholder:"Enter your password",icon:c,error:v.password&&!i(b.password)?"Password must be at least 6 characters":"",autocomplete:"current-password",rightElement:t.jsx("button",{type:"button",className:"text-gray-400 hover:text-gray-500 transition-colors",onClick:()=>S(!N),tabIndex:-1,children:N?t.jsx(m,{className:"w-4 h-4"}):t.jsx(x,{className:"w-4 h-4"})})}),t.jsxs("div",{className:"flex items-center justify-between text-sm",children:[t.jsxs("label",{className:"flex items-center cursor-pointer group",children:[t.jsxs("div",{className:"relative flex items-center",children:[t.jsx("input",{type:"checkbox",checked:I,onChange:e=>C(e.target.checked),className:"peer sr-only"}),t.jsx("div",{className:"w-5 h-5 border-2 border-gray-300 dark:border-gray-600 rounded transition-colors peer-checked:bg-blue-600 peer-checked:border-blue-600 peer-focus:ring-2 peer-focus:ring-blue-500/20"}),t.jsx("svg",{className:"absolute w-3 h-3 text-white left-1 top-1 opacity-0 peer-checked:opacity-100 transition-opacity pointer-events-none",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"3",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})})]}),t.jsx("span",{className:"ml-2 text-gray-600 dark:text-gray-400 group-hover:text-gray-900 dark:group-hover:text-gray-200 transition-colors",children:"Remember me"})]}),t.jsx("button",{type:"button",onClick:h,className:"text-blue-600 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-300 font-medium transition-colors",children:"Forgot password?"})]}),t.jsx(n,{label:f?"Signing in...":"Sign in",isLoading:f,icon:f?u:void 0})]}),t.jsxs("div",{className:"mt-6 flex items-center justify-center space-x-1 text-sm text-gray-600 dark:text-gray-400",children:[t.jsx("span",{children:"Don't have an account?"}),t.jsx("button",{type:"button",onClick:l,className:"text-blue-600 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-300 font-medium transition-colors",children:"Sign up"})]})]})}const N=({label:a,value:s,onChange:r,options:n,placeholder:l,icon:o,error:i,disabled:d})=>{const c=e.useMemo((()=>n.map((e=>t.jsx("option",{value:e.id,children:e.name},e.id)))),[n]);return t.jsxs("div",{className:"space-y-1.5",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:a}),t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none z-10",children:t.jsx(o,{className:"h-5 w-5 text-gray-400 dark:text-gray-500"})}),t.jsxs("select",{value:s,onChange:e=>r(e.target.value),disabled:d,className:`block w-full pl-10 pr-8 py-2.5 rounded-lg border transition-all duration-200 ${i?"border-red-300 dark:border-red-500/50 bg-red-50/30 dark:bg-red-900/10 focus:ring-2 focus:ring-red-100 focus:border-red-500":"border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800/50 hover:border-gray-300 dark:hover:border-gray-600 focus:ring-2 focus:ring-blue-50 focus:border-blue-500 dark:focus:ring-blue-900/20"} text-gray-900 dark:text-gray-100 text-sm\n          disabled:bg-gray-50 dark:disabled:bg-gray-800 disabled:text-gray-400 dark:disabled:text-gray-500 \n          disabled:cursor-not-allowed cursor-pointer appearance-none`,children:[t.jsx("option",{value:"",disabled:!0,children:l}),c]}),t.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none",children:t.jsx("svg",{className:"h-5 w-5 text-gray-400",viewBox:"0 0 20 20",fill:"currentColor",children:t.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})})]}),i&&t.jsx("p",{className:"mt-1 text-xs text-red-600 dark:text-red-400",children:i})]})};function S({onSubmit:l,onSwitchToLogin:m,error:x}){var j,w,v;const[k,S]=e.useState({name:"",email:"",password:"",phone:"",studentId:"",departmentId:"",batchId:"",sectionId:""}),[I,C]=e.useState(!1),[P,E]=e.useState(null),[L,F]=e.useState({name:!1,email:!1,password:!1,phone:!1,studentId:!1,departmentId:!1,batchId:!1,sectionId:!1}),[T,A]=e.useState([]),[M,_]=e.useState([]),[B,O]=e.useState([]),[D,z]=e.useState(!1),[R,W]=e.useState(!1),[q,U]=e.useState(!1);e.useEffect((()=>{let e=!0;return async function(){z(!0);try{const t=await async function(){return h.getOrFetch(g.departments(),(async()=>{const{data:e,error:t}=await a.from("departments").select("*").order("name");if(t)throw console.error("Error fetching departments:",t),new Error("Failed to fetch departments");return(e||[]).map((e=>({id:e.id,name:e.name,createdAt:e.created_at})))}),6e5)}();e&&A(t)}catch(t){console.error("Error loading departments:",t),e&&E("Failed to load departments. Please try again.")}finally{e&&z(!1)}}(),()=>{e=!1}}),[]),e.useEffect((()=>{if(!k.departmentId)return void _([]);let e=!0;return async function(){W(!0);try{const t=await async function(e){return h.getOrFetch(g.batches(e),(async()=>{const{data:t,error:s}=await a.from("batches").select("*").eq("department_id",e).order("name");if(s)throw console.error("Error fetching batches:",s),new Error("Failed to fetch batches");return(t||[]).map((e=>({id:e.id,name:e.name,departmentId:e.department_id,createdAt:e.created_at})))}),6e5)}(k.departmentId||"");e&&_(t)}catch(t){console.error("Error loading batches:",t),e&&E("Failed to load batches. Please try again.")}finally{e&&W(!1)}}(),S((e=>({...e,batchId:"",sectionId:""}))),O([]),()=>{e=!1}}),[k.departmentId]),e.useEffect((()=>{if(!k.batchId)return void O([]);let e=!0;return async function(){U(!0);try{const t=await async function(e){return h.getOrFetch(g.sections(e),(async()=>{try{const{data:t,error:s}=await a.from("sections").select("*").eq("batch_id",e).order("name");if(s)throw s;return(t||[]).map((e=>({id:e.id,name:e.name,batchId:e.batch_id,createdAt:e.created_at})))}catch(x){throw console.error("Error fetching sections:",x),new Error("Failed to fetch sections")}}),6e5)}(k.batchId||"");e&&O(t)}catch(t){console.error("Error loading sections:",t),e&&E("Failed to load sections. Please try again.")}finally{e&&U(!1)}}(),S((e=>({...e,sectionId:""}))),()=>{e=!1}}),[k.batchId]);const Y=e.useCallback((()=>k.name.trim()?o(k.email)?i(k.password)?k.departmentId?k.batchId?!!k.sectionId||(E("Please select your section"),!1):(E("Please select your batch"),!1):(E("Please select your department"),!1):(E("Password must be at least 6 characters long"),!1):(E("Please enter a valid email address"),!1):(E("Name is required"),!1)),[k]),H=e.useCallback(((e,t)=>{S((a=>({...a,[e]:t}))),F((t=>({...t,[e]:!0}))),E(null)}),[]),J=e.useMemo((()=>({name:L.name&&!k.name.trim()?"Name is required":"",email:L.email&&!o(k.email)?"Please enter a valid email":"",password:L.password&&!i(k.password)?"Password must be at least 6 characters":"",departmentId:L.departmentId&&!k.departmentId?"Please select your department":"",batchId:L.batchId&&!k.batchId&&k.departmentId?"Please select your batch":"",sectionId:L.sectionId&&!k.sectionId&&k.batchId?"Please select your section":""})),[L,k]);return t.jsxs("div",{className:"w-full animate-in fade-in slide-in-from-bottom-4 duration-500",children:[t.jsxs("div",{className:"mb-10 text-center",children:[t.jsx("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 dark:text-white tracking-tight",children:"Create Account"}),t.jsx("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:"Join our community and start managing your tasks"})]}),(x||P)&&t.jsx(s,{message:x||P||""}),t.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),E(null),Y()){C(!0);try{await l(k)}catch(t){E(t.message)}finally{C(!1)}}},className:"space-y-4",children:[t.jsx(r,{type:"text",value:k.name,onChange:e=>H("name",e),label:"Full Name",placeholder:"Enter your full name",icon:b,error:J.name}),t.jsx(r,{type:"email",value:k.email,onChange:e=>H("email",e),label:"Email",placeholder:"Enter your email",icon:d,error:J.email,inputMode:"email"}),t.jsx(N,{label:"Department",value:null!=(j=k.departmentId)?j:"",onChange:e=>H("departmentId",e),options:T,placeholder:D?"Loading departments...":"Select your department",icon:p,disabled:D,error:J.departmentId}),k.departmentId&&t.jsx("div",{className:"animate-in fade-in slide-in-from-top-2 duration-300",children:t.jsx(N,{label:"Batch",value:null!=(w=k.batchId)?w:"",onChange:e=>H("batchId",e),options:M,placeholder:R?"Loading batches...":"Select your batch",icon:f,disabled:R,error:J.batchId})}),k.batchId&&t.jsx("div",{className:"animate-in fade-in slide-in-from-top-2 duration-300",children:t.jsx(N,{label:"Section",value:null!=(v=k.sectionId)?v:"",onChange:e=>H("sectionId",e),options:B,placeholder:q?"Loading sections...":"Select your section",icon:y,disabled:q,error:J.sectionId})}),t.jsx(r,{type:"password",value:k.password,onChange:e=>H("password",e),label:"Password",placeholder:"Choose a password (min. 6 characters)",icon:c,error:J.password}),t.jsx("div",{className:"pt-2",children:t.jsx(n,{label:I?"Creating account...":"Create account",isLoading:I,icon:I?u:void 0})})]}),t.jsxs("div",{className:"mt-6 text-center text-sm",children:[t.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Already have an account? "}),t.jsx("button",{type:"button",onClick:m,className:"font-semibold text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 transition-colors",children:"Sign in"})]})]})}function I({onSubmit:a,onBackToLogin:i,error:c}){const[m,x]=e.useState(""),[h,g]=e.useState(!1),[b,p]=e.useState(null),[f,y]=e.useState(null),[j,w]=e.useState({email:!1});return t.jsx("div",{className:"w-full animate-in fade-in slide-in-from-bottom-4 duration-500",children:f?t.jsxs("div",{className:"text-center py-5",children:[t.jsx("div",{className:"inline-flex items-center justify-center p-4 bg-green-50 dark:bg-green-900/20 rounded-full mb-6 ring-8 ring-green-50/50 dark:ring-green-900/10",children:t.jsx(v,{className:"w-12 h-12 text-green-600 dark:text-green-400"})}),t.jsx("h3",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Check your inbox"}),t.jsxs("p",{className:"mb-8 text-gray-600 dark:text-gray-400 leading-relaxed",children:["We've sent a password reset link to ",t.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:m||"your email"}),". Please check your inbox and follow the instructions."]}),t.jsxs("div",{className:"flex flex-col gap-3",children:[t.jsx("button",{type:"button",onClick:()=>window.open("mailto:","_blank"),className:"w-full inline-flex items-center justify-center px-4 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-semibold transition-colors",children:"Open Email App"}),t.jsx("button",{type:"button",onClick:()=>y(null),className:"w-full inline-flex items-center justify-center px-4 py-3 bg-gray-100 hover:bg-gray-200 dark:bg-gray-800 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg font-medium transition-colors",children:"Try another email"}),t.jsxs("button",{type:"button",onClick:i,className:"mt-4 inline-flex items-center justify-center text-sm text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 transition-colors",children:[t.jsx(l,{className:"w-4 h-4 mr-1"}),"Back to Login"]})]})]}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"mb-10 text-center",children:[t.jsxs("button",{type:"button",onClick:i,className:"inline-flex items-center text-sm text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 mb-6 transition-colors",children:[t.jsx(l,{className:"w-4 h-4 mr-1"}),"Back"]}),t.jsx("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 dark:text-white tracking-tight",children:"Forgot Password?"}),t.jsx("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:"No worries, we'll send you reset instructions."})]}),(c||b)&&t.jsx(s,{message:c||b||""}),t.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),p(null),y(null),o(m)||(p("Please enter a valid email address"),0)){g(!0);try{await a(m),y("Password reset link sent to your email"),x("")}catch(t){p(t.message)}finally{g(!1)}}},className:"space-y-5",children:[t.jsx(r,{type:"email",value:m,onChange:e=>{x(e),w((e=>({...e,email:!0}))),p(null)},label:"Email",placeholder:"Enter your email",icon:d,error:j.email&&!o(m)?"Please enter a valid email":"",inputMode:"email"}),t.jsx(n,{label:h?"Sending...":"Send Reset Link",isLoading:h,icon:h?u:void 0})]})]})})}function C({onLogin:a,onSignup:s,onForgotPassword:r,error:n}){const[l,o]=e.useState("login");return t.jsxs("div",{className:"h-screen w-full flex bg-gray-50 dark:bg-gray-900 overflow-hidden",children:[t.jsxs("div",{className:"hidden lg:flex lg:w-1/2 relative bg-blue-600 overflow-hidden",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-600 to-indigo-900"}),t.jsx("div",{className:"absolute inset-0 opacity-10 mix-blend-overlay",children:t.jsxs("svg",{className:"w-full h-full",viewBox:"0 0 100 100",preserveAspectRatio:"none",xmlns:"http://www.w3.org/2000/svg",children:[t.jsx("defs",{children:t.jsx("pattern",{id:"grid",width:"10",height:"10",patternUnits:"userSpaceOnUse",children:t.jsx("circle",{cx:"1",cy:"1",r:"1",fill:"white",opacity:"0.3"})})}),t.jsx("rect",{width:"100",height:"100",fill:"url(#grid)"})]})}),t.jsx("div",{className:"absolute top-0 left-0 -translate-x-1/2 -translate-y-1/2 w-96 h-96 bg-white/10 rounded-full blur-3xl"}),t.jsx("div",{className:"absolute bottom-0 right-0 translate-x-1/2 translate-y-1/2 w-96 h-96 bg-indigo-500/20 rounded-full blur-3xl"}),t.jsxs("div",{className:"relative z-10 flex flex-col justify-between h-full p-16 text-white",children:[t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-2 mb-12",children:[t.jsx("img",{src:"/icons/icon-512x512.png",alt:"NestTask Logo",className:"w-[30px] h-[30px] rounded-lg shadow-lg shrink-0 object-contain"}),t.jsx("span",{className:"text-3xl font-bold tracking-tight text-white leading-none",children:"NestTask"})]}),t.jsxs("h1",{className:"text-5xl font-bold leading-tight mb-6 tracking-tight",children:["Manage your academic ",t.jsx("br",{}),t.jsx("span",{className:"text-blue-200",children:"journey with ease."})]}),t.jsx("p",{className:"text-lg text-blue-100 max-w-md leading-relaxed",children:"Streamline your tasks, track your progress, and collaborate with peers in one unified platform designed for students."})]}),t.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[t.jsxs("div",{className:"flex items-center gap-4 p-4 rounded-2xl bg-white/8 border border-white/5 hover:bg-white/10 transition-colors duration-300",children:[t.jsx("div",{className:"p-2 bg-blue-500/20 rounded-lg",children:t.jsx(w,{className:"w-6 h-6 text-blue-200"})}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-semibold text-white",children:"Task Tracking"}),t.jsx("p",{className:"text-sm text-blue-200",children:"Stay on top of assignments and deadlines"})]})]}),t.jsxs("div",{className:"flex items-center gap-4 p-4 rounded-2xl bg-white/8 border border-white/5 hover:bg-white/10 transition-colors duration-300",children:[t.jsx("div",{className:"p-2 bg-blue-500/20 rounded-lg",children:t.jsx(y,{className:"w-6 h-6 text-blue-200"})}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-semibold text-white",children:"Collaboration"}),t.jsx("p",{className:"text-sm text-blue-200",children:"Work together with classmates seamlessly"})]})]})]}),t.jsxs("div",{className:"text-sm text-blue-200/60",children:["Â© ",(new Date).getFullYear()," NestTask. All rights reserved."]})]})]}),t.jsx("div",{className:"flex-1 flex flex-col h-full bg-white dark:bg-gray-900 relative",children:t.jsx("div",{className:"absolute inset-0 overflow-y-auto safe-area-inset-bottom",children:t.jsx("div",{className:"min-h-full flex flex-col justify-center py-6 sm:py-12 px-4 sm:px-6 lg:px-20 xl:px-24",children:t.jsxs("div",{className:"mx-auto w-full max-w-md",children:["login"===l&&t.jsx("div",{className:"lg:hidden flex flex-col items-center mb-8 sm:mb-10",children:t.jsxs("div",{className:"flex items-center justify-center gap-2 mb-2",children:[t.jsx("img",{src:"/icons/icon-512x512.png",alt:"NestTask Logo",className:"w-[30px] h-[30px] rounded-lg shrink-0 object-contain"}),t.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white tracking-tight leading-none",children:"NestTask"})]})}),"login"===l&&t.jsx(k,{onSubmit:a,onSwitchToSignup:()=>o("signup"),onForgotPassword:()=>o("forgot-password"),error:n}),"signup"===l&&t.jsx(S,{onSubmit:s,onSwitchToLogin:()=>o("login"),error:n}),"forgot-password"===l&&t.jsx(I,{onSubmit:r,onBackToLogin:()=>o("login"),error:n})]})})})})]})}const P=Object.freeze(Object.defineProperty({__proto__:null,AuthPage:C},Symbol.toStringTag,{value:"Module"}));export{C as A,v as M,P as a};
