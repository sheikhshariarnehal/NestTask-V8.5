import{r as e,j as t}from"./index.CZiJqP2g.js";import{S as r}from"./search.C-HZM20f.js";import{A as a}from"./alert-triangle.DBcKatJw.js";import{T as s}from"./trash-2.DKyCgRC-.js";import"./createLucideIcon.Chj3Q81j.js";function d({users:d,onDeleteUser:i,onPromoteUser:l,onDemoteUser:n,isSectionAdmin:o=!1,isLoading:c=!1}){const[x,m]=e.useState(null),[g,u]=e.useState(!1),[y,h]=e.useState(null),[p,b]=e.useState(null),[f,w]=e.useState(""),k=e=>"section_admin"===e,j=d.filter((e=>{var t,r,a;return(null==(t=e.name)?void 0:t.toLowerCase().includes(f.toLowerCase()))||e.email.toLowerCase().includes(f.toLowerCase())||e.role.toLowerCase().includes(f.toLowerCase())||(null==(r=e.sectionName)?void 0:r.toLowerCase().includes(f.toLowerCase()))||(null==(a=e.sectionId)?void 0:a.toLowerCase().includes(f.toLowerCase()))})),N=o?j.filter((e=>{var t;return e.sectionId===(null==(t=d.find((e=>k(e.role))))?void 0:t.sectionId)})):j;return c?t.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-md p-8 text-center",children:t.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Loading users..."})}):t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-md overflow-hidden",children:[t.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:t.jsxs("div",{className:"relative",children:[t.jsx(r,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),t.jsx("input",{type:"text",placeholder:"Search users...",value:f,onChange:e=>w(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100"})]})}),p&&t.jsx("div",{className:"p-4 bg-red-50 dark:bg-red-900/20 border-l-4 border-red-500",children:t.jsxs("div",{className:"flex",children:[t.jsx(a,{className:"h-5 w-5 text-red-500 mr-2"}),t.jsx("p",{className:"text-sm text-red-700 dark:text-red-400",children:p})]})}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[t.jsx("thead",{className:"bg-gray-50 dark:bg-gray-750",children:t.jsxs("tr",{children:[t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Name"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Email"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Section"}),t.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Role"}),t.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Actions"})]})}),t.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:0===N.length?t.jsx("tr",{children:t.jsx("td",{colSpan:5,className:"px-6 py-4 text-center text-sm text-gray-500 dark:text-gray-400",children:"No users found"})}):N.map((e=>{var r;return t.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-750",children:[t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white",children:e.name||"N/A"}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:e.email}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:e.sectionName||(e.sectionId?`Section ${e.sectionId}`:"N/A")}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:t.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium "+("admin"===e.role?"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400":k(e.role)?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400":"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"),children:"admin"===e.role?"Admin":k(e.role)?"Section Admin":"User"})}),t.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:t.jsx("button",{onClick:()=>(e=>{const t=d.find((e=>k(e.role)));o&&e.sectionId!==(null==t?void 0:t.sectionId)?b("You can only delete users from your own section"):"admin"===e.role||"super-admin"===e.role||k(e.role)?b("You cannot delete administrators"):(h(e),u(!0),b(null))})(e),disabled:x===e.id||"admin"===e.role||"super-admin"===e.role||k(e.role)||o&&e.sectionId!==(null==(r=d.find((e=>k(e.role))))?void 0:r.sectionId),className:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300 disabled:opacity-50 disabled:cursor-not-allowed",children:t.jsx(s,{className:"h-5 w-5"})})})]},e.id)}))})]})}),g&&y&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg max-w-md w-full p-6",children:[t.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Delete User"}),t.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-4",children:["Are you sure you want to delete ",y.name||y.email,"? This action cannot be undone."]}),t.jsxs("div",{className:"flex justify-end gap-3",children:[t.jsx("button",{onClick:()=>{u(!1),h(null),b(null)},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white dark:bg-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Cancel"}),t.jsx("button",{onClick:async()=>{if(y)try{m(y.id),b(null),await i(y.id)}catch(e){b(e.message||"Failed to delete user")}finally{m(null),u(!1),h(null)}},disabled:x===y.id,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50",children:x===y.id?"Deleting...":"Delete"})]})]})})]})}export{d as UserList};
