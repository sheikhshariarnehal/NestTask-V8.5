const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/App.BH-g27D-.js","assets/js/index.D9Cz7xb0.js","assets/css/index.KrsTFQ0K.css","assets/js/index.BYtOk-W4.js","assets/js/index.DwuHo8dx.js","assets/js/useAuth.C-Vnm_W3.js","assets/js/dataCache.kYzFa4l-.js","assets/js/authErrors.BDay5vyW.js","assets/js/useTasks.BhhQYTjI.js","assets/js/telegram.service.BTr96-Tu.js","assets/js/dateUtils.8XYiGfWV.js","assets/js/AuthPage.B6IG-Pus.js","assets/js/AuthSubmitButton.DCAMkRwr.js","assets/js/createLucideIcon.nRTHO_rG.js","assets/js/alert-circle.Dp3YgBan.js","assets/js/mail.2zrFvU8Y.js","assets/js/lock.C1uj8xMS.js","assets/js/eye-off.wCpGEVaz.js","assets/js/eye.CWEvF3cC.js","assets/js/loader-2.Ck7Yi2Jx.js","assets/js/user.B039-XZ6.js","assets/js/book-open.DpLNG5gg.js","assets/js/layers.DIftaLHX.js","assets/js/users.DRczl-Km.js","assets/js/check-circle-2.BPQfQN80.js","assets/js/x.CnGBzzfj.js","assets/js/bell.CDwyY-RP.js","assets/js/smartphone.DfqYnVuA.js","assets/js/sun.BsRL2n3-.js","assets/js/shield.Bhs1y4jo.js","assets/js/chevron-right.Be6oAfn6.js","assets/js/calendar.BGMblVK0.js","assets/js/clock.CXFN-6Np.js","assets/js/search.bZ6nILxl.js","assets/js/ResetPasswordPage.BPCdIBnM.js","assets/js/shield-check.CBeLHU-x.js","assets/js/linkParser.CRNpH1Sh.js","assets/js/googleDriveUtils.C6Pv_b1m.js","assets/js/file-text.CgYpOND9.js","assets/js/link.DqKHFnou.js","assets/js/tag.IHEp_7C-.js","assets/js/copy.C6Y0lhR8.js","assets/js/download.CMz9Hfi9.js","assets/js/list-todo.BLufov7V.js"])))=>i.map(i=>d[i]);
import{r as e,_ as t,R as r,j as a}from"./index.D9Cz7xb0.js";import{a as s}from"./useTasks.BhhQYTjI.js";import{u as l}from"./useAuth.C-Vnm_W3.js";import{t as d,m as n,a as o,c as i,s as c,f as m,F as u}from"./App.BH-g27D-.js";import{P as g}from"./googleDriveUtils.C6Pv_b1m.js";import{C as x}from"./calendar.BGMblVK0.js";import{a as b}from"./addDays.Dmewymqe.js";import{C as p}from"./check-circle-2.BPQfQN80.js";import{A as h}from"./alert-circle.Dp3YgBan.js";import{C as y}from"./clock.CXFN-6Np.js";import{B as k}from"./book-open.DpLNG5gg.js";import{P as f,F as j}from"./pen-tool.1EMmkJzB.js";import{F as w}from"./file-text.CgYpOND9.js";import{G as N}from"./graduation-cap.BMIioroo.js";import{A as v}from"./activity.BXhHRHPR.js";import{B as D}from"./building.D6WGZnRo.js";import{U as T}from"./users.DRczl-Km.js";import{T as S}from"./tag.IHEp_7C-.js";import"./telegram.service.BTr96-Tu.js";import"./dateUtils.8XYiGfWV.js";import"./dataCache.kYzFa4l-.js";import"./authErrors.BDay5vyW.js";import"./index.BYtOk-W4.js";import"./index.DwuHo8dx.js";import"./AuthPage.B6IG-Pus.js";import"./AuthSubmitButton.DCAMkRwr.js";import"./createLucideIcon.nRTHO_rG.js";import"./mail.2zrFvU8Y.js";import"./lock.C1uj8xMS.js";import"./eye-off.wCpGEVaz.js";import"./eye.CWEvF3cC.js";import"./loader-2.Ck7Yi2Jx.js";import"./user.B039-XZ6.js";import"./layers.DIftaLHX.js";import"./x.CnGBzzfj.js";import"./bell.CDwyY-RP.js";import"./smartphone.DfqYnVuA.js";import"./sun.BsRL2n3-.js";import"./shield.Bhs1y4jo.js";import"./chevron-right.Be6oAfn6.js";import"./search.bZ6nILxl.js";import"./ResetPasswordPage.BPCdIBnM.js";import"./shield-check.CBeLHU-x.js";import"./linkParser.CRNpH1Sh.js";import"./link.DqKHFnou.js";import"./copy.C6Y0lhR8.js";import"./download.CMz9Hfi9.js";import"./list-todo.BLufov7V.js";function C(e,t){const r=d(e,null==t?void 0:t.in);return r.setHours(23,59,59,999),r}function $(e,t){return+d(e)<+d(t)}function M(e,t){const r=()=>i(null==t?void 0:t.in,NaN),a=function(e){const t={},r=e.split(A.dateTimeDelimiter);let a;if(r.length>2)return t;if(/:/.test(r[0])?a=r[0]:(t.date=r[0],a=r[1],A.timeZoneDelimiter.test(t.date)&&(t.date=e.split(A.timeZoneDelimiter)[0],a=e.substr(t.date.length,e.length))),a){const e=A.timezone.exec(a);e?(t.time=a.replace(e[1],""),t.timezone=e[1]):t.time=a}return t}(e);let s;if(a.date){const e=function(e){const t=new RegExp("^(?:(\\d{4}|[+-]\\d{6})|(\\d{2}|[+-]\\d{4})$)"),r=e.match(t);if(!r)return{year:NaN,restDateString:""};const a=r[1]?parseInt(r[1]):null,s=r[2]?parseInt(r[2]):null;return{year:null===s?a:100*s,restDateString:e.slice((r[1]||r[2]).length)}}(a.date);s=function(e,t){if(null===t)return new Date(NaN);const r=e.match(U);if(!r)return new Date(NaN);const a=!!r[4],s=I(r[1]),l=I(r[2])-1,d=I(r[3]),n=I(r[4]),o=I(r[5])-1;if(a)return function(e,t,r){return t>=1&&t<=53&&r>=0&&r<=6}(0,n,o)?function(e,t,r){const a=new Date(0);a.setUTCFullYear(e,0,4);const s=7*(t-1)+r+1-(a.getUTCDay()||7);return a.setUTCDate(a.getUTCDate()+s),a}(t,n,o):new Date(NaN);{const e=new Date(0);return function(e,t,r){return t>=0&&t<=11&&r>=1&&r<=(F[t]||(L(e)?29:28))}(t,l,d)&&function(e,t){return t>=1&&t<=(L(e)?366:365)}(t,s)?(e.setUTCFullYear(t,l,Math.max(s,d)),e):new Date(NaN)}}(e.restDateString,e.year)}if(!s||isNaN(+s))return r();const l=+s;let c,m=0;if(a.time&&(m=function(e){const t=e.match(E);if(!t)return NaN;const r=P(t[1]),a=P(t[2]),s=P(t[3]);return function(e,t,r){return 24===e?0===t&&0===r:r>=0&&r<60&&t>=0&&t<60&&e>=0&&e<25}(r,a,s)?r*n+a*o+1e3*s:NaN}(a.time),isNaN(m)))return r();if(!a.timezone){const e=new Date(l+m),r=d(0,null==t?void 0:t.in);return r.setFullYear(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()),r.setHours(e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds()),r}return c=function(e){if("Z"===e)return 0;const t=e.match(z);if(!t)return 0;const r="+"===t[1]?-1:1,a=parseInt(t[2]),s=t[3]&&parseInt(t[3])||0;return function(e,t){return t>=0&&t<=59}(0,s)?r*(a*n+s*o):NaN}(a.timezone),isNaN(c)?r():d(l+m+c,null==t?void 0:t.in)}const A={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},U=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,E=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,z=/^([+-])(\d{2})(?::?(\d{2}))?$/;function I(e){return e?parseInt(e):1}function P(e){return e&&parseFloat(e.replace(",","."))||0}const F=[31,null,31,30,31,30,31,31,30,31,30,31];function L(e){return e%400==0||e%4==0&&e%100!=0}const _=new Map,R=(e,t)=>{const r=`${e.getTime()}_${t}`;if(!_.has(r)&&(_.set(r,m(e,t)),_.size>100)){const e=_.keys().next().value;e&&_.delete(e)}return _.get(r)},Y=e.lazy((()=>t((()=>import("./App.BH-g27D-.js").then((e=>e.J))),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43])).then((e=>({default:e.TaskDetailsPopup}))))),Z=e.lazy((()=>t((()=>import("./App.BH-g27D-.js").then((e=>e.I))),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43])).then((e=>({default:e.MonthlyCalendar}))))),B=r.memo((()=>a.jsx("div",{className:"px-3 xs:px-4 md:max-w-4xl lg:max-w-5xl md:mx-auto pb-8",children:a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 md:gap-4",children:Array.from({length:6}).map(((e,t)=>a.jsxs("div",{className:"relative overflow-hidden bg-white dark:bg-gray-800/90 rounded-lg shadow-sm border border-gray-100 dark:border-gray-700/50 border-l-[3px] border-l-blue-300 dark:border-l-blue-600",style:{animationDelay:100*t+"ms"},children:[a.jsxs("div",{className:"p-4 h-full flex flex-col",children:[a.jsx("div",{className:"mb-2",children:a.jsx("div",{className:"h-5 bg-gray-200 dark:bg-gray-700 rounded w-1/3 animate-pulse"})}),a.jsx("div",{className:"mb-4",children:a.jsx("div",{className:"h-3.5 bg-gray-200 dark:bg-gray-700 rounded w-full animate-pulse",style:{animationDelay:"100ms"}})}),a.jsxs("div",{className:"flex items-center justify-between pt-2 mt-auto",children:[a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("div",{className:"w-3.5 h-3.5 bg-gray-200 dark:bg-gray-700 rounded animate-pulse"}),a.jsx("div",{className:"h-3 bg-gray-200 dark:bg-gray-700 rounded w-16 animate-pulse",style:{animationDelay:"150ms"}})]}),a.jsx("div",{className:"h-5 bg-blue-100 dark:bg-blue-900/30 rounded-md px-2.5 py-0.5 w-24 animate-pulse",style:{animationDelay:"250ms"}})]})]}),a.jsx("div",{className:"absolute inset-0 -translate-x-full animate-shimmer bg-gradient-to-r from-transparent via-white/10 dark:via-gray-400/5 to-transparent"})]},t)))})}))),O=r.memo((()=>a.jsxs("div",{className:"max-w-full md:max-w-5xl mx-auto px-2 md:px-6 mb-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("div",{className:"w-9 h-9 bg-gray-200 dark:bg-gray-700 rounded-lg animate-pulse"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-4 h-4 bg-gray-200 dark:bg-gray-700 rounded animate-pulse"}),a.jsx("div",{className:"h-5 w-28 bg-gray-200 dark:bg-gray-700 rounded animate-pulse"})]}),a.jsx("div",{className:"w-9 h-9 bg-gray-200 dark:bg-gray-700 rounded-lg animate-pulse"})]}),a.jsx("div",{className:"pb-4",children:a.jsx("div",{className:"grid grid-cols-7 gap-2 md:gap-3 px-2 md:px-4",children:Array.from({length:7}).map(((e,t)=>a.jsxs("div",{className:"flex flex-col items-center justify-center h-16 sm:h-20 md:h-24 w-full p-2 md:p-3 rounded-lg animate-pulse "+(3===t?"bg-blue-500/80":"bg-gray-200 dark:bg-gray-700"),style:{animationDelay:50*t+"ms"},children:[a.jsx("div",{className:"w-6 h-2.5 rounded mb-1 "+(3===t?"bg-blue-200":"bg-gray-300 dark:bg-gray-600")}),a.jsx("div",{className:"w-7 h-7 rounded "+(3===t?"bg-blue-200":"bg-gray-300 dark:bg-gray-600")})]},t)))})})]})));e.memo((({day:e,onClick:t})=>a.jsxs("button",{onClick:t,className:`\n        relative group\n        flex flex-col items-center justify-center\n        w-full aspect-square\n        p-1 sm:p-1.5 md:p-3 lg:p-4 rounded-lg sm:rounded-xl \n        border transition-all duration-200\n        ${e.isSelected?"bg-gradient-to-br from-blue-500 via-indigo-500 to-purple-600 border-blue-400/50 shadow-md shadow-blue-500/20 dark:shadow-blue-600/20 scale-[1.02] -translate-y-0.5 md:scale-105":e.isToday?"bg-gradient-to-br from-blue-100 via-indigo-50 to-purple-50 border-blue-200/70 dark:from-blue-900/50 dark:via-indigo-900/40 dark:to-purple-900/50 dark:border-blue-700/50":"bg-white/90 dark:bg-gray-800/90 border-gray-200/50 dark:border-gray-700/50"}\n        hover:shadow-md hover:-translate-y-0.5\n        hover:border-blue-300/70 dark:hover:border-blue-600/70\n        active:scale-95 touch-manipulation\n        md:hover:shadow-lg md:hover:-translate-y-1\n      `,children:[a.jsx("span",{className:`\n        text-[10px] sm:text-xs md:text-sm font-semibold tracking-wide\n        transition-colors duration-200\n        ${e.isSelected?"text-blue-100":e.isToday?"text-blue-600/90 dark:text-blue-400":"text-gray-500 group-hover:text-blue-500 dark:text-gray-400 dark:group-hover:text-blue-400"}\n        mb-0.5 sm:mb-1 md:mb-2\n      `,children:e.weekDay}),a.jsx("span",{className:`\n        text-base sm:text-lg md:text-3xl lg:text-4xl font-bold \n        transition-colors duration-200\n        ${e.isSelected?"text-white":e.isToday?"text-blue-600/90 dark:text-blue-400":"text-gray-700 group-hover:text-blue-600 dark:text-gray-300 dark:group-hover:text-blue-400"}\n      `,children:e.day}),e.isToday&&!e.isSelected&&a.jsx("div",{className:"absolute -bottom-0.5 left-1/2 transform -translate-x-1/2",children:a.jsx("div",{className:"w-1 h-1 sm:w-1.5 sm:h-1.5 md:w-2 md:h-2 rounded-full bg-gradient-to-r from-blue-500 to-indigo-500 dark:from-blue-400 dark:to-indigo-400 animate-pulse shadow-lg shadow-blue-500/50"})}),e.isSelected&&a.jsx("div",{className:"absolute inset-0 rounded-lg sm:rounded-xl ring-2 ring-blue-400/40 dark:ring-blue-500/40 animate-pulse"})]})));const q=e.memo((({task:e,status:t,categoryInfo:r,hasAttachments:s,cleanTaskDescription:l,onClick:d,preventTaskSelection:n})=>{const o=M(e.dueDate),i=new Date,u=$(C(o),c(i));return a.jsx("div",{onClick:d,className:`\n        group h-full bg-white dark:bg-gray-800/90 rounded-lg\n        shadow-sm hover:shadow-md\n        border border-gray-100 dark:border-gray-700/50\n        relative overflow-hidden ${n?"":"cursor-pointer"}\n        transition-all duration-200\n        transform ${n?"":"hover:-translate-y-0.5"}\n        flex flex-col\n        border-l-[3px] ${"completed"===e.status?"border-l-green-500/80":u?"border-l-red-500/80":{presentation:"border-l-purple-500/80",project:"border-l-blue-500/80",assignment:"border-l-indigo-500/80",quiz:"border-l-emerald-500/80","lab-report":"border-l-red-500/80","lab-final":"border-l-yellow-500/80","lab-perf":"border-l-amber-500/80",documents:"border-l-sky-500/80"}[e.category.toLowerCase()]||"border-l-gray-300 dark:border-l-gray-600"}\n        ${"completed"===e.status?"opacity-80":""}\n      `,children:a.jsxs("div",{className:"p-4 flex-grow flex flex-col",children:[a.jsx("div",{className:"flex items-start mb-2 sm:mb-3",children:a.jsxs("div",{className:"flex items-start gap-2 min-w-0 flex-1",children:[a.jsx("h3",{className:`\n              text-sm sm:text-base font-semibold leading-tight flex-1\n              ${"completed"===e.status?"text-gray-500 dark:text-gray-400 line-through":u?"text-red-800 dark:text-red-300":"text-gray-800 dark:text-gray-100"}\n            `,children:e.name}),s&&a.jsx("div",{className:"flex-shrink-0 p-0.5 mt-0.5",children:a.jsx(g,{className:"w-3 h-3 sm:w-3.5 sm:h-3.5 text-gray-500 dark:text-gray-400"})})]})}),a.jsx("p",{className:`\n          text-[11px] xs:text-xs sm:text-sm leading-relaxed line-clamp-2 xs:line-clamp-3 sm:line-clamp-2 mb-3 sm:mb-4 flex-grow\n          ${"completed"===e.status?"text-gray-500 dark:text-gray-400":u?"text-gray-700 dark:text-gray-300":"text-gray-600 dark:text-gray-300"}\n        `,children:l(e.description)}),a.jsxs("div",{className:"flex items-center justify-between pt-2 border-t border-gray-100 dark:border-gray-700/50",children:[a.jsxs("div",{className:"flex items-center gap-1 sm:gap-1.5",children:[a.jsx(x,{className:"\n              w-3 h-3 sm:w-3.5 sm:h-3.5\n              "+(u&&!e.status?"text-red-500 dark:text-red-400":"text-gray-500 dark:text-gray-400")}),a.jsxs("span",{className:"\n              text-[10px] sm:text-xs font-medium\n              "+(u&&!e.status?"text-red-500 dark:text-red-400":"text-gray-500 dark:text-gray-400"),children:["Due: ",m(o,"MMM d")]})]}),a.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2",children:[("completed"===e.status||u)&&a.jsxs("span",{className:`\n                inline-flex items-center gap-1\n                px-1.5 sm:px-2 py-0.5\n                text-[9px] sm:text-[10px] font-medium\n                rounded-full\n                ${"completed"===e.status?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":"bg-red-100 text-red-600 dark:bg-red-900/30 dark:text-red-400"}\n                ${u&&"completed"!==e.status?"animate-pulse":""}\n              `,children:[t.icon,a.jsx("span",{children:t.label})]}),a.jsxs("span",{className:`\n              inline-flex items-center gap-1 sm:gap-1.5\n              px-2 sm:px-2.5 py-0.5\n              text-[9px] sm:text-[10px] font-medium tracking-wide\n              rounded-md border\n              ${r.color.replace("bg-","bg-opacity-75 bg-").replace("text-","text-opacity-90 text-")}\n              transition-all duration-200\n              shadow-sm\n              border-opacity-30\n              ${r.color.includes("blue")?"border-blue-200 dark:border-blue-700":r.color.includes("purple")?"border-purple-200 dark:border-purple-700":r.color.includes("emerald")?"border-emerald-200 dark:border-emerald-700":r.color.includes("indigo")?"border-indigo-200 dark:border-indigo-700":r.color.includes("green")?"border-green-200 dark:border-green-700":r.color.includes("red")?"border-red-200 dark:border-red-700":r.color.includes("yellow")?"border-yellow-200 dark:border-yellow-700":r.color.includes("amber")?"border-amber-200 dark:border-amber-700":r.color.includes("sky")?"border-sky-200 dark:border-sky-700":"border-gray-200 dark:border-gray-700"}\n              hover:shadow-md group-hover:shadow-md\n            `,children:[a.jsx("div",{className:"flex-shrink-0",children:r.icon}),a.jsx("span",{className:"capitalize whitespace-nowrap",children:e.category.replace("-"," ")})]})]})]})]})})}));function H({tasks:t,openTaskId:r,onOpenTaskIdConsumed:d}){const{user:n}=l(),{tasks:o,loading:i,error:g,updateTask:A,refreshTasks:U}=s(t||null==n?void 0:n.id),[E,z]=e.useState([]),[I,P]=e.useState(new Date),[F,L]=e.useState(null),[_,H]=e.useState(!1),[W,V]=e.useState(null),[J,G]=e.useState(!1),[K,X]=e.useState(!1),[Q,ee]=e.useState(!0),[te,re]=e.useState(!0),[ae,se]=e.useState(0),le=e.useRef(!0),de=e.useRef(Date.now()),ne=e.useRef(),oe=e.useRef();e.useEffect((()=>{z(t||o||[])}),[t,o]),e.useEffect((()=>{if(!r)return;const e=t||o||[];if(0===e.length&&i)return;const a=e.find((e=>e.id===r));if(a){if(L(a),a.dueDate)try{const e="string"==typeof a.dueDate?M(a.dueDate):new Date(a.dueDate);Number.isNaN(e.getTime())||P(e)}catch(s){}null==d||d()}else if(!i){const e=setTimeout((()=>{null==d||d()}),2e3);return()=>clearTimeout(e)}}),[r,t,o,i]),e.useEffect((()=>(i&&(oe.current=setTimeout((()=>{i&&U()}),1e4)),()=>{oe.current&&clearTimeout(oe.current)})),[i,U]);const ie=e.useCallback((()=>{ae<3?(se((e=>e+1)),ne.current=setTimeout((()=>{U()}),2e3*(ae+1))):V("Failed to load tasks after multiple attempts. Please try again later.")}),[ae,U]);e.useEffect((()=>()=>{ne.current&&clearTimeout(ne.current)}),[]),e.useEffect((()=>{g&&(V(g),ie())}),[g,ie]),e.useEffect((()=>{const e=()=>{const e="visible"===document.visibilityState;if(re(e),e){const e=Date.now();e-de.current>3e4&&U(),de.current=e}};return document.addEventListener("visibilitychange",e),le.current&&(le.current=!1,i||o&&0!==o.length||U()),()=>{document.removeEventListener("visibilitychange",e)}}),[U,i,o]),e.useCallback((()=>{U()}),[U]);const ce=e.useCallback((e=>e?e.replace(/\*This task is assigned to section ID: [0-9a-f-]+\*/g,"").replace(/\[([^\]]+)\]\(attachment:[^)]+\)/g,"").replace(/\*\*Attachments:\*\*.*?\)/g,"").replace(/AS \*\*Attachments:\*\*.*?$/gm,"").replace(/Attachments:.*?$/gm,"").trim():""),[]),me=e.useCallback((e=>[/\[([^\]]+)\]\(attachment:[^)]+\)/,/\*\*Attachments:\*\*/,/AS \*\*Attachments:\*\*/,/Attachments:/].some((t=>t.test(e)))),[]),ue=e.useCallback((e=>R(e,"yyyy-MM-dd")),[]),ge=e.useCallback(((e,t)=>!(!e||!t)&&e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()),[]),xe=e.useMemo((()=>{const e=b(I,-3),t=new Date;return Array.from({length:7},((r,a)=>{const s=b(e,a);return{date:s,day:R(s,"dd"),weekDay:R(s,"EEE"),isSelected:ge(s,I),isToday:ge(s,t)}}))}),[I,ge,R]),be=e.useMemo((()=>{if(!E||0===E.length)return new Map;const e=new Map;return E.forEach((t=>{if(t.dueDate)try{const r=M(t.dueDate),a=`${r.getFullYear()}-${String(r.getMonth()+1).padStart(2,"0")}-${String(r.getDate()).padStart(2,"0")}`;e.has(a)||e.set(a,[]),e.get(a).push(t)}catch(r){}})),e}),[E]),pe=e.useMemo((()=>{const e=`${I.getFullYear()}-${String(I.getMonth()+1).padStart(2,"0")}-${String(I.getDate()).padStart(2,"0")}`;return be.get(e)||[]}),[be,I]),he=e.useCallback((e=>{const t=M(e.dueDate),r=new Date,s=$(C(t),c(r));return"completed"===e.status?{label:"Completed",color:"bg-green-50 text-green-600 dark:bg-green-900/20 dark:text-green-400 ring-green-500/20",icon:a.jsx(p,{className:"w-3.5 h-3.5"})}:s?{label:"Overdue",color:"bg-red-50 text-red-600 dark:bg-red-900/20 dark:text-red-400 ring-red-500/20",icon:a.jsx(h,{className:"w-3.5 h-3.5"}),cardStyle:"border-l-[3px] border-l-red-500 bg-red-50/30 dark:bg-red-900/10"}:{label:"In Progress",color:"bg-blue-50 text-blue-600 dark:bg-blue-900/20 dark:text-blue-400 ring-blue-500/20",icon:a.jsx(y,{className:"w-3.5 h-3.5"})}}),[]),ye=e.useMemo((()=>({task:a.jsx(k,{className:"w-3 h-3 md:w-4 md:h-4"}),presentation:a.jsx(f,{className:"w-3 h-3 md:w-4 md:h-4"}),project:a.jsx(u,{className:"w-3 h-3 md:w-4 md:h-4"}),assignment:a.jsx(w,{className:"w-3 h-3 md:w-4 md:h-4"}),quiz:a.jsx(k,{className:"w-3 h-3 md:w-4 md:h-4"}),"lab-report":a.jsx(j,{className:"w-3 h-3 md:w-4 md:h-4"}),"lab-final":a.jsx(N,{className:"w-3 h-3 md:w-4 md:h-4"}),"lab-performance":a.jsx(v,{className:"w-3 h-3 md:w-4 md:h-4"}),documents:a.jsx(w,{className:"w-3 h-3 md:w-4 md:h-4"}),blc:a.jsx(D,{className:"w-3 h-3 md:w-4 md:h-4"}),groups:a.jsx(T,{className:"w-3 h-3 md:w-4 md:h-4"}),default:a.jsx(S,{className:"w-3 h-3 md:w-4 md:h-4"})})),[]),ke=e.useMemo((()=>({task:"bg-blue-100 text-blue-700 dark:bg-blue-900/20 dark:text-blue-300",presentation:"bg-purple-100 text-purple-700 dark:bg-purple-900/20 dark:text-purple-300",project:"bg-emerald-100 text-emerald-700 dark:bg-emerald-900/20 dark:text-emerald-300",assignment:"bg-blue-100 text-blue-700 dark:bg-blue-900/20 dark:text-blue-300",quiz:"bg-indigo-100 text-indigo-700 dark:bg-indigo-900/20 dark:text-indigo-300","lab-report":"bg-green-100 text-green-700 dark:bg-green-900/20 dark:text-green-300","lab-final":"bg-red-100 text-red-700 dark:bg-red-900/20 dark:text-red-300","lab-performance":"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/20 dark:text-yellow-300",documents:"bg-gray-100 text-gray-700 dark:bg-gray-900/20 dark:text-gray-300",blc:"bg-amber-100 text-amber-700 dark:bg-amber-900/20 dark:text-amber-300",groups:"bg-sky-100 text-sky-700 dark:bg-sky-900/20 dark:text-sky-300",default:"bg-gray-100 text-gray-700 dark:bg-gray-900/20 dark:text-gray-300"})),[]),fe=e.useCallback((e=>{const t=e||"default";return{icon:ye[t]||ye.default,color:ke[t]||ke.default}}),[ye,ke]);return e.useCallback((e=>{P(e),L(null)}),[]),e.useEffect((()=>{const e=setTimeout((()=>{try{const e=new URLSearchParams(window.location.search),t=e.get("selectedDate"),r=ue(I);if(t!==r){e.set("selectedDate",r);const t=`${window.location.pathname}?${e.toString()}`;window.history.replaceState({path:t},"",t)}}catch(e){}}),300);return()=>clearTimeout(e)}),[I,ue]),Q&&i||i&&!Q?a.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 pt-4",children:[a.jsx(O,{}),a.jsx(B,{})]}):i||E&&0!==E.length?a.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[(g||W)&&a.jsx("div",{className:"fixed top-4 right-4 z-50 bg-red-100 dark:bg-red-900/20 border border-red-200 dark:border-red-800 text-red-700 dark:text-red-300 px-4 py-3 rounded-lg shadow-lg animate-fade-in",children:a.jsx("p",{className:"text-sm font-medium",children:g||W})}),(_||i&&!Q)&&a.jsx("div",{className:"fixed inset-0 bg-black/20 z-40 flex items-center justify-center",children:a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4 shadow-xl animate-scale-in",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto"}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 mt-2",children:_?"Updating task...":"Loading tasks..."})]})}),a.jsxs("div",{className:"max-w-full md:max-w-5xl mx-auto px-2 md:px-6 mb-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("button",{onClick:()=>P(b(I,-7)),className:"p-2.5 text-gray-600 hover:text-blue-600 hover:bg-blue-50/80 dark:text-gray-400 dark:hover:text-blue-400 dark:hover:bg-blue-900/30 rounded-lg transition-colors duration-150 active:scale-95","aria-label":"Previous week",children:a.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2.5,children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19l-7-7 7-7"})})}),a.jsxs("button",{className:"flex items-center gap-2 text-sm font-semibold text-gray-700 dark:text-gray-200 cursor-pointer hover:text-blue-600 dark:hover:text-blue-400 transition-colors px-4 py-2 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800/50 active:scale-98",onClick:()=>G(!0),"aria-label":"Open calendar",children:[a.jsx(x,{className:"w-4 h-4"}),a.jsx("span",{className:"whitespace-nowrap",children:R(I,"MMMM yyyy")})]}),a.jsx("button",{onClick:()=>P(b(I,7)),className:"p-2.5 text-gray-600 hover:text-blue-600 hover:bg-blue-50/80 dark:text-gray-400 dark:hover:text-blue-400 dark:hover:bg-blue-900/30 rounded-lg transition-colors duration-150 active:scale-95","aria-label":"Next week",children:a.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2.5,children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 5l7 7-7 7"})})})]}),a.jsx("div",{className:"pb-4",children:a.jsx("div",{className:"grid grid-cols-7 gap-2 md:gap-3 px-2 md:px-4",children:xe.map((e=>a.jsxs("button",{onClick:()=>P(e.date),className:`\n                flex flex-col items-center justify-center\n                h-16 sm:h-20 md:h-24 w-full\n                p-2 md:p-3 rounded-lg\n                border transition-all duration-200\n                ${e.isSelected?"bg-blue-600 border-blue-500 shadow-lg shadow-blue-500/20 text-white scale-105":e.isToday?"bg-blue-50/50 border-blue-200/60 dark:bg-blue-900/20 dark:border-blue-700/50":"bg-white dark:bg-gray-800/50 border-gray-200 dark:border-gray-700/50"}\n                hover:border-blue-400 dark:hover:border-blue-600 hover:shadow-md\n                active:scale-95\n              `,children:[a.jsx("span",{className:`\n                text-[10px] sm:text-xs font-semibold tracking-wider uppercase\n                ${e.isSelected?"text-blue-100":e.isToday?"text-blue-600 dark:text-blue-400":"text-gray-500 dark:text-gray-400"}\n              `,children:e.weekDay}),a.jsx("span",{className:`\n                text-xl sm:text-2xl md:text-3xl font-bold mt-1\n                ${e.isSelected?"text-white":e.isToday?"text-blue-600 dark:text-blue-400":"text-gray-800 dark:text-gray-200"}\n              `,children:e.day})]},e.day+e.weekDay)))})})]}),a.jsx("div",{className:"px-3 xs:px-4 md:max-w-4xl lg:max-w-5xl md:mx-auto pb-8",children:pe.length>0?a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-2 xs:gap-3 md:gap-4",children:pe.map((e=>a.jsx(q,{task:e,status:he(e),categoryInfo:fe(e.category),hasAttachments:me(e.description),cleanTaskDescription:ce,onClick:()=>{K||L(e)},preventTaskSelection:K},e.id)))}):a.jsxs("div",{className:"text-center py-12 bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200/80 dark:border-gray-700/80 mt-4",children:[a.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-gray-50 dark:bg-gray-700 rounded-full flex items-center justify-center",children:a.jsx(x,{className:"w-8 h-8 text-gray-400 dark:text-gray-500"})}),a.jsxs("p",{className:"text-lg text-gray-900 dark:text-gray-100 font-medium",children:["No tasks for ",m(I,"MMMM d")]}),a.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:ge(I,new Date)?"You're all caught up for today!":"Nothing scheduled for this day"})]})}),a.jsx(e.Suspense,{fallback:a.jsx("div",{className:"fixed inset-0 bg-black/60 z-50 flex items-center justify-center",children:a.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-white"})}),children:F&&a.jsx(Y,{task:F,onClose:()=>L(null),onStatusUpdate:async(e,t)=>{try{H(!0),V(null);const a=E.find((t=>t.id===e));if(!a)throw new Error("Task not found in current list");const s=a.status;try{const r=await A(e,{status:t});z((t=>t.map((t=>t.id===e?r:t)))),(null==F?void 0:F.id)===e&&L(r)}catch(r){throw z((t=>t.map((t=>t.id===e?{...t,status:s}:t)))),r}}catch(r){V("Failed to update task status. Please try again.")}finally{H(!1)}},isUpdating:_})}),a.jsx(e.Suspense,{fallback:a.jsx("div",{className:"fixed inset-0 bg-black/60 z-50 flex items-center justify-center",children:a.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-white"})}),children:J&&a.jsx(Z,{isOpen:J,onClose:()=>G(!1),selectedDate:I,onSelectDate:e=>{L(null),X(!0),setTimeout((()=>{X(!1)}),1e3),P(e),G(!1);try{const t=new URLSearchParams(window.location.search);t.set("selectedDate",ue(e));const r=`${window.location.pathname}?${t.toString()}`;window.history.pushState({path:r},"",r)}catch(t){}},tasks:E})})]}):a.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 pt-4",children:a.jsx("div",{className:"max-w-full md:max-w-5xl mx-auto px-2 md:px-6",children:a.jsxs("div",{className:"text-center py-16 bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200/80 dark:border-gray-700/80 mt-4",children:[a.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-gray-50 dark:bg-gray-700 rounded-full flex items-center justify-center",children:a.jsx(x,{className:"w-8 h-8 text-gray-400 dark:text-gray-500"})}),a.jsx("p",{className:"text-lg text-gray-900 dark:text-gray-100 font-medium",children:"No tasks available"}),a.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"Try refreshing the page or check back later"})]})})})}export{H as UpcomingPage};
