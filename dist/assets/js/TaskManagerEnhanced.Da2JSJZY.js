import{r as e,R as t,a as r,j as a}from"./react-vendor.CJcloKvn.js";import{s}from"./index.DDLbf5SO.js";import{AlertCircle as n,GripVertical as i,Calendar as l,LucideTarget as o,CheckCircle2 as d,Clock as c,LucideTrendingUp as u,LucideTrendingDown as g,LucidePlus as m,LucideStar as x,LucideTrash2 as h,Copy as b,LucideX as p,LucideRefreshCw as y,LucideUpload as f,CheckCircle as v,FileText as k,Link as w,Eye as j,Edit2 as N,ChevronUp as C,ChevronDown as D,LucideMessageSquare as S,LucideSend as E,History as T,LucideUser as R,LucideUsers as I,LucideTag as _,Download as L,List as M,LayoutGrid as A,BarChart3 as O,LucideSearch as P,Filter as F,CheckSquare as z}from"./icons.C9QY32ra.js";import{R as $,i as U,b as B,X as q,Y as X,T as Y,B as K,P as V,j as J,k as W,L as H}from"./charts.Gb_JFp2r.js";import"./supabase.Dq8fQFgD.js";class G{static async execute(e,t="Operation",r){var a,s;let n=null;for(let l=0;l<=2;l++)try{if(null==r?void 0:r.aborted)throw new Error("Operation cancelled");const{data:a,error:s}=await e();if(s)throw new Error(s.message||`${t} failed`);if(null===a)throw new Error(`${t}: No data returned`);return a}catch(i){if(n=i,"Operation cancelled"===i.message||(null==r?void 0:r.aborted))throw new Error("Operation cancelled");if((null==(a=i.message)?void 0:a.includes("JWT"))||(null==(s=i.message)?void 0:s.includes("session")))throw new Error("Session expired. Please refresh the page.");if(l<2){await new Promise((e=>setTimeout(e,1e3)));continue}}throw n||new Error(`${t} failed`)}static async executeVoid(e,t="Operation"){var r,a;let s=null;for(let i=0;i<=2;i++)try{const{error:r}=await e();if(r)throw new Error(r.message||`${t} failed`);return}catch(n){if(s=n,(null==(r=n.message)?void 0:r.includes("JWT"))||(null==(a=n.message)?void 0:a.includes("session")))throw new Error("Session expired. Please refresh the page.");if(i<2){await new Promise((e=>setTimeout(e,1e3)));continue}}throw s||new Error(`${t} failed`)}}async function Z(e,t,r,a){const n={name:t.name,description:t.description,category:t.category,due_date:t.dueDate,priority:t.priority||"medium",tags:t.tags||[],assigned_to:t.assignedTo||null,assigned_by:t.assignedTo?e:null,section_id:r||t.sectionId||null,attachments:t.attachments||[],google_drive_links:t.googleDriveLinks||[],status:t.status||"pending",user_id:e,is_admin_task:!!r,is_template:!1},i=te(await G.execute((()=>s.from("tasks").insert(n).select("*").single()),"Create task",a));return i.isAdminTask&&async function(e){try{const t="https://ycuymjlcsvigorskvsdr.supabase.co",r="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InljdXltamxjc3ZpZ29yc2t2c2RyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI0MTY1NzksImV4cCI6MjA2Nzk5MjU3OX0.TzFx-CboTXkic_c3AKlHLFnhlX9IVxUQy6bKMZcmPNo",a=new Date(e.dueDate).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),s={presentation:"ðŸ“Š",assignment:"ðŸ“",quiz:"â“","lab-report":"ðŸ”¬","lab-final":"ðŸ§ª","lab-performance":"âš—ï¸",task:"âœ“",documents:"ðŸ“„",blc:"ðŸ“š",groups:"ðŸ‘¥",project:"ðŸš€",midterm:"ðŸ“–","final-exam":"ðŸŽ“",others:"ðŸ“Œ"},n=e.category.split("-").map((e=>e.charAt(0).toUpperCase()+e.slice(1))).join(" "),i=s[e.category]||"ðŸ“Œ",l={taskId:e.id,title:`${i} New ${n}`,body:`${e.name}\nðŸ“… Due: ${a}`,sectionId:e.sectionId||void 0,data:{taskId:e.id,category:e.category,categoryName:n,priority:e.priority||"medium",dueDate:e.dueDate,taskName:e.name}},o=await fetch(`${t}/functions/v1/send-fcm-push`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify(l)});if(!o.ok){const e=await o.json().catch((()=>({})));throw new Error(`FCM push failed: ${JSON.stringify(e)}`)}await o.json()}catch(t){throw t}}(i).catch((()=>{})),i}async function Q(e,t){const r={};return void 0!==t.name&&(r.name=t.name),void 0!==t.description&&(r.description=t.description),void 0!==t.category&&(r.category=t.category),void 0!==t.dueDate&&(r.due_date=t.dueDate),void 0!==t.status&&(r.status=t.status,"completed"===t.status&&(r.completed_at=(new Date).toISOString())),void 0!==t.priority&&(r.priority=t.priority),void 0!==t.tags&&(r.tags=t.tags),void 0!==t.assignedTo&&(r.assigned_to=t.assignedTo),void 0!==t.attachments&&(r.attachments=t.attachments),void 0!==t.googleDriveLinks&&(r.google_drive_links=t.googleDriveLinks),te(await G.execute((()=>s.from("tasks").update(r).eq("id",e).select("*").single()),"Update task"))}async function ee(e){await G.executeVoid((()=>s.from("tasks").delete().eq("id",e)),"Delete task")}function te(e){return{id:e.id,name:e.name,category:e.category,dueDate:e.due_date,description:e.description,status:e.status,createdAt:e.created_at,updatedAt:e.updated_at,isAdminTask:e.is_admin_task||!1,sectionId:e.section_id,departmentId:e.department_id,batchId:e.batch_id,priority:e.priority||"medium",tags:e.tags||[],assignedTo:e.assigned_to,assignedBy:e.assigned_by,completedAt:e.completed_at,completedBy:e.completed_by,attachments:e.attachments||[],googleDriveLinks:e.google_drive_links||[],isTemplate:e.is_template||!1,templateName:e.template_name,userId:e.user_id,assignedToUser:e.assignedToUser,assignedByUser:e.assignedByUser,section:e.section,department:e.department,batch:e.batch}}function re(e){return{id:e.id,taskId:e.task_id,userId:e.user_id,comment:e.comment,createdAt:e.created_at,updatedAt:e.updated_at,isEdited:e.is_edited||!1,user:e.user}}function ae(e){return{id:e.id,taskId:e.task_id,userId:e.user_id,action:e.action,fieldName:e.field_name,oldValue:e.old_value,newValue:e.new_value,metadata:e.metadata,createdAt:e.created_at,user:e.user}}function se(e){return{id:e.id,name:e.name,description:e.description,category:e.category,priority:e.priority,tags:e.tags||[],defaultDueDays:e.default_due_days,sectionId:e.section_id,createdBy:e.created_by,createdAt:e.created_at,updatedAt:e.updated_at,isActive:e.is_active,useCount:e.use_count||0,section:e.section}}const ne="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement;function ie(e){const t=Object.prototype.toString.call(e);return"[object Window]"===t||"[object global]"===t}function le(e){return"nodeType"in e}function oe(e){var t,r;return e?ie(e)?e:le(e)&&null!=(t=null==(r=e.ownerDocument)?void 0:r.defaultView)?t:window:window}function de(e){const{Document:t}=oe(e);return e instanceof t}function ce(e){return!ie(e)&&e instanceof oe(e).HTMLElement}function ue(e){return e instanceof oe(e).SVGElement}function ge(e){return e?ie(e)?e.document:le(e)?de(e)?e:ce(e)||ue(e)?e.ownerDocument:document:document:document}const me=ne?e.useLayoutEffect:e.useEffect;function xe(t){const r=e.useRef(t);return me((()=>{r.current=t})),e.useCallback((function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return null==r.current?void 0:r.current(...t)}),[])}function he(t,r){void 0===r&&(r=[t]);const a=e.useRef(t);return me((()=>{a.current!==t&&(a.current=t)}),r),a}function be(t,r){const a=e.useRef();return e.useMemo((()=>{const e=t(a.current);return a.current=e,e}),[...r])}function pe(t){const r=xe(t),a=e.useRef(null),s=e.useCallback((e=>{e!==a.current&&(null==r||r(e,a.current)),a.current=e}),[]);return[a,s]}function ye(t){const r=e.useRef();return e.useEffect((()=>{r.current=t}),[t]),r.current}let fe={};function ve(t,r){return e.useMemo((()=>{if(r)return r;const e=null==fe[t]?0:fe[t]+1;return fe[t]=e,t+"-"+e}),[t,r])}function ke(e){return function(t){for(var r=arguments.length,a=new Array(r>1?r-1:0),s=1;s<r;s++)a[s-1]=arguments[s];return a.reduce(((t,r)=>{const a=Object.entries(r);for(const[s,n]of a){const r=t[s];null!=r&&(t[s]=r+e*n)}return t}),{...t})}}const we=ke(1),je=ke(-1);function Ne(e){if(!e)return!1;const{KeyboardEvent:t}=oe(e.target);return t&&e instanceof t}function Ce(e){if(function(e){if(!e)return!1;const{TouchEvent:t}=oe(e.target);return t&&e instanceof t}(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:r}=e.touches[0];return{x:t,y:r}}if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:r}=e.changedTouches[0];return{x:t,y:r}}}return function(e){return"clientX"in e&&"clientY"in e}(e)?{x:e.clientX,y:e.clientY}:null}const De=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:r}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(r?Math.round(r):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:r}=e;return"scaleX("+t+") scaleY("+r+")"}},Transform:{toString(e){if(e)return[De.Translate.toString(e),De.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:r,easing:a}=e;return t+" "+r+"ms "+a}}}),Se="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function Ee(e){return e.matches(Se)?e:e.querySelector(Se)}const Te={display:"none"};function Re(e){let{id:r,value:a}=e;return t.createElement("div",{id:r,style:Te},a)}function Ie(e){let{id:r,announcement:a,ariaLiveType:s="assertive"}=e;return t.createElement("div",{id:r,style:{position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"},role:"status","aria-live":s,"aria-atomic":!0},a)}const _e=e.createContext(null),Le={draggable:"\n    To pick up a draggable item, press the space bar.\n    While dragging, use the arrow keys to move the item.\n    Press space again to drop the item in its new position, or press escape to cancel.\n  "},Me={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was moved over droppable area "+r.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:r}=e;return r?"Draggable item "+t.id+" was dropped over droppable area "+r.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function Ae(a){let{announcements:s=Me,container:n,hiddenTextDescribedById:i,screenReaderInstructions:l=Le}=a;const{announce:o,announcement:d}=function(){const[t,r]=e.useState("");return{announce:e.useCallback((e=>{null!=e&&r(e)}),[]),announcement:t}}(),c=ve("DndLiveRegion"),[u,g]=e.useState(!1);if(e.useEffect((()=>{g(!0)}),[]),function(t){const r=e.useContext(_e);e.useEffect((()=>{if(!r)throw new Error("useDndMonitor must be used within a children of <DndContext>");return r(t)}),[t,r])}(e.useMemo((()=>({onDragStart(e){let{active:t}=e;o(s.onDragStart({active:t}))},onDragMove(e){let{active:t,over:r}=e;s.onDragMove&&o(s.onDragMove({active:t,over:r}))},onDragOver(e){let{active:t,over:r}=e;o(s.onDragOver({active:t,over:r}))},onDragEnd(e){let{active:t,over:r}=e;o(s.onDragEnd({active:t,over:r}))},onDragCancel(e){let{active:t,over:r}=e;o(s.onDragCancel({active:t,over:r}))}})),[o,s])),!u)return null;const m=t.createElement(t.Fragment,null,t.createElement(Re,{id:i,value:l.draggable}),t.createElement(Ie,{id:c,announcement:d}));return n?r.createPortal(m,n):m}var Oe,Pe;function Fe(){}(Pe=Oe||(Oe={})).DragStart="dragStart",Pe.DragMove="dragMove",Pe.DragEnd="dragEnd",Pe.DragCancel="dragCancel",Pe.DragOver="dragOver",Pe.RegisterDroppable="registerDroppable",Pe.SetDroppableDisabled="setDroppableDisabled",Pe.UnregisterDroppable="unregisterDroppable";const ze=Object.freeze({x:0,y:0});function $e(e,t){const r=Ce(e);return r?(r.x-t.left)/t.width*100+"% "+(r.y-t.top)/t.height*100+"%":"0 0"}function Ue(e,t){let{data:{value:r}}=e,{data:{value:a}}=t;return r-a}function Be(e,t){let{data:{value:r}}=e,{data:{value:a}}=t;return a-r}function qe(e){let{left:t,top:r,height:a,width:s}=e;return[{x:t,y:r},{x:t+s,y:r},{x:t,y:r+a},{x:t+s,y:r+a}]}const Xe=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:a}=e;const s=qe(t),n=[];for(const i of a){const{id:e}=i,t=r.get(e);if(t){const r=qe(t),a=s.reduce(((e,t,a)=>{return e+(s=r[a],n=t,Math.sqrt(Math.pow(s.x-n.x,2)+Math.pow(s.y-n.y,2)));var s,n}),0),l=Number((a/4).toFixed(4));n.push({id:e,data:{droppableContainer:i,value:l}})}}return n.sort(Ue)};function Ye(e,t){const r=Math.max(t.top,e.top),a=Math.max(t.left,e.left),s=Math.min(t.left+t.width,e.left+e.width),n=Math.min(t.top+t.height,e.top+e.height),i=s-a,l=n-r;if(a<s&&r<n){const r=t.width*t.height,a=e.width*e.height,s=i*l;return Number((s/(r+a-s)).toFixed(4))}return 0}const Ke=e=>{let{collisionRect:t,droppableRects:r,droppableContainers:a}=e;const s=[];for(const n of a){const{id:e}=n,a=r.get(e);if(a){const r=Ye(a,t);r>0&&s.push({id:e,data:{droppableContainer:n,value:r}})}}return s.sort(Be)};function Ve(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:ze}function Je(e){return function(t){for(var r=arguments.length,a=new Array(r>1?r-1:0),s=1;s<r;s++)a[s-1]=arguments[s];return a.reduce(((t,r)=>({...t,top:t.top+e*r.y,bottom:t.bottom+e*r.y,left:t.left+e*r.x,right:t.right+e*r.x})),{...t})}}const We=Je(1);function He(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}const Ge={ignoreTransform:!1};function Ze(e,t){void 0===t&&(t=Ge);let r=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:t,transformOrigin:a}=oe(e).getComputedStyle(e);t&&(r=function(e,t,r){const a=He(t);if(!a)return e;const{scaleX:s,scaleY:n,x:i,y:l}=a,o=e.left-i-(1-s)*parseFloat(r),d=e.top-l-(1-n)*parseFloat(r.slice(r.indexOf(" ")+1)),c=s?e.width/s:e.width,u=n?e.height/n:e.height;return{width:c,height:u,top:d,right:o+c,bottom:d+u,left:o}}(r,t,a))}const{top:a,left:s,width:n,height:i,bottom:l,right:o}=r;return{top:a,left:s,width:n,height:i,bottom:l,right:o}}function Qe(e){return Ze(e,{ignoreTransform:!0})}function et(e,t){const r=[];return e?function a(s){if(null!=t&&r.length>=t)return r;if(!s)return r;if(de(s)&&null!=s.scrollingElement&&!r.includes(s.scrollingElement))return r.push(s.scrollingElement),r;if(!ce(s)||ue(s))return r;if(r.includes(s))return r;const n=oe(e).getComputedStyle(s);return s!==e&&function(e,t){void 0===t&&(t=oe(e).getComputedStyle(e));const r=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some((e=>{const a=t[e];return"string"==typeof a&&r.test(a)}))}(s,n)&&r.push(s),function(e,t){return void 0===t&&(t=oe(e).getComputedStyle(e)),"fixed"===t.position}(s,n)?r:a(s.parentNode)}(e):r}function tt(e){const[t]=et(e,1);return null!=t?t:null}function rt(e){return ne&&e?ie(e)?e:le(e)?de(e)||e===ge(e).scrollingElement?window:ce(e)?e:null:null:null}function at(e){return ie(e)?e.scrollX:e.scrollLeft}function st(e){return ie(e)?e.scrollY:e.scrollTop}function nt(e){return{x:at(e),y:st(e)}}var it,lt;function ot(e){return!(!ne||!e)&&e===document.scrollingElement}function dt(e){const t={x:0,y:0},r=ot(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},a={x:e.scrollWidth-r.width,y:e.scrollHeight-r.height};return{isTop:e.scrollTop<=t.y,isLeft:e.scrollLeft<=t.x,isBottom:e.scrollTop>=a.y,isRight:e.scrollLeft>=a.x,maxScroll:a,minScroll:t}}(lt=it||(it={}))[lt.Forward=1]="Forward",lt[lt.Backward=-1]="Backward";const ct={x:.2,y:.2};function ut(e,t,r,a,s){let{top:n,left:i,right:l,bottom:o}=r;void 0===a&&(a=10),void 0===s&&(s=ct);const{isTop:d,isBottom:c,isLeft:u,isRight:g}=dt(e),m={x:0,y:0},x={x:0,y:0},h=t.height*s.y,b=t.width*s.x;return!d&&n<=t.top+h?(m.y=it.Backward,x.y=a*Math.abs((t.top+h-n)/h)):!c&&o>=t.bottom-h&&(m.y=it.Forward,x.y=a*Math.abs((t.bottom-h-o)/h)),!g&&l>=t.right-b?(m.x=it.Forward,x.x=a*Math.abs((t.right-b-l)/b)):!u&&i<=t.left+b&&(m.x=it.Backward,x.x=a*Math.abs((t.left+b-i)/b)),{direction:m,speed:x}}function gt(e){if(e===document.scrollingElement){const{innerWidth:e,innerHeight:t}=window;return{top:0,left:0,right:e,bottom:t,width:e,height:t}}const{top:t,left:r,right:a,bottom:s}=e.getBoundingClientRect();return{top:t,left:r,right:a,bottom:s,width:e.clientWidth,height:e.clientHeight}}function mt(e){return e.reduce(((e,t)=>we(e,nt(t))),ze)}function xt(e,t){if(void 0===t&&(t=Ze),!e)return;const{top:r,left:a,bottom:s,right:n}=t(e);tt(e)&&(s<=0||n<=0||r>=window.innerHeight||a>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const ht=[["x",["left","right"],function(e){return e.reduce(((e,t)=>e+at(t)),0)}],["y",["top","bottom"],function(e){return e.reduce(((e,t)=>e+st(t)),0)}]];class bt{constructor(e,t){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=et(t),a=mt(r);this.rect={...e},this.width=e.width,this.height=e.height;for(const[s,n,i]of ht)for(const e of n)Object.defineProperty(this,e,{get:()=>{const t=i(r),n=a[s]-t;return this.rect[e]+n},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class pt{constructor(e){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach((e=>{var t;return null==(t=this.target)?void 0:t.removeEventListener(...e)}))},this.target=e}add(e,t,r){var a;null==(a=this.target)||a.addEventListener(e,t,r),this.listeners.push([e,t,r])}}function yt(e,t){const r=Math.abs(e.x),a=Math.abs(e.y);return"number"==typeof t?Math.sqrt(r**2+a**2)>t:"x"in t&&"y"in t?r>t.x&&a>t.y:"x"in t?r>t.x:"y"in t&&a>t.y}var ft,vt,kt,wt;function jt(e){e.preventDefault()}function Nt(e){e.stopPropagation()}(vt=ft||(ft={})).Click="click",vt.DragStart="dragstart",vt.Keydown="keydown",vt.ContextMenu="contextmenu",vt.Resize="resize",vt.SelectionChange="selectionchange",vt.VisibilityChange="visibilitychange",(wt=kt||(kt={})).Space="Space",wt.Down="ArrowDown",wt.Right="ArrowRight",wt.Left="ArrowLeft",wt.Up="ArrowUp",wt.Esc="Escape",wt.Enter="Enter",wt.Tab="Tab";const Ct={start:[kt.Space,kt.Enter],cancel:[kt.Esc],end:[kt.Space,kt.Enter,kt.Tab]},Dt=(e,t)=>{let{currentCoordinates:r}=t;switch(e.code){case kt.Right:return{...r,x:r.x+25};case kt.Left:return{...r,x:r.x-25};case kt.Down:return{...r,y:r.y+25};case kt.Up:return{...r,y:r.y-25}}};class St{constructor(e){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=e;const{event:{target:t}}=e;this.props=e,this.listeners=new pt(ge(t)),this.windowListeners=new pt(oe(t)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(ft.Resize,this.handleCancel),this.windowListeners.add(ft.VisibilityChange,this.handleCancel),setTimeout((()=>this.listeners.add(ft.Keydown,this.handleKeyDown)))}handleStart(){const{activeNode:e,onStart:t}=this.props,r=e.node.current;r&&xt(r),t(ze)}handleKeyDown(e){if(Ne(e)){const{active:t,context:r,options:a}=this.props,{keyboardCodes:s=Ct,coordinateGetter:n=Dt,scrollBehavior:i="smooth"}=a,{code:l}=e;if(s.end.includes(l))return void this.handleEnd(e);if(s.cancel.includes(l))return void this.handleCancel(e);const{collisionRect:o}=r.current,d=o?{x:o.left,y:o.top}:ze;this.referenceCoordinates||(this.referenceCoordinates=d);const c=n(e,{active:t,context:r.current,currentCoordinates:d});if(c){const t=je(c,d),a={x:0,y:0},{scrollableAncestors:s}=r.current;for(const r of s){const s=e.code,{isTop:n,isRight:l,isLeft:o,isBottom:d,maxScroll:u,minScroll:g}=dt(r),m=gt(r),x={x:Math.min(s===kt.Right?m.right-m.width/2:m.right,Math.max(s===kt.Right?m.left:m.left+m.width/2,c.x)),y:Math.min(s===kt.Down?m.bottom-m.height/2:m.bottom,Math.max(s===kt.Down?m.top:m.top+m.height/2,c.y))},h=s===kt.Right&&!l||s===kt.Left&&!o,b=s===kt.Down&&!d||s===kt.Up&&!n;if(h&&x.x!==c.x){const e=r.scrollLeft+t.x,n=s===kt.Right&&e<=u.x||s===kt.Left&&e>=g.x;if(n&&!t.y)return void r.scrollTo({left:e,behavior:i});a.x=n?r.scrollLeft-e:s===kt.Right?r.scrollLeft-u.x:r.scrollLeft-g.x,a.x&&r.scrollBy({left:-a.x,behavior:i});break}if(b&&x.y!==c.y){const e=r.scrollTop+t.y,n=s===kt.Down&&e<=u.y||s===kt.Up&&e>=g.y;if(n&&!t.x)return void r.scrollTo({top:e,behavior:i});a.y=n?r.scrollTop-e:s===kt.Down?r.scrollTop-u.y:r.scrollTop-g.y,a.y&&r.scrollBy({top:-a.y,behavior:i});break}}this.handleMove(e,we(je(c,this.referenceCoordinates),a))}}}handleMove(e,t){const{onMove:r}=this.props;e.preventDefault(),r(t)}handleEnd(e){const{onEnd:t}=this.props;e.preventDefault(),this.detach(),t()}handleCancel(e){const{onCancel:t}=this.props;e.preventDefault(),this.detach(),t()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}function Et(e){return Boolean(e&&"distance"in e)}function Tt(e){return Boolean(e&&"delay"in e)}St.activators=[{eventName:"onKeyDown",handler:(e,t,r)=>{let{keyboardCodes:a=Ct,onActivation:s}=t,{active:n}=r;const{code:i}=e.nativeEvent;if(a.start.includes(i)){const t=n.activatorNode.current;return!(t&&e.target!==t||(e.preventDefault(),null==s||s({event:e.nativeEvent}),0))}return!1}}];class Rt{constructor(e,t,r){var a;void 0===r&&(r=function(e){const{EventTarget:t}=oe(e);return e instanceof t?e:ge(e)}(e.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=e,this.events=t;const{event:s}=e,{target:n}=s;this.props=e,this.events=t,this.document=ge(n),this.documentListeners=new pt(this.document),this.listeners=new pt(r),this.windowListeners=new pt(oe(n)),this.initialCoordinates=null!=(a=Ce(s))?a:ze,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:e,props:{options:{activationConstraint:t,bypassActivationConstraint:r}}}=this;if(this.listeners.add(e.move.name,this.handleMove,{passive:!1}),this.listeners.add(e.end.name,this.handleEnd),e.cancel&&this.listeners.add(e.cancel.name,this.handleCancel),this.windowListeners.add(ft.Resize,this.handleCancel),this.windowListeners.add(ft.DragStart,jt),this.windowListeners.add(ft.VisibilityChange,this.handleCancel),this.windowListeners.add(ft.ContextMenu,jt),this.documentListeners.add(ft.Keydown,this.handleKeydown),t){if(null!=r&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(Tt(t))return this.timeoutId=setTimeout(this.handleStart,t.delay),void this.handlePending(t);if(Et(t))return void this.handlePending(t)}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),null!==this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(e,t){const{active:r,onPending:a}=this.props;a(r,e,this.initialCoordinates,t)}handleStart(){const{initialCoordinates:e}=this,{onStart:t}=this.props;e&&(this.activated=!0,this.documentListeners.add(ft.Click,Nt,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(ft.SelectionChange,this.removeTextSelection),t(e))}handleMove(e){var t;const{activated:r,initialCoordinates:a,props:s}=this,{onMove:n,options:{activationConstraint:i}}=s;if(!a)return;const l=null!=(t=Ce(e))?t:ze,o=je(a,l);if(!r&&i){if(Et(i)){if(null!=i.tolerance&&yt(o,i.tolerance))return this.handleCancel();if(yt(o,i.distance))return this.handleStart()}return Tt(i)&&yt(o,i.tolerance)?this.handleCancel():void this.handlePending(i,o)}e.cancelable&&e.preventDefault(),n(l)}handleEnd(){const{onAbort:e,onEnd:t}=this.props;this.detach(),this.activated||e(this.props.active),t()}handleCancel(){const{onAbort:e,onCancel:t}=this.props;this.detach(),this.activated||e(this.props.active),t()}handleKeydown(e){e.code===kt.Esc&&this.handleCancel()}removeTextSelection(){var e;null==(e=this.document.getSelection())||e.removeAllRanges()}}const It={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class _t extends Rt{constructor(e){const{event:t}=e,r=ge(t.target);super(e,It,r)}}_t.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:a}=t;return!(!r.isPrimary||0!==r.button||(null==a||a({event:r}),0))}}];const Lt={move:{name:"mousemove"},end:{name:"mouseup"}};var Mt,At;(At=Mt||(Mt={}))[At.RightClick=2]="RightClick",class extends Rt{constructor(e){super(e,Lt,ge(e.event.target))}}.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:a}=t;return r.button!==Mt.RightClick&&(null==a||a({event:r}),!0)}}];const Ot={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};var Pt,Ft,zt,$t;(class extends Rt{constructor(e){super(e,Ot)}static setup(){return window.addEventListener(Ot.move.name,e,{capture:!1,passive:!1}),function(){window.removeEventListener(Ot.move.name,e)};function e(){}}}).activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:r}=e,{onActivation:a}=t;const{touches:s}=r;return!(s.length>1||(null==a||a({event:r}),0))}}],(Ft=Pt||(Pt={}))[Ft.Pointer=0]="Pointer",Ft[Ft.DraggableRect=1]="DraggableRect",($t=zt||(zt={}))[$t.TreeOrder=0]="TreeOrder",$t[$t.ReversedTreeOrder=1]="ReversedTreeOrder";const Ut={x:{[it.Backward]:!1,[it.Forward]:!1},y:{[it.Backward]:!1,[it.Forward]:!1}};var Bt,qt,Xt;(qt=Bt||(Bt={}))[qt.Always=0]="Always",qt[qt.BeforeDragging=1]="BeforeDragging",qt[qt.WhileDragging=2]="WhileDragging",(Xt||(Xt={})).Optimized="optimized";const Yt=new Map;function Kt(e,t){return be((r=>e?r||("function"==typeof t?t(e):e):null),[t,e])}function Vt(t){let{callback:r,disabled:a}=t;const s=xe(r),n=e.useMemo((()=>{if(a||"undefined"==typeof window||void 0===window.ResizeObserver)return;const{ResizeObserver:e}=window;return new e(s)}),[a]);return e.useEffect((()=>()=>null==n?void 0:n.disconnect()),[n]),n}function Jt(e){return new bt(Ze(e),e)}function Wt(t,r,a){void 0===r&&(r=Jt);const[s,n]=e.useState(null);function i(){n((e=>{if(!t)return null;var s;if(!1===t.isConnected)return null!=(s=null!=e?e:a)?s:null;const n=r(t);return JSON.stringify(e)===JSON.stringify(n)?e:n}))}const l=function(t){let{callback:r,disabled:a}=t;const s=xe(r),n=e.useMemo((()=>{if(a||"undefined"==typeof window||void 0===window.MutationObserver)return;const{MutationObserver:e}=window;return new e(s)}),[s,a]);return e.useEffect((()=>()=>null==n?void 0:n.disconnect()),[n]),n}({callback(e){if(t)for(const r of e){const{type:e,target:a}=r;if("childList"===e&&a instanceof HTMLElement&&a.contains(t)){i();break}}}}),o=Vt({callback:i});return me((()=>{i(),t?(null==o||o.observe(t),null==l||l.observe(document.body,{childList:!0,subtree:!0})):(null==o||o.disconnect(),null==l||l.disconnect())}),[t]),s}const Ht=[];function Gt(t,r){void 0===r&&(r=[]);const a=e.useRef(null);return e.useEffect((()=>{a.current=null}),r),e.useEffect((()=>{const e=t!==ze;e&&!a.current&&(a.current=t),!e&&a.current&&(a.current=null)}),[t]),a.current?je(t,a.current):ze}function Zt(t){return e.useMemo((()=>t?function(e){const t=e.innerWidth,r=e.innerHeight;return{top:0,left:0,right:t,bottom:r,width:t,height:r}}(t):null),[t])}const Qt=[];function er(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return ce(t)?t:e}const tr=[{sensor:_t,options:{}},{sensor:St,options:{}}],rr={current:{}},ar={draggable:{measure:Qe},droppable:{measure:Qe,strategy:Bt.WhileDragging,frequency:Xt.Optimized},dragOverlay:{measure:Ze}};class sr extends Map{get(e){var t;return null!=e&&null!=(t=super.get(e))?t:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter((e=>{let{disabled:t}=e;return!t}))}getNodeFor(e){var t,r;return null!=(t=null==(r=this.get(e))?void 0:r.node.current)?t:void 0}}const nr={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new sr,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:Fe},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:ar,measureDroppableContainers:Fe,windowRect:null,measuringScheduled:!1},ir={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:Fe,draggableNodes:new Map,over:null,measureDroppableContainers:Fe},lr=e.createContext(ir),or=e.createContext(nr);function dr(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new sr}}}function cr(e,t){switch(t.type){case Oe.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case Oe.DragMove:return null==e.draggable.active?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case Oe.DragEnd:case Oe.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case Oe.RegisterDroppable:{const{element:r}=t,{id:a}=r,s=new sr(e.droppable.containers);return s.set(a,r),{...e,droppable:{...e.droppable,containers:s}}}case Oe.SetDroppableDisabled:{const{id:r,key:a,disabled:s}=t,n=e.droppable.containers.get(r);if(!n||a!==n.key)return e;const i=new sr(e.droppable.containers);return i.set(r,{...n,disabled:s}),{...e,droppable:{...e.droppable,containers:i}}}case Oe.UnregisterDroppable:{const{id:r,key:a}=t,s=e.droppable.containers.get(r);if(!s||a!==s.key)return e;const n=new sr(e.droppable.containers);return n.delete(r),{...e,droppable:{...e.droppable,containers:n}}}default:return e}}function ur(t){let{disabled:r}=t;const{active:a,activatorEvent:s,draggableNodes:n}=e.useContext(lr),i=ye(s),l=ye(null==a?void 0:a.id);return e.useEffect((()=>{if(!r&&!s&&i&&null!=l){if(!Ne(i))return;if(document.activeElement===i.target)return;const e=n.get(l);if(!e)return;const{activatorNode:t,node:r}=e;if(!t.current&&!r.current)return;requestAnimationFrame((()=>{for(const e of[t.current,r.current]){if(!e)continue;const t=Ee(e);if(t){t.focus();break}}}))}}),[s,r,n,l,i]),null}function gr(e,t){let{transform:r,...a}=t;return null!=e&&e.length?e.reduce(((e,t)=>t({transform:e,...a})),r):r}const mr=e.createContext({...ze,scaleX:1,scaleY:1});var xr,hr;(hr=xr||(xr={}))[hr.Uninitialized=0]="Uninitialized",hr[hr.Initializing=1]="Initializing",hr[hr.Initialized=2]="Initialized";const br=e.memo((function(a){var s,n,i,l;let{id:o,accessibility:d,autoScroll:c=!0,children:u,sensors:g=tr,collisionDetection:m=Ke,measuring:x,modifiers:h,...b}=a;const p=e.useReducer(cr,void 0,dr),[y,f]=p,[v,k]=function(){const[t]=e.useState((()=>new Set)),r=e.useCallback((e=>(t.add(e),()=>t.delete(e))),[t]);return[e.useCallback((e=>{let{type:r,event:a}=e;t.forEach((e=>{var t;return null==(t=e[r])?void 0:t.call(e,a)}))}),[t]),r]}(),[w,j]=e.useState(xr.Uninitialized),N=w===xr.Initialized,{draggable:{active:C,nodes:D,translate:S},droppable:{containers:E}}=y,T=null!=C?D.get(C):null,R=e.useRef({initial:null,translated:null}),I=e.useMemo((()=>{var e;return null!=C?{id:C,data:null!=(e=null==T?void 0:T.data)?e:rr,rect:R}:null}),[C,T]),_=e.useRef(null),[L,M]=e.useState(null),[A,O]=e.useState(null),P=he(b,Object.values(b)),F=ve("DndDescribedBy",o),z=e.useMemo((()=>E.getEnabled()),[E]),$=(U=x,e.useMemo((()=>({draggable:{...ar.draggable,...null==U?void 0:U.draggable},droppable:{...ar.droppable,...null==U?void 0:U.droppable},dragOverlay:{...ar.dragOverlay,...null==U?void 0:U.dragOverlay}})),[null==U?void 0:U.draggable,null==U?void 0:U.droppable,null==U?void 0:U.dragOverlay]));var U;const{droppableRects:B,measureDroppableContainers:q,measuringScheduled:X}=function(t,r){let{dragging:a,dependencies:s,config:n}=r;const[i,l]=e.useState(null),{frequency:o,measure:d,strategy:c}=n,u=e.useRef(t),g=function(){switch(c){case Bt.Always:return!1;case Bt.BeforeDragging:return a;default:return!a}}(),m=he(g),x=e.useCallback((function(e){void 0===e&&(e=[]),m.current||l((t=>null===t?e:t.concat(e.filter((e=>!t.includes(e))))))}),[m]),h=e.useRef(null),b=be((e=>{if(g&&!a)return Yt;if(!e||e===Yt||u.current!==t||null!=i){const e=new Map;for(let r of t){if(!r)continue;if(i&&i.length>0&&!i.includes(r.id)&&r.rect.current){e.set(r.id,r.rect.current);continue}const t=r.node.current,a=t?new bt(d(t),t):null;r.rect.current=a,a&&e.set(r.id,a)}return e}return e}),[t,i,a,g,d]);return e.useEffect((()=>{u.current=t}),[t]),e.useEffect((()=>{g||x()}),[a,g]),e.useEffect((()=>{i&&i.length>0&&l(null)}),[JSON.stringify(i)]),e.useEffect((()=>{g||"number"!=typeof o||null!==h.current||(h.current=setTimeout((()=>{x(),h.current=null}),o))}),[o,g,x,...s]),{droppableRects:b,measureDroppableContainers:x,measuringScheduled:null!=i}}(z,{dragging:N,dependencies:[S.x,S.y],config:$.droppable}),Y=function(e,t){const r=null!=t?e.get(t):void 0,a=r?r.node.current:null;return be((e=>{var r;return null==t?null:null!=(r=null!=a?a:e)?r:null}),[a,t])}(D,C),K=e.useMemo((()=>A?Ce(A):null),[A]),V=function(){const e=!1===(null==L?void 0:L.autoScrollEnabled),t="object"==typeof c?!1===c.enabled:!1===c,r=N&&!e&&!t;return"object"==typeof c?{...c,enabled:r}:{enabled:r}}(),J=function(e,t){return Kt(e,t)}(Y,$.draggable.measure);!function(t){let{activeNode:r,measure:a,initialRect:s,config:n=!0}=t;const i=e.useRef(!1),{x:l,y:o}="boolean"==typeof n?{x:n,y:n}:n;me((()=>{if(!l&&!o||!r)return void(i.current=!1);if(i.current||!s)return;const e=null==r?void 0:r.node.current;if(!e||!1===e.isConnected)return;const t=Ve(a(e),s);if(l||(t.x=0),o||(t.y=0),i.current=!0,Math.abs(t.x)>0||Math.abs(t.y)>0){const r=tt(e);r&&r.scrollBy({top:t.y,left:t.x})}}),[r,l,o,s,a])}({activeNode:null!=C?D.get(C):null,config:V.layoutShiftCompensation,initialRect:J,measure:$.draggable.measure});const W=Wt(Y,$.draggable.measure,J),H=Wt(Y?Y.parentElement:null),G=e.useRef({activatorEvent:null,active:null,activeNode:Y,collisionRect:null,collisions:null,droppableRects:B,draggableNodes:D,draggingNode:null,draggingNodeRect:null,droppableContainers:E,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),Z=E.getNodeFor(null==(s=G.current.over)?void 0:s.id),Q=function(t){let{measure:r}=t;const[a,s]=e.useState(null),n=Vt({callback:e.useCallback((e=>{for(const{target:t}of e)if(ce(t)){s((e=>{const a=r(t);return e?{...e,width:a.width,height:a.height}:a}));break}}),[r])}),i=e.useCallback((e=>{const t=er(e);null==n||n.disconnect(),t&&(null==n||n.observe(t)),s(t?r(t):null)}),[r,n]),[l,o]=pe(i);return e.useMemo((()=>({nodeRef:l,rect:a,setRef:o})),[a,l,o])}({measure:$.dragOverlay.measure}),ee=null!=(n=Q.nodeRef.current)?n:Y,te=N?null!=(i=Q.rect)?i:W:null,re=Boolean(Q.nodeRef.current&&Q.rect),ae=Ve(se=re?null:W,Kt(se));var se;const ie=Zt(ee?oe(ee):null),le=function(t){const r=e.useRef(t),a=be((e=>t?e&&e!==Ht&&t&&r.current&&t.parentNode===r.current.parentNode?e:et(t):Ht),[t]);return e.useEffect((()=>{r.current=t}),[t]),a}(N?null!=Z?Z:Y:null),de=function(t,r){void 0===r&&(r=Ze);const[a]=t,s=Zt(a?oe(a):null),[n,i]=e.useState(Qt);function l(){i((()=>t.length?t.map((e=>ot(e)?s:new bt(r(e),e))):Qt))}const o=Vt({callback:l});return me((()=>{null==o||o.disconnect(),l(),t.forEach((e=>null==o?void 0:o.observe(e)))}),[t]),n}(le),ue=gr(h,{transform:{x:S.x-ae.x,y:S.y-ae.y,scaleX:1,scaleY:1},activatorEvent:A,active:I,activeNodeRect:W,containerNodeRect:H,draggingNodeRect:te,over:G.current.over,overlayNodeRect:Q.rect,scrollableAncestors:le,scrollableAncestorRects:de,windowRect:ie}),ge=K?we(K,S):null,xe=function(t){const[r,a]=e.useState(null),s=e.useRef(t),n=e.useCallback((e=>{const t=rt(e.target);t&&a((e=>e?(e.set(t,nt(t)),new Map(e)):null))}),[]);return e.useEffect((()=>{const e=s.current;if(t!==e){r(e);const i=t.map((e=>{const t=rt(e);return t?(t.addEventListener("scroll",n,{passive:!0}),[t,nt(t)]):null})).filter((e=>null!=e));a(i.length?new Map(i):null),s.current=t}return()=>{r(t),r(e)};function r(e){e.forEach((e=>{const t=rt(e);null==t||t.removeEventListener("scroll",n)}))}}),[n,t]),e.useMemo((()=>t.length?r?Array.from(r.values()).reduce(((e,t)=>we(e,t)),ze):mt(t):ze),[t,r])}(le),fe=Gt(xe),ke=Gt(xe,[W]),je=we(ue,fe),Ne=te?We(te,ue):null,De=I&&Ne?m({active:I,collisionRect:Ne,droppableRects:B,droppableContainers:z,pointerCoordinates:ge}):null,Se=function(e){if(!e||0===e.length)return null;const[t]=e;return t.id}(De),[Ee,Te]=e.useState(null),Re=function(e,t,r){return{...e,scaleX:t&&r?t.width/r.width:1,scaleY:t&&r?t.height/r.height:1}}(re?ue:we(ue,ke),null!=(l=null==Ee?void 0:Ee.rect)?l:null,W),Ie=e.useRef(null),Le=e.useCallback(((e,t)=>{let{sensor:a,options:s}=t;if(null==_.current)return;const n=D.get(_.current);if(!n)return;const i=e.nativeEvent,l=new a({active:_.current,activeNode:n,event:i,options:s,context:G,onAbort(e){if(!D.get(e))return;const{onDragAbort:t}=P.current,r={id:e};null==t||t(r),v({type:"onDragAbort",event:r})},onPending(e,t,r,a){if(!D.get(e))return;const{onDragPending:s}=P.current,n={id:e,constraint:t,initialCoordinates:r,offset:a};null==s||s(n),v({type:"onDragPending",event:n})},onStart(e){const t=_.current;if(null==t)return;const a=D.get(t);if(!a)return;const{onDragStart:s}=P.current,n={activatorEvent:i,active:{id:t,data:a.data,rect:R}};r.unstable_batchedUpdates((()=>{null==s||s(n),j(xr.Initializing),f({type:Oe.DragStart,initialCoordinates:e,active:t}),v({type:"onDragStart",event:n}),M(Ie.current),O(i)}))},onMove(e){f({type:Oe.DragMove,coordinates:e})},onEnd:o(Oe.DragEnd),onCancel:o(Oe.DragCancel)});function o(e){return async function(){const{active:t,collisions:a,over:s,scrollAdjustedTranslate:n}=G.current;let l=null;if(t&&n){const{cancelDrop:r}=P.current;l={activatorEvent:i,active:t,collisions:a,delta:n,over:s},e===Oe.DragEnd&&"function"==typeof r&&await Promise.resolve(r(l))&&(e=Oe.DragCancel)}_.current=null,r.unstable_batchedUpdates((()=>{f({type:e}),j(xr.Uninitialized),Te(null),M(null),O(null),Ie.current=null;const t=e===Oe.DragEnd?"onDragEnd":"onDragCancel";if(l){const e=P.current[t];null==e||e(l),v({type:t,event:l})}}))}}Ie.current=l}),[D]),Me=function(t,r){return e.useMemo((()=>t.reduce(((e,t)=>{const{sensor:a}=t;return[...e,...a.activators.map((e=>({eventName:e.eventName,handler:r(e.handler,t)})))]}),[])),[t,r])}(g,e.useCallback(((e,t)=>(r,a)=>{const s=r.nativeEvent,n=D.get(a);if(null!==_.current||!n||s.dndKit||s.defaultPrevented)return;const i={active:n};!0===e(r,t.options,i)&&(s.dndKit={capturedBy:t.sensor},_.current=a,Le(r,t))}),[D,Le]));!function(t){e.useEffect((()=>{if(!ne)return;const e=t.map((e=>{let{sensor:t}=e;return null==t.setup?void 0:t.setup()}));return()=>{for(const t of e)null==t||t()}}),t.map((e=>{let{sensor:t}=e;return t})))}(g),me((()=>{W&&w===xr.Initializing&&j(xr.Initialized)}),[W,w]),e.useEffect((()=>{const{onDragMove:e}=P.current,{active:t,activatorEvent:a,collisions:s,over:n}=G.current;if(!t||!a)return;const i={active:t,activatorEvent:a,collisions:s,delta:{x:je.x,y:je.y},over:n};r.unstable_batchedUpdates((()=>{null==e||e(i),v({type:"onDragMove",event:i})}))}),[je.x,je.y]),e.useEffect((()=>{const{active:e,activatorEvent:t,collisions:a,droppableContainers:s,scrollAdjustedTranslate:n}=G.current;if(!e||null==_.current||!t||!n)return;const{onDragOver:i}=P.current,l=s.get(Se),o=l&&l.rect.current?{id:l.id,rect:l.rect.current,data:l.data,disabled:l.disabled}:null,d={active:e,activatorEvent:t,collisions:a,delta:{x:n.x,y:n.y},over:o};r.unstable_batchedUpdates((()=>{Te(o),null==i||i(d),v({type:"onDragOver",event:d})}))}),[Se]),me((()=>{G.current={activatorEvent:A,active:I,activeNode:Y,collisionRect:Ne,collisions:De,droppableRects:B,draggableNodes:D,draggingNode:ee,draggingNodeRect:te,droppableContainers:E,over:Ee,scrollableAncestors:le,scrollAdjustedTranslate:je},R.current={initial:te,translated:Ne}}),[I,Y,De,Ne,D,ee,te,B,E,Ee,le,je]),function(t){let{acceleration:r,activator:a=Pt.Pointer,canScroll:s,draggingRect:n,enabled:i,interval:l=5,order:o=zt.TreeOrder,pointerCoordinates:d,scrollableAncestors:c,scrollableAncestorRects:u,delta:g,threshold:m}=t;const x=function(e){let{delta:t,disabled:r}=e;const a=ye(t);return be((e=>{if(r||!a||!e)return Ut;const s=Math.sign(t.x-a.x),n=Math.sign(t.y-a.y);return{x:{[it.Backward]:e.x[it.Backward]||-1===s,[it.Forward]:e.x[it.Forward]||1===s},y:{[it.Backward]:e.y[it.Backward]||-1===n,[it.Forward]:e.y[it.Forward]||1===n}}}),[r,t,a])}({delta:g,disabled:!i}),[h,b]=function(){const t=e.useRef(null);return[e.useCallback(((e,r)=>{t.current=setInterval(e,r)}),[]),e.useCallback((()=>{null!==t.current&&(clearInterval(t.current),t.current=null)}),[])]}(),p=e.useRef({x:0,y:0}),y=e.useRef({x:0,y:0}),f=e.useMemo((()=>{switch(a){case Pt.Pointer:return d?{top:d.y,bottom:d.y,left:d.x,right:d.x}:null;case Pt.DraggableRect:return n}}),[a,n,d]),v=e.useRef(null),k=e.useCallback((()=>{const e=v.current;if(!e)return;const t=p.current.x*y.current.x,r=p.current.y*y.current.y;e.scrollBy(t,r)}),[]),w=e.useMemo((()=>o===zt.TreeOrder?[...c].reverse():c),[o,c]);e.useEffect((()=>{if(i&&c.length&&f){for(const e of w){if(!1===(null==s?void 0:s(e)))continue;const t=c.indexOf(e),a=u[t];if(!a)continue;const{direction:n,speed:i}=ut(e,a,f,r,m);for(const e of["x","y"])x[e][n[e]]||(i[e]=0,n[e]=0);if(i.x>0||i.y>0)return b(),v.current=e,h(k,l),p.current=i,void(y.current=n)}p.current={x:0,y:0},y.current={x:0,y:0},b()}else b()}),[r,k,s,b,i,l,JSON.stringify(f),JSON.stringify(x),h,c,w,u,JSON.stringify(m)])}({...V,delta:S,draggingRect:Ne,pointerCoordinates:ge,scrollableAncestors:le,scrollableAncestorRects:de});const Pe=e.useMemo((()=>({active:I,activeNode:Y,activeNodeRect:W,activatorEvent:A,collisions:De,containerNodeRect:H,dragOverlay:Q,draggableNodes:D,droppableContainers:E,droppableRects:B,over:Ee,measureDroppableContainers:q,scrollableAncestors:le,scrollableAncestorRects:de,measuringConfiguration:$,measuringScheduled:X,windowRect:ie})),[I,Y,W,A,De,H,Q,D,E,B,Ee,q,le,de,$,X,ie]),Fe=e.useMemo((()=>({activatorEvent:A,activators:Me,active:I,activeNodeRect:W,ariaDescribedById:{draggable:F},dispatch:f,draggableNodes:D,over:Ee,measureDroppableContainers:q})),[A,Me,I,W,f,F,D,Ee,q]);return t.createElement(_e.Provider,{value:k},t.createElement(lr.Provider,{value:Fe},t.createElement(or.Provider,{value:Pe},t.createElement(mr.Provider,{value:Re},u)),t.createElement(ur,{disabled:!1===(null==d?void 0:d.restoreFocus)})),t.createElement(Ae,{...d,hiddenTextDescribedById:F}))})),pr=e.createContext(null),yr="button";function fr(){return e.useContext(or)}const vr={timeout:25};function kr(r){let{animation:a,children:s}=r;const[n,i]=e.useState(null),[l,o]=e.useState(null),d=ye(s);return s||n||!d||i(d),me((()=>{if(!l)return;const e=null==n?void 0:n.key,t=null==n?void 0:n.props.id;null!=e&&null!=t?Promise.resolve(a(t,l)).then((()=>{i(null)})):i(null)}),[a,n,l]),t.createElement(t.Fragment,null,s,n?e.cloneElement(n,{ref:o}):null)}const wr={x:0,y:0,scaleX:1,scaleY:1};function jr(e){let{children:r}=e;return t.createElement(lr.Provider,{value:ir},t.createElement(mr.Provider,{value:wr},r))}const Nr={position:"fixed",touchAction:"none"},Cr=e=>Ne(e)?"transform 250ms ease":void 0,Dr=e.forwardRef(((e,r)=>{let{as:a,activatorEvent:s,adjustScale:n,children:i,className:l,rect:o,style:d,transform:c,transition:u=Cr}=e;if(!o)return null;const g=n?c:{...c,scaleX:1,scaleY:1},m={...Nr,width:o.width,height:o.height,top:o.top,left:o.left,transform:De.Transform.toString(g),transformOrigin:n&&s?$e(s,o):void 0,transition:"function"==typeof u?u(s):u,...d};return t.createElement(a,{className:l,style:m,ref:r},i)})),Sr={duration:250,easing:"ease",keyframes:e=>{let{transform:{initial:t,final:r}}=e;return[{transform:De.Transform.toString(t)},{transform:De.Transform.toString(r)}]},sideEffects:(e=>t=>{let{active:r,dragOverlay:a}=t;const s={},{styles:n,className:i}=e;if(null!=n&&n.active)for(const[e,l]of Object.entries(n.active))void 0!==l&&(s[e]=r.node.style.getPropertyValue(e),r.node.style.setProperty(e,l));if(null!=n&&n.dragOverlay)for(const[e,l]of Object.entries(n.dragOverlay))void 0!==l&&a.node.style.setProperty(e,l);return null!=i&&i.active&&r.node.classList.add(i.active),null!=i&&i.dragOverlay&&a.node.classList.add(i.dragOverlay),function(){for(const[e,t]of Object.entries(s))r.node.style.setProperty(e,t);null!=i&&i.active&&r.node.classList.remove(i.active)}})({styles:{active:{opacity:"0"}}})};let Er=0;const Tr=t.memo((r=>{let{adjustScale:a=!1,children:s,dropAnimation:n,style:i,transition:l,modifiers:o,wrapperElement:d="div",className:c,zIndex:u=999}=r;const{activatorEvent:g,active:m,activeNodeRect:x,containerNodeRect:h,draggableNodes:b,droppableContainers:p,dragOverlay:y,over:f,measuringConfiguration:v,scrollableAncestors:k,scrollableAncestorRects:w,windowRect:j}=fr(),N=e.useContext(mr),C=(D=null==m?void 0:m.id,e.useMemo((()=>{if(null!=D)return Er++,Er}),[D]));var D;const S=gr(o,{activatorEvent:g,active:m,activeNodeRect:x,containerNodeRect:h,draggingNodeRect:y.rect,over:f,overlayNodeRect:y.rect,scrollableAncestors:k,scrollableAncestorRects:w,transform:N,windowRect:j}),E=Kt(x),T=function(e){let{config:t,draggableNodes:r,droppableContainers:a,measuringConfiguration:s}=e;return xe(((e,n)=>{if(null===t)return;const i=r.get(e);if(!i)return;const l=i.node.current;if(!l)return;const o=er(n);if(!o)return;const{transform:d}=oe(n).getComputedStyle(n),c=He(d);if(!c)return;const u="function"==typeof t?t:function(e){const{duration:t,easing:r,sideEffects:a,keyframes:s}={...Sr,...e};return e=>{let{active:n,dragOverlay:i,transform:l,...o}=e;if(!t)return;const d=i.rect.left-n.rect.left,c=i.rect.top-n.rect.top,u={scaleX:1!==l.scaleX?n.rect.width*l.scaleX/i.rect.width:1,scaleY:1!==l.scaleY?n.rect.height*l.scaleY/i.rect.height:1},g={x:l.x-d,y:l.y-c,...u},m=s({...o,active:n,dragOverlay:i,transform:{initial:l,final:g}}),[x]=m,h=m[m.length-1];if(JSON.stringify(x)===JSON.stringify(h))return;const b=null==a?void 0:a({active:n,dragOverlay:i,...o}),p=i.node.animate(m,{duration:t,easing:r,fill:"forwards"});return new Promise((e=>{p.onfinish=()=>{null==b||b(),e()}}))}}(t);return xt(l,s.draggable.measure),u({active:{id:e,data:i.data,node:l,rect:s.draggable.measure(l)},draggableNodes:r,dragOverlay:{node:n,rect:s.dragOverlay.measure(o)},droppableContainers:a,measuringConfiguration:s,transform:c})}))}({config:n,draggableNodes:b,droppableContainers:p,measuringConfiguration:v}),R=E?y.setRef:void 0;return t.createElement(jr,null,t.createElement(kr,{animation:T},m&&C?t.createElement(Dr,{key:C,id:m.id,ref:R,as:d,activatorEvent:g,adjustScale:a,className:c,transition:l,rect:E,style:{zIndex:u,...i},transform:S},s):null))}));function Rr(e,t,r){const a=e.slice();return a.splice(r<0?a.length+r:r,0,a.splice(t,1)[0]),a}function Ir(e,t){return e.reduce(((e,r,a)=>{const s=t.get(r);return s&&(e[a]=s),e}),Array(e.length))}function _r(e){return null!==e&&e>=0}const Lr=e=>{let{rects:t,activeIndex:r,overIndex:a,index:s}=e;const n=Rr(t,a,r),i=t[s],l=n[s];return l&&i?{x:l.left-i.left,y:l.top-i.top,scaleX:l.width/i.width,scaleY:l.height/i.height}:null},Mr={scaleX:1,scaleY:1},Ar=e=>{var t;let{activeIndex:r,activeNodeRect:a,index:s,rects:n,overIndex:i}=e;const l=null!=(t=n[r])?t:a;if(!l)return null;if(s===r){const e=n[i];return e?{x:0,y:r<i?e.top+e.height-(l.top+l.height):e.top-l.top,...Mr}:null}const o=function(e,t,r){const a=e[t],s=e[t-1],n=e[t+1];return a?r<t?s?a.top-(s.top+s.height):n?n.top-(a.top+a.height):0:n?n.top-(a.top+a.height):s?a.top-(s.top+s.height):0:0}(n,s,r);return s>r&&s<=i?{x:0,y:-l.height-o,...Mr}:s<r&&s>=i?{x:0,y:l.height+o,...Mr}:{x:0,y:0,...Mr}},Or="Sortable",Pr=t.createContext({activeIndex:-1,containerId:Or,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:Lr,disabled:{draggable:!1,droppable:!1}});function Fr(r){let{children:a,id:s,items:n,strategy:i=Lr,disabled:l=!1}=r;const{active:o,dragOverlay:d,droppableRects:c,over:u,measureDroppableContainers:g}=fr(),m=ve(Or,s),x=Boolean(null!==d.rect),h=e.useMemo((()=>n.map((e=>"object"==typeof e&&"id"in e?e.id:e))),[n]),b=null!=o,p=o?h.indexOf(o.id):-1,y=u?h.indexOf(u.id):-1,f=e.useRef(h),v=!function(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}(h,f.current),k=-1!==y&&-1===p||v,w=function(e){return"boolean"==typeof e?{draggable:e,droppable:e}:e}(l);me((()=>{v&&b&&g(h)}),[v,h,b,g]),e.useEffect((()=>{f.current=h}),[h]);const j=e.useMemo((()=>({activeIndex:p,containerId:m,disabled:w,disableTransforms:k,items:h,overIndex:y,useDragOverlay:x,sortedRects:Ir(h,c),strategy:i})),[p,m,w.draggable,w.droppable,k,h,y,c,x,i]);return t.createElement(Pr.Provider,{value:j},a)}const zr=e=>{let{id:t,items:r,activeIndex:a,overIndex:s}=e;return Rr(r,a,s).indexOf(t)},$r=e=>{let{containerId:t,isSorting:r,wasDragging:a,index:s,items:n,newIndex:i,previousItems:l,previousContainerId:o,transition:d}=e;return!(!d||!a||l!==n&&s===i||!r&&(i===s||t!==o))},Ur={duration:200,easing:"ease"},Br="transform",qr=De.Transition.toString({property:Br,duration:0,easing:"linear"}),Xr={roleDescription:"sortable"};function Yr(t){let{animateLayoutChanges:r=$r,attributes:a,disabled:s,data:n,getNewIndex:i=zr,id:l,strategy:o,resizeObserverConfig:d,transition:c=Ur}=t;const{items:u,containerId:g,activeIndex:m,disabled:x,disableTransforms:h,sortedRects:b,overIndex:p,useDragOverlay:y,strategy:f}=e.useContext(Pr),v=function(e,t){var r,a;return"boolean"==typeof e?{draggable:e,droppable:!1}:{draggable:null!=(r=null==e?void 0:e.draggable)?r:t.draggable,droppable:null!=(a=null==e?void 0:e.droppable)?a:t.droppable}}(s,x),k=u.indexOf(l),w=e.useMemo((()=>({sortable:{containerId:g,index:k,items:u},...n})),[g,n,k,u]),j=e.useMemo((()=>u.slice(u.indexOf(l))),[u,l]),{rect:N,node:C,isOver:D,setNodeRef:S}=function(t){let{data:r,disabled:a=!1,id:s,resizeObserverConfig:n}=t;const i=ve("Droppable"),{active:l,dispatch:o,over:d,measureDroppableContainers:c}=e.useContext(lr),u=e.useRef({disabled:a}),g=e.useRef(!1),m=e.useRef(null),x=e.useRef(null),{disabled:h,updateMeasurementsFor:b,timeout:p}={...vr,...n},y=he(null!=b?b:s),f=Vt({callback:e.useCallback((()=>{g.current?(null!=x.current&&clearTimeout(x.current),x.current=setTimeout((()=>{c(Array.isArray(y.current)?y.current:[y.current]),x.current=null}),p)):g.current=!0}),[p]),disabled:h||!l}),v=e.useCallback(((e,t)=>{f&&(t&&(f.unobserve(t),g.current=!1),e&&f.observe(e))}),[f]),[k,w]=pe(v),j=he(r);return e.useEffect((()=>{f&&k.current&&(f.disconnect(),g.current=!1,f.observe(k.current))}),[k,f]),e.useEffect((()=>(o({type:Oe.RegisterDroppable,element:{id:s,key:i,disabled:a,node:k,rect:m,data:j}}),()=>o({type:Oe.UnregisterDroppable,key:i,id:s}))),[s]),e.useEffect((()=>{a!==u.current.disabled&&(o({type:Oe.SetDroppableDisabled,id:s,key:i,disabled:a}),u.current.disabled=a)}),[s,i,a,o]),{active:l,rect:m,isOver:(null==d?void 0:d.id)===s,node:k,over:d,setNodeRef:w}}({id:l,data:w,disabled:v.droppable,resizeObserverConfig:{updateMeasurementsFor:j,...d}}),{active:E,activatorEvent:T,activeNodeRect:R,attributes:I,setNodeRef:_,listeners:L,isDragging:M,over:A,setActivatorNodeRef:O,transform:P}=function(t){let{id:r,data:a,disabled:s=!1,attributes:n}=t;const i=ve("Draggable"),{activators:l,activatorEvent:o,active:d,activeNodeRect:c,ariaDescribedById:u,draggableNodes:g,over:m}=e.useContext(lr),{role:x=yr,roleDescription:h="draggable",tabIndex:b=0}=null!=n?n:{},p=(null==d?void 0:d.id)===r,y=e.useContext(p?mr:pr),[f,v]=pe(),[k,w]=pe(),j=function(t,r){return e.useMemo((()=>t.reduce(((e,t)=>{let{eventName:a,handler:s}=t;return e[a]=e=>{s(e,r)},e}),{})),[t,r])}(l,r),N=he(a);return me((()=>(g.set(r,{id:r,key:i,node:f,activatorNode:k,data:N}),()=>{const e=g.get(r);e&&e.key===i&&g.delete(r)})),[g,r]),{active:d,activatorEvent:o,activeNodeRect:c,attributes:e.useMemo((()=>({role:x,tabIndex:b,"aria-disabled":s,"aria-pressed":!(!p||x!==yr)||void 0,"aria-roledescription":h,"aria-describedby":u.draggable})),[s,x,b,p,h,u.draggable]),isDragging:p,listeners:s?void 0:j,node:f,over:m,setNodeRef:v,setActivatorNodeRef:w,transform:y}}({id:l,data:w,attributes:{...Xr,...a},disabled:v.draggable}),F=function(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return e.useMemo((()=>e=>{r.forEach((t=>t(e)))}),r)}(S,_),z=Boolean(E),$=z&&!h&&_r(m)&&_r(p),U=!y&&M,B=U&&$?P:null,q=$?null!=B?B:(null!=o?o:f)({rects:b,activeNodeRect:R,activeIndex:m,overIndex:p,index:k}):null,X=_r(m)&&_r(p)?i({id:l,items:u,activeIndex:m,overIndex:p}):k,Y=null==E?void 0:E.id,K=e.useRef({activeId:Y,items:u,newIndex:X,containerId:g}),V=u!==K.current.items,J=r({active:E,containerId:g,isDragging:M,isSorting:z,id:l,index:k,items:u,newIndex:K.current.newIndex,previousItems:K.current.items,previousContainerId:K.current.containerId,transition:c,wasDragging:null!=K.current.activeId}),W=function(t){let{disabled:r,index:a,node:s,rect:n}=t;const[i,l]=e.useState(null),o=e.useRef(a);return me((()=>{if(!r&&a!==o.current&&s.current){const e=n.current;if(e){const t=Ze(s.current,{ignoreTransform:!0}),r={x:e.left-t.left,y:e.top-t.top,scaleX:e.width/t.width,scaleY:e.height/t.height};(r.x||r.y)&&l(r)}}a!==o.current&&(o.current=a)}),[r,a,s,n]),e.useEffect((()=>{i&&l(null)}),[i]),i}({disabled:!J,index:k,node:C,rect:N});return e.useEffect((()=>{z&&K.current.newIndex!==X&&(K.current.newIndex=X),g!==K.current.containerId&&(K.current.containerId=g),u!==K.current.items&&(K.current.items=u)}),[z,X,g,u]),e.useEffect((()=>{if(Y===K.current.activeId)return;if(null!=Y&&null==K.current.activeId)return void(K.current.activeId=Y);const e=setTimeout((()=>{K.current.activeId=Y}),50);return()=>clearTimeout(e)}),[Y]),{active:E,activeIndex:m,attributes:I,data:w,rect:N,index:k,newIndex:X,items:u,isOver:D,isSorting:z,isDragging:M,listeners:L,node:C,overIndex:p,over:A,setNodeRef:F,setActivatorNodeRef:O,setDroppableNodeRef:S,setDraggableNodeRef:_,transform:null!=W?W:q,transition:W||V&&K.current.newIndex===k?qr:U&&!Ne(T)||!c?void 0:z||J?De.Transition.toString({...c,property:Br}):void 0}}kt.Down,kt.Right,kt.Up,kt.Left;const Kr=[{id:"my-tasks",title:"To Do",color:"border-gray-300 dark:border-gray-600",bgGradient:"bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-800 dark:to-gray-850"},{id:"in-progress",title:"In Progress",color:"border-orange-300 dark:border-orange-600",bgGradient:"bg-gradient-to-br from-orange-50 to-orange-100 dark:from-orange-900/20 dark:to-orange-800/20"},{id:"completed",title:"Completed",color:"border-green-300 dark:border-green-600",bgGradient:"bg-gradient-to-br from-green-50 to-green-100 dark:from-green-900/20 dark:to-green-800/20"}],Vr=t.memo((function({tasks:t,onTaskUpdate:r,onTaskClick:s}){const[n,i]=e.useState(null),l=function(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return e.useMemo((()=>[...r].filter((e=>null!=e))),[...r])}((o=_t,d={activationConstraint:{distance:8}},e.useMemo((()=>({sensor:o,options:null!=d?d:{}})),[o,d])));var o,d;const c=Kr.reduce(((e,r)=>(e[r.id]=t.filter((e=>e.status===r.id)),e)),{});return a.jsxs(br,{sensors:l,collisionDetection:Xe,onDragStart:e=>{const r=t.find((t=>t.id===e.active.id));r&&i(r)},onDragEnd:async e=>{const{active:a,over:s}=e;if(i(null),!s)return;const n=a.id,l=s.id,o=t.find((e=>e.id===n));if(o&&o.status!==l)try{const e=await Q(n,{status:l});r(e)}catch(d){}},children:[a.jsx("div",{className:"flex gap-4 lg:gap-6 overflow-x-auto pb-6 min-h-[500px] sm:min-h-[600px] px-4 sm:px-6 py-4 scrollbar-hide",children:Kr.map((e=>a.jsx(Jr,{status:e,tasks:c[e.id],onTaskClick:s},e.id)))}),a.jsx(Tr,{children:n&&a.jsx(Hr,{task:n,isDragging:!0})})]})}));function Jr({status:e,tasks:t,onTaskClick:r}){return a.jsx("div",{className:"flex-shrink-0 w-80 sm:w-[340px] lg:w-[360px]",children:a.jsxs("div",{className:`${e.bgGradient} ${e.color} border-2 rounded-2xl p-5 h-full shadow-sm`,children:[a.jsxs("div",{className:"flex items-center justify-between mb-5 pb-3 border-b-2 border-gray-200 dark:border-gray-600",children:[a.jsx("h3",{className:"font-bold text-lg text-gray-900 dark:text-white flex items-center gap-2",children:e.title}),a.jsx("span",{className:"inline-flex items-center justify-center min-w-[28px] h-7 px-2.5 bg-white dark:bg-gray-700 text-gray-900 dark:text-white rounded-full text-sm font-semibold shadow-sm",children:t.length})]}),a.jsx(Fr,{items:t.map((e=>e.id)),strategy:Ar,children:a.jsx("div",{className:"space-y-3 min-h-[450px]",children:0===t.length?a.jsxs("div",{className:"flex flex-col items-center justify-center text-center text-gray-500 dark:text-gray-400 py-12 px-4",children:[a.jsx("div",{className:"w-16 h-16 rounded-full bg-white dark:bg-gray-700 flex items-center justify-center mb-3 shadow-sm",children:a.jsx(n,{className:"w-8 h-8"})}),a.jsx("p",{className:"text-sm font-medium",children:"No tasks yet"}),a.jsx("p",{className:"text-xs mt-1",children:"Drag tasks here"})]}):t.map((e=>a.jsx(Wr,{task:e,onClick:()=>r(e)},e.id)))})})]})})}function Wr({task:e,onClick:t}){const{attributes:r,listeners:s,setNodeRef:n,transform:i,transition:l,isDragging:o}=Yr({id:e.id}),d={transform:De.Transform.toString(i),transition:l,opacity:o?.5:1};return a.jsx("div",{ref:n,style:d,children:a.jsx(Hr,{task:e,onClick:t,dragHandleProps:{...r,...s}})})}function Hr({task:e,onClick:t,isDragging:r,dragHandleProps:s}){const o=new Date(e.dueDate)<new Date&&"completed"!==e.status;return a.jsxs("div",{className:`\n        relative bg-white dark:bg-gray-750 rounded-xl p-4 shadow-md border-2 border-gray-200 dark:border-gray-600\n        hover:shadow-xl hover:border-blue-300 dark:hover:border-blue-600 transition-all duration-200 cursor-pointer group touch-manipulation\n        ${r?"rotate-2 scale-105 shadow-2xl opacity-75":""}\n        ${o?"ring-2 ring-red-500 ring-offset-2 dark:ring-offset-gray-900":""}\n      `,onClick:t,children:[o&&a.jsx("div",{className:"absolute -top-1 -right-1 w-4 h-4 bg-red-500 rounded-full animate-pulse"}),a.jsxs("div",{className:"flex items-start gap-3",children:[s&&a.jsx("button",{...s,className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 cursor-grab active:cursor-grabbing mt-1 transition-colors",onClick:e=>e.stopPropagation(),children:a.jsx(i,{className:"w-5 h-5"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-semibold text-base text-gray-900 dark:text-white mb-2 line-clamp-2 group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors",children:e.name}),e.description&&a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3 line-clamp-2",children:e.description}),a.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-3",children:[a.jsx("span",{className:`px-3 py-1 rounded-lg text-xs font-semibold border ${{low:"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-300 border-gray-200 dark:border-gray-600",medium:"bg-blue-100 text-blue-700 dark:bg-blue-900/40 dark:text-blue-300 border-blue-200 dark:border-blue-700",high:"bg-orange-100 text-orange-700 dark:bg-orange-900/40 dark:text-orange-300 border-orange-200 dark:border-orange-700",urgent:"bg-red-100 text-red-700 dark:bg-red-900/40 dark:text-red-300 border-red-200 dark:border-red-700"}[e.priority]}`,children:e.priority.charAt(0).toUpperCase()+e.priority.slice(1)}),a.jsx("span",{className:"px-3 py-1 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg text-xs font-medium capitalize",children:e.category.replace("-"," ")}),o&&a.jsxs("span",{className:"flex items-center gap-1 px-3 py-1 bg-red-100 text-red-700 dark:bg-red-900/40 dark:text-red-300 rounded-lg text-xs font-semibold border border-red-200 dark:border-red-700",children:[a.jsx(n,{className:"w-3.5 h-3.5"}),"Overdue"]})]}),a.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-600",children:[a.jsx(l,{className:"w-4 h-4 text-gray-500 dark:text-gray-400"}),a.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:new Date(e.dueDate).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})})]})]})]})]})}function Gr(){return a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-white dark:bg-gray-900",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"w-12 h-12 border-4 border-blue-600/20 dark:border-blue-400/20 border-t-blue-600 dark:border-t-blue-400 rounded-full animate-spin mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:"Loading..."})]})})}const Zr={primary:["#3b82f6","#8b5cf6","#ec4899","#f59e0b","#10b981","#6366f1"],status:{"my-tasks":"#94a3b8","in-progress":"#f59e0b",completed:"#10b981"},priority:{low:"#94a3b8",medium:"#3b82f6",high:"#f59e0b",urgent:"#ef4444"}};function Qr({sectionId:t}){const[r,i]=e.useState(null),[l,u]=e.useState(!0),[g,m]=e.useState(null);e.useEffect((()=>{x()}),[t]);const x=async()=>{try{u(!0),m(null);const e=await async function(e){const t=await async function(e){const{data:t,error:r}=await s.rpc("get_task_statistics",{p_section_id:e||null,p_user_id:null,p_start_date:null,p_end_date:null});if(r)throw new Error(`Failed to fetch statistics: ${r.message}`);return t[0]}(e);let r=s.from("tasks").select("category");e&&(r=r.eq("section_id",e));const{data:a}=await r,n=Object.entries((a||[]).reduce(((e,t)=>(e[t.category]=(e[t.category]||0)+1,e)),{})).map((([e,t])=>({category:e,count:t})));let i=s.from("tasks").select("priority");e&&(i=i.eq("section_id",e));const{data:l}=await i,o=Object.entries((l||[]).reduce(((e,t)=>(e[t.priority]=(e[t.priority]||0)+1,e)),{})).map((([e,t])=>({priority:e,count:t})));let d=s.from("tasks").select("status");e&&(d=d.eq("section_id",e));const{data:c}=await d,u=Object.entries((c||[]).reduce(((e,t)=>(e[t.status]=(e[t.status]||0)+1,e)),{})).map((([e,t])=>({status:e,count:t}))),g=new Date;g.setDate(g.getDate()-30);let m=s.from("tasks").select("created_at, completed_at").gte("created_at",g.toISOString());e&&(m=m.eq("section_id",e)),await m;const x=(new Date).toISOString().split("T")[0];let h=s.from("tasks").select("category").lt("due_date",x).neq("status","completed");e&&(h=h.eq("section_id",e));const{data:b}=await h;return{statistics:t,categoryDistribution:n,priorityDistribution:o,statusDistribution:u,completionTrend:[],overdueByCategory:Object.entries((b||[]).reduce(((e,t)=>(e[t.category]=(e[t.category]||0)+1,e)),{})).map((([e,t])=>({category:e,count:t}))),userPerformance:[]}}(t);i(e)}catch(e){m(e.message)}finally{u(!1)}};if(l)return a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx(Gr,{})});if(g)return a.jsxs("div",{className:"text-center text-red-600 dark:text-red-400 p-8",children:[a.jsx(n,{className:"w-12 h-12 mx-auto mb-4"}),a.jsxs("p",{children:["Failed to load analytics: ",g]}),a.jsx("button",{onClick:x,className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Retry"})]});if(!r)return null;const{statistics:h}=r;return a.jsxs("div",{className:"space-y-6 p-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[a.jsx(ea,{title:"Total Tasks",value:h.totalTasks,icon:a.jsx(o,{className:"w-6 h-6"}),color:"blue"}),a.jsx(ea,{title:"Completed",value:h.completedTasks,subtitle:`${h.completionRate.toFixed(1)}% completion`,icon:a.jsx(d,{className:"w-6 h-6"}),color:"green",trend:h.completionRate>=70?"up":"down"}),a.jsx(ea,{title:"In Progress",value:h.inProgressTasks,icon:a.jsx(c,{className:"w-6 h-6"}),color:"orange"}),a.jsx(ea,{title:"Overdue",value:h.overdueTasks,icon:a.jsx(n,{className:"w-6 h-6"}),color:"red",trend:h.overdueTasks>0?"down":void 0})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsx(ta,{title:"Tasks by Category",children:a.jsx($,{width:"100%",height:300,children:a.jsxs(U,{data:r.categoryDistribution,children:[a.jsx(B,{strokeDasharray:"3 3",className:"stroke-gray-200 dark:stroke-gray-700"}),a.jsx(q,{dataKey:"category",className:"text-xs",angle:-45,textAnchor:"end",height:100}),a.jsx(X,{}),a.jsx(Y,{contentStyle:{backgroundColor:"rgba(255, 255, 255, 0.95)",border:"1px solid #e5e7eb",borderRadius:"8px"}}),a.jsx(K,{dataKey:"count",fill:"#3b82f6",radius:[8,8,0,0]})]})})}),a.jsx(ta,{title:"Tasks by Priority",children:a.jsx($,{width:"100%",height:300,children:a.jsxs(V,{children:[a.jsx(J,{data:r.priorityDistribution,dataKey:"count",nameKey:"priority",cx:"50%",cy:"50%",outerRadius:100,label:e=>`${e.priority}: ${e.count}`,children:r.priorityDistribution.map(((e,t)=>a.jsx(W,{fill:Zr.priority[e.priority]||Zr.primary[t]},`cell-${t}`)))}),a.jsx(Y,{}),a.jsx(H,{})]})})}),a.jsx(ta,{title:"Tasks by Status",children:a.jsx($,{width:"100%",height:300,children:a.jsxs(V,{children:[a.jsx(J,{data:r.statusDistribution,dataKey:"count",nameKey:"status",cx:"50%",cy:"50%",outerRadius:100,label:e=>`${e.status}: ${e.count}`,children:r.statusDistribution.map(((e,t)=>a.jsx(W,{fill:Zr.status[e.status]||Zr.primary[t]},`cell-${t}`)))}),a.jsx(Y,{}),a.jsx(H,{})]})})}),r.overdueByCategory.length>0&&a.jsx(ta,{title:"Overdue Tasks by Category",children:a.jsx($,{width:"100%",height:300,children:a.jsxs(U,{data:r.overdueByCategory,children:[a.jsx(B,{strokeDasharray:"3 3",className:"stroke-gray-200 dark:stroke-gray-700"}),a.jsx(q,{dataKey:"category",className:"text-xs",angle:-45,textAnchor:"end",height:100}),a.jsx(X,{}),a.jsx(Y,{contentStyle:{backgroundColor:"rgba(255, 255, 255, 0.95)",border:"1px solid #e5e7eb",borderRadius:"8px"}}),a.jsx(K,{dataKey:"count",fill:"#ef4444",radius:[8,8,0,0]})]})})})]}),h.highPriorityTasks>0&&a.jsx("div",{className:"bg-orange-50 dark:bg-orange-900/20 border border-orange-200 dark:border-orange-800 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(n,{className:"w-5 h-5 text-orange-600 dark:text-orange-400"}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold text-orange-900 dark:text-orange-100",children:"High Priority Tasks"}),a.jsxs("p",{className:"text-sm text-orange-700 dark:text-orange-300",children:["You have ",h.highPriorityTasks," high priority or urgent tasks that need attention."]})]})]})})]})}function ea({title:e,value:t,subtitle:r,icon:s,color:n,trend:i}){return a.jsxs("div",{className:`${{blue:"bg-blue-50 dark:bg-blue-900/20 text-blue-600 dark:text-blue-400 border-blue-200 dark:border-blue-800",green:"bg-green-50 dark:bg-green-900/20 text-green-600 dark:text-green-400 border-green-200 dark:border-green-800",orange:"bg-orange-50 dark:bg-orange-900/20 text-orange-600 dark:text-orange-400 border-orange-200 dark:border-orange-800",red:"bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400 border-red-200 dark:border-red-800"}[n]} border rounded-lg p-4 transition-all hover:shadow-md`,children:[a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"text-sm font-medium opacity-80",children:e}),a.jsx("p",{className:"text-3xl font-bold mt-2",children:t.toLocaleString()}),r&&a.jsx("p",{className:"text-xs mt-1 opacity-70",children:r})]}),a.jsx("div",{className:"p-2 rounded-lg bg-white dark:bg-gray-800",children:s})]}),i&&a.jsx("div",{className:"mt-2 flex items-center gap-1 text-sm",children:"up"===i?a.jsxs(a.Fragment,{children:[a.jsx(u,{className:"w-4 h-4"}),a.jsx("span",{className:"text-xs",children:"Good performance"})]}):a.jsxs(a.Fragment,{children:[a.jsx(g,{className:"w-4 h-4"}),a.jsx("span",{className:"text-xs",children:"Needs attention"})]})})]})}function ta({title:e,children:t}){return a.jsxs("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-6 shadow-sm",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:e}),t]})}function ra({userId:t,sectionId:r,onCreateFromTemplate:n}){const[i,l]=e.useState([]),[o,d]=e.useState(!0),[c,u]=e.useState(!1);e.useState(null),e.useEffect((()=>{g()}),[r]);const g=async()=>{try{d(!0);const e=await async function(e){let t=s.from("task_templates").select("\n      *,\n      section:sections(id, name)\n    ").eq("is_active",!0).order("use_count",{ascending:!1});e&&(t=t.or(`section_id.eq.${e},section_id.is.null`));const{data:r,error:a}=await t;if(a)throw new Error(`Failed to fetch templates: ${a.message}`);return(r||[]).map(se)}(r);l(e)}catch(e){}finally{d(!1)}};return o?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx(Gr,{})}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Task Templates"}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"Create and manage reusable task templates"})]}),a.jsxs("button",{onClick:()=>u(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[a.jsx(m,{className:"w-4 h-4"}),"New Template"]})]}),c&&a.jsx(sa,{userId:t,sectionId:r,onClose:()=>u(!1),onCreated:e=>{l([e,...i]),u(!1)}}),0===i.length?a.jsxs("div",{className:"text-center py-12 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[a.jsx(x,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"No templates yet"}),a.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"Create your first template to quickly generate tasks"}),a.jsx("button",{onClick:()=>u(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Create Template"})]}):a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:i.map((e=>a.jsx(aa,{template:e,onUse:()=>(async e=>{try{const r=await async function(e,t){const{data:r,error:a}=await s.from("task_templates").select("*").eq("id",t).single();if(a)throw new Error(`Failed to fetch template: ${a.message}`);const n=new Date;n.setDate(n.getDate()+r.default_due_days);const i={name:r.name,description:r.description||"",category:r.category,dueDate:n.toISOString().split("T")[0],priority:r.priority,tags:r.tags,sectionId:r.section_id},l=await Z(e,i);return await s.from("task_templates").update({use_count:r.use_count+1}).eq("id",t),l}(t,e.id);alert(`Task "${r.name}" created from template!`),n&&n({name:r.name,description:r.description,category:r.category,dueDate:r.dueDate,priority:r.priority,tags:r.tags})}catch(r){alert("Failed to create task from template")}})(e),onDelete:()=>(async e=>{if(confirm("Are you sure you want to delete this template?"))try{await async function(e){const{error:t}=await s.from("task_templates").delete().eq("id",e);if(t)throw new Error(`Failed to delete template: ${t.message}`)}(e),l(i.filter((t=>t.id!==e)))}catch(t){alert("Failed to delete template")}})(e.id)},e.id)))})]})}function aa({template:e,onUse:t,onDelete:r}){return a.jsxs("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-4 hover:shadow-lg transition-all",children:[a.jsxs("div",{className:"flex items-start justify-between mb-3",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-1",children:e.name}),e.description&&a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 line-clamp-2",children:e.description})]}),a.jsx("button",{onClick:r,className:"text-gray-400 hover:text-red-600 dark:hover:text-red-400 transition-colors",children:a.jsx(h,{className:"w-4 h-4"})})]}),a.jsxs("div",{className:"space-y-2 mb-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${{low:"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-300",medium:"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300",high:"bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-300",urgent:"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-300"}[e.priority]}`,children:e.priority.toUpperCase()}),a.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-400 capitalize",children:e.category.replace("-"," ")})]}),e.tags.length>0&&a.jsx("div",{className:"flex flex-wrap gap-1",children:e.tags.slice(0,3).map(((e,t)=>a.jsx("span",{className:"px-2 py-1 bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-300 rounded text-xs",children:e},t)))}),a.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-600 dark:text-gray-400",children:[a.jsx(u,{className:"w-3 h-3"}),a.jsxs("span",{children:["Used ",e.useCount," times"]}),a.jsx("span",{children:"â€¢"}),a.jsxs("span",{children:["Due in ",e.defaultDueDays," days"]})]})]}),a.jsxs("button",{onClick:t,className:"w-full flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[a.jsx(b,{className:"w-4 h-4"}),"Use Template"]})]})}function sa({userId:t,sectionId:r,onClose:n,onCreated:i}){const[l,o]=e.useState({name:"",description:"",category:"assignment",priority:"medium",tags:"",defaultDueDays:7}),[d,c]=e.useState(!1);return e.useEffect((()=>()=>{c(!1)}),[]),a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg max-w-2xl w-full p-6 max-h-[90vh] overflow-y-auto",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4",children:"Create Task Template"}),a.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),!d){c(!0);try{const e=await async function(e,t){const{data:r,error:a}=await s.from("task_templates").insert({name:t.name,description:t.description,category:t.category,priority:t.priority,tags:t.tags,default_due_days:t.defaultDueDays,section_id:t.sectionId,created_by:e,is_active:t.isActive}).select("\n      *,\n      section:sections(id, name)\n    ").single();if(a)throw new Error(`Failed to create template: ${a.message}`);return se(r)}(t,{name:l.name,description:l.description||null,category:l.category,priority:l.priority,tags:l.tags.split(",").map((e=>e.trim())).filter(Boolean),defaultDueDays:l.defaultDueDays,sectionId:r||null,createdBy:t,isActive:!0});c(!1),i(e)}catch(a){alert("Failed to create template"),c(!1)}}},className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Template Name *"}),a.jsx("input",{type:"text",required:!0,value:l.name,onChange:e=>o({...l,name:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"e.g., Weekly Assignment Template"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Description"}),a.jsx("textarea",{value:l.description,onChange:e=>o({...l,description:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",rows:3,placeholder:"Template description..."})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Category *"}),a.jsxs("select",{required:!0,value:l.category,onChange:e=>o({...l,category:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[a.jsx("option",{value:"assignment",children:"Assignment"}),a.jsx("option",{value:"quiz",children:"Quiz"}),a.jsx("option",{value:"presentation",children:"Presentation"}),a.jsx("option",{value:"project",children:"Project"}),a.jsx("option",{value:"lab-report",children:"Lab Report"}),a.jsx("option",{value:"midterm",children:"Midterm"}),a.jsx("option",{value:"final-exam",children:"Final Exam"}),a.jsx("option",{value:"task",children:"Task"}),a.jsx("option",{value:"others",children:"Others"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Priority *"}),a.jsxs("select",{required:!0,value:l.priority,onChange:e=>o({...l,priority:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",children:[a.jsx("option",{value:"low",children:"Low"}),a.jsx("option",{value:"medium",children:"Medium"}),a.jsx("option",{value:"high",children:"High"}),a.jsx("option",{value:"urgent",children:"Urgent"})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Default Due Days *"}),a.jsx("input",{type:"number",required:!0,min:"1",value:l.defaultDueDays,onChange:e=>o({...l,defaultDueDays:parseInt(e.target.value)}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"}),a.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Number of days from creation date for due date"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Tags (comma-separated)"}),a.jsx("input",{type:"text",value:l.tags,onChange:e=>o({...l,tags:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white",placeholder:"e.g., important, weekly, math"})]}),a.jsxs("div",{className:"flex gap-3 pt-4",children:[a.jsx("button",{type:"button",onClick:n,className:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700",disabled:d,children:"Cancel"}),a.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",disabled:d,children:d?"Creating...":"Create Template"})]})]})]})})}const na=e.memo((({userId:t,sectionId:r,task:i,onClose:l,onTaskCreated:o,onTaskUpdated:d})=>{var c,u;const g=!!i,m=e.useRef(!0),x=e.useRef(),[b,j]=e.useState({name:(null==i?void 0:i.name)||"",description:(null==i?void 0:i.description)||"",category:(null==i?void 0:i.category)||"assignment",dueDate:(null==i?void 0:i.dueDate)||"",priority:(null==i?void 0:i.priority)||"medium",googleDriveLinks:(null==(c=null==i?void 0:i.googleDriveLinks)?void 0:c.join("\n"))||""}),[N,C]=e.useState(!1),[D,S]=e.useState(!1),[E,T]=e.useState(null),[R,I]=e.useState({}),[_,L]=e.useState((null==(u=null==i?void 0:i.attachments)?void 0:u.map((e=>{var t;return{url:e,name:(null==(t=e.split("/").pop())?void 0:t.split("_").slice(0,-2).join("_"))||"file",size:0}})))||[]),M=e.useRef(null),A=e.useRef(null);e.useEffect((()=>(m.current=!0,S(!1),C(!1),()=>{m.current=!1,x.current&&x.current.abort()})),[]),e.useEffect((()=>{const e=()=>{"visible"===document.visibilityState&&D&&A.current&&Date.now()-A.current>2e4&&(S(!1),T("Operation may have timed out. Please try again."),x.current&&x.current.abort())};return document.addEventListener("visibilitychange",e),()=>{document.removeEventListener("visibilitychange",e)}}),[D]),e.useEffect((()=>{A.current=D?Date.now():null}),[D]);const O=e.useCallback((e=>{L((t=>t.filter(((t,r)=>r!==e))))}),[]),P=e=>{if(0===e)return"Unknown size";const t=Math.floor(Math.log(e)/Math.log(1024));return Math.round(e/Math.pow(1024,t)*100)/100+" "+["Bytes","KB","MB","GB"][t]},F=e.useCallback((async e=>{if(e.preventDefault(),D)return;S(!0),T(null),x.current=new AbortController;const a=setTimeout((()=>{m.current&&D&&(S(!1),T("Request timed out. Please try again."))}),3e4);try{const e=b.googleDriveLinks.split("\n").map((e=>e.trim())).filter(Boolean);if(g){const t={name:b.name,description:b.description,category:b.category,dueDate:b.dueDate,priority:b.priority,attachments:_.map((e=>e.url)),googleDriveLinks:e},r=await Q(i.id,t);clearTimeout(a),m.current&&(null==d||d(r),l())}else{const s={name:b.name,description:b.description,category:b.category,dueDate:b.dueDate,priority:b.priority,sectionId:r,attachments:_.map((e=>e.url)),googleDriveLinks:e},n=await Z(t,s,r,x.current.signal);clearTimeout(a),m.current&&(S(!1),null==o||o(n),l())}}catch(s){if(clearTimeout(a),"Operation cancelled"===(null==s?void 0:s.message))return;if(m.current){const e=(null==s?void 0:s.message)||"Failed to save task. Please try again.";T(e),S(!1)}}}),[D,b,g,i,_,t,r,o,d,l]);return a.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4 animate-in fade-in duration-200",children:a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl max-w-3xl w-full max-h-[90vh] overflow-hidden shadow-2xl border-2 border-gray-200 dark:border-gray-700",children:[a.jsxs("div",{className:"flex items-center justify-between p-6 border-b-2 border-gray-200 dark:border-gray-700 bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-gray-800 dark:to-gray-750",children:[a.jsx("h2",{className:"text-2xl font-bold bg-gradient-to-r from-blue-600 to-indigo-600 dark:from-blue-400 dark:to-indigo-400 bg-clip-text text-transparent",children:g?"Edit Task":"Create New Task"}),a.jsx("button",{onClick:l,disabled:D,className:"p-2 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 disabled:opacity-50 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-all duration-200","aria-label":"Close form",children:a.jsx(p,{className:"w-6 h-6"})})]}),E&&a.jsxs("div",{className:"mx-6 mt-4 p-4 bg-red-50 dark:bg-red-900/20 border-2 border-red-200 dark:border-red-800 rounded-xl flex items-start gap-3",children:[a.jsx(n,{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"text-sm font-medium text-red-700 dark:text-red-300",children:E}),a.jsxs("button",{type:"button",onClick:()=>T(null),className:"mt-2 text-sm text-red-600 dark:text-red-400 hover:underline flex items-center gap-1 font-medium",children:[a.jsx(y,{className:"w-3 h-3"}),"Dismiss and try again"]})]})]}),a.jsx("div",{className:"overflow-y-auto max-h-[calc(90vh-120px)] admin-scrollbar",children:a.jsxs("form",{onSubmit:F,className:"p-6 space-y-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Task Name *"}),a.jsx("input",{type:"text",required:!0,value:b.name,onChange:e=>j({...b,name:e.target.value}),className:"w-full px-4 py-3 border-2 border-gray-300 dark:border-gray-600 rounded-xl bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:border-blue-500 dark:focus:border-blue-500 transition-colors outline-none shadow-sm",placeholder:"Enter a clear and concise task name"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Description *"}),a.jsx("textarea",{required:!0,value:b.description,onChange:e=>j({...b,description:e.target.value}),rows:4,className:"w-full px-4 py-3 border-2 border-gray-300 dark:border-gray-600 rounded-xl bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:border-blue-500 dark:focus:border-blue-500 transition-colors outline-none shadow-sm resize-none",placeholder:"Provide detailed information about the task"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Category *"}),a.jsxs("select",{required:!0,value:b.category,onChange:e=>j({...b,category:e.target.value}),className:"w-full px-4 py-3 border-2 border-gray-300 dark:border-gray-600 rounded-xl bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:border-blue-500 dark:focus:border-blue-500 transition-colors outline-none shadow-sm",children:[a.jsx("option",{value:"assignment",children:"ðŸ“ Assignment"}),a.jsx("option",{value:"quiz",children:"â“ Quiz"}),a.jsx("option",{value:"presentation",children:"ðŸŽ¯ Presentation"}),a.jsx("option",{value:"project",children:"ðŸ› ï¸ Project"}),a.jsx("option",{value:"lab-report",children:"ðŸ”¬ Lab Report"}),a.jsx("option",{value:"lab-final",children:"ðŸ† Lab Final"}),a.jsx("option",{value:"lab-performance",children:"ðŸ“ˆ Lab Performance"}),a.jsx("option",{value:"task",children:"âœ”ï¸ Task"}),a.jsx("option",{value:"documents",children:"ðŸ“„ Documents"}),a.jsx("option",{value:"blc",children:"ðŸ“š BLC"}),a.jsx("option",{value:"groups",children:"ðŸ‘¥ Groups"}),a.jsx("option",{value:"midterm",children:"ðŸ“Š Midterm"}),a.jsx("option",{value:"final-exam",children:"ðŸŽ“ Final Exam"}),a.jsx("option",{value:"others",children:"ðŸ”¹ Others"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Due Date *"}),a.jsx("input",{type:"date",required:!0,value:b.dueDate,onChange:e=>j({...b,dueDate:e.target.value}),className:"w-full px-4 py-3 border-2 border-gray-300 dark:border-gray-600 rounded-xl bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:border-blue-500 dark:focus:border-blue-500 transition-colors outline-none shadow-sm"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Priority *"}),a.jsxs("select",{required:!0,value:b.priority,onChange:e=>j({...b,priority:e.target.value}),className:"w-full px-4 py-3 border-2 border-gray-300 dark:border-gray-600 rounded-xl bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:border-blue-500 dark:focus:border-blue-500 transition-colors outline-none shadow-sm",children:[a.jsx("option",{value:"low",children:"ðŸŸ¢ Low Priority"}),a.jsx("option",{value:"medium",children:"ðŸ”µ Medium Priority"}),a.jsx("option",{value:"high",children:"ðŸŸ  High Priority"}),a.jsx("option",{value:"urgent",children:"ðŸ”´ Urgent Priority"})]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:[a.jsx(f,{className:"w-4 h-4 inline mr-2"}),"Attachments ",a.jsx("span",{className:"text-xs text-gray-500",children:"(Max 10 files, 50MB each)"})]}),a.jsx("div",{className:"relative",children:a.jsx("input",{ref:M,type:"file",multiple:!0,onChange:async e=>{const t=e.target.files;if(!t||0===t.length)return;const r=_.length+t.length;if(r>10)return void T(`Maximum 10 files allowed. You're trying to upload ${r} files.`);C(!0),T(null);const a={};try{const e=Array.from(t).map((async e=>{const t=`${e.name}-${Date.now()}`;a[t]=0,I({...a});try{const r=await async function(e,t,r){var a;const n=["pdf","doc","docx","xls","xlsx","ppt","pptx","txt","csv","jpg","jpeg","png","gif","svg","zip","rar","7z","mp4","mp3","wav"];if(e.size>52428800)throw new Error(`File size exceeds 50MB limit. Your file: ${(e.size/1024/1024).toFixed(2)}MB`);const i=null==(a=e.name.split(".").pop())?void 0:a.toLowerCase();if(!i||!n.includes(i))throw new Error(`File type .${i} is not allowed. Allowed types: ${n.join(", ")}`);const l=Date.now();var o;const d=`${(o=e.name).substring(0,o.lastIndexOf(".")).replace(/[^a-zA-Z0-9._-]/g,"_").replace(/_+/g,"_").replace(/^_|_$/g,"")||"file"}_${l}_${Math.random().toString(36).substring(2,8)}.${i}`,c=t?`tasks/${t}/${d}`:`temp/${d}`;try{const{data:t,error:a}=await s.storage.from("task-attachments").upload(c,e,{cacheControl:"3600",upsert:!1});if(a){if(a.message.includes("already exists"))throw new Error("A file with this name already exists. Please rename and try again.");throw new Error(`Upload failed: ${a.message}`)}const{data:n}=s.storage.from("task-attachments").getPublicUrl(t.path);return r&&r(100),{url:n.publicUrl,name:e.name,size:e.size}}catch(E){throw new Error(E.message||"Failed to upload file. Please try again.")}}(e,null==i?void 0:i.id,(e=>{m.current&&(a[t]=e,I({...a}))}));return r}catch(r){throw new Error(`${e.name}: ${r.message}`)}})),r=await Promise.all(e);m.current&&(L((e=>[...e,...r])),I({}),M.current&&(M.current.value=""))}catch(n){m.current&&(T((null==n?void 0:n.message)||"Failed to upload files. Please try again."),I({}))}finally{m.current&&C(!1)}},disabled:N||_.length>=10,accept:".pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.txt,.csv,.jpg,.jpeg,.png,.gif,.svg,.zip,.rar,.7z,.mp4,.mp3,.wav",className:"w-full px-4 py-3 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-xl bg-white dark:bg-gray-700 text-gray-900 dark:text-white file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100 dark:file:bg-blue-900/30 dark:file:text-blue-300 disabled:opacity-50 disabled:cursor-not-allowed transition-colors cursor-pointer"})}),N&&Object.keys(R).length>0&&a.jsx("div",{className:"mt-3 space-y-2",children:Object.entries(R).map((([e,t])=>a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex items-center justify-between text-xs",children:[a.jsx("span",{className:"text-gray-600 dark:text-gray-400 truncate flex-1",children:e.split("-")[0]}),a.jsxs("span",{className:"text-blue-600 dark:text-blue-400 font-semibold ml-2",children:[t,"%"]})]}),a.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1.5 overflow-hidden",children:a.jsx("div",{className:"bg-blue-600 dark:bg-blue-500 h-full transition-all duration-300 ease-out",style:{width:`${t}%`}})})]},e)))}),_.length>0&&a.jsxs("div",{className:"mt-3 p-4 bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-800 dark:to-gray-750 rounded-xl border-2 border-gray-200 dark:border-gray-600",children:[a.jsx("div",{className:"flex items-center justify-between mb-3",children:a.jsxs("p",{className:"text-xs font-bold text-gray-700 dark:text-gray-300 flex items-center gap-2",children:[a.jsx(v,{className:"w-4 h-4 text-green-600 dark:text-green-400"}),"Uploaded Files (",_.length,"/10)"]})}),a.jsx("div",{className:"space-y-2",children:_.map(((e,t)=>a.jsxs("div",{className:"group flex items-center gap-3 bg-white dark:bg-gray-700 px-3 py-2.5 rounded-lg border border-gray-200 dark:border-gray-600 hover:border-blue-400 dark:hover:border-blue-500 transition-all duration-200",children:[a.jsx(k,{className:"w-5 h-5 text-blue-600 dark:text-blue-400 flex-shrink-0"}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white truncate",children:e.name}),e.size>0&&a.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:P(e.size)})]}),a.jsx("button",{type:"button",onClick:()=>O(t),disabled:D,className:"p-1.5 text-gray-400 hover:text-red-600 dark:hover:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-all duration-200 opacity-0 group-hover:opacity-100 disabled:opacity-50 disabled:cursor-not-allowed",title:"Remove file",children:a.jsx(h,{className:"w-4 h-4"})})]},t)))})]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:[a.jsx(w,{className:"w-4 h-4 inline mr-2"}),"Google Drive Links (one per line)"]}),a.jsx("textarea",{value:b.googleDriveLinks,onChange:e=>j({...b,googleDriveLinks:e.target.value}),rows:3,className:"w-full px-4 py-3 border-2 border-gray-300 dark:border-gray-600 rounded-xl bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:border-blue-500 dark:focus:border-blue-500 transition-colors outline-none shadow-sm resize-none",placeholder:"https://drive.google.com/file/d/..."})]}),a.jsxs("div",{className:"flex gap-3 pt-4 border-t-2 border-gray-200 dark:border-gray-700",children:[a.jsx("button",{type:"button",onClick:()=>{S(!1),l()},className:"flex-1 px-6 py-3 border-2 border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-xl hover:bg-gray-50 dark:hover:bg-gray-700 font-semibold transition-all duration-200 disabled:opacity-50 active:scale-95",disabled:D,children:"Cancel"}),a.jsx("button",{type:"submit",className:"flex-1 px-6 py-3 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white rounded-xl font-semibold shadow-lg shadow-blue-500/30 hover:shadow-xl hover:shadow-blue-500/40 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed active:scale-95",disabled:D||N,children:D?a.jsxs("span",{className:"flex items-center justify-center gap-2",children:[a.jsx(y,{className:"w-5 h-5 animate-spin"}),"Saving..."]}):g?"âœ”ï¸ Update Task":"âœ¨ Create Task"})]})]})})]})})})),ia=t.memo((function({tasks:e,selectedTaskIds:t,onSelectTasks:r,onTaskClick:s,onTaskEdit:n,onTaskDelete:i,sort:o,onSortChange:d}){const c=(e,a)=>{r(a?[...t,e]:t.filter((t=>t!==e)))},u=e=>{o.field===e?d({field:e,direction:"asc"===o.direction?"desc":"asc"}):d({field:e,direction:"asc"})},g=async e=>{if(confirm("Delete this task?"))try{await ee(e),i(e)}catch(t){alert("Failed to delete task")}},m={low:"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-300",medium:"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300",high:"bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-300",urgent:"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-300"},x={"my-tasks":"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-300","in-progress":"bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-300",completed:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300"},b=({field:e})=>o.field!==e?null:"asc"===o.direction?a.jsx(C,{className:"w-4 h-4"}):a.jsx(D,{className:"w-4 h-4"});return 0===e.length?a.jsxs("div",{className:"flex flex-col items-center justify-center py-20 px-4",children:[a.jsxs("div",{className:"relative mb-6",children:[a.jsx("div",{className:"w-24 h-24 rounded-full bg-gradient-to-br from-blue-100 to-indigo-100 dark:from-blue-900/30 dark:to-indigo-900/30 flex items-center justify-center",children:a.jsx(k,{className:"w-12 h-12 text-blue-600 dark:text-blue-400"})}),a.jsx("div",{className:"absolute -bottom-1 -right-1 w-8 h-8 rounded-full bg-gradient-to-br from-blue-500 to-indigo-500 flex items-center justify-center shadow-lg",children:a.jsx("span",{className:"text-white text-lg",children:"âœ¨"})})]}),a.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:"No Tasks Found"}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 text-center max-w-md",children:"Try adjusting your search or filters, or create your first task to get started"})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"md:hidden space-y-4 p-4",children:e.map(((e,r)=>{const i=new Date(e.dueDate)<new Date&&"completed"!==e.status;return a.jsxs("div",{className:"group relative bg-white dark:bg-gray-800 rounded-2xl border-2 transition-all duration-200 shadow-sm hover:shadow-lg overflow-hidden animate-fade-in "+(i?"border-red-300 dark:border-red-700 bg-red-50/30 dark:bg-red-900/10":"border-gray-200 dark:border-gray-700 hover:border-blue-300 dark:hover:border-blue-600"),children:[i&&a.jsx("div",{className:"absolute top-0 right-0 bg-gradient-to-l from-red-500 to-red-600 text-white px-3 py-1 rounded-bl-lg text-xs font-semibold",children:"Overdue"}),a.jsx("div",{className:"p-5",children:a.jsxs("div",{className:"flex items-start gap-3 mb-4",children:[a.jsx("input",{type:"checkbox",checked:t.includes(e.id),onChange:t=>c(e.id,t.target.checked),className:"mt-1 w-5 h-5 rounded border-2 border-gray-300 dark:border-gray-600 text-blue-600 focus:ring-2 focus:ring-blue-500 focus:ring-offset-0 transition-colors"}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("button",{onClick:()=>s(e),className:"font-semibold text-base text-gray-900 dark:text-white hover:text-blue-600 dark:hover:text-blue-400 text-left mb-2 line-clamp-2 transition-colors",children:e.name}),e.description&&a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4 line-clamp-2",children:e.description}),a.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-4",children:[a.jsx("span",{className:"inline-flex items-center px-2.5 py-1 text-xs font-medium rounded-lg bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 capitalize",children:e.category.replace("-"," ")}),a.jsx("span",{className:`inline-flex items-center px-2.5 py-1 text-xs font-semibold rounded-lg ${x[e.status]}`,children:"my-tasks"===e.status?"To Do":e.status.replace("-"," ")}),a.jsx("span",{className:`inline-flex items-center px-2.5 py-1 text-xs font-semibold rounded-lg ${m[e.priority]}`,children:e.priority.toUpperCase()})]}),a.jsxs("div",{className:"flex items-center justify-between pt-3 border-t border-gray-200 dark:border-gray-700",children:[a.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 dark:text-gray-400",children:[a.jsx(l,{className:"w-4 h-4"}),a.jsx("span",{className:"font-medium",children:new Date(e.dueDate).toLocaleDateString()})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("button",{onClick:()=>s(e),className:"p-2 text-blue-600 hover:bg-blue-100 dark:text-blue-400 dark:hover:bg-blue-900/30 rounded-lg transition-all duration-200 touch-manipulation active:scale-95",title:"View details",children:a.jsx(j,{className:"w-5 h-5"})}),a.jsx("button",{onClick:()=>n(e),className:"p-2 text-green-600 hover:bg-green-100 dark:text-green-400 dark:hover:bg-green-900/30 rounded-lg transition-all duration-200 touch-manipulation active:scale-95",title:"Edit task",children:a.jsx(N,{className:"w-5 h-5"})}),a.jsx("button",{onClick:()=>g(e.id),className:"p-2 text-red-600 hover:bg-red-100 dark:text-red-400 dark:hover:bg-red-900/30 rounded-lg transition-all duration-200 touch-manipulation active:scale-95",title:"Delete",children:a.jsx(h,{className:"w-5 h-5"})})]})]})]})]})})]},e.id)}))}),a.jsx("div",{className:"hidden md:block overflow-x-auto p-4",children:a.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-2xl border-2 border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-800 dark:to-gray-750 border-b-2 border-gray-200 dark:border-gray-700",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-4 text-left",children:a.jsx("input",{type:"checkbox",checked:t.length===e.length,onChange:t=>{return a=t.target.checked,void r(a?e.map((e=>e.id)):[]);var a},className:"w-5 h-5 rounded border-2 border-gray-300 dark:border-gray-600 text-blue-600 focus:ring-2 focus:ring-blue-500"})}),a.jsx("th",{onClick:()=>u("name"),className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:text-blue-600 dark:hover:text-blue-400 transition-colors select-none",children:a.jsxs("div",{className:"flex items-center gap-2",children:["Task Name",a.jsx(b,{field:"name"})]})}),a.jsx("th",{onClick:()=>u("category"),className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:text-blue-600 dark:hover:text-blue-400 transition-colors select-none",children:a.jsxs("div",{className:"flex items-center gap-2",children:["Category",a.jsx(b,{field:"category"})]})}),a.jsx("th",{onClick:()=>u("status"),className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:text-blue-600 dark:hover:text-blue-400 transition-colors select-none",children:a.jsxs("div",{className:"flex items-center gap-2",children:["Status",a.jsx(b,{field:"status"})]})}),a.jsx("th",{onClick:()=>u("priority"),className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:text-blue-600 dark:hover:text-blue-400 transition-colors select-none",children:a.jsxs("div",{className:"flex items-center gap-2",children:["Priority",a.jsx(b,{field:"priority"})]})}),a.jsx("th",{onClick:()=>u("dueDate"),className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider cursor-pointer hover:text-blue-600 dark:hover:text-blue-400 transition-colors select-none",children:a.jsxs("div",{className:"flex items-center gap-2",children:["Due Date",a.jsx(b,{field:"dueDate"})]})}),a.jsx("th",{className:"px-6 py-4 text-right text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider",children:"Actions"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:e.map((e=>{const r=new Date(e.dueDate)<new Date&&"completed"!==e.status;return a.jsxs("tr",{className:"group transition-all duration-150 "+(r?"bg-red-50/50 dark:bg-red-900/10 hover:bg-red-100/50 dark:hover:bg-red-900/20":"hover:bg-blue-50/50 dark:hover:bg-gray-750"),children:[a.jsx("td",{className:"px-6 py-4",children:a.jsx("input",{type:"checkbox",checked:t.includes(e.id),onChange:t=>c(e.id,t.target.checked),className:"w-5 h-5 rounded border-2 border-gray-300 dark:border-gray-600 text-blue-600 focus:ring-2 focus:ring-blue-500 transition-colors"})}),a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{className:"text-sm max-w-md",children:[a.jsx("button",{onClick:()=>s(e),className:"font-semibold text-gray-900 dark:text-white hover:text-blue-600 dark:hover:text-blue-400 text-left transition-colors",children:e.name}),e.description&&a.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-1.5 line-clamp-1",children:e.description})]})}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("span",{className:"inline-flex items-center px-2.5 py-1 text-sm font-medium rounded-lg bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 capitalize",children:e.category.replace("-"," ")})}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("span",{className:`inline-flex items-center px-3 py-1.5 text-xs font-semibold rounded-lg ${x[e.status]}`,children:"my-tasks"===e.status?"To Do":e.status.replace("-"," ")})}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("span",{className:`inline-flex items-center px-3 py-1.5 text-xs font-semibold rounded-lg ${m[e.priority]}`,children:e.priority.toUpperCase()})}),a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{className:"flex flex-col gap-1",children:[a.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 dark:text-gray-300",children:[a.jsx(l,{className:"w-4 h-4 text-gray-500"}),new Date(e.dueDate).toLocaleDateString()]}),r&&a.jsx("span",{className:"inline-flex items-center text-xs text-red-600 dark:text-red-400 font-semibold",children:"âš ï¸ Overdue"})]})}),a.jsx("td",{className:"px-6 py-4 text-right",children:a.jsxs("div",{className:"flex items-center justify-end gap-1 opacity-0 group-hover:opacity-100 transition-opacity duration-150",children:[a.jsx("button",{onClick:()=>s(e),className:"p-2 text-blue-600 hover:bg-blue-100 dark:text-blue-400 dark:hover:bg-blue-900/30 rounded-lg transition-all duration-200",title:"View details","aria-label":"View task details",children:a.jsx(j,{className:"w-5 h-5"})}),a.jsx("button",{onClick:()=>n(e),className:"p-2 text-green-600 hover:bg-green-100 dark:text-green-400 dark:hover:bg-green-900/30 rounded-lg transition-all duration-200",title:"Edit task","aria-label":"Edit task",children:a.jsx(N,{className:"w-5 h-5"})}),a.jsx("button",{onClick:()=>g(e.id),className:"p-2 text-red-600 hover:bg-red-100 dark:text-red-400 dark:hover:bg-red-900/30 rounded-lg transition-all duration-200",title:"Delete","aria-label":"Delete task",children:a.jsx(h,{className:"w-5 h-5"})})]})})]},e.id)}))})]})})})]})}));function la({taskId:t,userId:r,userName:n}){const[i,l]=e.useState([]),[o,d]=e.useState(!0),[c,u]=e.useState(""),[g,m]=e.useState(!1),[x,h]=e.useState(null),[b,p]=e.useState("");e.useEffect((()=>{y()}),[t]),e.useEffect((()=>()=>{m(!1)}),[]);const y=async()=>{try{d(!0);const e=await async function(e){const{data:t,error:r}=await s.from("task_comments").select("\n      *,\n      user:users(id, name, email)\n    ").eq("task_id",e).order("created_at",{ascending:!0});if(r)throw new Error(`Failed to fetch comments: ${r.message}`);return(t||[]).map(re)}(t);l(e)}catch(e){}finally{d(!1)}};return o?a.jsx("div",{className:"flex items-center justify-center h-32",children:a.jsx(Gr,{})}):a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center gap-2 text-gray-900 dark:text-white",children:[a.jsx(S,{className:"w-5 h-5"}),a.jsxs("h3",{className:"font-semibold",children:["Comments (",i.length,")"]})]}),a.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:0===i.length?a.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 text-center py-8",children:"No comments yet. Be the first to comment!"}):i.map((e=>a.jsx(oa,{comment:e,isOwner:e.userId===r,isEditing:x===e.id,editText:b,onEditTextChange:p,onStartEdit:()=>{h(e.id),p(e.comment)},onCancelEdit:()=>{h(null),p("")},onSaveEdit:()=>(async e=>{if(b.trim())try{const t=await async function(e,t){const{data:r,error:a}=await s.from("task_comments").update({comment:t,is_edited:!0}).eq("id",e).select("\n      *,\n      user:users(id, name, email)\n    ").single();if(a)throw new Error(`Failed to update comment: ${a.message}`);return re(r)}(e,b.trim());l(i.map((r=>r.id===e?t:r))),h(null),p("")}catch(t){alert("Failed to update comment")}})(e.id),onDelete:()=>(async e=>{if(confirm("Delete this comment?"))try{await async function(e){const{error:t}=await s.from("task_comments").delete().eq("id",e);if(t)throw new Error(`Failed to delete comment: ${t.message}`)}(e),l(i.filter((t=>t.id!==e)))}catch(t){alert("Failed to delete comment")}})(e.id)},e.id)))}),a.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),c.trim()&&!g){m(!0);try{const e=await async function(e,t,r){const{data:a,error:n}=await s.from("task_comments").insert({task_id:e,user_id:t,comment:r}).select("\n      *,\n      user:users(id, name, email)\n    ").single();if(n)throw new Error(`Failed to add comment: ${n.message}`);return re(a)}(t,r,c.trim());l([...i,e]),u("")}catch(a){alert("Failed to add comment")}finally{m(!1)}}},className:"flex gap-2",children:[a.jsx("div",{className:"flex-1",children:a.jsx("textarea",{value:c,onChange:e=>u(e.target.value),placeholder:"Write a comment...",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white resize-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:2,disabled:g})}),a.jsxs("button",{type:"submit",disabled:!c.trim()||g,className:"self-end px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center gap-2",children:[a.jsx(E,{className:"w-4 h-4"}),g?"Sending...":"Send"]})]})]})}function oa({comment:e,isOwner:t,isEditing:r,editText:s,onEditTextChange:n,onStartEdit:i,onCancelEdit:l,onSaveEdit:o,onDelete:d}){var c,u,g;return a.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 rounded-lg p-4",children:[a.jsxs("div",{className:"flex items-start justify-between mb-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-600 text-white flex items-center justify-center text-sm font-medium",children:(null==(u=null==(c=e.user)?void 0:c.name)?void 0:u.charAt(0).toUpperCase())||"?"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-gray-900 dark:text-white text-sm",children:(null==(g=e.user)?void 0:g.name)||"Unknown"}),a.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[(e=>{const t=new Date(e),r=(new Date).getTime()-t.getTime(),a=Math.floor(r/6e4),s=Math.floor(r/36e5),n=Math.floor(r/864e5);return a<1?"Just now":a<60?`${a}m ago`:s<24?`${s}h ago`:n<7?`${n}d ago`:t.toLocaleDateString()})(e.createdAt),e.isEdited&&" (edited)"]})]})]}),t&&!r&&a.jsxs("div",{className:"flex gap-1",children:[a.jsx("button",{onClick:i,className:"p-1 text-gray-500 hover:text-blue-600 dark:hover:text-blue-400 transition-colors",title:"Edit comment",children:a.jsx(N,{className:"w-4 h-4"})}),a.jsx("button",{onClick:d,className:"p-1 text-gray-500 hover:text-red-600 dark:hover:text-red-400 transition-colors",title:"Delete comment",children:a.jsx(h,{className:"w-4 h-4"})})]})]}),r?a.jsxs("div",{className:"space-y-2",children:[a.jsx("textarea",{value:s,onChange:e=>n(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white resize-none",rows:2}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:o,className:"px-3 py-1 bg-blue-600 text-white text-sm rounded hover:bg-blue-700",children:"Save"}),a.jsx("button",{onClick:l,className:"px-3 py-1 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 text-sm rounded hover:bg-gray-100 dark:hover:bg-gray-700",children:"Cancel"})]})]}):a.jsx("p",{className:"text-gray-700 dark:text-gray-300 text-sm whitespace-pre-wrap",children:e.comment})]})}function da({task:t,userId:r,onClose:i,onTaskUpdated:o,onTaskDeleted:u}){const[g,m]=e.useState("details"),[x,b]=e.useState(!1),[y,f]=e.useState([]),[v,k]=e.useState(!1),[j,C]=e.useState(!1);e.useEffect((()=>{"history"===g&&D()}),[g]);const D=async()=>{try{k(!0);const e=await async function(e){const{data:t,error:r}=await s.from("task_history").select("\n      *,\n      user:users(id, name, email)\n    ").eq("task_id",e).order("created_at",{ascending:!1});if(r)throw new Error(`Failed to fetch history: ${r.message}`);return(t||[]).map(ae)}(t.id);f(e)}catch(e){}finally{k(!1)}},E=async e=>{try{C(!0);const r=await Q(t.id,{status:e});o(r)}catch(r){alert("Failed to update status")}finally{C(!1)}},M=new Date(t.dueDate)<new Date&&"completed"!==t.status;return x?a.jsx(na,{userId:r,task:t,onClose:()=>b(!1),onTaskUpdated:e=>{o(e),b(!1)}}):a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[a.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[a.jsxs("div",{className:"flex-1 mr-4",children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:t.name}),a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${{low:"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-300",medium:"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300",high:"bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-300",urgent:"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-300"}[t.priority]}`,children:t.priority.toUpperCase()}),a.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${{"my-tasks":"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-300","in-progress":"bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-300",completed:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300"}[t.status]}`,children:"my-tasks"===t.status?"To Do":t.status.replace("-"," ")}),M&&a.jsxs("span",{className:"flex items-center gap-1 px-3 py-1 bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-300 rounded-full text-xs font-medium",children:[a.jsx(n,{className:"w-3 h-3"}),"Overdue"]})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:()=>b(!0),className:"p-2 text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",title:"Edit task",children:a.jsx(N,{className:"w-5 h-5"})}),a.jsx("button",{onClick:async()=>{if(confirm("Delete this task? This action cannot be undone."))try{await ee(t.id),u(t.id),i()}catch(e){alert("Failed to delete task")}},className:"p-2 text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300",title:"Delete task",children:a.jsx(h,{className:"w-5 h-5"})}),a.jsx("button",{onClick:i,className:"p-2 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300",children:a.jsx(p,{className:"w-6 h-6"})})]})]}),a.jsxs("div",{className:"flex border-b border-gray-200 dark:border-gray-700 px-6",children:[a.jsx("button",{onClick:()=>m("details"),className:"px-4 py-3 font-medium border-b-2 transition-colors "+("details"===g?"border-blue-600 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"),children:"Details"}),a.jsxs("button",{onClick:()=>m("comments"),className:"flex items-center gap-2 px-4 py-3 font-medium border-b-2 transition-colors "+("comments"===g?"border-blue-600 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"),children:[a.jsx(S,{className:"w-4 h-4"}),"Comments"]}),a.jsxs("button",{onClick:()=>m("history"),className:"flex items-center gap-2 px-4 py-3 font-medium border-b-2 transition-colors "+("history"===g?"border-blue-600 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"),children:[a.jsx(T,{className:"w-4 h-4"}),"History"]})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:["details"===g&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Description"}),a.jsx("p",{className:"text-gray-900 dark:text-white whitespace-pre-wrap",children:t.description})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Quick Actions"}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:["in-progress"!==t.status&&a.jsx("button",{onClick:()=>E("in-progress"),disabled:j,className:"px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 disabled:opacity-50",children:"Start Working"}),"completed"!==t.status&&a.jsxs("button",{onClick:()=>E("completed"),disabled:j,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 flex items-center gap-2",children:[a.jsx(d,{className:"w-4 h-4"}),"Mark Complete"]}),"completed"===t.status&&a.jsx("button",{onClick:()=>E("my-tasks"),disabled:j,className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 disabled:opacity-50",children:"Reopen Task"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx(ca,{icon:a.jsx(l,{className:"w-5 h-5"}),label:"Due Date",value:new Date(t.dueDate).toLocaleDateString()}),a.jsx(ca,{icon:a.jsx(c,{className:"w-5 h-5"}),label:"Category",value:t.category.replace("-"," ")}),t.assignedToUser&&a.jsx(ca,{icon:a.jsx(R,{className:"w-5 h-5"}),label:"Assigned To",value:t.assignedToUser.name}),t.assignedByUser&&a.jsx(ca,{icon:a.jsx(I,{className:"w-5 h-5"}),label:"Assigned By",value:t.assignedByUser.name}),a.jsx(ca,{icon:a.jsx(c,{className:"w-5 h-5"}),label:"Created",value:new Date(t.createdAt).toLocaleString()}),t.completedAt&&a.jsx(ca,{icon:a.jsx(d,{className:"w-5 h-5"}),label:"Completed",value:new Date(t.completedAt).toLocaleString()})]}),t.tags&&t.tags.length>0&&a.jsxs("div",{children:[a.jsxs("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2 flex items-center gap-2",children:[a.jsx(_,{className:"w-4 h-4"}),"Tags"]}),a.jsx("div",{className:"flex flex-wrap gap-2",children:t.tags.map(((e,t)=>a.jsx("span",{className:"px-3 py-1 bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-300 rounded-full text-sm",children:e},t)))})]}),t.attachments&&t.attachments.length>0&&a.jsxs("div",{children:[a.jsxs("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2 flex items-center gap-2",children:[a.jsx(L,{className:"w-4 h-4"}),"Attachments"]}),a.jsx("div",{className:"space-y-2",children:t.attachments.map(((e,t)=>a.jsxs("a",{href:e,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",children:[a.jsx(L,{className:"w-4 h-4"}),e.split("/").pop()]},t)))})]}),t.googleDriveLinks&&t.googleDriveLinks.length>0&&a.jsxs("div",{children:[a.jsxs("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2 flex items-center gap-2",children:[a.jsx(w,{className:"w-4 h-4"}),"Google Drive Links"]}),a.jsx("div",{className:"space-y-2",children:t.googleDriveLinks.map(((e,t)=>a.jsxs("a",{href:e,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 break-all",children:[a.jsx(w,{className:"w-4 h-4 flex-shrink-0"}),e]},t)))})]})]}),"comments"===g&&a.jsx(la,{taskId:t.id,userId:r,userName:"Current User"}),"history"===g&&a.jsx("div",{className:"space-y-4",children:v?a.jsx("p",{className:"text-center text-gray-500 dark:text-gray-400",children:"Loading history..."}):0===y.length?a.jsx("p",{className:"text-center text-gray-500 dark:text-gray-400",children:"No history yet"}):y.map((e=>a.jsx(ua,{entry:e},e.id)))})]})]})})}function ca({icon:e,label:t,value:r}){return a.jsxs("div",{className:"flex items-start gap-3 p-4 bg-gray-50 dark:bg-gray-750 rounded-lg",children:[a.jsx("div",{className:"text-gray-600 dark:text-gray-400",children:e}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:t}),a.jsx("p",{className:"text-base font-medium text-gray-900 dark:text-white capitalize",children:r})]})]})}function ua({entry:e}){var t,r,s,n,i;return a.jsxs("div",{className:"flex gap-3 p-4 bg-gray-50 dark:bg-gray-750 rounded-lg",children:[a.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-600 text-white flex items-center justify-center text-sm font-medium flex-shrink-0",children:(null==(r=null==(t=e.user)?void 0:t.name)?void 0:r.charAt(0).toUpperCase())||"?"}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"flex items-start justify-between gap-2",children:a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:(null==(s=e.user)?void 0:s.name)||"Unknown User"}),a.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:(i=e.createdAt,new Date(i).toLocaleString())})]})}),a.jsxs("p",{className:"text-sm text-gray-700 dark:text-gray-300 mt-2",children:[(n=e.action,{created:"Created task",status_changed:"Changed status",priority_changed:"Changed priority",assigned:"Assigned task",deleted:"Deleted task"}[n]||n),e.fieldName&&a.jsxs(a.Fragment,{children:[" ",a.jsx("span",{className:"font-medium",children:e.fieldName}),e.oldValue&&e.newValue&&a.jsxs(a.Fragment,{children:[" from ",a.jsx("span",{className:"font-medium text-red-600 dark:text-red-400",children:e.oldValue})," to ",a.jsx("span",{className:"font-medium text-green-600 dark:text-green-400",children:e.newValue})]})]})]})]})]})}const ga=()=>a.jsxs("div",{className:"space-y-4 p-4",children:[a.jsx("div",{className:"md:hidden space-y-4",children:[1,2,3,4,5].map((e=>a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl border-2 border-gray-200 dark:border-gray-700 p-5 overflow-hidden relative",style:{animationDelay:.1*e+"s"},children:[a.jsx("div",{className:"absolute inset-0 shimmer"}),a.jsxs("div",{className:"flex items-start gap-3 relative",children:[a.jsx("div",{className:"w-5 h-5 bg-gray-200 dark:bg-gray-700 rounded mt-1"}),a.jsxs("div",{className:"flex-1 space-y-3",children:[a.jsx("div",{className:"h-5 bg-gray-200 dark:bg-gray-700 rounded w-3/4"}),a.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-full"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("div",{className:"h-6 bg-gray-200 dark:bg-gray-700 rounded-lg w-20"}),a.jsx("div",{className:"h-6 bg-gray-200 dark:bg-gray-700 rounded-lg w-24"}),a.jsx("div",{className:"h-6 bg-gray-200 dark:bg-gray-700 rounded-lg w-16"})]}),a.jsxs("div",{className:"flex justify-between items-center pt-3 border-t border-gray-200 dark:border-gray-700",children:[a.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-32"}),a.jsxs("div",{className:"flex gap-1",children:[a.jsx("div",{className:"w-9 h-9 bg-gray-200 dark:bg-gray-700 rounded-lg"}),a.jsx("div",{className:"w-9 h-9 bg-gray-200 dark:bg-gray-700 rounded-lg"}),a.jsx("div",{className:"w-9 h-9 bg-gray-200 dark:bg-gray-700 rounded-lg"})]})]})]})]})]},e)))}),a.jsx("div",{className:"hidden md:block",children:a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl border-2 border-gray-200 dark:border-gray-700 overflow-hidden shadow-sm relative",children:[a.jsx("div",{className:"absolute inset-0 shimmer z-10 pointer-events-none"}),a.jsxs("table",{className:"w-full relative z-0",children:[a.jsx("thead",{className:"bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-800 dark:to-gray-750 border-b-2 border-gray-200 dark:border-gray-700",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-4",children:a.jsx("div",{className:"w-5 h-5 bg-gray-200 dark:bg-gray-700 rounded"})}),a.jsx("th",{className:"px-6 py-4 text-left",children:a.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-24"})}),a.jsx("th",{className:"px-6 py-4 text-left",children:a.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-20"})}),a.jsx("th",{className:"px-6 py-4 text-left",children:a.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-16"})}),a.jsx("th",{className:"px-6 py-4 text-left",children:a.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-16"})}),a.jsx("th",{className:"px-6 py-4 text-left",children:a.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-20"})}),a.jsx("th",{className:"px-6 py-4",children:a.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-16 ml-auto"})})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:[1,2,3,4,5,6,7].map((e=>a.jsxs("tr",{style:{animationDelay:.05*e+"s"},children:[a.jsx("td",{className:"px-6 py-4",children:a.jsx("div",{className:"w-5 h-5 bg-gray-200 dark:bg-gray-700 rounded"})}),a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{className:"space-y-2",children:[a.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-48"}),a.jsx("div",{className:"h-3 bg-gray-200 dark:bg-gray-700 rounded w-64"})]})}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("div",{className:"h-6 bg-gray-200 dark:bg-gray-700 rounded-lg w-24"})}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("div",{className:"h-6 bg-gray-200 dark:bg-gray-700 rounded-lg w-20"})}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("div",{className:"h-6 bg-gray-200 dark:bg-gray-700 rounded-lg w-20"})}),a.jsx("td",{className:"px-6 py-4",children:a.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-32"})}),a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{className:"flex items-center justify-end gap-1",children:[a.jsx("div",{className:"w-9 h-9 bg-gray-200 dark:bg-gray-700 rounded-lg"}),a.jsx("div",{className:"w-9 h-9 bg-gray-200 dark:bg-gray-700 rounded-lg"}),a.jsx("div",{className:"w-9 h-9 bg-gray-200 dark:bg-gray-700 rounded-lg"})]})})]},e)))})]})]})})]}),ma=()=>a.jsx("div",{className:"flex gap-4 lg:gap-6 overflow-x-auto pb-6 min-h-[500px] px-4 sm:px-6 py-4 scrollbar-hide",children:[1,2,3].map((e=>a.jsx("div",{className:"flex-shrink-0 w-80 sm:w-[340px] lg:w-[360px]",style:{animationDelay:.1*e+"s"},children:a.jsxs("div",{className:"bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-800 dark:to-gray-850 border-2 border-gray-200 dark:border-gray-600 rounded-2xl p-5 h-full shadow-sm relative overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0 shimmer z-10 pointer-events-none"}),a.jsxs("div",{className:"flex items-center justify-between mb-5 pb-3 border-b-2 border-gray-200 dark:border-gray-600 relative z-0",children:[a.jsx("div",{className:"h-6 bg-gray-200 dark:bg-gray-700 rounded w-32"}),a.jsx("div",{className:"w-7 h-7 bg-gray-200 dark:bg-gray-700 rounded-full"})]}),a.jsx("div",{className:"space-y-3 relative z-0",children:[1,2,3,4].map((t=>a.jsx("div",{className:"bg-white dark:bg-gray-750 rounded-xl p-4 shadow-md border-2 border-gray-200 dark:border-gray-600",style:{animationDelay:.1*e+.05*t+"s"},children:a.jsxs("div",{className:"space-y-3",children:[a.jsx("div",{className:"h-5 bg-gray-200 dark:bg-gray-700 rounded w-3/4"}),a.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-full"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("div",{className:"h-6 bg-gray-200 dark:bg-gray-700 rounded-lg w-16"}),a.jsx("div",{className:"h-6 bg-gray-200 dark:bg-gray-700 rounded-lg w-20"})]}),a.jsx("div",{className:"h-10 bg-gray-200 dark:bg-gray-700 rounded-lg w-full"})]})},t)))})]})},e)))}),xa=()=>a.jsxs("div",{className:"p-6 space-y-6",children:[a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[1,2,3,4].map((e=>a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border-2 border-gray-200 dark:border-gray-700 p-6 relative overflow-hidden",style:{animationDelay:.1*e+"s"},children:[a.jsx("div",{className:"absolute inset-0 shimmer"}),a.jsxs("div",{className:"flex items-center justify-between mb-3 relative",children:[a.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-24"}),a.jsx("div",{className:"w-10 h-10 bg-gray-200 dark:bg-gray-700 rounded-lg"})]}),a.jsx("div",{className:"h-8 bg-gray-200 dark:bg-gray-700 rounded w-16 mb-2 relative"}),a.jsx("div",{className:"h-3 bg-gray-200 dark:bg-gray-700 rounded w-32 relative"})]},e)))}),a.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[1,2].map((e=>a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border-2 border-gray-200 dark:border-gray-700 p-6 relative overflow-hidden",style:{animationDelay:.1*(e+4)+"s"},children:[a.jsx("div",{className:"absolute inset-0 shimmer"}),a.jsx("div",{className:"h-6 bg-gray-200 dark:bg-gray-700 rounded w-48 mb-6 relative"}),a.jsx("div",{className:"h-64 bg-gray-200 dark:bg-gray-700 rounded relative"})]},e)))})]}),ha=e.memo((({userId:t,sectionId:r,isSectionAdmin:i=!1,isAdmin:l=!1,openCreateForm:o=!1})=>{const[d,c]=e.useState("list"),[u,g]=e.useState(!1),[x,b]=e.useState(o),[p,f]=e.useState(null),[v,w]=e.useState(null),[j,N]=e.useState(0),[C,D]=e.useState([]),[S,E]=e.useState(!0),[T,R]=e.useState(null),[I]=e.useState(1),[_,$]=e.useState(0),U=e.useRef(null),B=e.useRef(null),q=e.useRef(!0),[X,Y]=e.useState(""),[K,V]=e.useState({search:"",category:"all",status:"all",priority:"all"}),[J,W]=e.useState({field:"createdAt",direction:"desc"}),[H,Z]=e.useState([]),[Q,ee]=e.useState(!1),re=e.useCallback((async(e=!1)=>{U.current&&U.current.abort();const t=new AbortController;U.current=t;try{e||E(!0),R(null);const a=await async function(e,t={}){var r,a;const{page:n=1,pageSize:i=50,filters:l={},sort:o,sectionId:d}=t,c=(n-1)*i,u=c+i-1;let g=s.from("tasks").select("*",{count:"exact"});if(d&&(g=g.eq("section_id",d)),l.search&&(g=g.or(`name.ilike.%${l.search}%,description.ilike.%${l.search}%`)),l.category&&"all"!==l.category&&(g=g.eq("category",l.category)),l.status&&"all"!==l.status&&(g=g.eq("status",l.status)),l.priority&&"all"!==l.priority&&(g=g.eq("priority",l.priority)),l.assignedTo&&(g=g.eq("assigned_to",l.assignedTo)),l.tags&&l.tags.length>0&&(g=g.contains("tags",l.tags)),(null==(r=l.dateRange)?void 0:r.start)&&(g=g.gte("due_date",l.dateRange.start)),(null==(a=l.dateRange)?void 0:a.end)&&(g=g.lte("due_date",l.dateRange.end)),l.overdue){const e=(new Date).toISOString().split("T")[0];g=g.lt("due_date",e).neq("status","completed")}if(o){const e="dueDate"===o.field?"due_date":"createdAt"===o.field?"created_at":o.field;g=g.order(e,{ascending:"asc"===o.direction})}else g=g.order("created_at",{ascending:!1});g=g.range(c,u);const{data:m,error:x,count:h}=await g;if(x)throw new Error(`Failed to fetch tasks: ${x.message}`);return{tasks:(m||[]).map(te),total:h||0,page:n,pageSize:i,hasMore:!!h&&h>u+1}}(0,{page:I,pageSize:50,filters:K,sort:J,sectionId:r});q.current&&!t.signal.aborted&&(D(a.tasks),$(a.total),R(null))}catch(a){if(q.current&&!t.signal.aborted&&"Operation cancelled"!==a.message){const e=a.message||"Failed to load tasks";R(e)}}finally{q.current&&!t.signal.aborted&&E(!1),U.current===t&&(U.current=null)}}),[t,I,K,J,r]);e.useEffect((()=>(B.current&&clearTimeout(B.current),B.current=setTimeout((()=>{V((e=>({...e,search:X})))}),300),()=>{B.current&&clearTimeout(B.current)})),[X]),e.useEffect((()=>{re()}),[re]),e.useEffect((()=>(q.current=!0,()=>{q.current=!1,U.current&&(U.current.abort(),U.current=null),B.current&&(clearTimeout(B.current),B.current=null),b(!1)})),[]),e.useEffect((()=>{o&&(N((e=>e+1)),b(!0))}),[o]);const ae=e.useCallback((e=>{b(!1),N((e=>e+1)),re(!0)}),[re]),se=e.useCallback((e=>{q.current&&(D((t=>t.map((t=>t.id===e.id?e:t)))),f((t=>(null==t?void 0:t.id)===e.id?e:t)))}),[]),ne=e.useCallback((e=>{w(e)}),[]),ie=e.useCallback((e=>{q.current&&(D((t=>t.filter((t=>t.id!==e)))),$((e=>e-1)),Z((t=>t.filter((t=>t!==e)))),f((t=>(null==t?void 0:t.id)===e?null:t)))}),[]),le=e.useCallback((async()=>{if(0!==H.length&&!Q&&confirm(`Delete ${H.length} selected task${H.length>1?"s":""}?`)){ee(!0);try{await async function(e){await G.executeVoid((()=>s.from("tasks").delete().in("id",e)),"Bulk delete tasks")}(H),q.current&&(D((e=>e.filter((e=>!H.includes(e.id))))),$((e=>e-H.length)),Z([]),re(!0))}catch(e){q.current&&(R(e.message||"Failed to delete tasks"),re(!0))}finally{q.current&&ee(!1)}}}),[H,Q,re]),oe=e.useCallback((async e=>{if(0!==H.length&&!Q){ee(!0);try{await async function(e,t){const r={status:t};"completed"===t&&(r.completed_at=(new Date).toISOString()),await G.executeVoid((()=>s.from("tasks").update(r).in("id",e)),"Bulk update status")}(H,e),q.current&&(Z([]),await re(!0))}catch(t){q.current&&R(t.message||"Failed to update tasks")}finally{q.current&&ee(!1)}}}),[H,Q,re]),de=e.useCallback((()=>{const e=[["Name","Category","Status","Priority","Due Date","Created At"],...C.map((e=>[e.name,e.category,e.status,e.priority,e.dueDate,new Date(e.createdAt).toLocaleDateString()]))].map((e=>e.join(","))).join("\n"),t=new Blob([e],{type:"text/csv"}),r=URL.createObjectURL(t),a=document.createElement("a");a.href=r,a.download=`tasks-${(new Date).toISOString().split("T")[0]}.csv`,a.click(),URL.revokeObjectURL(r)}),[C]),ce=e.useMemo((()=>{if(!K.search)return C;const e=K.search.toLowerCase();return C.filter((t=>t.name.toLowerCase().includes(e)||t.description.toLowerCase().includes(e)))}),[C,K.search]);return a.jsxs("div",{className:"h-full flex flex-col bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-900 dark:to-gray-950",children:[a.jsxs("div",{className:"bg-white/80 dark:bg-gray-800/80 backdrop-blur-xl border-b border-gray-200/50 dark:border-gray-700/50 px-4 sm:px-6 lg:px-8 py-4 sm:py-5 shadow-sm",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("h1",{className:"text-2xl sm:text-3xl font-bold bg-gradient-to-r from-blue-600 to-indigo-600 dark:from-blue-400 dark:to-indigo-400 bg-clip-text text-transparent",children:"Task Management"}),a.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[a.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:[a.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:_})," total tasks"]}),H.length>0&&a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"text-gray-300 dark:text-gray-600",children:"â€¢"}),a.jsxs("p",{className:"text-blue-600 dark:text-blue-400 font-medium",children:[H.length," selected"]})]})]})]}),a.jsx("div",{className:"hidden lg:flex items-center gap-2",children:a.jsxs("button",{onClick:()=>{N((e=>e+1)),b(!0)},className:"flex items-center justify-center gap-2 px-5 py-3 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white rounded-xl font-medium shadow-lg shadow-blue-500/30 hover:shadow-xl hover:shadow-blue-500/40 transition-all duration-200 active:scale-95","aria-label":"Create new task",children:[a.jsx(m,{className:"w-5 h-5"}),a.jsx("span",{children:"Create Task"})]})})]}),a.jsx("div",{className:"mt-4 flex items-center gap-2 overflow-x-auto pb-2 scrollbar-hide",children:[{mode:"list",icon:M,label:"List"},{mode:"kanban",icon:A,label:"Kanban"},{mode:"analytics",icon:O,label:"Analytics"},{mode:"templates",icon:k,label:"Templates"}].map((({mode:e,icon:t,label:r})=>a.jsxs("button",{onClick:()=>c(e),className:"flex items-center gap-2 px-4 py-2.5 rounded-xl font-medium transition-all duration-200 whitespace-nowrap touch-manipulation "+(d===e?"bg-gradient-to-r from-blue-600 to-indigo-600 text-white shadow-lg shadow-blue-500/30 scale-105":"bg-gray-100/80 text-gray-700 hover:bg-gray-200/80 dark:bg-gray-700/50 dark:text-gray-300 dark:hover:bg-gray-600/50 hover:shadow-md hover:scale-105"),"aria-label":`Switch to ${r} view`,"aria-pressed":d===e,children:[a.jsx(t,{className:"w-4 h-4"}),a.jsx("span",{className:"text-sm",children:r})]},e)))})]}),("list"===d||"kanban"===d)&&a.jsxs("div",{className:"bg-white/80 dark:bg-gray-800/80 backdrop-blur-xl border-b border-gray-200/50 dark:border-gray-700/50 px-4 sm:px-6 lg:px-8 py-4",children:[a.jsxs("div",{className:"flex flex-col lg:flex-row items-stretch lg:items-center gap-3 lg:gap-4",children:[a.jsx("div",{className:"flex-1 lg:max-w-lg",children:a.jsxs("div",{className:"relative group",children:[a.jsx(P,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400 group-focus-within:text-blue-500 transition-colors"}),a.jsx("input",{type:"text",placeholder:"Search tasks by name or description...",value:X,onChange:e=>Y(e.target.value),className:"w-full pl-11 pr-4 py-3 text-sm border-2 border-gray-200 dark:border-gray-600 focus:border-blue-500 dark:focus:border-blue-500 rounded-xl bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 transition-colors shadow-sm focus:shadow-md outline-none","aria-label":"Search tasks"})]})}),a.jsxs("div",{className:"flex items-center gap-2 overflow-x-auto scrollbar-hide",children:[a.jsxs("button",{onClick:()=>g(!u),className:"flex items-center gap-2 px-4 py-2.5 border-2 rounded-xl font-medium transition-all duration-200 touch-manipulation whitespace-nowrap "+(u?"border-blue-500 bg-blue-50 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300":"border-gray-200 dark:border-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 hover:border-gray-300"),children:[a.jsx(F,{className:"w-4 h-4"}),a.jsx("span",{className:"text-sm",children:"Filters"})]}),H.length>0&&a.jsxs(a.Fragment,{children:[a.jsxs("button",{onClick:()=>oe("completed"),disabled:Q,className:"flex items-center gap-2 px-4 py-2.5 bg-green-600 text-white rounded-xl hover:bg-green-700 disabled:bg-green-400 disabled:cursor-not-allowed font-medium transition-all duration-200 shadow-md hover:shadow-lg touch-manipulation whitespace-nowrap active:scale-95",children:[a.jsx(z,{className:"w-4 h-4"}),a.jsx("span",{className:"text-sm",children:Q?"Processing...":"Complete"})]}),a.jsxs("button",{onClick:le,disabled:Q,className:"flex items-center gap-2 px-4 py-2.5 bg-red-600 text-white rounded-xl hover:bg-red-700 disabled:bg-red-400 disabled:cursor-not-allowed font-medium transition-all duration-200 shadow-md hover:shadow-lg touch-manipulation whitespace-nowrap active:scale-95",children:[a.jsx(h,{className:"w-4 h-4"}),a.jsx("span",{className:"text-sm",children:Q?"Deleting...":"Delete"})]})]}),a.jsxs("button",{onClick:de,className:"flex items-center gap-2 px-4 py-2.5 border-2 border-gray-200 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-xl hover:bg-gray-50 dark:hover:bg-gray-700 font-medium transition-all duration-200 touch-manipulation whitespace-nowrap",children:[a.jsx(L,{className:"w-4 h-4"}),a.jsx("span",{className:"text-sm",children:"Export"})]})]})]}),u&&a.jsx("div",{className:"mt-4 p-5 bg-gradient-to-br from-gray-50 to-white dark:from-gray-800/50 dark:to-gray-700/50 rounded-2xl border-2 border-gray-200 dark:border-gray-600 shadow-sm",children:a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Category"}),a.jsxs("select",{value:K.category,onChange:e=>V({...K,category:e.target.value}),className:"w-full px-3 py-2.5 border-2 border-gray-200 dark:border-gray-600 rounded-xl bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:border-blue-500 dark:focus:border-blue-500 transition-colors outline-none","aria-label":"Filter by category",children:[a.jsx("option",{value:"all",children:"All Categories"}),a.jsx("option",{value:"assignment",children:"Assignment"}),a.jsx("option",{value:"quiz",children:"Quiz"}),a.jsx("option",{value:"presentation",children:"Presentation"}),a.jsx("option",{value:"project",children:"Project"}),a.jsx("option",{value:"lab-report",children:"Lab Report"}),a.jsx("option",{value:"midterm",children:"Midterm"}),a.jsx("option",{value:"final-exam",children:"Final Exam"}),a.jsx("option",{value:"task",children:"Task"}),a.jsx("option",{value:"others",children:"Others"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Status"}),a.jsxs("select",{value:K.status,onChange:e=>V({...K,status:e.target.value}),className:"w-full px-3 py-2.5 border-2 border-gray-200 dark:border-gray-600 rounded-xl bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:border-blue-500 dark:focus:border-blue-500 transition-colors outline-none",children:[a.jsx("option",{value:"all",children:"All Status"}),a.jsx("option",{value:"my-tasks",children:"To Do"}),a.jsx("option",{value:"in-progress",children:"In Progress"}),a.jsx("option",{value:"completed",children:"Completed"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Priority"}),a.jsxs("select",{value:K.priority,onChange:e=>V({...K,priority:e.target.value}),className:"w-full px-3 py-2.5 border-2 border-gray-200 dark:border-gray-600 rounded-xl bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:border-blue-500 dark:focus:border-blue-500 transition-colors outline-none",children:[a.jsx("option",{value:"all",children:"All Priorities"}),a.jsx("option",{value:"low",children:"Low"}),a.jsx("option",{value:"medium",children:"Medium"}),a.jsx("option",{value:"high",children:"High"}),a.jsx("option",{value:"urgent",children:"Urgent"})]})]}),a.jsx("div",{className:"flex items-end",children:a.jsx("button",{onClick:()=>{Y(""),V({search:"",category:"all",status:"all",priority:"all"})},className:"w-full px-4 py-2.5 border-2 border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-xl hover:bg-gray-100 dark:hover:bg-gray-600 font-medium transition-all duration-200 active:scale-95",children:"Reset Filters"})})]})})]}),a.jsx("div",{className:"flex-1 overflow-auto admin-scrollbar",children:T?a.jsxs("div",{className:"flex flex-col items-center justify-center h-full gap-4 p-8",children:[a.jsx("div",{className:"flex items-center justify-center w-16 h-16 rounded-full bg-red-100 dark:bg-red-900/30",children:a.jsx(n,{className:"w-8 h-8 text-red-600 dark:text-red-400"})}),a.jsxs("div",{className:"text-center space-y-2",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Failed to Load Tasks"}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 max-w-md",children:T})]}),a.jsxs("button",{onClick:()=>re(!1),disabled:S,className:"flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white rounded-xl font-medium shadow-lg hover:shadow-xl transition-all duration-200 active:scale-95 disabled:cursor-not-allowed",children:[a.jsx(y,{className:"w-4 h-4 "+(S?"animate-spin":"")}),a.jsx("span",{children:"Retry"})]})]}):S?a.jsxs(a.Fragment,{children:["list"===d&&a.jsx(ga,{}),"kanban"===d&&a.jsx(ma,{}),"analytics"===d&&a.jsx(xa,{}),"templates"===d&&a.jsxs("div",{className:"flex flex-col items-center justify-center h-full gap-4",children:[a.jsx("div",{className:"w-16 h-16 border-4 border-blue-600/20 dark:border-blue-400/20 border-t-blue-600 dark:border-t-blue-400 rounded-full animate-spin"}),a.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 font-medium",children:"Loading templates..."})]})]}):a.jsxs(a.Fragment,{children:["list"===d&&a.jsx(ia,{tasks:ce,selectedTaskIds:H,onSelectTasks:Z,onTaskClick:f,onTaskEdit:ne,onTaskDelete:ie,sort:J,onSortChange:W}),"kanban"===d&&a.jsx(Vr,{tasks:ce,onTaskUpdate:se,onTaskClick:f}),"analytics"===d&&a.jsx(Qr,{sectionId:r}),"templates"===d&&a.jsx(ra,{userId:t,sectionId:r,onCreateFromTemplate:()=>b(!0)})]})}),x&&a.jsx(na,{userId:t,sectionId:r,onClose:()=>b(!1),onTaskCreated:ae},j),v&&a.jsx(na,{userId:t,sectionId:r,task:v,onClose:()=>w(null),onTaskUpdated:e=>{se(e),w(null)}}),p&&a.jsx(da,{task:p,userId:t,onClose:()=>f(null),onTaskUpdated:se,onTaskDeleted:ie})]})}));export{ha as TaskManagerEnhanced};
