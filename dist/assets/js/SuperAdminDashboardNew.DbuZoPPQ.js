import{j as e,r as t,s,i as a,u as r,a as n}from"./index.G03YpSsJ.js";import{c as l}from"./clsx.BeLtu-UY.js";import{X as o}from"./x.C_w1sNd_.js";import{C as i}from"./chevron-right.1ZgpXlYX.js";import{C as d}from"./chevron-left.C4vu3Wn_.js";import{L as c,M as m}from"./menu.DrGzX9vm.js";import{S as u}from"./shield.fXIAB8gJ.js";import{U as x}from"./users.Ds5gqD7F.js";import{A as g}from"./activity.CnXi5TPH.js";import{F as h}from"./file-text.BS0r6X7H.js";import{S as p,u as f,a as b,M as y,L as v}from"./sun.Ck_D6jYx.js";import{C as j}from"./check-circle.D1VsgnDH.js";import{D as w,K as k,C as N,A as _,a as C,U as S,c as A,Z as T,T as U,B as E,b as D,d as z}from"./zap.Bty_0b-9.js";import{L as F}from"./layers.Cf_N9n_Z.js";import{T as $}from"./trending-up.BJ2trz1q.js";import{a as M,s as R}from"./notifications.DvTNppm3.js";import{R as P}from"./refresh-cw.W_cjirZU.js";import{P as I}from"./plus.BDnHBWdl.js";import{S as L}from"./search.C5Ibavgl.js";import{D as O}from"./download.Bbl31xXs.js";import{S as q}from"./square-pen.O4Q2aMw0.js";import{M as G}from"./more-vertical.CtHJaj6g.js";import{F as W}from"./filter.DrST7cpV.js";import{C as B}from"./clock.CxnJyE1q.js";import{U as V}from"./user.yGv05BZJ.js";import{E as H}from"./eye-off.B3IeMpz2.js";import{E as Y}from"./eye.Ds-jmL8l.js";import{C as J,S as Z}from"./shield-check.D_zW1EBC.js";import{C as X}from"./copy.BAeB8FHC.js";import{A as K}from"./alert-triangle.88nsUuGr.js";import{C as Q}from"./calendar.DyuQt31k.js";import{A as ee}from"./alert-circle.Kse7H8-2.js";import{M as te}from"./mail.BalnhmN_.js";import{P as se}from"./phone.BBk8E3NC.js";import{P as ae}from"./pen.BOfwGw5d.js";import{T as re}from"./trash-2.DCyQRQyM.js";import{U as ne}from"./user-check.hbQwg7Tl.js";import{C as le}from"./check-circle-2.B1KNYTCX.js";import{P as oe}from"./pie-chart.ARjsi3rT.js";import{B as ie}from"./bell.LrvbAutK.js";import{u as de}from"./useAuth.C6Yhzmx9.js";import"./createLucideIcon.D0wOJrC3.js";import"./dataCache.yGM8Zd45.js";import"./authErrors.BDay5vyW.js";const ce=(e=new Map,t=null,s)=>({nextPart:e,validators:t,classGroupId:s}),me="-",ue=[],xe=e=>{const t=pe(e),{conflictingClassGroups:s,conflictingClassGroupModifiers:a}=e;return{getClassGroupId:e=>{if(e.startsWith("[")&&e.endsWith("]"))return he(e);const s=e.split(me),a=""===s[0]&&s.length>1?1:0;return ge(s,a,t)},getConflictingClassGroupIds:(e,t)=>{if(t){const t=a[e],r=s[e];return t?r?((e,t)=>{const s=new Array(e.length+t.length);for(let a=0;a<e.length;a++)s[a]=e[a];for(let a=0;a<t.length;a++)s[e.length+a]=t[a];return s})(r,t):t:r||ue}return s[e]||ue}}},ge=(e,t,s)=>{if(0==e.length-t)return s.classGroupId;const a=e[t],r=s.nextPart.get(a);if(r){const s=ge(e,t+1,r);if(s)return s}const n=s.validators;if(null===n)return;const l=0===t?e.join(me):e.slice(t).join(me),o=n.length;for(let i=0;i<o;i++){const e=n[i];if(e.validator(l))return e.classGroupId}},he=e=>-1===e.slice(1,-1).indexOf(":")?void 0:(()=>{const t=e.slice(1,-1),s=t.indexOf(":"),a=t.slice(0,s);return a?"arbitrary.."+a:void 0})(),pe=e=>{const{theme:t,classGroups:s}=e;return fe(s,t)},fe=(e,t)=>{const s=ce();for(const a in e){const r=e[a];be(r,s,a,t)}return s},be=(e,t,s,a)=>{const r=e.length;for(let n=0;n<r;n++){const r=e[n];ye(r,t,s,a)}},ye=(e,t,s,a)=>{"string"!=typeof e?"function"!=typeof e?we(e,t,s,a):je(e,t,s,a):ve(e,t,s)},ve=(e,t,s)=>{(""===e?t:ke(t,e)).classGroupId=s},je=(e,t,s,a)=>{Ne(e)?be(e(a),t,s,a):(null===t.validators&&(t.validators=[]),t.validators.push(((e,t)=>({classGroupId:e,validator:t}))(s,e)))},we=(e,t,s,a)=>{const r=Object.entries(e),n=r.length;for(let l=0;l<n;l++){const[e,n]=r[l];be(n,ke(t,e),s,a)}},ke=(e,t)=>{let s=e;const a=t.split(me),r=a.length;for(let n=0;n<r;n++){const e=a[n];let t=s.nextPart.get(e);t||(t=ce(),s.nextPart.set(e,t)),s=t}return s},Ne=e=>"isThemeGetter"in e&&!0===e.isThemeGetter,_e=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,s=Object.create(null),a=Object.create(null);const r=(r,n)=>{s[r]=n,t++,t>e&&(t=0,a=s,s=Object.create(null))};return{get(e){let t=s[e];return void 0!==t?t:void 0!==(t=a[e])?(r(e,t),t):void 0},set(e,t){e in s?s[e]=t:r(e,t)}}},Ce=[],Se=(e,t,s,a,r)=>({modifiers:e,hasImportantModifier:t,baseClassName:s,maybePostfixModifierPosition:a,isExternal:r}),Ae=e=>{const{prefix:t,experimentalParseClassName:s}=e;let a=e=>{const t=[];let s,a=0,r=0,n=0;const l=e.length;for(let c=0;c<l;c++){const l=e[c];if(0===a&&0===r){if(":"===l){t.push(e.slice(n,c)),n=c+1;continue}if("/"===l){s=c;continue}}"["===l?a++:"]"===l?a--:"("===l?r++:")"===l&&r--}const o=0===t.length?e:e.slice(n);let i=o,d=!1;return o.endsWith("!")?(i=o.slice(0,-1),d=!0):o.startsWith("!")&&(i=o.slice(1),d=!0),Se(t,d,i,s&&s>n?s-n:void 0)};if(t){const e=t+":",s=a;a=t=>t.startsWith(e)?s(t.slice(e.length)):Se(Ce,!1,t,void 0,!0)}if(s){const e=a;a=t=>s({className:t,parseClassName:e})}return a},Te=e=>{const t=new Map;return e.orderSensitiveModifiers.forEach(((e,s)=>{t.set(e,1e6+s)})),e=>{const s=[];let a=[];for(let r=0;r<e.length;r++){const n=e[r],l="["===n[0],o=t.has(n);l||o?(a.length>0&&(a.sort(),s.push(...a),a=[]),s.push(n)):a.push(n)}return a.length>0&&(a.sort(),s.push(...a)),s}},Ue=/\s+/,Ee=e=>{if("string"==typeof e)return e;let t,s="";for(let a=0;a<e.length;a++)e[a]&&(t=Ee(e[a]))&&(s&&(s+=" "),s+=t);return s},De=[],ze=e=>{const t=t=>t[e]||De;return t.isThemeGetter=!0,t},Fe=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,$e=/^\((?:(\w[\w-]*):)?(.+)\)$/i,Me=/^\d+\/\d+$/,Re=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Pe=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,Ie=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,Le=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,Oe=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,qe=e=>Me.test(e),Ge=e=>!!e&&!Number.isNaN(Number(e)),We=e=>!!e&&Number.isInteger(Number(e)),Be=e=>e.endsWith("%")&&Ge(e.slice(0,-1)),Ve=e=>Re.test(e),He=()=>!0,Ye=e=>Pe.test(e)&&!Ie.test(e),Je=()=>!1,Ze=e=>Le.test(e),Xe=e=>Oe.test(e),Ke=e=>!et(e)&&!lt(e),Qe=e=>xt(e,ft,Je),et=e=>Fe.test(e),tt=e=>xt(e,bt,Ye),st=e=>xt(e,yt,Ge),at=e=>xt(e,ht,Je),rt=e=>xt(e,pt,Xe),nt=e=>xt(e,jt,Ze),lt=e=>$e.test(e),ot=e=>gt(e,bt),it=e=>gt(e,vt),dt=e=>gt(e,ht),ct=e=>gt(e,ft),mt=e=>gt(e,pt),ut=e=>gt(e,jt,!0),xt=(e,t,s)=>{const a=Fe.exec(e);return!!a&&(a[1]?t(a[1]):s(a[2]))},gt=(e,t,s=!1)=>{const a=$e.exec(e);return!!a&&(a[1]?t(a[1]):s)},ht=e=>"position"===e||"percentage"===e,pt=e=>"image"===e||"url"===e,ft=e=>"length"===e||"size"===e||"bg-size"===e,bt=e=>"length"===e,yt=e=>"number"===e,vt=e=>"family-name"===e,jt=e=>"shadow"===e,wt=((e,...t)=>{let s,a,r,n;const l=e=>{const t=a(e);if(t)return t;const n=((e,t)=>{const{parseClassName:s,getClassGroupId:a,getConflictingClassGroupIds:r,sortModifiers:n}=t,l=[],o=e.trim().split(Ue);let i="";for(let d=o.length-1;d>=0;d-=1){const e=o[d],{isExternal:t,modifiers:c,hasImportantModifier:m,baseClassName:u,maybePostfixModifierPosition:x}=s(e);if(t){i=e+(i.length>0?" "+i:i);continue}let g=!!x,h=a(g?u.substring(0,x):u);if(!h){if(!g){i=e+(i.length>0?" "+i:i);continue}if(h=a(u),!h){i=e+(i.length>0?" "+i:i);continue}g=!1}const p=0===c.length?"":1===c.length?c[0]:n(c).join(":"),f=m?p+"!":p,b=f+h;if(l.indexOf(b)>-1)continue;l.push(b);const y=r(h,g);for(let s=0;s<y.length;++s){const e=y[s];l.push(f+e)}i=e+(i.length>0?" "+i:i)}return i})(e,s);return r(e,n),n};return n=o=>{const i=t.reduce(((e,t)=>t(e)),e());return s=(e=>({cache:_e(e.cacheSize),parseClassName:Ae(e),sortModifiers:Te(e),...xe(e)}))(i),a=s.cache.get,r=s.cache.set,n=l,l(o)},(...e)=>n(((...e)=>{let t,s,a=0,r="";for(;a<e.length;)(t=e[a++])&&(s=Ee(t))&&(r&&(r+=" "),r+=s);return r})(...e))})((()=>{const e=ze("color"),t=ze("font"),s=ze("text"),a=ze("font-weight"),r=ze("tracking"),n=ze("leading"),l=ze("breakpoint"),o=ze("container"),i=ze("spacing"),d=ze("radius"),c=ze("shadow"),m=ze("inset-shadow"),u=ze("text-shadow"),x=ze("drop-shadow"),g=ze("blur"),h=ze("perspective"),p=ze("aspect"),f=ze("ease"),b=ze("animate"),y=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom",lt,et],v=()=>[lt,et,i],j=()=>[qe,"full","auto",...v()],w=()=>[We,"none","subgrid",lt,et],k=()=>["auto",{span:["full",We,lt,et]},We,lt,et],N=()=>[We,"auto",lt,et],_=()=>["auto","min","max","fr",lt,et],C=()=>["auto",...v()],S=()=>[qe,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...v()],A=()=>[e,lt,et],T=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom",dt,at,{position:[lt,et]}],U=()=>["auto","cover","contain",ct,Qe,{size:[lt,et]}],E=()=>[Be,ot,tt],D=()=>["","none","full",d,lt,et],z=()=>["",Ge,ot,tt],F=()=>[Ge,Be,dt,at],$=()=>["","none",g,lt,et],M=()=>["none",Ge,lt,et],R=()=>["none",Ge,lt,et],P=()=>[Ge,lt,et],I=()=>[qe,"full",...v()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[Ve],breakpoint:[Ve],color:[He],container:[Ve],"drop-shadow":[Ve],ease:["in","out","in-out"],font:[Ke],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[Ve],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[Ve],shadow:[Ve],spacing:["px",Ge],text:[Ve],"text-shadow":[Ve],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",qe,et,lt,p]}],container:["container"],columns:[{columns:[Ge,et,lt,o]}],"break-after":[{"break-after":["auto","avoid","all","avoid-page","page","left","right","column"]}],"break-before":[{"break-before":["auto","avoid","all","avoid-page","page","left","right","column"]}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:y()}],overflow:[{overflow:["auto","hidden","clip","visible","scroll"]}],"overflow-x":[{"overflow-x":["auto","hidden","clip","visible","scroll"]}],"overflow-y":[{"overflow-y":["auto","hidden","clip","visible","scroll"]}],overscroll:[{overscroll:["auto","contain","none"]}],"overscroll-x":[{"overscroll-x":["auto","contain","none"]}],"overscroll-y":[{"overscroll-y":["auto","contain","none"]}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:j()}],"inset-x":[{"inset-x":j()}],"inset-y":[{"inset-y":j()}],start:[{start:j()}],end:[{end:j()}],top:[{top:j()}],right:[{right:j()}],bottom:[{bottom:j()}],left:[{left:j()}],visibility:["visible","invisible","collapse"],z:[{z:[We,"auto",lt,et]}],basis:[{basis:[qe,"full","auto",o,...v()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[Ge,qe,"auto","initial","none",et]}],grow:[{grow:["",Ge,lt,et]}],shrink:[{shrink:["",Ge,lt,et]}],order:[{order:[We,"first","last","none",lt,et]}],"grid-cols":[{"grid-cols":w()}],"col-start-end":[{col:k()}],"col-start":[{"col-start":N()}],"col-end":[{"col-end":N()}],"grid-rows":[{"grid-rows":w()}],"row-start-end":[{row:k()}],"row-start":[{"row-start":N()}],"row-end":[{"row-end":N()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":_()}],"auto-rows":[{"auto-rows":_()}],gap:[{gap:v()}],"gap-x":[{"gap-x":v()}],"gap-y":[{"gap-y":v()}],"justify-content":[{justify:["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe","normal"]}],"justify-items":[{"justify-items":["start","end","center","stretch","center-safe","end-safe","normal"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch","center-safe","end-safe"]}],"align-content":[{content:["normal","start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"]}],"align-items":[{items:["start","end","center","stretch","center-safe","end-safe",{baseline:["","last"]}]}],"align-self":[{self:["auto","start","end","center","stretch","center-safe","end-safe",{baseline:["","last"]}]}],"place-content":[{"place-content":["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"]}],"place-items":[{"place-items":["start","end","center","stretch","center-safe","end-safe","baseline"]}],"place-self":[{"place-self":["auto","start","end","center","stretch","center-safe","end-safe"]}],p:[{p:v()}],px:[{px:v()}],py:[{py:v()}],ps:[{ps:v()}],pe:[{pe:v()}],pt:[{pt:v()}],pr:[{pr:v()}],pb:[{pb:v()}],pl:[{pl:v()}],m:[{m:C()}],mx:[{mx:C()}],my:[{my:C()}],ms:[{ms:C()}],me:[{me:C()}],mt:[{mt:C()}],mr:[{mr:C()}],mb:[{mb:C()}],ml:[{ml:C()}],"space-x":[{"space-x":v()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":v()}],"space-y-reverse":["space-y-reverse"],size:[{size:S()}],w:[{w:[o,"screen",...S()]}],"min-w":[{"min-w":[o,"screen","none",...S()]}],"max-w":[{"max-w":[o,"screen","none","prose",{screen:[l]},...S()]}],h:[{h:["screen","lh",...S()]}],"min-h":[{"min-h":["screen","lh","none",...S()]}],"max-h":[{"max-h":["screen","lh",...S()]}],"font-size":[{text:["base",s,ot,tt]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[a,lt,st]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",Be,et]}],"font-family":[{font:[it,et,t]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[r,lt,et]}],"line-clamp":[{"line-clamp":[Ge,"none",lt,st]}],leading:[{leading:[n,...v()]}],"list-image":[{"list-image":["none",lt,et]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",lt,et]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:A()}],"text-color":[{text:A()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:["solid","dashed","dotted","double","wavy"]}],"text-decoration-thickness":[{decoration:[Ge,"from-font","auto",lt,tt]}],"text-decoration-color":[{decoration:A()}],"underline-offset":[{"underline-offset":[Ge,"auto",lt,et]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:v()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",lt,et]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",lt,et]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:T()}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","space","round"]}]}],"bg-size":[{bg:U()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},We,lt,et],radial:["",lt,et],conic:[We,lt,et]},mt,rt]}],"bg-color":[{bg:A()}],"gradient-from-pos":[{from:E()}],"gradient-via-pos":[{via:E()}],"gradient-to-pos":[{to:E()}],"gradient-from":[{from:A()}],"gradient-via":[{via:A()}],"gradient-to":[{to:A()}],rounded:[{rounded:D()}],"rounded-s":[{"rounded-s":D()}],"rounded-e":[{"rounded-e":D()}],"rounded-t":[{"rounded-t":D()}],"rounded-r":[{"rounded-r":D()}],"rounded-b":[{"rounded-b":D()}],"rounded-l":[{"rounded-l":D()}],"rounded-ss":[{"rounded-ss":D()}],"rounded-se":[{"rounded-se":D()}],"rounded-ee":[{"rounded-ee":D()}],"rounded-es":[{"rounded-es":D()}],"rounded-tl":[{"rounded-tl":D()}],"rounded-tr":[{"rounded-tr":D()}],"rounded-br":[{"rounded-br":D()}],"rounded-bl":[{"rounded-bl":D()}],"border-w":[{border:z()}],"border-w-x":[{"border-x":z()}],"border-w-y":[{"border-y":z()}],"border-w-s":[{"border-s":z()}],"border-w-e":[{"border-e":z()}],"border-w-t":[{"border-t":z()}],"border-w-r":[{"border-r":z()}],"border-w-b":[{"border-b":z()}],"border-w-l":[{"border-l":z()}],"divide-x":[{"divide-x":z()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":z()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:["solid","dashed","dotted","double","hidden","none"]}],"divide-style":[{divide:["solid","dashed","dotted","double","hidden","none"]}],"border-color":[{border:A()}],"border-color-x":[{"border-x":A()}],"border-color-y":[{"border-y":A()}],"border-color-s":[{"border-s":A()}],"border-color-e":[{"border-e":A()}],"border-color-t":[{"border-t":A()}],"border-color-r":[{"border-r":A()}],"border-color-b":[{"border-b":A()}],"border-color-l":[{"border-l":A()}],"divide-color":[{divide:A()}],"outline-style":[{outline:["solid","dashed","dotted","double","none","hidden"]}],"outline-offset":[{"outline-offset":[Ge,lt,et]}],"outline-w":[{outline:["",Ge,ot,tt]}],"outline-color":[{outline:A()}],shadow:[{shadow:["","none",c,ut,nt]}],"shadow-color":[{shadow:A()}],"inset-shadow":[{"inset-shadow":["none",m,ut,nt]}],"inset-shadow-color":[{"inset-shadow":A()}],"ring-w":[{ring:z()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:A()}],"ring-offset-w":[{"ring-offset":[Ge,tt]}],"ring-offset-color":[{"ring-offset":A()}],"inset-ring-w":[{"inset-ring":z()}],"inset-ring-color":[{"inset-ring":A()}],"text-shadow":[{"text-shadow":["none",u,ut,nt]}],"text-shadow-color":[{"text-shadow":A()}],opacity:[{opacity:[Ge,lt,et]}],"mix-blend":[{"mix-blend":["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity","plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"]}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[Ge]}],"mask-image-linear-from-pos":[{"mask-linear-from":F()}],"mask-image-linear-to-pos":[{"mask-linear-to":F()}],"mask-image-linear-from-color":[{"mask-linear-from":A()}],"mask-image-linear-to-color":[{"mask-linear-to":A()}],"mask-image-t-from-pos":[{"mask-t-from":F()}],"mask-image-t-to-pos":[{"mask-t-to":F()}],"mask-image-t-from-color":[{"mask-t-from":A()}],"mask-image-t-to-color":[{"mask-t-to":A()}],"mask-image-r-from-pos":[{"mask-r-from":F()}],"mask-image-r-to-pos":[{"mask-r-to":F()}],"mask-image-r-from-color":[{"mask-r-from":A()}],"mask-image-r-to-color":[{"mask-r-to":A()}],"mask-image-b-from-pos":[{"mask-b-from":F()}],"mask-image-b-to-pos":[{"mask-b-to":F()}],"mask-image-b-from-color":[{"mask-b-from":A()}],"mask-image-b-to-color":[{"mask-b-to":A()}],"mask-image-l-from-pos":[{"mask-l-from":F()}],"mask-image-l-to-pos":[{"mask-l-to":F()}],"mask-image-l-from-color":[{"mask-l-from":A()}],"mask-image-l-to-color":[{"mask-l-to":A()}],"mask-image-x-from-pos":[{"mask-x-from":F()}],"mask-image-x-to-pos":[{"mask-x-to":F()}],"mask-image-x-from-color":[{"mask-x-from":A()}],"mask-image-x-to-color":[{"mask-x-to":A()}],"mask-image-y-from-pos":[{"mask-y-from":F()}],"mask-image-y-to-pos":[{"mask-y-to":F()}],"mask-image-y-from-color":[{"mask-y-from":A()}],"mask-image-y-to-color":[{"mask-y-to":A()}],"mask-image-radial":[{"mask-radial":[lt,et]}],"mask-image-radial-from-pos":[{"mask-radial-from":F()}],"mask-image-radial-to-pos":[{"mask-radial-to":F()}],"mask-image-radial-from-color":[{"mask-radial-from":A()}],"mask-image-radial-to-color":[{"mask-radial-to":A()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"]}],"mask-image-conic-pos":[{"mask-conic":[Ge]}],"mask-image-conic-from-pos":[{"mask-conic-from":F()}],"mask-image-conic-to-pos":[{"mask-conic-to":F()}],"mask-image-conic-from-color":[{"mask-conic-from":A()}],"mask-image-conic-to-color":[{"mask-conic-to":A()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:T()}],"mask-repeat":[{mask:["no-repeat",{repeat:["","x","y","space","round"]}]}],"mask-size":[{mask:U()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",lt,et]}],filter:[{filter:["","none",lt,et]}],blur:[{blur:$()}],brightness:[{brightness:[Ge,lt,et]}],contrast:[{contrast:[Ge,lt,et]}],"drop-shadow":[{"drop-shadow":["","none",x,ut,nt]}],"drop-shadow-color":[{"drop-shadow":A()}],grayscale:[{grayscale:["",Ge,lt,et]}],"hue-rotate":[{"hue-rotate":[Ge,lt,et]}],invert:[{invert:["",Ge,lt,et]}],saturate:[{saturate:[Ge,lt,et]}],sepia:[{sepia:["",Ge,lt,et]}],"backdrop-filter":[{"backdrop-filter":["","none",lt,et]}],"backdrop-blur":[{"backdrop-blur":$()}],"backdrop-brightness":[{"backdrop-brightness":[Ge,lt,et]}],"backdrop-contrast":[{"backdrop-contrast":[Ge,lt,et]}],"backdrop-grayscale":[{"backdrop-grayscale":["",Ge,lt,et]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[Ge,lt,et]}],"backdrop-invert":[{"backdrop-invert":["",Ge,lt,et]}],"backdrop-opacity":[{"backdrop-opacity":[Ge,lt,et]}],"backdrop-saturate":[{"backdrop-saturate":[Ge,lt,et]}],"backdrop-sepia":[{"backdrop-sepia":["",Ge,lt,et]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":v()}],"border-spacing-x":[{"border-spacing-x":v()}],"border-spacing-y":[{"border-spacing-y":v()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",lt,et]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[Ge,"initial",lt,et]}],ease:[{ease:["linear","initial",f,lt,et]}],delay:[{delay:[Ge,lt,et]}],animate:[{animate:["none",b,lt,et]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[h,lt,et]}],"perspective-origin":[{"perspective-origin":y()}],rotate:[{rotate:M()}],"rotate-x":[{"rotate-x":M()}],"rotate-y":[{"rotate-y":M()}],"rotate-z":[{"rotate-z":M()}],scale:[{scale:R()}],"scale-x":[{"scale-x":R()}],"scale-y":[{"scale-y":R()}],"scale-z":[{"scale-z":R()}],"scale-3d":["scale-3d"],skew:[{skew:P()}],"skew-x":[{"skew-x":P()}],"skew-y":[{"skew-y":P()}],transform:[{transform:[lt,et,"","none","gpu","cpu"]}],"transform-origin":[{origin:y()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:I()}],"translate-x":[{"translate-x":I()}],"translate-y":[{"translate-y":I()}],"translate-z":[{"translate-z":I()}],"translate-none":["translate-none"],accent:[{accent:A()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:A()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",lt,et]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":v()}],"scroll-mx":[{"scroll-mx":v()}],"scroll-my":[{"scroll-my":v()}],"scroll-ms":[{"scroll-ms":v()}],"scroll-me":[{"scroll-me":v()}],"scroll-mt":[{"scroll-mt":v()}],"scroll-mr":[{"scroll-mr":v()}],"scroll-mb":[{"scroll-mb":v()}],"scroll-ml":[{"scroll-ml":v()}],"scroll-p":[{"scroll-p":v()}],"scroll-px":[{"scroll-px":v()}],"scroll-py":[{"scroll-py":v()}],"scroll-ps":[{"scroll-ps":v()}],"scroll-pe":[{"scroll-pe":v()}],"scroll-pt":[{"scroll-pt":v()}],"scroll-pr":[{"scroll-pr":v()}],"scroll-pb":[{"scroll-pb":v()}],"scroll-pl":[{"scroll-pl":v()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",lt,et]}],fill:[{fill:["none",...A()]}],"stroke-w":[{stroke:[Ge,ot,tt,st]}],stroke:[{stroke:["none",...A()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}}));function kt(...e){return wt(l(e))}const Nt=[{id:"overview",label:"Overview",icon:c},{id:"admins",label:"Admin Management",icon:u},{id:"section-admins",label:"Section Admins",icon:x},{id:"analytics",label:"Analytics",icon:g},{id:"logs",label:"System Logs",icon:h},{id:"security",label:"Security Settings",icon:p}];function _t({activeTab:t,onTabChange:s,isCollapsed:a,onToggleCollapse:r,isMobile:n=!1,isOpen:l=!1,onClose:c}){return n?e.jsxs(e.Fragment,{children:[l&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-40 lg:hidden",onClick:c}),e.jsxs("div",{className:kt("fixed inset-y-0 left-0 z-50 w-64 bg-white dark:bg-gray-900 border-r border-gray-200 dark:border-gray-800 transform transition-transform duration-300 lg:hidden",l?"translate-x-0":"-translate-x-full"),children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-800",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Super Admin"}),e.jsx("button",{onClick:c,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg",children:e.jsx(o,{className:"w-5 h-5"})})]}),e.jsx("nav",{className:"p-4 space-y-2",children:Nt.map((a=>{const r=a.icon,n=t===a.id;return e.jsxs("button",{onClick:()=>{s(a.id),null==c||c()},className:kt("w-full flex items-center gap-3 px-3 py-2 rounded-lg transition-colors",n?"bg-blue-50 text-blue-600 dark:bg-blue-900/30 dark:text-blue-400":"text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800"),children:[e.jsx(r,{className:"w-5 h-5"}),e.jsx("span",{className:"font-medium",children:a.label})]},a.id)}))})]})]}):e.jsxs("div",{className:kt("hidden lg:flex flex-col bg-white dark:bg-gray-900 border-r border-gray-200 dark:border-gray-800 transition-all duration-300",a?"w-20":"w-64"),children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-4 border-b border-gray-200 dark:border-gray-800 h-16",children:[!a&&e.jsx("h2",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"Super Admin"}),e.jsx("button",{onClick:r,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg ml-auto",children:a?e.jsx(i,{className:"w-5 h-5"}):e.jsx(d,{className:"w-5 h-5"})})]}),e.jsx("nav",{className:"flex-1 p-4 space-y-2",children:Nt.map((r=>{const n=r.icon,l=t===r.id;return e.jsxs("button",{onClick:()=>s(r.id),className:kt("w-full flex items-center gap-3 px-3 py-2 rounded-lg transition-colors",l?"bg-blue-50 text-blue-600 dark:bg-blue-900/30 dark:text-blue-400":"text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800",a&&"justify-center"),title:a?r.label:void 0,children:[e.jsx(n,{className:"w-5 h-5 flex-shrink-0"}),!a&&e.jsx("span",{className:"font-medium",children:r.label})]},r.id)}))})]})}const Ct=t.forwardRef((({className:t,...s},a)=>e.jsx("div",{ref:a,className:kt("rounded-xl border border-gray-200 bg-white text-gray-950 shadow-sm dark:border-gray-800 dark:bg-gray-900 dark:text-gray-50",t),...s})));Ct.displayName="Card";const St=t.forwardRef((({className:t,...s},a)=>e.jsx("div",{ref:a,className:kt("flex flex-col space-y-1.5 p-6",t),...s})));St.displayName="CardHeader";const At=t.forwardRef((({className:t,...s},a)=>e.jsx("h3",{ref:a,className:kt("font-semibold leading-none tracking-tight",t),...s})));At.displayName="CardTitle";const Tt=t.forwardRef((({className:t,...s},a)=>e.jsx("p",{ref:a,className:kt("text-sm text-gray-500 dark:text-gray-400",t),...s})));Tt.displayName="CardDescription";const Ut=t.forwardRef((({className:t,...s},a)=>e.jsx("div",{ref:a,className:kt("p-6 pt-0",t),...s})));Ut.displayName="CardContent",t.forwardRef((({className:t,...s},a)=>e.jsx("div",{ref:a,className:kt("flex items-center p-6 pt-0",t),...s}))).displayName="CardFooter";const Et=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,Dt=l,zt=(e,t)=>s=>{var a;if(null==(null==t?void 0:t.variants))return Dt(e,null==s?void 0:s.class,null==s?void 0:s.className);const{variants:r,defaultVariants:n}=t,l=Object.keys(r).map((e=>{const t=null==s?void 0:s[e],a=null==n?void 0:n[e];if(null===t)return null;const l=Et(t)||Et(a);return r[e][l]})),o=s&&Object.entries(s).reduce(((e,t)=>{let[s,a]=t;return void 0===a||(e[s]=a),e}),{}),i=null==t||null===(a=t.compoundVariants)||void 0===a?void 0:a.reduce(((e,t)=>{let{class:s,className:a,...r}=t;return Object.entries(r).every((e=>{let[t,s]=e;return Array.isArray(s)?s.includes({...n,...o}[t]):{...n,...o}[t]===s}))?[...e,s,a]:e}),[]);return Dt(e,l,i,null==s?void 0:s.class,null==s?void 0:s.className)},Ft=zt("inline-flex items-center rounded-md border border-gray-200 px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-gray-950 focus:ring-offset-2 dark:border-gray-800 dark:focus:ring-gray-300",{variants:{variant:{default:"border-transparent bg-gray-900 text-gray-50 shadow hover:bg-gray-900/80 dark:bg-gray-50 dark:text-gray-900 dark:hover:bg-gray-50/80",secondary:"border-transparent bg-gray-100 text-gray-900 hover:bg-gray-100/80 dark:bg-gray-800 dark:text-gray-50 dark:hover:bg-gray-800/80",destructive:"border-transparent bg-red-500 text-gray-50 shadow hover:bg-red-500/80 dark:bg-red-900 dark:text-gray-50 dark:hover:bg-red-900/80",outline:"text-gray-950 dark:text-gray-50",success:"border-transparent bg-green-500 text-white shadow hover:bg-green-600 dark:bg-green-600 dark:hover:bg-green-700",warning:"border-transparent bg-yellow-500 text-white shadow hover:bg-yellow-600 dark:bg-yellow-600 dark:hover:bg-yellow-700",info:"border-transparent bg-blue-500 text-white shadow hover:bg-blue-600 dark:bg-blue-600 dark:hover:bg-blue-700"}},defaultVariants:{variant:"default"}});function $t({className:t,variant:s,...a}){return e.jsx("div",{className:kt(Ft({variant:s}),t),...a})}function Mt(){const[a,r]=t.useState(null),[n,l]=t.useState([]),[o,i]=t.useState(!0);t.useEffect((()=>{d()}),[]);const d=async()=>{try{i(!0);const{data:e,error:t}=await s.rpc("get_dashboard_stats",{});if(t){const[e,t,a,n,l,o,i,d]=await Promise.all([s.from("users").select("*",{count:"exact",head:!0}),s.from("users").select("*",{count:"exact",head:!0}).eq("role","admin"),s.from("users").select("*",{count:"exact",head:!0}).eq("role","section_admin"),s.from("tasks").select("*",{count:"exact",head:!0}),s.from("tasks").select("*",{count:"exact",head:!0}).eq("status","completed"),s.from("departments").select("*",{count:"exact",head:!0}),s.from("batches").select("*",{count:"exact",head:!0}),s.from("sections").select("*",{count:"exact",head:!0})]);r({total_users:e.count||0,total_admins:t.count||0,total_section_admins:a.count||0,total_tasks:n.count||0,completed_tasks:l.count||0,total_departments:o.count||0,total_batches:i.count||0,total_sections:d.count||0})}else r(e);const{data:a}=await s.from("activities").select("\n          id,\n          type,\n          title,\n          metadata,\n          created_at,\n          user:users(name, email)\n        ").order("created_at",{ascending:!1}).limit(10);a&&l(a.map((e=>({...e,user:Array.isArray(e.user)?e.user[0]:e.user}))))}catch(e){}finally{i(!1)}},c=a?[{title:"Total Users",value:a.total_users,change:"+12%",icon:x,color:"text-blue-600",bgColor:"bg-blue-50 dark:bg-blue-900/20"},{title:"Admins",value:a.total_admins,change:"+3%",icon:u,color:"text-purple-600",bgColor:"bg-purple-50 dark:bg-purple-900/20"},{title:"Section Admins",value:a.total_section_admins,change:"+8%",icon:x,color:"text-green-600",bgColor:"bg-green-50 dark:bg-green-900/20"},{title:"Total Tasks",value:a.total_tasks,change:"+24%",icon:j,color:"text-orange-600",bgColor:"bg-orange-50 dark:bg-orange-900/20"},{title:"Completed Tasks",value:a.completed_tasks,change:`${a.total_tasks>0?Math.round(a.completed_tasks/a.total_tasks*100):0}%`,icon:j,color:"text-emerald-600",bgColor:"bg-emerald-50 dark:bg-emerald-900/20"},{title:"Departments",value:a.total_departments,change:"",icon:w,color:"text-indigo-600",bgColor:"bg-indigo-50 dark:bg-indigo-900/20"},{title:"Batches",value:a.total_batches,change:"",icon:F,color:"text-pink-600",bgColor:"bg-pink-50 dark:bg-pink-900/20"},{title:"Sections",value:a.total_sections,change:"",icon:F,color:"text-teal-600",bgColor:"bg-teal-50 dark:bg-teal-900/20"}]:[];return o?e.jsx("div",{className:"space-y-6 animate-pulse",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[1,2,3,4].map((t=>e.jsx("div",{className:"h-32 bg-gray-200 dark:bg-gray-800 rounded-xl"},t)))})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:c.map(((t,s)=>{var a;const r=t.icon;return e.jsxs(Ct,{className:"hover:shadow-lg transition-shadow",children:[e.jsxs(St,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(At,{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:t.title}),e.jsx("div",{className:`p-2 rounded-lg ${t.bgColor}`,children:e.jsx(r,{className:`w-5 h-5 ${t.color}`})})]}),e.jsxs(Ut,{children:[e.jsx("div",{className:"text-2xl font-bold",children:Number(null!=(a=t.value)?a:0).toLocaleString()}),t.change&&e.jsxs("p",{className:"text-xs text-green-600 dark:text-green-400 flex items-center gap-1 mt-1",children:[e.jsx($,{className:"w-3 h-3"}),t.change," from last month"]})]})]},s)}))}),e.jsxs(Ct,{children:[e.jsxs(St,{children:[e.jsxs(At,{className:"flex items-center gap-2",children:[e.jsx(g,{className:"w-5 h-5"}),"Recent Activity"]}),e.jsx(Tt,{children:"Latest system activities and updates"})]}),e.jsx(Ut,{children:0===n.length?e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 text-center py-8",children:"No recent activities to display"}):e.jsx("div",{className:"space-y-4",children:n.map((t=>e.jsxs("div",{className:"flex items-start justify-between p-3 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 rounded-full bg-blue-50 dark:bg-blue-900/20",children:e.jsx(g,{className:"w-4 h-4 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:t.title}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:t.user&&"object"==typeof t.user&&!Array.isArray(t.user)?t.user.name||t.user.email:"System"})]})]}),e.jsxs("div",{className:"flex flex-col items-end gap-1",children:[e.jsx($t,{variant:"secondary",className:"text-xs",children:t.type}),e.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:new Date(t.created_at).toLocaleDateString()})]})]},t.id)))})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsxs(Ct,{children:[e.jsxs(St,{children:[e.jsxs(At,{className:"flex items-center gap-2",children:[e.jsx(w,{className:"w-5 h-5"}),"Organization Structure"]}),e.jsx(Tt,{children:"Hierarchical breakdown"})]}),e.jsx(Ut,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsx("span",{className:"text-sm font-medium",children:"Departments"}),e.jsx($t,{variant:"info",children:(null==a?void 0:a.total_departments)||0})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsx("span",{className:"text-sm font-medium",children:"Batches"}),e.jsx($t,{variant:"info",children:(null==a?void 0:a.total_batches)||0})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsx("span",{className:"text-sm font-medium",children:"Sections"}),e.jsx($t,{variant:"info",children:(null==a?void 0:a.total_sections)||0})]})]})})]}),e.jsxs(Ct,{children:[e.jsxs(St,{children:[e.jsxs(At,{className:"flex items-center gap-2",children:[e.jsx(j,{className:"w-5 h-5"}),"Task Overview"]}),e.jsx(Tt,{children:"Current task statistics"})]}),e.jsx(Ut,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsx("span",{className:"text-sm font-medium",children:"Total Tasks"}),e.jsx($t,{variant:"info",children:(null==a?void 0:a.total_tasks)||0})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsx("span",{className:"text-sm font-medium",children:"Completed"}),e.jsx($t,{variant:"success",children:(null==a?void 0:a.completed_tasks)||0})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:[e.jsx("span",{className:"text-sm font-medium",children:"Pending"}),e.jsx($t,{variant:"warning",children:((null==a?void 0:a.total_tasks)||0)-((null==a?void 0:a.completed_tasks)||0)})]})]})})]})]})]})}function Rt(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}var Pt=Symbol.for("react.lazy"),It=a[" use ".trim().toString()];function Lt(e){return null!=e&&"object"==typeof e&&"$$typeof"in e&&e.$$typeof===Pt&&"_payload"in e&&"object"==typeof(t=e._payload)&&null!==t&&"then"in t;var t}function Ot(s){const a=Gt(s),r=t.forwardRef(((s,r)=>{let{children:n,...l}=s;Lt(n)&&"function"==typeof It&&(n=It(n._payload));const o=t.Children.toArray(n),i=o.find(Bt);if(i){const s=i.props.children,n=o.map((e=>e===i?t.Children.count(s)>1?t.Children.only(null):t.isValidElement(s)?s.props.children:null:e));return e.jsx(a,{...l,ref:r,children:t.isValidElement(s)?t.cloneElement(s,void 0,n):null})}return e.jsx(a,{...l,ref:r,children:n})}));return r.displayName=`${s}.Slot`,r}var qt=Ot("Slot");function Gt(e){const s=t.forwardRef(((e,s)=>{let{children:a,...r}=e;if(Lt(a)&&"function"==typeof It&&(a=It(a._payload)),t.isValidElement(a)){const e=function(e){var t,s;let a=null==(t=Object.getOwnPropertyDescriptor(e.props,"ref"))?void 0:t.get,r=a&&"isReactWarning"in a&&a.isReactWarning;return r?e.ref:(a=null==(s=Object.getOwnPropertyDescriptor(e,"ref"))?void 0:s.get,r=a&&"isReactWarning"in a&&a.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}(a),n=function(e,t){const s={...t};for(const a in t){const r=e[a],n=t[a];/^on[A-Z]/.test(a)?r&&n?s[a]=(...e)=>{const t=n(...e);return r(...e),t}:r&&(s[a]=r):"style"===a?s[a]={...r,...n}:"className"===a&&(s[a]=[r,n].filter(Boolean).join(" "))}return{...e,...s}}(r,a.props);return a.type!==t.Fragment&&(n.ref=s?function(...e){return t=>{let s=!1;const a=e.map((e=>{const a=Rt(e,t);return s||"function"!=typeof a||(s=!0),a}));if(s)return()=>{for(let t=0;t<a.length;t++){const s=a[t];"function"==typeof s?s():Rt(e[t],null)}}}}(s,e):e),t.cloneElement(a,n)}return t.Children.count(a)>1?t.Children.only(null):null}));return s.displayName=`${e}.SlotClone`,s}var Wt=Symbol("radix.slottable");function Bt(e){return t.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===Wt}const Vt=zt("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-gray-950 disabled:pointer-events-none disabled:opacity-50 dark:focus-visible:ring-gray-300",{variants:{variant:{default:"bg-gray-900 text-gray-50 shadow hover:bg-gray-900/90 dark:bg-gray-50 dark:text-gray-900 dark:hover:bg-gray-50/90",destructive:"bg-red-500 text-gray-50 shadow-sm hover:bg-red-500/90 dark:bg-red-900 dark:text-gray-50 dark:hover:bg-red-900/90",outline:"border border-gray-200 bg-white shadow-sm hover:bg-gray-100 hover:text-gray-900 dark:border-gray-800 dark:bg-gray-950 dark:hover:bg-gray-800 dark:hover:text-gray-50",secondary:"bg-gray-100 text-gray-900 shadow-sm hover:bg-gray-100/80 dark:bg-gray-800 dark:text-gray-50 dark:hover:bg-gray-800/80",ghost:"hover:bg-gray-100 hover:text-gray-900 dark:hover:bg-gray-800 dark:hover:text-gray-50",link:"text-gray-900 underline-offset-4 hover:underline dark:text-gray-50"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),Ht=t.forwardRef((({className:t,variant:s,size:a,asChild:r=!1,...n},l)=>{const o=r?qt:"button";return e.jsx(o,{className:kt(Vt({variant:s,size:a,className:t})),ref:l,...n})}));Ht.displayName="Button";const Yt=t.forwardRef((({className:t,type:s,...a},r)=>e.jsx("input",{type:s,className:kt("flex h-9 w-full rounded-md border border-gray-200 bg-white px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-gray-500 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-gray-950 disabled:cursor-not-allowed disabled:opacity-50 dark:border-gray-800 dark:bg-gray-950 dark:placeholder:text-gray-400 dark:focus-visible:ring-gray-300",t),ref:r,...a})));Yt.displayName="Input";const Jt=t.forwardRef((({className:t,...s},a)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:a,className:kt("w-full caption-bottom text-sm",t),...s})})));Jt.displayName="Table";const Zt=t.forwardRef((({className:t,...s},a)=>e.jsx("thead",{ref:a,className:kt("[&_tr]:border-b",t),...s})));Zt.displayName="TableHeader";const Xt=t.forwardRef((({className:t,...s},a)=>e.jsx("tbody",{ref:a,className:kt("[&_tr:last-child]:border-0",t),...s})));Xt.displayName="TableBody",t.forwardRef((({className:t,...s},a)=>e.jsx("tfoot",{ref:a,className:kt("border-t bg-gray-100/50 font-medium [&>tr]:last:border-b-0 dark:bg-gray-800/50",t),...s}))).displayName="TableFooter";const Kt=t.forwardRef((({className:t,...s},a)=>e.jsx("tr",{ref:a,className:kt("border-b transition-colors hover:bg-gray-100/50 data-[state=selected]:bg-gray-100 dark:hover:bg-gray-800/50 dark:data-[state=selected]:bg-gray-800",t),...s})));Kt.displayName="TableRow";const Qt=t.forwardRef((({className:t,...s},a)=>e.jsx("th",{ref:a,className:kt("h-10 px-2 text-left align-middle font-medium text-gray-500 [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px] dark:text-gray-400",t),...s})));Qt.displayName="TableHead";const es=t.forwardRef((({className:t,...s},a)=>e.jsx("td",{ref:a,className:kt("p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...s})));function ts(...e){const s=e[0];if(1===e.length)return s;const a=()=>{const a=e.map((e=>({useScope:e(),scopeName:e.scopeName})));return function(e){const r=a.reduce(((t,{useScope:s,scopeName:a})=>({...t,...s(e)[`__scope${a}`]})),{});return t.useMemo((()=>({[`__scope${s.scopeName}`]:r})),[r])}};return a.scopeName=s.scopeName,a}es.displayName="TableCell",t.forwardRef((({className:t,...s},a)=>e.jsx("caption",{ref:a,className:kt("mt-4 text-sm text-gray-500 dark:text-gray-400",t),...s}))).displayName="TableCaption";var ss=(null==globalThis?void 0:globalThis.document)?t.useLayoutEffect:()=>{},as=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce(((s,a)=>{const r=Ot(`Primitive.${a}`),n=t.forwardRef(((t,s)=>{const{asChild:n,...l}=t,o=n?r:a;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),e.jsx(o,{...l,ref:s})}));return n.displayName=`Primitive.${a}`,{...s,[a]:n}}),{}),rs={exports:{}},ns={},ls=t,os="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},is=ls.useState,ds=ls.useEffect,cs=ls.useLayoutEffect,ms=ls.useDebugValue;function us(e){var t=e.getSnapshot;e=e.value;try{var s=t();return!os(e,s)}catch(a){return!0}}var xs="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var s=t(),a=is({inst:{value:s,getSnapshot:t}}),r=a[0].inst,n=a[1];return cs((function(){r.value=s,r.getSnapshot=t,us(r)&&n({inst:r})}),[e,s,t]),ds((function(){return us(r)&&n({inst:r}),e((function(){us(r)&&n({inst:r})}))}),[e]),ms(s),s};ns.useSyncExternalStore=void 0!==ls.useSyncExternalStore?ls.useSyncExternalStore:xs,rs.exports=ns;var gs=rs.exports;function hs(){return()=>{}}var ps="Avatar",[fs,bs]=function(s,a=[]){let r=[];const n=()=>{const e=r.map((e=>t.createContext(e)));return function(a){const r=(null==a?void 0:a[s])||e;return t.useMemo((()=>({[`__scope${s}`]:{...a,[s]:r}})),[a,r])}};return n.scopeName=s,[function(a,n){const l=t.createContext(n);l.displayName=a+"Context";const o=r.length;r=[...r,n];const i=a=>{var r;const{scope:n,children:i,...d}=a,c=(null==(r=null==n?void 0:n[s])?void 0:r[o])||l,m=t.useMemo((()=>d),Object.values(d));return e.jsx(c.Provider,{value:m,children:i})};return i.displayName=a+"Provider",[i,function(e,r){var i;const d=(null==(i=null==r?void 0:r[s])?void 0:i[o])||l,c=t.useContext(d);if(c)return c;if(void 0!==n)return n;throw new Error(`\`${e}\` must be used within \`${a}\``)}]},ts(n,...a)]}(ps),[ys,vs]=fs(ps),js=t.forwardRef(((s,a)=>{const{__scopeAvatar:r,...n}=s,[l,o]=t.useState("idle");return e.jsx(ys,{scope:r,imageLoadingStatus:l,onImageLoadingStatusChange:o,children:e.jsx(as.span,{...n,ref:a})})}));js.displayName=ps;var ws="AvatarImage",ks=t.forwardRef(((s,a)=>{const{__scopeAvatar:r,src:n,onLoadingStatusChange:l=()=>{},...o}=s,i=vs(ws,r),d=function(e,{referrerPolicy:s,crossOrigin:a}){const r=gs.useSyncExternalStore(hs,(()=>!0),(()=>!1)),n=t.useRef(null),l=r?(n.current||(n.current=new window.Image),n.current):null,[o,i]=t.useState((()=>Cs(l,e)));return ss((()=>{i(Cs(l,e))}),[l,e]),ss((()=>{const e=e=>()=>{i(e)};if(!l)return;const t=e("loaded"),r=e("error");return l.addEventListener("load",t),l.addEventListener("error",r),s&&(l.referrerPolicy=s),"string"==typeof a&&(l.crossOrigin=a),()=>{l.removeEventListener("load",t),l.removeEventListener("error",r)}}),[l,a,s]),o}(n,o),c=function(e){const s=t.useRef(e);return t.useEffect((()=>{s.current=e})),t.useMemo((()=>(...e)=>{var t;return null==(t=s.current)?void 0:t.call(s,...e)}),[])}((e=>{l(e),i.onImageLoadingStatusChange(e)}));return ss((()=>{"idle"!==d&&c(d)}),[d,c]),"loaded"===d?e.jsx(as.img,{...o,ref:a,src:n}):null}));ks.displayName=ws;var Ns="AvatarFallback",_s=t.forwardRef(((s,a)=>{const{__scopeAvatar:r,delayMs:n,...l}=s,o=vs(Ns,r),[i,d]=t.useState(void 0===n);return t.useEffect((()=>{if(void 0!==n){const e=window.setTimeout((()=>d(!0)),n);return()=>window.clearTimeout(e)}}),[n]),i&&"loaded"!==o.imageLoadingStatus?e.jsx(as.span,{...l,ref:a}):null}));function Cs(e,t){return e?t?(e.src!==t&&(e.src=t),e.complete&&e.naturalWidth>0?"loaded":"loading"):"error":"idle"}_s.displayName=Ns;var Ss=js,As=ks,Ts=_s;const Us=t.forwardRef((({className:t,...s},a)=>e.jsx(Ss,{ref:a,className:kt("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",t),...s})));Us.displayName=Ss.displayName,t.forwardRef((({className:t,...s},a)=>e.jsx(As,{ref:a,className:kt("aspect-square h-full w-full",t),...s}))).displayName=As.displayName;const Es=t.forwardRef((({className:t,...s},a)=>e.jsx(Ts,{ref:a,className:kt("flex h-full w-full items-center justify-center rounded-full bg-gray-100 dark:bg-gray-800",t),...s})));async function Ds(e,t,a,r,n){try{const{data:l,error:o}=await s.from("users").select("name").eq("id",e).single();if(o)return;const{error:i}=await s.from("admin_logs").insert([{admin_id:e,admin_name:(null==l?void 0:l.name)||"Unknown",action:t,details:a,timestamp:(new Date).toISOString(),resource:r,resource_id:n}])}catch(l){}}function zs(){const[e,a]=t.useState([]),[r,n]=t.useState(!0),[l,o]=t.useState(null),i=t.useCallback((async()=>{n(!0),o(null);try{const e=await async function(){try{const{data:{user:e}}=await s.auth.getUser(),{data:t,error:a}=await s.from("users").select("id, email, name, role, phone, student_id, last_active, created_at, department_id, batch_id, section_id").order("created_at",{ascending:!1});if(a)throw new Error(a.message||"Failed to fetch admin users");const{data:r}=await s.from("departments").select("id, name"),{data:n}=await s.from("batches").select("id, name"),{data:l}=await s.from("sections").select("id, name"),o=new Map((null==r?void 0:r.map((e=>[e.id,e.name])))||[]),i=new Map((null==n?void 0:n.map((e=>[e.id,e.name])))||[]),d=new Map((null==l?void 0:l.map((e=>[e.id,e.name])))||[]);return(null==t?void 0:t.map((e=>({id:e.id,username:e.name||"",email:e.email||"",role:e.role||"user",department:o.get(e.department_id)||"",departmentId:e.department_id,batch:i.get(e.batch_id)||"",batchId:e.batch_id,section:d.get(e.section_id)||"",sectionId:e.section_id,permissions:[],status:"active",isActive:!0,lastLogin:e.last_active,createdAt:e.created_at,phone:e.phone||"",studentId:e.student_id||""}))))||[]}catch(l){throw new Error(l.message||"Failed to fetch admin users")}}();a(e)}catch(e){o(e.message||"Failed to fetch admin users")}finally{n(!1)}}),[]);return t.useEffect((()=>{i()}),[i]),{admins:e,loading:r,error:l,createAdmin:async e=>{n(!0),o(null);try{const t=Math.random().toString(36).slice(-8)+Math.random().toString(36).slice(-8).toUpperCase()+"!1",a=await async function(e,t){try{const{data:{user:a}}=await s.auth.getUser(),{data:r,error:n}=await s.auth.admin.createUser({email:e.email,password:t,email_confirm:!0,user_metadata:{name:e.username,role:e.role,department:e.department||null}});if(n||!r.user)throw new Error((null==n?void 0:n.message)||"Failed to create admin user");const{data:l,error:o}=await s.from("users").update({permissions:e.permissions,status:e.status,department:e.department}).eq("id",r.user.id).select();if(o)throw new Error(o.message||"Failed to create admin user");return a&&await Ds(a.id,"create_admin",`Created admin user: ${e.email}`),{id:r.user.id,username:e.username,email:e.email,role:e.role,department:e.department,permissions:e.permissions,status:e.status,isActive:"active"===e.status,createdAt:(new Date).toISOString(),phone:e.phone,studentId:e.studentId}}catch(l){throw new Error(l.message||"Failed to create admin user")}}(e,t);return await i(),a}catch(t){throw o(t.message||"Failed to create admin user"),t}finally{n(!1)}},updateAdmin:async(e,t)=>{n(!0),o(null);try{await async function(e,t){try{const{data:{user:a}}=await s.auth.getUser();if(t.email||t.role||t.username){const{error:a}=await s.auth.admin.updateUserById(e,{email:t.email,user_metadata:{name:t.username,role:t.role,department:t.department}});if(a)throw new Error(a.message||"Failed to update admin user")}const r={};t.permissions&&(r.permissions=t.permissions),t.status&&(r.status=t.status),t.department&&(r.department=t.department);const{data:n,error:l}=await s.from("users").update(r).eq("id",e).select();if(l)throw new Error(l.message||"Failed to update admin user");a&&await Ds(a.id,"update_admin",`Updated admin user: ${e}`);const o=null==n?void 0:n[0];return{id:o.id,username:o.name||"",email:o.email||"",role:o.role||"admin",department:o.department,permissions:o.permissions||[],status:o.status||"active",isActive:"active"===o.status,lastLogin:o.last_active,createdAt:o.created_at,updatedAt:o.updated_at,phone:o.phone||"",studentId:o.student_id||""}}catch(l){throw new Error(l.message||"Failed to update admin user")}}(e,t),await i()}catch(a){throw o(a.message||"Failed to update admin user"),a}finally{n(!1)}},deleteAdmin:async e=>{n(!0),o(null);try{await async function(e){try{const{data:{user:a}}=await s.auth.getUser(),{data:r,error:n}=await s.from("users").select("*").eq("id",e).single();if(n)throw new Error(n.message||"Failed to delete admin user");try{const{error:t}=await s.from("admin_archives").insert([{admin_id:e,admin_data:r,archived_by:(null==a?void 0:a.id)||"system",archived_at:(new Date).toISOString()}])}catch(t){}const{error:l}=await s.auth.admin.deleteUser(e);if(l)throw new Error(l.message||"Failed to delete admin user");a&&await Ds(a.id,"delete_admin",`Deleted admin user: ${e}`)}catch(l){throw new Error(l.message||"Failed to delete admin user")}}(e),await i()}catch(t){throw o(t.message||"Failed to delete admin user"),t}finally{n(!1)}},resetPassword:async(e,t)=>{n(!0),o(null);try{const a=await async function(e,t){try{const{data:{user:r}}=await s.auth.getUser(),{error:n}=await s.auth.admin.updateUserById(e,{password:t});if(n)throw new Error(n.message||"Failed to reset admin password");try{r&&await Ds(r.id,"reset_password",`Reset password for admin: ${e}`)}catch(a){}return!0}catch(l){throw new Error(l.message||"Failed to reset admin password")}}(e,t);return await i(),a}catch(a){return o(a.message||"Failed to reset admin password"),!1}finally{n(!1)}},promoteToAdmin:async e=>{n(!0),o(null);try{await async function(e){var t;try{const{data:{user:a}}=await s.auth.getUser();let r="super-admin"===(null==(t=null==a?void 0:a.user_metadata)?void 0:t.role);if(!r){const{data:e,error:t}=await s.from("users").select("role").eq("id",null==a?void 0:a.id).single();!t&&e&&(r="super-admin"===e.role)}if(!r)throw new Error("Unauthorized: Only super admins can promote users to admin");const{error:n}=await s.from("users").update({role:"admin"}).eq("id",e);if(n)throw new Error(n.message||"Failed to promote user to admin");a&&await Ds(a.id,"promote_to_admin",`Promoted user ${e} to admin role`)}catch(l){throw new Error(l.message||"Failed to promote user to admin")}}(e),await i()}catch(t){throw o(t.message||"Failed to promote user to admin"),t}finally{n(!1)}},promoteToSectionAdmin:async t=>{n(!0),o(null);try{const a=e.find((e=>e.id===t));if(!a)throw new Error("User not found");if(!a.sectionId)throw new Error("User does not have a section assigned. Please assign a section first.");await async function(e){try{const{data:t,error:a}=await s.rpc("promote_user_to_section_admin",{input_user_id:e});if(a)throw new Error(a.message||"Failed to promote user to section admin")}catch(l){throw new Error(l.message||"Failed to promote user to section admin")}}(t),await i()}catch(a){throw o(a.message||"Failed to promote user to section admin"),a}finally{n(!1)}},demoteUser:async t=>{n(!0),o(null);try{const a=e.find((e=>e.id===t));if(!a)throw new Error("User not found");if("super-admin"===a.role)throw new Error("Super admins cannot be demoted through this interface");await async function(e){try{const{data:t,error:a}=await s.rpc("demote_user_to_regular",{user_id:e});if(a)throw new Error(a.message||"Failed to demote user")}catch(l){throw new Error(l.message||"Failed to demote user")}}(t),await i()}catch(a){throw o(a.message||"Failed to demote user"),a}finally{n(!1)}},getSectionUsers:async e=>{n(!0),o(null);try{const t=await async function(e){try{const{data:{user:t}}=await s.auth.getUser();if(!e)throw new Error("No section ID provided");const{data:a,error:r}=await s.from("sections").select("id, name, batch_id").eq("id",e).single(),{data:n,error:l}=await s.from("users").select("id, email, name, role, phone, student_id, last_active, created_at, department_id, batch_id, section_id").eq("section_id",e).order("created_at",{ascending:!1});if(l)throw new Error(l.message||"Failed to fetch section users");const{data:o}=await s.from("departments").select("id, name"),{data:i}=await s.from("batches").select("id, name"),{data:d}=await s.from("sections").select("id, name"),c=new Map((null==o?void 0:o.map((e=>[e.id,e.name])))||[]),m=new Map((null==i?void 0:i.map((e=>[e.id,e.name])))||[]),u=new Map((null==d?void 0:d.map((e=>[e.id,e.name])))||[]),x=(null==n?void 0:n.map((e=>({id:e.id,username:e.name||"",email:e.email||"",role:e.role||"user",department:c.get(e.department_id)||"",departmentId:e.department_id,batch:m.get(e.batch_id)||"",batchId:e.batch_id,section:u.get(e.section_id)||"",sectionId:e.section_id,permissions:[],status:"active",isActive:!0,lastLogin:e.last_active,createdAt:e.created_at,phone:e.phone||"",studentId:e.student_id||""}))))||[];if(0===x.length){const{data:e,error:t}=await s.from("users").select("id, email, section_id").not("section_id","is",null).limit(5);t||e.length}return x}catch(l){throw new Error(l.message||"Failed to fetch section users")}}(e);return t}catch(t){throw o(t.message||"Failed to fetch section users"),t}finally{n(!1)}},getSections:async(e,t)=>{n(!0),o(null);try{const a=await async function(e,t){try{let a=s.from("sections").select("id, name, batch_id");e&&(a=a.eq("batch_id",e));const{data:r,error:n}=await a.order("name");if(n)throw new Error(n.message||"Failed to fetch sections");if(t&&!e){const{data:e,error:a}=await s.from("batches").select("id").eq("department_id",t);if(a)throw new Error(a.message||"Failed to fetch batches");const n=e.map((e=>e.id));return r.filter((e=>n.includes(e.batch_id)))}return r||[]}catch(l){throw new Error(l.message||"Failed to fetch sections")}}(e,t);return a}catch(a){throw o(a.message||"Failed to fetch sections"),a}finally{n(!1)}},refreshAdmins:i}}function Fs(){const[s,a]=t.useState(""),[r,n]=t.useState("all"),[l,o]=t.useState("all"),{admins:i,loading:d,error:c,refreshAdmins:m}=zs(),x=i.filter((e=>{var t,a,n;const o=(null==(t=e.username)?void 0:t.toLowerCase().includes(s.toLowerCase()))||(null==(a=e.email)?void 0:a.toLowerCase().includes(s.toLowerCase()))||(null==(n=e.department)?void 0:n.toLowerCase().includes(s.toLowerCase())),i="all"===r||e.role===r,d="all"===l||("active"===l?e.isActive:!e.isActive);return o&&i&&d})),g=t=>{switch(t){case"super-admin":return e.jsx($t,{variant:"destructive",children:"Super Admin"});case"admin":return e.jsx($t,{variant:"info",children:"Admin"});case"section_admin":return e.jsx($t,{variant:"warning",children:"Section Admin"});default:return e.jsx($t,{variant:"secondary",children:"User"})}};return d&&0===i.length?e.jsxs("div",{className:"space-y-4 animate-pulse",children:[e.jsx("div",{className:"h-32 bg-gray-200 dark:bg-gray-800 rounded-xl"}),e.jsx("div",{className:"h-96 bg-gray-200 dark:bg-gray-800 rounded-xl"})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(Ct,{children:[e.jsx(St,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(At,{className:"text-2xl",children:"Admin Management"}),e.jsx(Tt,{children:"Manage system administrators and their permissions"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(Ht,{variant:"outline",size:"sm",onClick:async()=>{try{await m(),M("Admins refreshed successfully")}catch(e){R("Failed to refresh admins")}},disabled:d,children:[e.jsx(P,{className:"w-4 h-4 mr-2 "+(d?"animate-spin":"")}),"Refresh"]}),e.jsxs(Ht,{size:"sm",children:[e.jsx(I,{className:"w-4 h-4 mr-2"}),"Add Admin"]})]})]})}),e.jsx(Ut,{children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(L,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(Yt,{placeholder:"Search by name, email, or department...",value:s,onChange:e=>a(e.target.value),className:"pl-10"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("select",{value:r,onChange:e=>n(e.target.value),className:"px-3 py-2 border border-gray-200 dark:border-gray-800 rounded-md bg-white dark:bg-gray-950 text-sm",children:[e.jsx("option",{value:"all",children:"All Roles"}),e.jsx("option",{value:"super-admin",children:"Super Admin"}),e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"section_admin",children:"Section Admin"}),e.jsx("option",{value:"user",children:"User"})]}),e.jsxs("select",{value:l,onChange:e=>o(e.target.value),className:"px-3 py-2 border border-gray-200 dark:border-gray-800 rounded-md bg-white dark:bg-gray-950 text-sm",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]}),e.jsxs(Ht,{variant:"outline",size:"sm",children:[e.jsx(O,{className:"w-4 h-4 mr-2"}),"Export"]})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(Ct,{children:e.jsxs(St,{className:"pb-2",children:[e.jsx(Tt,{children:"Total Admins"}),e.jsx(At,{className:"text-3xl",children:i.length})]})}),e.jsx(Ct,{children:e.jsxs(St,{className:"pb-2",children:[e.jsx(Tt,{children:"Active"}),e.jsx(At,{className:"text-3xl text-green-600",children:i.filter((e=>e.isActive)).length})]})}),e.jsx(Ct,{children:e.jsxs(St,{className:"pb-2",children:[e.jsx(Tt,{children:"Super Admins"}),e.jsx(At,{className:"text-3xl text-purple-600",children:i.filter((e=>"super-admin"===e.role)).length})]})}),e.jsx(Ct,{children:e.jsxs(St,{className:"pb-2",children:[e.jsx(Tt,{children:"Section Admins"}),e.jsx(At,{className:"text-3xl text-blue-600",children:i.filter((e=>"section_admin"===e.role)).length})]})})]}),e.jsxs(Ct,{children:[e.jsxs(St,{children:[e.jsxs(At,{children:["Administrators (",x.length,")"]}),e.jsx(Tt,{children:s||"all"!==r||"all"!==l?`Showing ${x.length} of ${i.length} admins`:"All system administrators"})]}),e.jsxs(Ut,{children:[c&&e.jsx("div",{className:"mb-4 p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg text-red-600 dark:text-red-400",children:c}),0===x.length?e.jsxs("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:[e.jsx(u,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{className:"text-lg font-medium",children:"No admins found"}),e.jsx("p",{className:"text-sm",children:"Try adjusting your search or filters"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Jt,{children:[e.jsx(Zt,{children:e.jsxs(Kt,{children:[e.jsx(Qt,{children:"Admin"}),e.jsx(Qt,{children:"Role"}),e.jsx(Qt,{children:"Department"}),e.jsx(Qt,{children:"Status"}),e.jsx(Qt,{children:"Joined"}),e.jsx(Qt,{className:"text-right",children:"Actions"})]})}),e.jsx(Xt,{children:x.map((t=>{var s,a,r;return e.jsxs(Kt,{children:[e.jsx(es,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Us,{className:"h-10 w-10",children:e.jsx(Es,{className:"bg-blue-100 dark:bg-blue-900 text-blue-600 dark:text-blue-400",children:(null==(s=t.username)?void 0:s.charAt(0).toUpperCase())||(null==(a=t.email)?void 0:a.charAt(0).toUpperCase())})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:t.username||"N/A"}),e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:t.email})]})]})}),e.jsx(es,{children:g(t.role||"user")}),e.jsx(es,{className:"text-gray-600 dark:text-gray-400",children:t.department||"N/A"}),e.jsx(es,{children:(r=t.isActive,r?e.jsx($t,{variant:"success",children:"Active"}):e.jsx($t,{variant:"secondary",children:"Inactive"}))}),e.jsx(es,{className:"text-gray-600 dark:text-gray-400",children:t.createdAt?new Date(t.createdAt).toLocaleDateString():"N/A"}),e.jsx(es,{className:"text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(Ht,{variant:"ghost",size:"sm",children:e.jsx(q,{className:"w-4 h-4"})}),e.jsx(Ht,{variant:"ghost",size:"sm",children:e.jsx(k,{className:"w-4 h-4"})}),e.jsx(Ht,{variant:"ghost",size:"sm",children:e.jsx(G,{className:"w-4 h-4"})})]})})]},t.id)}))})]})})]})]})]})}function $s({logs:s,loading:a}){const[r,n]=t.useState(""),[l,i]=t.useState([]),[d,c]=t.useState("all"),[m,u]=t.useState({from:"",to:""}),[x,g]=t.useState("desc");t.useEffect((()=>{let e=[...s];if(r){const t=r.toLowerCase();e=e.filter((e=>e.adminName.toLowerCase().includes(t)||e.action.toLowerCase().includes(t)||e.details.toLowerCase().includes(t)))}if("all"!==d&&(e=e.filter((e=>e.action===d))),m.from){const t=new Date(m.from);e=e.filter((e=>new Date(e.timestamp)>=t))}if(m.to){const t=new Date(m.to);t.setHours(23,59,59,999),e=e.filter((e=>new Date(e.timestamp)<=t))}e.sort(((e,t)=>{const s=new Date(e.timestamp),a=new Date(t.timestamp);return"desc"===x?+a-+s:+s-+a})),i(e)}),[s,r,d,m,x]);const h=e=>{const{name:t,value:s}=e.target;u((e=>({...e,[t]:s})))},p=e=>{switch(e){case"create_admin":return"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-300";case"update_admin":return"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-300";case"delete_admin":return"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-300";case"reset_password":return"bg-amber-100 text-amber-800 dark:bg-amber-900/20 dark:text-amber-300";case"login":return"bg-purple-100 text-purple-800 dark:bg-purple-900/20 dark:text-purple-300";default:return"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"}},f=e=>e.split("_").map((e=>e.charAt(0).toUpperCase()+e.slice(1))).join(" ");return e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-750 rounded-lg border border-gray-200 dark:border-gray-700 p-4 space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between gap-3",children:[e.jsxs("h2",{className:"text-lg font-bold text-gray-900 dark:text-white flex items-center",children:[e.jsx(N,{className:"h-5 w-5 text-indigo-600 dark:text-indigo-400 mr-2"}),"Admin Activity Logs"]}),e.jsxs("button",{onClick:()=>{if(0===l.length)return;const e=[["Admin","Action","Details","Timestamp","IP Address"].join(","),...l.map((e=>[`"${e.adminName}"`,`"${e.action}"`,`"${e.details.replace(/"/g,'""')}"`,`"${new Date(e.timestamp).toLocaleString()}"`,`"${e.ipAddress||""}"`].join(",")))].join("\n"),t=new Blob([e],{type:"text/csv;charset=utf-8;"}),s=URL.createObjectURL(t),a=document.createElement("a");a.setAttribute("href",s),a.setAttribute("download",`admin-logs-${(new Date).toISOString().split("T")[0]}.csv`),a.style.visibility="hidden",document.body.appendChild(a),a.click(),document.body.removeChild(a)},disabled:0===l.length,className:"inline-flex items-center px-3 py-1.5 text-sm font-medium text-indigo-700 bg-indigo-100 border border-transparent rounded-lg hover:bg-indigo-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 dark:bg-indigo-900/20 dark:text-indigo-300 dark:hover:bg-indigo-900/30 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(O,{className:"h-4 w-4 mr-1.5"}),"Export CSV"]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:"Search logs...",value:r,onChange:e=>n(e.target.value),className:"w-full px-3 py-2 pl-9 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:text-white"}),e.jsx(L,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("select",{value:d,onChange:e=>c(e.target.value),className:"w-full px-3 py-2 pl-9 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:text-white appearance-none",children:["all","create_admin","update_admin","delete_admin","reset_password","login","logout"].map((t=>e.jsx("option",{value:t,children:"all"===t?"All Actions":f(t)},t)))}),e.jsx(W,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"date",name:"from",value:m.from,onChange:h,className:"w-full px-3 py-2 pl-9 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:text-white",placeholder:"From date"}),e.jsx(N,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"date",name:"to",value:m.to,onChange:h,className:"w-full px-3 py-2 pl-9 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-700 dark:text-white",placeholder:"To date"}),e.jsx(N,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2 pt-2",children:[e.jsx("div",{className:"flex flex-wrap items-center gap-2",children:(r||"all"!==d||m.from||m.to)&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Active filters:"}),r&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300",children:["Search: ",r,e.jsx(o,{size:14,className:"ml-1 cursor-pointer",onClick:()=>n("")})]}),"all"!==d&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300",children:["Action: ",f(d),e.jsx(o,{size:14,className:"ml-1 cursor-pointer",onClick:()=>c("all")})]}),m.from&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300",children:["From: ",m.from,e.jsx(o,{size:14,className:"ml-1 cursor-pointer",onClick:()=>u((e=>({...e,from:""})))})]}),m.to&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300",children:["To: ",m.to,e.jsx(o,{size:14,className:"ml-1 cursor-pointer",onClick:()=>u((e=>({...e,to:""})))})]}),e.jsx("button",{onClick:()=>{n(""),c("all"),u({from:"",to:""})},className:"text-sm text-indigo-600 dark:text-indigo-400 hover:text-indigo-800 dark:hover:text-indigo-300",children:"Clear all"})]})}),e.jsxs("button",{onClick:()=>g((e=>"desc"===e?"asc":"desc")),className:"inline-flex items-center px-2 py-1 text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition-colors",children:[e.jsx(B,{className:"h-4 w-4 mr-1"}),"desc"===x?e.jsxs(e.Fragment,{children:["Newest first ",e.jsx(_,{className:"h-3 w-3 ml-1"})]}):e.jsxs(e.Fragment,{children:["Oldest first ",e.jsx(C,{className:"h-3 w-3 ml-1"})]})]})]})]}),e.jsx("div",{className:"bg-white dark:bg-gray-750 rounded-lg border border-gray-200 dark:border-gray-700 overflow-hidden",children:a?e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"animate-pulse space-y-4",children:[e.jsx("div",{className:"h-8 bg-gray-200 dark:bg-gray-700 rounded"}),[...Array(5)].map(((t,s)=>e.jsx("div",{className:"h-20 bg-gray-200 dark:bg-gray-700 rounded"},s)))]})}):0===l.length?e.jsx("div",{className:"p-8 text-center text-gray-500 dark:text-gray-400",children:0===s.length?"No activity logs found in the system.":"No logs match your current filters."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Admin"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Action"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Details"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Timestamp"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"IP Address"})]})}),e.jsx("tbody",{className:"bg-white dark:bg-gray-750 divide-y divide-gray-200 dark:divide-gray-700",children:l.map((t=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/40 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-8 w-8 rounded-full bg-indigo-100 dark:bg-indigo-900/30 flex items-center justify-center text-indigo-600 dark:text-indigo-400",children:e.jsx(V,{className:"h-4 w-4"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:t.adminName}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:t.adminId.substring(0,8)})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2.5 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${p(t.action)}`,children:f(t.action)})}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"text-sm text-gray-900 dark:text-white max-w-xs truncate",children:t.details}),t.resource&&e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:["Resource: ",t.resource," ",t.resourceId&&`#${t.resourceId.substring(0,8)}`]})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:new Date(t.timestamp).toLocaleString()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:t.ipAddress||"-"})]},t.id)))})]})})}),!a&&s.length>0&&e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400 text-right",children:["Showing ",l.length," of ",s.length," logs"]})]})}function Ms({admins:s,onResetPassword:a}){const[r,n]=t.useState(""),[l,o]=t.useState(""),[i,d]=t.useState(!1),[c,m]=t.useState(!1),[x,g]=t.useState(!1);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-1",children:"Security Settings"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Manage security settings and reset passwords"})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Password Reset"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"admin-select",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Select User"}),e.jsxs("select",{id:"admin-select",value:r,onChange:e=>n(e.target.value),className:"w-full rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Select a user"}),s.filter((e=>"super-admin"!==e.role)).map((t=>e.jsxs("option",{value:t.id,children:[t.username," (",t.email,") - ",t.role]},t.id)))]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"New Password"}),e.jsx("div",{className:"relative",children:e.jsxs("div",{className:"flex",children:[e.jsx("input",{id:"password",type:i?"text":"password",value:l,onChange:e=>o(e.target.value),className:"flex-1 rounded-l-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Generate a secure password",readOnly:!0}),e.jsx("button",{type:"button",onClick:()=>d(!i),className:"bg-gray-100 dark:bg-gray-600 border-y border-r border-gray-300 dark:border-gray-600 rounded-r-lg px-3",children:i?e.jsx(H,{className:"h-5 w-5 text-gray-500 dark:text-gray-400"}):e.jsx(Y,{className:"h-5 w-5 text-gray-500 dark:text-gray-400"})})]})})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{type:"button",onClick:()=>{let e="";e+="ABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(26*Math.random())],e+="abcdefghijklmnopqrstuvwxyz"[Math.floor(26*Math.random())],e+="0123456789"[Math.floor(10*Math.random())],e+="!@#$%^&*()_+"[Math.floor(12*Math.random())];for(let t=4;t<12;t++)e+="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*()_+"[Math.floor(74*Math.random())];e=e.split("").sort((()=>Math.random()-.5)).join(""),o(e)},className:"flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors",children:[e.jsx(k,{className:"h-4 w-4"}),e.jsx("span",{children:"Generate Password"})]}),l&&e.jsx("button",{type:"button",onClick:()=>{navigator.clipboard.writeText(l).then((()=>{g(!0),setTimeout((()=>g(!1)),2e3)})).catch((e=>{R("Failed to copy password to clipboard")}))},className:"flex items-center gap-2 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600 px-4 py-2 rounded-lg transition-colors",children:x?e.jsxs(e.Fragment,{children:[e.jsx(J,{className:"h-4 w-4 text-green-500"}),e.jsx("span",{children:"Copied!"})]}):e.jsxs(e.Fragment,{children:[e.jsx(X,{className:"h-4 w-4"}),e.jsx("span",{children:"Copy"})]})})]}),e.jsx("div",{className:"mt-6",children:e.jsxs("button",{type:"button",onClick:async()=>{if(r)if(!l||l.length<8)R("Please generate a secure password");else{m(!0);try{await a(r,l)?(M("Password reset successfully"),n(""),o("")):R("Failed to reset password")}catch(e){R(e.message||"Failed to reset password")}finally{m(!1)}}else R("Please select an admin")},disabled:!r||!l||c,className:"flex items-center gap-2 bg-red-600 hover:bg-red-700 text-white px-6 py-2 rounded-lg transition-colors disabled:bg-red-300 dark:disabled:bg-red-800/50 disabled:cursor-not-allowed",children:[c?e.jsx(P,{className:"h-4 w-4 animate-spin"}):e.jsx(u,{className:"h-4 w-4"}),e.jsx("span",{children:"Reset Password"})]})}),r&&l&&e.jsxs("div",{className:"mt-4 p-3 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800/50 rounded-lg flex items-start gap-2 text-sm",children:[e.jsx(K,{className:"h-5 w-5 text-yellow-500 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-yellow-800 dark:text-yellow-400",children:"Important:"}),e.jsx("p",{className:"text-yellow-700 dark:text-yellow-300",children:"You are about to reset the password for this user. Make sure to share the new password with them securely. They should change their password after logging in."})]})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Security Policies"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between pb-4 border-b border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"Two-factor Authentication"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Require 2FA for all admin accounts"})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"sr-only peer",defaultChecked:!0}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"})]})]}),e.jsxs("div",{className:"flex items-center justify-between py-4 border-b border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"Password Expiry"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Force password change every 90 days"})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"sr-only peer",defaultChecked:!0}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"})]})]}),e.jsxs("div",{className:"flex items-center justify-between py-4 border-b border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"Session Timeout"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Auto logout after 30 minutes of inactivity"})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"})]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"Failed Login Lockout"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Lock account after 5 failed login attempts"})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"sr-only peer",defaultChecked:!0}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full rtl:peer-checked:after:-translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"})]})]})]}),e.jsx("div",{className:"mt-6",children:e.jsxs("button",{type:"button",className:"flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors",children:[e.jsx(u,{className:"h-4 w-4"}),e.jsx("span",{children:"Save Security Settings"})]})})]})]})}Es.displayName=Ts.displayName;var Rs=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce(((s,a)=>{const r=Ot(`Primitive.${a}`),n=t.forwardRef(((t,s)=>{const{asChild:n,...l}=t,o=n?r:a;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),e.jsx(o,{...l,ref:s})}));return n.displayName=`Primitive.${a}`,{...s,[a]:n}}),{}),Ps=t.forwardRef(((t,s)=>e.jsx(Rs.label,{...t,ref:s,onMouseDown:e=>{var s;e.target.closest("button, input, select, textarea")||(null==(s=t.onMouseDown)||s.call(t,e),!e.defaultPrevented&&e.detail>1&&e.preventDefault())}})));Ps.displayName="Label";var Is=Ps;const Ls=zt("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Os=t.forwardRef((({className:t,...s},a)=>e.jsx(Is,{ref:a,className:kt(Ls(),t),...s})));Os.displayName=Is.displayName;const qs=({open:t,onOpenChange:s,children:a})=>t?e.jsxs("div",{className:"fixed inset-0 z-50",children:[e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm",onClick:()=>s(!1)}),e.jsx("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:a})]}):null,Gs=t.forwardRef((({className:t,children:s,onClose:a,...r},n)=>e.jsxs("div",{ref:n,className:kt("relative bg-white dark:bg-gray-950 rounded-lg shadow-xl border border-gray-200 dark:border-gray-800 w-full max-w-lg max-h-[90vh] overflow-y-auto",t),onClick:e=>e.stopPropagation(),...r,children:[a&&e.jsxs("button",{onClick:a,className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-white transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-gray-950 focus:ring-offset-2 disabled:pointer-events-none dark:ring-offset-gray-950 dark:focus:ring-gray-300",children:[e.jsx(o,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]}),s]})));Gs.displayName="DialogContent";const Ws=({className:t,...s})=>e.jsx("div",{className:kt("flex flex-col space-y-1.5 p-6 pb-4",t),...s});Ws.displayName="DialogHeader";const Bs=({className:t,...s})=>e.jsx("div",{className:kt("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2 p-6 pt-4",t),...s});Bs.displayName="DialogFooter";const Vs=t.forwardRef((({className:t,...s},a)=>e.jsx("h2",{ref:a,className:kt("text-lg font-semibold leading-none tracking-tight text-gray-900 dark:text-white",t),...s})));Vs.displayName="DialogTitle";const Hs=t.forwardRef((({className:t,...s},a)=>e.jsx("p",{ref:a,className:kt("text-sm text-gray-500 dark:text-gray-400",t),...s})));Hs.displayName="DialogDescription";const Ys=({className:t,...s})=>e.jsx("div",{className:kt("px-6 py-2",t),...s});async function Js(){try{const{data:e,error:t}=await s.from("users").select("*").order("created_at",{ascending:!1});if(t)throw new Error(t.message);return e||[]}catch(e){throw e}}async function Zs(){try{const{data:e,error:t}=await s.from("departments").select("*").order("name");if(t)throw new Error(t.message);return e||[]}catch(e){throw e}}async function Xs(e){try{let e=s.from("batches").select("*").order("name");const{data:t,error:a}=await e;if(a)throw new Error(a.message);return t||[]}catch(t){throw t}}async function Ks(e){try{let e=s.from("sections").select("*").order("name");const{data:t,error:a}=await e;if(a)throw new Error(a.message);return t||[]}catch(t){throw t}}Ys.displayName="DialogBody";const Qs={"super-admin":{label:"Super Admin",color:"text-red-600 dark:text-red-400",icon:A,badgeVariant:"destructive"},admin:{label:"Admin",color:"text-blue-600 dark:text-blue-400",icon:Z,badgeVariant:"info"},section_admin:{label:"Section Admin",color:"text-orange-600 dark:text-orange-400",icon:u,badgeVariant:"warning"},user:{label:"User",color:"text-gray-600 dark:text-gray-400",icon:V,badgeVariant:"secondary"}};function ea({open:s,onClose:a,user:r,departments:n,batches:l,sections:o,onSubmit:i,mode:d}){const[c,m]=t.useState({email:"",password:"",name:"",role:"user",phone:"",student_id:"",department_id:"",batch_id:"",section_id:""}),[u,x]=t.useState(!1),[g,h]=t.useState([]),[p,f]=t.useState([]);return t.useEffect((()=>{m("edit"===d&&r?{email:r.email||"",password:"",name:r.name||"",role:r.role,phone:r.phone||"",student_id:r.student_id||"",department_id:r.department_id||"",batch_id:r.batch_id||"",section_id:r.section_id||""}:{email:"",password:"",name:"",role:"user",phone:"",student_id:"",department_id:"",batch_id:"",section_id:""})}),[r,d,s]),t.useEffect((()=>{c.department_id?h(l.filter((e=>e.department_id===c.department_id))):h(l)}),[c.department_id,l]),t.useEffect((()=>{c.batch_id?f(o.filter((e=>e.batch_id===c.batch_id))):f(o)}),[c.batch_id,o]),e.jsx(qs,{open:s,onOpenChange:a,children:e.jsxs(Gs,{onClose:a,className:"max-w-2xl",children:[e.jsxs(Ws,{children:[e.jsx(Vs,{children:"create"===d?"Create New User":"Edit User"}),e.jsx(Hs,{children:"create"===d?"Add a new user to the system with specified role and details.":`Update user information for ${(null==r?void 0:r.name)||(null==r?void 0:r.email)}`})]}),e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),"create"!==d||c.email&&c.password)if(c.name){x(!0);try{const e="create"===d?c:{name:c.name,role:c.role,phone:c.phone||void 0,student_id:c.student_id||void 0,department_id:c.department_id||void 0,batch_id:c.batch_id||void 0,section_id:c.section_id||void 0};await i(e),a()}catch(t){R(t.message||"Failed to save user")}finally{x(!1)}}else R("Name is required");else R("Email and password are required")},children:[e.jsxs(Ys,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:["create"===d&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Os,{htmlFor:"email",children:"Email *"}),e.jsx(Yt,{id:"email",type:"email",placeholder:"user@example.com",value:c.email,onChange:e=>m((t=>({...t,email:e.target.value}))),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Os,{htmlFor:"password",children:"Password *"}),e.jsx(Yt,{id:"password",type:"password",placeholder:"",value:c.password,onChange:e=>m((t=>({...t,password:e.target.value}))),required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Os,{htmlFor:"name",children:"Full Name *"}),e.jsx(Yt,{id:"name",placeholder:"John Doe",value:c.name,onChange:e=>m((t=>({...t,name:e.target.value}))),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Os,{htmlFor:"role",children:"Role *"}),e.jsxs("select",{id:"role",value:c.role,onChange:e=>m((t=>({...t,role:e.target.value}))),className:"w-full h-9 px-3 border border-gray-200 dark:border-gray-800 rounded-md bg-white dark:bg-gray-950 text-sm",children:[e.jsx("option",{value:"user",children:"User"}),e.jsx("option",{value:"section_admin",children:"Section Admin"}),e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"super-admin",children:"Super Admin"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Os,{htmlFor:"phone",children:"Phone"}),e.jsx(Yt,{id:"phone",placeholder:"+1234567890",value:c.phone,onChange:e=>m((t=>({...t,phone:e.target.value})))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Os,{htmlFor:"student_id",children:"Student ID"}),e.jsx(Yt,{id:"student_id",placeholder:"STU-123456",value:c.student_id,onChange:e=>m((t=>({...t,student_id:e.target.value})))})]})]}),e.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-800 pt-4 mt-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 dark:text-white mb-4",children:"Organization"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Os,{htmlFor:"department",children:"Department"}),e.jsxs("select",{id:"department",value:c.department_id,onChange:e=>m((t=>({...t,department_id:e.target.value,batch_id:"",section_id:""}))),className:"w-full h-9 px-3 border border-gray-200 dark:border-gray-800 rounded-md bg-white dark:bg-gray-950 text-sm",children:[e.jsx("option",{value:"",children:"Select Department"}),n.map((t=>e.jsx("option",{value:t.id,children:t.name},t.id)))]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Os,{htmlFor:"batch",children:"Batch"}),e.jsxs("select",{id:"batch",value:c.batch_id,onChange:e=>m((t=>({...t,batch_id:e.target.value,section_id:""}))),className:"w-full h-9 px-3 border border-gray-200 dark:border-gray-800 rounded-md bg-white dark:bg-gray-950 text-sm",disabled:!c.department_id,children:[e.jsx("option",{value:"",children:"Select Batch"}),g.map((t=>e.jsx("option",{value:t.id,children:t.name},t.id)))]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Os,{htmlFor:"section",children:"Section"}),e.jsxs("select",{id:"section",value:c.section_id,onChange:e=>m((t=>({...t,section_id:e.target.value}))),className:"w-full h-9 px-3 border border-gray-200 dark:border-gray-800 rounded-md bg-white dark:bg-gray-950 text-sm",disabled:!c.batch_id,children:[e.jsx("option",{value:"",children:"Select Section"}),p.map((t=>e.jsx("option",{value:t.id,children:t.name},t.id)))]})]})]})]})]}),e.jsxs(Bs,{children:[e.jsx(Ht,{type:"button",variant:"outline",onClick:a,disabled:u,children:"Cancel"}),e.jsx(Ht,{type:"submit",disabled:u,children:u?"Saving...":"create"===d?"Create User":"Update User"})]})]})]})})}function ta({open:s,onClose:a,user:r,sections:n,onRoleChange:l}){var o,i;const[d,c]=t.useState("user"),[m,u]=t.useState(""),[x,g]=t.useState(!1);return t.useEffect((()=>{r&&(c(r.role),u(r.section_id||""))}),[r,s]),r?e.jsx(qs,{open:s,onOpenChange:a,children:e.jsxs(Gs,{onClose:a,children:[e.jsxs(Ws,{children:[e.jsx(Vs,{children:"Change User Role"}),e.jsxs(Hs,{children:["Change the role for ",r.name||r.email]})]}),e.jsxs(Ys,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-900 rounded-lg",children:[e.jsx(Us,{className:"h-12 w-12",children:e.jsx(Es,{className:"bg-blue-100 dark:bg-blue-900 text-blue-600 dark:text-blue-400 text-lg",children:(null==(o=r.name)?void 0:o.charAt(0).toUpperCase())||(null==(i=r.email)?void 0:i.charAt(0).toUpperCase())})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:r.name}),e.jsx("div",{className:"text-sm text-gray-500",children:r.email}),e.jsxs($t,{variant:Qs[r.role].badgeVariant,className:"mt-1",children:["Current: ",Qs[r.role].label]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Os,{children:"New Role"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:Object.entries(Qs).map((([t,s])=>{const a=s.icon;return e.jsxs("button",{type:"button",onClick:()=>c(t),className:"flex items-center gap-2 p-3 border rounded-lg transition-all "+(d===t?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-800 hover:border-gray-300"),children:[e.jsx(a,{className:`w-4 h-4 ${s.color}`}),e.jsx("span",{className:"text-sm font-medium",children:s.label})]},t)}))})]}),"section_admin"===d&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(Os,{children:"Assign to Section *"}),e.jsxs("select",{value:m,onChange:e=>u(e.target.value),className:"w-full h-9 px-3 border border-gray-200 dark:border-gray-800 rounded-md bg-white dark:bg-gray-950 text-sm",children:[e.jsx("option",{value:"",children:"Select Section"}),n.map((t=>e.jsx("option",{value:t.id,children:t.name},t.id)))]})]})]}),e.jsxs(Bs,{children:[e.jsx(Ht,{variant:"outline",onClick:a,disabled:x,children:"Cancel"}),e.jsx(Ht,{onClick:async()=>{if(r)if("section_admin"!==d||m){g(!0);try{await l(r.id,d,m||void 0),M(`Role changed to ${Qs[d].label}`),a()}catch(e){R(e.message||"Failed to change role")}finally{g(!1)}}else R("Please select a section for section admin")},disabled:x||d===r.role,children:x?"Updating...":"Change Role"})]})]})}):null}function sa({open:s,onClose:a,user:r,onDelete:n}){var l,o;const[i,d]=t.useState(!1),[c,m]=t.useState("");if(t.useEffect((()=>{s||m("")}),[s]),!r)return null;const u="delete"===c.toLowerCase();return e.jsx(qs,{open:s,onOpenChange:a,children:e.jsxs(Gs,{onClose:a,children:[e.jsxs(Ws,{children:[e.jsx(Vs,{className:"text-red-600",children:"Delete User"}),e.jsx(Hs,{children:"This action cannot be undone. This will permanently delete the user account."})]}),e.jsxs(Ys,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-red-50 dark:bg-red-900/20 rounded-lg border border-red-200 dark:border-red-800",children:[e.jsx(Us,{className:"h-12 w-12",children:e.jsx(Es,{className:"bg-red-100 dark:bg-red-900 text-red-600 dark:text-red-400 text-lg",children:(null==(l=r.name)?void 0:l.charAt(0).toUpperCase())||(null==(o=r.email)?void 0:o.charAt(0).toUpperCase())})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:r.name}),e.jsx("div",{className:"text-sm text-gray-500",children:r.email}),e.jsx($t,{variant:Qs[r.role].badgeVariant,className:"mt-1",children:Qs[r.role].label})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Os,{children:'Type "delete" to confirm'}),e.jsx(Yt,{value:c,onChange:e=>m(e.target.value),placeholder:"delete",className:"border-red-200 dark:border-red-800 focus:border-red-500"})]})]}),e.jsxs(Bs,{children:[e.jsx(Ht,{variant:"outline",onClick:a,disabled:i,children:"Cancel"}),e.jsx(Ht,{variant:"destructive",onClick:async()=>{if(r){d(!0);try{await n(r.id),M("User deleted successfully"),a()}catch(e){R(e.message||"Failed to delete user")}finally{d(!1)}}},disabled:i||!u,children:i?"Deleting...":"Delete User"})]})]})})}function aa({onEdit:s,onChangeRole:a,onDelete:r}){const[n,l]=t.useState(!1);return e.jsxs("div",{className:"relative",children:[e.jsx(Ht,{variant:"ghost",size:"icon",onClick:()=>l(!n),children:e.jsx(G,{className:"w-4 h-4"})}),n&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>l(!1)}),e.jsxs("div",{className:"absolute right-0 mt-1 w-48 py-1 bg-white dark:bg-gray-950 border border-gray-200 dark:border-gray-800 rounded-lg shadow-lg z-50",children:[e.jsxs("button",{onClick:()=>{s(),l(!1)},className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-100 dark:hover:bg-gray-800 flex items-center gap-2",children:[e.jsx(ae,{className:"w-4 h-4"}),"Edit User"]}),e.jsxs("button",{onClick:()=>{a(),l(!1)},className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-100 dark:hover:bg-gray-800 flex items-center gap-2",children:[e.jsx(u,{className:"w-4 h-4"}),"Change Role"]}),e.jsx("div",{className:"border-t border-gray-200 dark:border-gray-800 my-1"}),e.jsxs("button",{onClick:()=>{r(),l(!1)},className:"w-full px-4 py-2 text-left text-sm text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 flex items-center gap-2",children:[e.jsx(re,{className:"w-4 h-4"}),"Delete User"]})]})]})]})}function ra({title:t,value:s,icon:a,color:r,bgColor:n}){return e.jsx(Ct,{children:e.jsx(Ut,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:t}),e.jsx("p",{className:`text-2xl font-bold ${r}`,children:s})]}),e.jsx("div",{className:`p-3 rounded-full ${n}`,children:e.jsx(a,{className:`w-5 h-5 ${r}`})})]})})})}function na(){const[a,r]=t.useState([]),[n,l]=t.useState([]),[o,i]=t.useState([]),[d,c]=t.useState([]),[m,g]=t.useState(!0),[h,p]=t.useState(""),[f,b]=t.useState("all"),[y,v]=t.useState(!1),[j,w]=t.useState(!1),[k,N]=t.useState(!1),[_,C]=t.useState(null),[T,U]=t.useState("create"),E=t.useCallback((async()=>{try{g(!0);const[e,t,s,a]=await Promise.all([Js(),Zs(),Xs(),Ks()]);r(e),l(t),i(s),c(a)}catch(e){R(e.message||"Failed to load data")}finally{g(!1)}}),[]);t.useEffect((()=>{E()}),[E]);const D=t.useMemo((()=>function(e){const t=e.length,s=e.filter((e=>"super-admin"===e.role)).length,a=e.filter((e=>"admin"===e.role)).length,r=e.filter((e=>"section_admin"===e.role)).length,n=e.filter((e=>"user"===e.role)).length,l=new Date;return l.setDate(l.getDate()-7),{totalUsers:t,superAdmins:s,admins:a,sectionAdmins:r,regularUsers:n,activeUsers:e.filter((e=>e.last_active&&new Date(e.last_active)>l)).length,newUsersThisWeek:e.filter((e=>e.created_at&&new Date(e.created_at)>l)).length}}(a)),[a]),z=t.useMemo((()=>{let e=function(e,t){if(!t)return e;const s=t.toLowerCase();return e.filter((e=>{var t,a,r,n;return(null==(t=e.name)?void 0:t.toLowerCase().includes(s))||(null==(a=e.email)?void 0:a.toLowerCase().includes(s))||(null==(r=e.student_id)?void 0:r.toLowerCase().includes(s))||(null==(n=e.phone)?void 0:n.toLowerCase().includes(s))}))}(a,h);return e=function(e,t){return"all"===t?e:e.filter((e=>e.role===t))}(e,f),e}),[a,h,f]),F=e=>{C(e),U("edit"),v(!0)},$=e=>{C(e),w(!0)},I=e=>{C(e),N(!0)},O=e=>{var t;return e&&(null==(t=n.find((t=>t.id===e)))?void 0:t.name)||""},q=e=>{var t;return e&&(null==(t=d.find((t=>t.id===e)))?void 0:t.name)||""};return m?e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsxs("div",{className:"text-center",children:[e.jsx(P,{className:"w-8 h-8 animate-spin text-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Loading users..."})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"User Management"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Manage all users, roles and permissions"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(Ht,{variant:"outline",onClick:E,children:[e.jsx(P,{className:"w-4 h-4 mr-2"}),"Refresh"]}),e.jsxs(Ht,{onClick:()=>{C(null),U("create"),v(!0)},children:[e.jsx(S,{className:"w-4 h-4 mr-2"}),"Add User"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4",children:[e.jsx(ra,{title:"Total Users",value:D.totalUsers,icon:x,color:"text-gray-700 dark:text-gray-300",bgColor:"bg-gray-100 dark:bg-gray-800"}),e.jsx(ra,{title:"Super Admins",value:D.superAdmins,icon:A,color:"text-red-600 dark:text-red-400",bgColor:"bg-red-100 dark:bg-red-900/30"}),e.jsx(ra,{title:"Admins",value:D.admins,icon:Z,color:"text-blue-600 dark:text-blue-400",bgColor:"bg-blue-100 dark:bg-blue-900/30"}),e.jsx(ra,{title:"Section Admins",value:D.sectionAdmins,icon:u,color:"text-orange-600 dark:text-orange-400",bgColor:"bg-orange-100 dark:bg-orange-900/30"}),e.jsx(ra,{title:"Regular Users",value:D.regularUsers,icon:V,color:"text-green-600 dark:text-green-400",bgColor:"bg-green-100 dark:bg-green-900/30"}),e.jsx(ra,{title:"Active (7d)",value:D.activeUsers,icon:Q,color:"text-purple-600 dark:text-purple-400",bgColor:"bg-purple-100 dark:bg-purple-900/30"})]}),e.jsx(Ct,{children:e.jsx(Ut,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(L,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(Yt,{placeholder:"Search by name, email, student ID or phone...",value:h,onChange:e=>p(e.target.value),className:"pl-10"})]}),e.jsxs("select",{value:f,onChange:e=>b(e.target.value),className:"h-9 px-3 border border-gray-200 dark:border-gray-800 rounded-md bg-white dark:bg-gray-950 text-sm min-w-[150px]",children:[e.jsx("option",{value:"all",children:"All Roles"}),e.jsx("option",{value:"super-admin",children:"Super Admins"}),e.jsx("option",{value:"admin",children:"Admins"}),e.jsx("option",{value:"section_admin",children:"Section Admins"}),e.jsx("option",{value:"user",children:"Users"})]})]})})}),e.jsxs(Ct,{children:[e.jsx(St,{children:e.jsx(At,{className:"flex items-center justify-between",children:e.jsxs("span",{children:["Users (",z.length,")"]})})}),e.jsx(Ut,{children:0===z.length?e.jsxs("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:[e.jsx(ee,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{className:"text-lg font-medium",children:"No users found"}),e.jsx("p",{className:"text-sm",children:"Try adjusting your search or filters"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Jt,{children:[e.jsx(Zt,{children:e.jsxs(Kt,{children:[e.jsx(Qt,{children:"User"}),e.jsx(Qt,{children:"Role"}),e.jsx(Qt,{className:"hidden lg:table-cell",children:"Department"}),e.jsx(Qt,{className:"hidden md:table-cell",children:"Section"}),e.jsx(Qt,{className:"hidden lg:table-cell",children:"Joined"}),e.jsx(Qt,{className:"text-right",children:"Actions"})]})}),e.jsx(Xt,{children:z.map((t=>{var s,a,r,n,l,o;const i=(null==(s=Qs[t.role])?void 0:s.icon)||V;return e.jsxs(Kt,{children:[e.jsx(es,{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Us,{className:"h-10 w-10",children:e.jsx(Es,{className:"bg-blue-100 dark:bg-blue-900 text-blue-600 dark:text-blue-400",children:(null==(a=t.name)?void 0:a.charAt(0).toUpperCase())||(null==(r=t.email)?void 0:r.charAt(0).toUpperCase())})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:t.name||""}),e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400 flex items-center gap-1",children:[e.jsx(te,{className:"w-3 h-3"}),t.email]}),t.phone&&e.jsxs("div",{className:"text-xs text-gray-400 flex items-center gap-1",children:[e.jsx(se,{className:"w-3 h-3"}),t.phone]})]})]})}),e.jsx(es,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(i,{className:`w-4 h-4 ${(null==(n=Qs[t.role])?void 0:n.color)||""}`}),e.jsx($t,{variant:(null==(l=Qs[t.role])?void 0:l.badgeVariant)||"secondary",children:(null==(o=Qs[t.role])?void 0:o.label)||t.role})]})}),e.jsx(es,{className:"hidden lg:table-cell text-gray-600 dark:text-gray-400",children:O(t.department_id)}),e.jsx(es,{className:"hidden md:table-cell text-gray-600 dark:text-gray-400",children:q(t.section_id)}),e.jsx(es,{className:"hidden lg:table-cell text-gray-600 dark:text-gray-400",children:t.created_at?new Date(t.created_at).toLocaleDateString():""}),e.jsx(es,{className:"text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-1",children:[e.jsxs(Ht,{variant:"ghost",size:"sm",onClick:()=>$(t),className:"hidden sm:inline-flex",children:[e.jsx(u,{className:"w-4 h-4 mr-1"}),"Role"]}),e.jsx(Ht,{variant:"ghost",size:"sm",onClick:()=>F(t),className:"hidden sm:inline-flex",children:e.jsx(ae,{className:"w-4 h-4"})}),e.jsx(Ht,{variant:"ghost",size:"sm",onClick:()=>I(t),className:"hidden sm:inline-flex text-red-600 hover:text-red-700 hover:bg-red-50 dark:hover:bg-red-900/20",children:e.jsx(re,{className:"w-4 h-4"})}),e.jsx("div",{className:"sm:hidden",children:e.jsx(aa,{user:t,onEdit:()=>F(t),onChangeRole:()=>$(t),onDelete:()=>I(t)})})]})})]},t.id)}))})]})})})]}),e.jsx(ea,{open:y,onClose:()=>v(!1),user:_,departments:n,batches:o,sections:d,onSubmit:"create"===T?async e=>{await async function(e){try{const{data:t}=await s.auth.getUser();if(!t.user)throw new Error("You must be logged in to create users");const{data:a,error:r}=await s.auth.signUp({email:e.email,password:e.password,options:{data:{name:e.name,role:e.role}}});if(r)throw new Error(r.message);if(!a.user)throw new Error("Failed to create user account");const{data:n,error:l}=await s.from("users").upsert({id:a.user.id,email:e.email,name:e.name,role:e.role,phone:e.phone||null,student_id:e.student_id||null,department_id:e.department_id||null,batch_id:e.batch_id||null,section_id:e.section_id||null}).select().single();if(l)throw new Error(l.message);return await s.from("activities").insert({type:"user_created",title:`New user created: ${e.name}`,user_id:t.user.id,metadata:{target_user_id:a.user.id,email:e.email,role:e.role}}),n}catch(t){throw t}}(e),M("User created successfully"),await E()}:async e=>{_&&(await async function(e,t){try{const{data:a}=await s.auth.getUser();if(!a.user)throw new Error("You must be logged in to update users");const{data:r}=await s.from("users").select("*").eq("id",e).single(),{data:n,error:l}=await s.from("users").update({name:t.name,role:t.role,phone:t.phone,student_id:t.student_id,department_id:t.department_id,batch_id:t.batch_id,section_id:t.section_id}).eq("id",e).select().single();if(l)throw new Error(l.message);return"section_admin"===t.role&&t.section_id&&"section_admin"!==(null==r?void 0:r.role)&&await s.from("section_admins").upsert({user_id:e,section_id:t.section_id,assigned_by:a.user.id}),"section_admin"===(null==r?void 0:r.role)&&"section_admin"!==t.role&&await s.from("section_admins").delete().eq("user_id",e),await s.from("activities").insert({type:"user_updated",title:`User updated: ${n.name}`,user_id:a.user.id,metadata:{target_user_id:e,changes:t,previous:r}}),n}catch(a){throw a}}(_.id,e),M("User updated successfully"),await E())},mode:T}),e.jsx(ta,{open:j,onClose:()=>w(!1),user:_,sections:d,onRoleChange:async(e,t,a)=>{await async function(e,t,a){try{const{data:r}=await s.auth.getUser();if(!r.user)throw new Error("You must be logged in to change user roles");const{data:n}=await s.from("users").select("*").eq("id",e).single(),l={role:t};a&&(l.section_id=a);const{data:o,error:i}=await s.from("users").update(l).eq("id",e).select().single();if(i)throw new Error(i.message);return"section_admin"===t&&a?(await s.from("section_admins").delete().eq("user_id",e),await s.from("section_admins").insert({user_id:e,section_id:a,assigned_by:r.user.id})):"section_admin"===(null==n?void 0:n.role)&&"section_admin"!==t&&await s.from("section_admins").delete().eq("user_id",e),await s.from("activities").insert({type:"role_change",title:`User role changed: ${null==n?void 0:n.role}  ${t}`,user_id:r.user.id,metadata:{target_user_id:e,previous_role:null==n?void 0:n.role,new_role:t,section_id:a}}),o}catch(r){throw r}}(e,t,a),await E()}}),e.jsx(sa,{open:k,onClose:()=>N(!1),user:_,onDelete:async e=>{await async function(e){try{const{data:t}=await s.auth.getUser();if(!t.user)throw new Error("You must be logged in to delete users");const{data:a}=await s.from("users").select("*").eq("id",e).single();await s.from("section_admins").delete().eq("user_id",e);const{error:r}=await s.from("users").delete().eq("id",e);if(r)throw new Error(r.message);await s.from("activities").insert({type:"user_deleted",title:`User deleted: ${(null==a?void 0:a.name)||(null==a?void 0:a.email)}`,user_id:t.user.id,metadata:{deleted_user:a}})}catch(t){throw t}}(e),await E()}})]})}function la({className:t}){return e.jsx("div",{className:`animate-pulse bg-muted rounded ${t}`})}function oa({title:t,value:s,icon:a,trend:r,subtitle:n,color:l="bg-blue-500"}){return e.jsx(Ct,{className:"p-6 hover:shadow-lg transition-all duration-200",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-1",children:t}),e.jsx("h3",{className:"text-3xl font-bold mb-2",children:s}),n&&e.jsx("p",{className:"text-xs text-muted-foreground",children:n}),r&&e.jsxs("div",{className:"flex items-center gap-1 mt-2 text-sm "+(r.isPositive?"text-green-600":"text-red-600"),children:[r.isPositive?e.jsx($,{className:"w-4 h-4"}):e.jsx(z,{className:"w-4 h-4"}),e.jsxs("span",{children:[Math.abs(r.value),"%"]})]})]}),e.jsx("div",{className:`p-3 rounded-xl ${l} bg-opacity-10`,children:e.jsx("div",{className:`text-${l.split("-")[1]}-600`,children:a})})]})})}function ia({label:t,value:s,max:a,color:r="bg-blue-500"}){const n=a>0?s/a*100:0;return e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[e.jsx("span",{className:"font-medium",children:t}),e.jsxs("span",{className:"text-muted-foreground",children:[s," / ",a]})]}),e.jsx("div",{className:"w-full bg-muted rounded-full h-3",children:e.jsx("div",{className:`${r} h-3 rounded-full transition-all duration-500`,style:{width:`${Math.min(n,100)}%`}})})]})}function da({data:t,color:s="#3b82f6"}){if(!t||0===t.length)return null;const a=Math.max(...t.map((e=>e.count)),1),r=t.map(((e,s)=>`${s/(t.length-1||1)*90+5},${55-e.count/a*50}`)).join(" "),n=`5,55 ${r} 95,55`;return e.jsxs("svg",{viewBox:"0 0 100 60",className:"w-full h-24",children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:`gradient-${s}`,x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[e.jsx("stop",{offset:"0%",stopColor:s,stopOpacity:"0.3"}),e.jsx("stop",{offset:"100%",stopColor:s,stopOpacity:"0.05"})]})}),e.jsx("polygon",{points:n,fill:`url(#gradient-${s})`}),e.jsx("polyline",{points:r,fill:"none",stroke:s,strokeWidth:"2"}),t.map(((r,n)=>{const l=n/(t.length-1||1)*90+5,o=55-r.count/a*50;return e.jsx("circle",{cx:l,cy:o,r:"2.5",fill:s},n)}))]})}function ca({data:t,maxValue:s,color:a="#3b82f6"}){const r=s||Math.max(...t.map((e=>e.value)),1);return e.jsx("div",{className:"space-y-3",children:t.map(((t,s)=>{const n=t.value/r*100;return e.jsxs("div",{className:"group",children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1.5",children:[e.jsx("span",{className:"font-medium truncate",children:t.label}),e.jsx("span",{className:"text-muted-foreground ml-2",children:t.value})]}),e.jsx("div",{className:"relative w-full bg-muted rounded-full h-2.5 overflow-hidden",children:e.jsx("div",{className:"h-full rounded-full transition-all duration-700 ease-out",style:{width:`${n}%`,background:`linear-gradient(90deg, ${a} 0%, ${a}dd 100%)`}})})]},s)}))})}function ma({data:t}){const s=t.reduce(((e,t)=>e+t.value),0);if(0===s)return e.jsx("div",{className:"text-center text-muted-foreground text-sm",children:"No data"});let a=-90;const r=50;return e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("svg",{viewBox:"0 0 100 100",className:"w-40 h-40",children:[t.map(((t,n)=>{const l=t.value/s*100/100*360,o=((e,t,s,a)=>{const n=e*Math.PI/180,l=t*Math.PI/180,o=t-e>180?1:0;return`M ${r+s*Math.cos(n)} ${50+s*Math.sin(n)} A 40 40 0 ${o} 1 ${r+s*Math.cos(l)} ${50+s*Math.sin(l)} L ${r+a*Math.cos(l)} ${50+a*Math.sin(l)} A 28 28 0 ${o} 0 ${r+a*Math.cos(n)} ${50+a*Math.sin(n)} Z`})(a,a+l,40,28);return a+=l,e.jsx("g",{children:e.jsx("path",{d:o,fill:t.color,className:"transition-all hover:opacity-80"})},n)})),e.jsx("circle",{cx:r,cy:50,r:26,fill:"currentColor",className:"text-background"}),e.jsx("text",{x:r,y:45,textAnchor:"middle",className:"text-xl font-bold",fill:"currentColor",children:s}),e.jsx("text",{x:r,y:58,textAnchor:"middle",className:"text-xs",fill:"currentColor",opacity:"0.6",children:"Total"})]}),e.jsx("div",{className:"flex-1 space-y-2",children:t.map(((t,a)=>e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:t.color}}),e.jsx("span",{className:"font-medium",children:t.label})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-muted-foreground",children:t.value}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",(t.value/s*100).toFixed(0),"%)"]})]})]},a)))})]})}function ua({dept:t}){return e.jsx(Ct,{className:"p-5 hover:shadow-md transition-all",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 bg-purple-500 bg-opacity-10 rounded-lg",children:e.jsx(D,{className:"w-5 h-5 text-purple-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold mb-2 text-sm",children:t.department_name}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Users"}),e.jsx("p",{className:"font-bold text-lg",children:t.user_count})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Tasks"}),e.jsx("p",{className:"font-bold text-lg",children:t.task_count})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Batches"}),e.jsx("p",{className:"font-bold text-lg",children:t.batch_count})]})]})]})]})})}function xa(){const[a,r]=t.useState(null),[n,l]=t.useState(!0),[o,i]=t.useState(null);t.useEffect((()=>{d()}),[]);const d=async()=>{try{l(!0),i(null);const[e,t,a,n,o,d,c,m]=await Promise.all([s.from("users").select("*").then((e=>{const t=e.data||[],s=new Date,a=new Date(s.getTime()-6048e5),r=new Date(s.getTime()-2592e6),n=new Date(s.getTime()-864e5);return{total_users:t.length,students:t.filter((e=>"user"===e.role)).length,admins:t.filter((e=>"admin"===e.role)).length,section_admins:t.filter((e=>"section_admin"===e.role)).length,super_admins:t.filter((e=>"super-admin"===e.role)).length,new_users_week:t.filter((e=>new Date(e.created_at)>a)).length,new_users_month:t.filter((e=>new Date(e.created_at)>r)).length,active_today:t.filter((e=>e.last_active&&new Date(e.last_active)>n)).length,active_week:t.filter((e=>e.last_active&&new Date(e.last_active)>a)).length}})),s.from("tasks").select("*").then((e=>{const t=e.data||[],s=new Date,a=new Date(s.getTime()-6048e5),r=new Date(s.getTime()-2592e6),n=s.toISOString().split("T")[0];return{total_tasks:t.length,completed_tasks:t.filter((e=>"completed"===e.status)).length,in_progress_tasks:t.filter((e=>"in-progress"===e.status)).length,pending_tasks:t.filter((e=>"pending"===e.status)).length,overdue_tasks:t.filter((e=>e.due_date<n&&"completed"!==e.status)).length,tasks_created_week:t.filter((e=>new Date(e.created_at)>a)).length,tasks_created_month:t.filter((e=>new Date(e.created_at)>r)).length,urgent_tasks:t.filter((e=>"urgent"===e.priority)).length,high_priority_tasks:t.filter((e=>"high"===e.priority)).length}})),Promise.all([s.from("departments").select("*",{count:"exact"}),s.from("batches").select("*",{count:"exact"}),s.from("sections").select("*",{count:"exact"}),s.from("task_assignments").select("*",{count:"exact"}),s.from("activities").select("*",{count:"exact"}),s.from("fcm_tokens").select("*",{count:"exact"}).eq("is_active",!0),s.from("task_templates").select("*",{count:"exact"})]).then((e=>({total_departments:e[0].count||0,total_batches:e[1].count||0,total_sections:e[2].count||0,total_assignments:e[3].count||0,total_activities:e[4].count||0,active_fcm_tokens:e[5].count||0,total_templates:e[6].count||0}))),Promise.all([s.from("departments").select("id, name"),s.from("users").select("department_id"),s.from("tasks").select("department_id"),s.from("batches").select("department_id")]).then((([e,t,s,a])=>{const r=e.data||[],n=t.data||[],l=s.data||[],o=a.data||[];return r.map((e=>({department_name:e.name,user_count:n.filter((t=>t.department_id===e.id)).length,task_count:l.filter((t=>t.department_id===e.id)).length,batch_count:o.filter((t=>t.department_id===e.id)).length})))})),s.from("users").select("created_at").gte("created_at",new Date(Date.now()-2592e6).toISOString()).then((e=>{const t=e.data||[],s={};return t.forEach((e=>{const t=e.created_at.split("T")[0];s[t]=(s[t]||0)+1})),Object.entries(s).map((([e,t])=>({date:e,count:t}))).sort(((e,t)=>t.date.localeCompare(e.date)))})),s.from("tasks").select("created_at").gte("created_at",new Date(Date.now()-2592e6).toISOString()).then((e=>{const t=e.data||[],s={};return t.forEach((e=>{const t=e.created_at.split("T")[0];s[t]=(s[t]||0)+1})),Object.entries(s).map((([e,t])=>({date:e,count:t}))).sort(((e,t)=>t.date.localeCompare(e.date)))})),s.from("tasks").select("category").then((e=>{const t=e.data||[],s={};return t.forEach((e=>{e.category&&(s[e.category]=(s[e.category]||0)+1)})),Object.entries(s).map((([e,t])=>({category:e,count:t}))).sort(((e,t)=>t.count-e.count))})),s.from("activities").select("type").then((e=>{const t=e.data||[],s={};return t.forEach((e=>{e.type&&(s[e.type]=(s[e.type]||0)+1)})),Object.entries(s).map((([e,t])=>({type:e,count:t}))).sort(((e,t)=>t.count-e.count)).slice(0,10)}))]);r({totalUsers:e.total_users||0,students:e.students||0,admins:e.admins||0,sectionAdmins:e.section_admins||0,superAdmins:e.super_admins||0,newUsersWeek:e.new_users_week||0,newUsersMonth:e.new_users_month||0,activeToday:e.active_today||0,activeWeek:e.active_week||0,totalTasks:t.total_tasks||0,completedTasks:t.completed_tasks||0,inProgressTasks:t.in_progress_tasks||0,pendingTasks:t.pending_tasks||0,overdueTasks:t.overdue_tasks||0,tasksCreatedWeek:t.tasks_created_week||0,tasksCreatedMonth:t.tasks_created_month||0,urgentTasks:t.urgent_tasks||0,highPriorityTasks:t.high_priority_tasks||0,totalDepartments:a.total_departments||0,totalBatches:a.total_batches||0,totalSections:a.total_sections||0,totalAssignments:a.total_assignments||0,totalActivities:a.total_activities||0,activeFcmTokens:a.active_fcm_tokens||0,totalTemplates:a.total_templates||0,departmentStats:n||[],userGrowth:o||[],taskGrowth:d||[],taskCategories:c||[],activityTypes:m||[]})}catch(e){i("Failed to load analytics data. Please try again.")}finally{l(!1)}};if(n)return e.jsx("div",{className:"p-6 space-y-6",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[...Array(8)].map(((t,s)=>e.jsx(la,{className:"h-32"},s)))})});if(o||!a)return e.jsx("div",{className:"p-6",children:e.jsxs(Ct,{className:"p-8 text-center",children:[e.jsx(K,{className:"w-12 h-12 text-red-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Error Loading Analytics"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:o}),e.jsx("button",{onClick:d,className:"px-4 py-2 bg-primary text-primary-foreground rounded-lg hover:opacity-90",children:"Retry"})]})});const c=a.totalTasks>0?(a.completedTasks/a.totalTasks*100).toFixed(1):"0",m=a.totalUsers>0?(a.activeWeek/a.totalUsers*100).toFixed(1):"0";return e.jsxs("div",{className:"space-y-6 animate-in fade-in duration-500",children:[e.jsxs("section",{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(oa,{title:"Total Users",value:a.totalUsers,icon:e.jsx(x,{className:"w-6 h-6"}),subtitle:`${a.newUsersMonth} new this month`,color:"bg-blue-500"}),e.jsx(oa,{title:"Students",value:a.students,icon:e.jsx(ne,{className:"w-6 h-6"}),subtitle:`${(a.students/a.totalUsers*100).toFixed(1)}% of total`,color:"bg-green-500"}),e.jsx(oa,{title:"Active Users (Week)",value:a.activeWeek,icon:e.jsx(g,{className:"w-6 h-6"}),subtitle:`${m}% engagement rate`,color:"bg-purple-500"}),e.jsx(oa,{title:"Active Today",value:a.activeToday,icon:e.jsx(T,{className:"w-6 h-6"}),subtitle:`${a.activeWeek} active this week`,color:"bg-orange-500"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mt-6",children:[e.jsxs(Ct,{className:"p-6",children:[e.jsxs("h3",{className:"font-semibold mb-4 flex items-center gap-2",children:[e.jsx($,{className:"w-4 h-4"}),"User Growth Trend"]}),e.jsx(da,{data:a.userGrowth.slice(0,14).reverse(),color:"#3b82f6"}),e.jsx("div",{className:"mt-4 pt-4 border-t",children:e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Last 14 days"}),e.jsxs("span",{className:"font-semibold text-blue-600",children:["+",a.userGrowth.slice(0,14).reduce(((e,t)=>e+t.count),0)," users"]})]})})]}),e.jsxs(Ct,{className:"p-6",children:[e.jsxs("h3",{className:"font-semibold mb-4 flex items-center gap-2",children:[e.jsx(U,{className:"w-4 h-4"}),"User Roles Distribution"]}),e.jsx(ia,{label:"Students",value:a.students,max:a.totalUsers,color:"bg-green-500"}),e.jsx(ia,{label:"Section Admins",value:a.sectionAdmins,max:a.totalUsers,color:"bg-blue-500"}),e.jsx(ia,{label:"Admins",value:a.admins,max:a.totalUsers,color:"bg-purple-500"}),e.jsx(ia,{label:"Super Admins",value:a.superAdmins,max:a.totalUsers,color:"bg-red-500"})]}),e.jsxs(Ct,{className:"p-6",children:[e.jsxs("h3",{className:"font-semibold mb-4 flex items-center gap-2",children:[e.jsx($,{className:"w-4 h-4"}),"Growth Summary"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"New Users (Week)"}),e.jsxs("p",{className:"text-2xl font-bold text-green-600",children:["+",a.newUsersWeek]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"New Users (Month)"}),e.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:["+",a.newUsersMonth]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Engagement Rate"}),e.jsxs("p",{className:"text-2xl font-bold text-purple-600",children:[m,"%"]})]})]})]}),e.jsxs(Ct,{className:"p-6",children:[e.jsxs("h3",{className:"font-semibold mb-4 flex items-center gap-2",children:[e.jsx(g,{className:"w-4 h-4"}),"Active Users"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-center p-4 bg-gradient-to-br from-blue-50 to-purple-50 dark:from-blue-950/30 dark:to-purple-950/30 rounded-lg",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Active Today"}),e.jsx("p",{className:"text-4xl font-bold text-blue-600",children:a.activeToday}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[(a.activeToday/a.totalUsers*100).toFixed(1),"% of total"]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"This Week"}),e.jsx("span",{className:"text-lg font-bold text-purple-600",children:a.activeWeek})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Engagement"}),e.jsxs("span",{className:"text-lg font-bold text-green-600",children:[m,"%"]})]})]})]})]})]})]}),e.jsxs("section",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(le,{className:"w-5 h-5 text-green-600"}),e.jsx("h2",{className:"text-xl font-semibold",children:"Task Analytics"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(oa,{title:"Total Tasks",value:a.totalTasks,icon:e.jsx(h,{className:"w-6 h-6"}),subtitle:`${a.tasksCreatedMonth} created this month`,color:"bg-indigo-500"}),e.jsx(oa,{title:"Completed",value:a.completedTasks,icon:e.jsx(le,{className:"w-6 h-6"}),subtitle:`${c}% completion rate`,color:"bg-green-500"}),e.jsx(oa,{title:"In Progress",value:a.inProgressTasks,icon:e.jsx(B,{className:"w-6 h-6"}),subtitle:`${a.pendingTasks} pending`,color:"bg-yellow-500"}),e.jsx(oa,{title:"Overdue",value:a.overdueTasks,icon:e.jsx(K,{className:"w-6 h-6"}),subtitle:`${a.urgentTasks} urgent tasks`,color:"bg-red-500"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mt-6",children:[e.jsxs(Ct,{className:"p-6",children:[e.jsxs("h3",{className:"font-semibold mb-4 flex items-center gap-2",children:[e.jsx(oe,{className:"w-4 h-4"}),"Task Status Overview"]}),e.jsx(ma,{data:[{label:"Completed",value:a.completedTasks,color:"#22c55e"},{label:"In Progress",value:a.inProgressTasks,color:"#eab308"},{label:"Pending",value:a.pendingTasks,color:"#3b82f6"},{label:"Overdue",value:a.overdueTasks,color:"#ef4444"}]})]}),e.jsxs(Ct,{className:"p-6",children:[e.jsxs("h3",{className:"font-semibold mb-4 flex items-center gap-2",children:[e.jsx($,{className:"w-4 h-4"}),"Task Creation Trend"]}),e.jsx(da,{data:a.taskGrowth.slice(0,14).reverse(),color:"#22c55e"}),e.jsx("div",{className:"mt-4 pt-4 border-t",children:e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Last 14 days"}),e.jsxs("span",{className:"font-semibold text-green-600",children:["+",a.taskGrowth.slice(0,14).reduce(((e,t)=>e+t.count),0)," tasks"]})]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mt-6",children:[e.jsxs(Ct,{className:"p-6",children:[e.jsxs("h3",{className:"font-semibold mb-4 flex items-center gap-2",children:[e.jsx(E,{className:"w-4 h-4"}),"Task Categories"]}),e.jsx(ca,{data:a.taskCategories.slice(0,5).map((e=>({label:e.category.replace("-"," ").replace(/\b\w/g,(e=>e.toUpperCase())),value:e.count}))),color:"#6366f1"})]}),e.jsxs(Ct,{className:"p-6",children:[e.jsxs("h3",{className:"font-semibold mb-4 flex items-center gap-2",children:[e.jsx(U,{className:"w-4 h-4"}),"Priority Distribution"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-red-50 dark:bg-red-950/20 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(K,{className:"w-5 h-5 text-red-600"}),e.jsx("span",{className:"font-medium",children:"Urgent"})]}),e.jsx("span",{className:"text-2xl font-bold text-red-600",children:a.urgentTasks})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-orange-50 dark:bg-orange-950/20 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($,{className:"w-5 h-5 text-orange-600"}),e.jsx("span",{className:"font-medium",children:"High Priority"})]}),e.jsx("span",{className:"text-2xl font-bold text-orange-600",children:a.highPriorityTasks})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-blue-50 dark:bg-blue-950/20 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(B,{className:"w-5 h-5 text-blue-600"}),e.jsx("span",{className:"font-medium",children:"Overdue"})]}),e.jsx("span",{className:"text-2xl font-bold text-blue-600",children:a.overdueTasks})]})]})]})]})]}),e.jsxs("section",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(F,{className:"w-5 h-5 text-purple-600"}),e.jsx("h2",{className:"text-xl font-semibold",children:"System Overview"})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-7 gap-4",children:[e.jsx(oa,{title:"Departments",value:a.totalDepartments,icon:e.jsx(D,{className:"w-5 h-5"}),color:"bg-purple-500"}),e.jsx(oa,{title:"Batches",value:a.totalBatches,icon:e.jsx(F,{className:"w-5 h-5"}),color:"bg-blue-500"}),e.jsx(oa,{title:"Sections",value:a.totalSections,icon:e.jsx(F,{className:"w-5 h-5"}),color:"bg-indigo-500"}),e.jsx(oa,{title:"Assignments",value:a.totalAssignments,icon:e.jsx(h,{className:"w-5 h-5"}),color:"bg-green-500"}),e.jsx(oa,{title:"Activities",value:a.totalActivities,icon:e.jsx(g,{className:"w-5 h-5"}),color:"bg-orange-500"}),e.jsx(oa,{title:"FCM Tokens",value:a.activeFcmTokens,icon:e.jsx(ie,{className:"w-5 h-5"}),color:"bg-red-500"}),e.jsx(oa,{title:"Templates",value:a.totalTemplates,icon:e.jsx(h,{className:"w-5 h-5"}),color:"bg-teal-500"})]})]}),e.jsxs("section",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(D,{className:"w-5 h-5 text-purple-600"}),e.jsx("h2",{className:"text-xl font-semibold",children:"Department Distribution"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx("div",{className:"grid grid-cols-1 gap-4",children:a.departmentStats.map(((t,s)=>e.jsx(ua,{dept:t},s)))}),e.jsxs(Ct,{className:"p-6",children:[e.jsx("h3",{className:"font-semibold mb-6",children:"Department Comparison"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-3 text-muted-foreground",children:"Users by Department"}),e.jsx(ca,{data:a.departmentStats.map((e=>({label:e.department_name.split(" ")[0],value:e.user_count}))),color:"#a855f7"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium mb-3 text-muted-foreground",children:"Tasks by Department"}),e.jsx(ca,{data:a.departmentStats.map((e=>({label:e.department_name.split(" ")[0],value:e.task_count}))),color:"#3b82f6"})]})]})]})]})]}),e.jsxs("section",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(g,{className:"w-5 h-5 text-orange-600"}),e.jsx("h2",{className:"text-xl font-semibold",children:"System Activity"})]}),e.jsxs(Ct,{className:"p-6",children:[e.jsx("h3",{className:"font-semibold mb-4",children:"Activity Breakdown"}),e.jsx(ca,{data:a.activityTypes.map((e=>({label:e.type.replace("_"," ").replace(/\b\w/g,(e=>e.toUpperCase())),value:e.count}))),color:"#f97316"})]})]})]})}function ga(){return e.jsx(na,{})}function ha(){return e.jsx(xa,{})}function pa(){const[a,r]=t.useState([]),[n,l]=t.useState(!0);return t.useEffect((()=>{(async()=>{try{l(!0);const{data:e}=await s.from("activities").select("*").order("created_at",{ascending:!1}).limit(100);if(e){const t=e.map((e=>({id:e.id,timestamp:e.created_at,adminId:e.user_id||"",adminName:"Admin",action:e.type,target:e.title,details:{description:e.title,metadata:e.metadata},ipAddress:"0.0.0.0",userAgent:"N/A",status:"success"})));r(t)}}catch(e){}finally{l(!1)}})()}),[]),e.jsx($s,{logs:a,loading:n})}function fa(){const{admins:t,resetPassword:s}=zs();return e.jsx(Ms,{admins:t,onResetPassword:s})}function ba(){var s;const a=r(),l=n(),[o,i]=t.useState("overview"),[d,c]=t.useState(!1),[u,x]=t.useState(!1),[g,h]=t.useState(!1),[p,j]=t.useState(!1),{isDark:w,toggle:k}=f(),{logout:N,user:_}=de(),{refreshAdmins:C}=zs();return t.useEffect((()=>{const e=l.pathname;i({"/superadmin/dashboard":"overview","/superadmin/overview":"overview","/superadmin/admins":"admins","/superadmin/sectionadmins":"section-admins","/superadmin/analytics":"analytics","/superadmin/logs":"logs","/superadmin/security":"security"}[e]||"overview")}),[l.pathname]),t.useEffect((()=>{const e=()=>{const e=window.innerWidth<1024;h(e),!e&&u&&x(!1)};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[u]),t.useEffect((()=>{localStorage.setItem("is_super_admin","true"),sessionStorage.setItem("is_super_admin","true"),C()}),[C]),e.jsxs("div",{className:"flex h-screen bg-gray-50 dark:bg-gray-950",children:[e.jsx(_t,{activeTab:o,onTabChange:e=>{i(e),a({overview:"/superadmin/dashboard",admins:"/superadmin/admins","section-admins":"/superadmin/sectionadmins",analytics:"/superadmin/analytics",logs:"/superadmin/logs",security:"/superadmin/security"}[e]||"/superadmin/dashboard",{replace:!0})},isCollapsed:d,onToggleCollapse:()=>c(!d),isMobile:g,isOpen:u,onClose:()=>x(!1)}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsx("header",{className:"bg-white dark:bg-gray-900 border-b border-gray-200 dark:border-gray-800 px-4 lg:px-6 py-4 h-16",children:e.jsxs("div",{className:"flex items-center justify-between h-full",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>x(!0),className:"lg:hidden p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg",children:e.jsx(m,{className:"w-5 h-5"})}),e.jsx("div",{children:e.jsx("h1",{className:"text-xl lg:text-2xl font-bold text-gray-900 dark:text-white",children:{overview:"Dashboard Overview",admins:"Admin Management","section-admins":"Section Admin Management",analytics:"Analytics & Reports",logs:"System Logs",security:"Security Settings"}[o]||"Dashboard"})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg relative",children:[e.jsx(ie,{className:"w-5 h-5"}),e.jsx($t,{variant:"destructive",className:"absolute -top-1 -right-1 h-5 w-5 flex items-center justify-center p-0 text-[10px]",children:"3"})]}),e.jsx("button",{onClick:k,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg",children:w?e.jsx(b,{className:"w-5 h-5"}):e.jsx(y,{className:"w-5 h-5"})}),e.jsxs("div",{className:"hidden sm:flex items-center gap-2 pl-2 border-l border-gray-200 dark:border-gray-800",children:[e.jsx(Us,{className:"h-8 w-8",children:e.jsx(Es,{className:"bg-blue-600 text-white text-sm",children:(null==(s=null==_?void 0:_.name)?void 0:s.charAt(0).toUpperCase())||"SA"})}),e.jsxs("div",{className:"hidden lg:block",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:(null==_?void 0:_.name)||"Super Admin"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:null==_?void 0:_.email})]})]}),e.jsxs(Ht,{variant:"ghost",size:"sm",onClick:async()=>{if(!p)try{j(!0),await N(),a("/auth",{replace:!0})}catch(e){j(!1)}},disabled:p,className:"gap-2",children:[e.jsx(v,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:p?"Logging out...":"Logout"})]})]})]})}),e.jsx("main",{className:"flex-1 overflow-auto p-4 lg:p-6",children:e.jsx("div",{className:"max-w-[1600px] mx-auto",children:(()=>{switch(o){case"overview":default:return e.jsx(Mt,{});case"admins":return e.jsx(Fs,{});case"section-admins":return e.jsx(ga,{});case"analytics":return e.jsx(ha,{});case"logs":return e.jsx(pa,{});case"security":return e.jsx(fa,{})}})()})})]})]})}export{ba as SuperAdminDashboard};
