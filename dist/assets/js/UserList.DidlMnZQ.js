import{r as a,j as e}from"./index.D6B7_sTU.js";import{S as C}from"./search.CcWmmoIp.js";import{A as L}from"./alert-triangle.D7VoMI5q.js";import{T as I}from"./trash-2.Do-rdZj3.js";import"./createLucideIcon.BhiB5r5E.js";const Y=a.memo(function({users:i,onDeleteUser:h,onPromoteUser:U,onDemoteUser:D,isSectionAdmin:c=!1,isLoading:k=!1}){const[x,p]=a.useState(null),[w,m]=a.useState(!1),[s,g]=a.useState(null),[u,o]=a.useState(null),[n,j]=a.useState(""),d=a.useCallback(t=>t==="section_admin",[]),N=a.useCallback(t=>{const r=i.find(l=>d(l.role));if(c&&t.sectionId!==(r==null?void 0:r.sectionId)){o("You can only delete users from your own section");return}if(t.role==="admin"||t.role==="super-admin"||d(t.role)){o("You cannot delete administrators");return}g(t),m(!0),o(null)},[c,d,i]),v=a.useCallback(async()=>{if(s)try{p(s.id),o(null),await h(s.id)}catch(t){o(t.message||"Failed to delete user")}finally{p(null),m(!1),g(null)}},[s,h]),y=a.useMemo(()=>i.filter(t=>{var r,l,b;return((r=t.name)==null?void 0:r.toLowerCase().includes(n.toLowerCase()))||t.email.toLowerCase().includes(n.toLowerCase())||t.role.toLowerCase().includes(n.toLowerCase())||((l=t.sectionName)==null?void 0:l.toLowerCase().includes(n.toLowerCase()))||((b=t.sectionId)==null?void 0:b.toLowerCase().includes(n.toLowerCase()))}),[i,n]),f=a.useMemo(()=>c?y.filter(t=>{var r;return t.sectionId===((r=i.find(l=>d(l.role)))==null?void 0:r.sectionId)}):y,[c,y,i,d]);return k?e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-md p-8 text-center",children:e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Loading users..."})}):e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-md overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"relative",children:[e.jsx(C,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search users...",value:n,onChange:t=>j(t.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100"})]})}),u&&e.jsx("div",{className:"p-4 bg-red-50 dark:bg-red-900/20 border-l-4 border-red-500",children:e.jsxs("div",{className:"flex",children:[e.jsx(L,{className:"h-5 w-5 text-red-500 mr-2"}),e.jsx("p",{className:"text-sm text-red-700 dark:text-red-400",children:u})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-750",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Email"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Section"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Role"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:f.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-6 py-4 text-center text-sm text-gray-500 dark:text-gray-400",children:"No users found"})}):f.map(t=>{var r;return e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-750",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white",children:t.name||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:t.email}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:t.sectionName||(t.sectionId?`Section ${t.sectionId}`:"N/A")}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${t.role==="admin"?"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400":d(t.role)?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400":"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300"}`,children:t.role==="admin"?"Admin":d(t.role)?"Section Admin":"User"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsx("button",{onClick:()=>N(t),disabled:x===t.id||t.role==="admin"||t.role==="super-admin"||d(t.role)||c&&t.sectionId!==((r=i.find(l=>d(l.role)))==null?void 0:r.sectionId),className:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300 disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(I,{className:"h-5 w-5"})})})]},t.id)})})]})}),w&&s&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg max-w-md w-full p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Delete User"}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-4",children:["Are you sure you want to delete ",s.name||s.email,"? This action cannot be undone."]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{onClick:()=>{m(!1),g(null),o(null)},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white dark:bg-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600 rounded-md hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Cancel"}),e.jsx("button",{onClick:v,disabled:x===s.id,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50",children:x===s.id?"Deleting...":"Delete"})]})]})})]})});export{Y as UserList};
