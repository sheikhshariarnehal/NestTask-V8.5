import{r as e,j as t,s as r}from"./index.D9Cz7xb0.js";import{i as a,n as s,g as l,E as n,P as i}from"./googleDriveUtils.C6Pv_b1m.js";import{L as d}from"./list-todo.BLufov7V.js";import{T as o}from"./tag.IHEp_7C-.js";import{C as c}from"./calendar.BGMblVK0.js";import{A as m,S as u,C as x,b as g,a as p,c as h,L as b,R as y}from"./square.BVfAs9Q2.js";import{U as f}from"./upload.B6aor5d-.js";import{L as k}from"./link.DqKHFnou.js";import{P as j}from"./plus.CXZCpPv1.js";import{A as v}from"./alert-circle.Dp3YgBan.js";import{C as w}from"./check-circle.2D8Kec5F.js";import{X as N}from"./x.CnGBzzfj.js";import{F as D}from"./file-text.CgYpOND9.js";import{T as S}from"./trash-2.D21yLqG0.js";import{S as C}from"./save.DlUzG5vr.js";import{i as E,f as T}from"./dateUtils.8XYiGfWV.js";import{C as R}from"./check-square.D31hum5v.js";import{A as L}from"./alert-triangle.CV66xwyd.js";import{C as $}from"./copy.C6Y0lhR8.js";import{P as _}from"./pen.__crcxp7.js";import{C as A}from"./clock.CXFN-6Np.js";import{a as I,s as U}from"./notifications.DvTNppm3.js";import{C as O}from"./chevron-up.D6LPVqkV.js";import{F as P}from"./filter.DpLgbnk9.js";import{D as F}from"./download.CMz9Hfi9.js";import{R as G}from"./refresh-cw.DV23stN0.js";import{S as M}from"./search.bZ6nILxl.js";import{L as z}from"./loader-2.Ck7Yi2Jx.js";import"./createLucideIcon.nRTHO_rG.js";const B=e=>({taskDetails:{name:"",category:"task",dueDate:"",description:"",status:"in-progress",sectionId:e||void 0,googleDriveLinks:[]},errors:{},files:[],fileUrls:[],googleDriveLinks:[],currentGoogleDriveLink:"",isSubmitting:!1,success:!1,uploadProgress:0});function q(e,t){switch(t.type){case"SET_TASK_FIELD":return{...e,taskDetails:{...e.taskDetails,[t.field]:t.value}};case"SET_ERRORS":return{...e,errors:t.errors};case"CLEAR_ERROR":const{[t.field]:r,...a}=e.errors;return{...e,errors:a};case"ADD_FILES":return{...e,files:[...e.files,...t.newFiles],fileUrls:[...e.fileUrls,...t.newUrls]};case"REMOVE_FILE":return{...e,files:e.files.filter(((e,r)=>r!==t.index)),fileUrls:e.fileUrls.filter(((e,r)=>r!==t.index))};case"SET_CURRENT_GOOGLE_DRIVE_LINK":return{...e,currentGoogleDriveLink:t.link};case"ADD_GOOGLE_DRIVE_LINK":return{...e,googleDriveLinks:[...e.googleDriveLinks,t.link],currentGoogleDriveLink:"",taskDetails:{...e.taskDetails,googleDriveLinks:[...e.taskDetails.googleDriveLinks||[],t.link]}};case"REMOVE_GOOGLE_DRIVE_LINK":const s=e.googleDriveLinks.filter(((e,r)=>r!==t.index));return{...e,googleDriveLinks:s,taskDetails:{...e.taskDetails,googleDriveLinks:s}};case"SET_SUBMITTING":return{...e,isSubmitting:t.isSubmitting};case"SET_SUCCESS":return{...e,success:t.success};case"SET_UPLOAD_PROGRESS":return{...e,uploadProgress:t.progress};case"RESET_FORM":return B(t.sectionId);default:return e}}const V=({id:e,label:r,required:a=!1,error:s,children:l})=>t.jsxs("div",{children:[t.jsxs("label",{htmlFor:e,className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[r," ",a&&t.jsx("span",{className:"text-red-500",children:"*"})]}),l,s&&t.jsxs("p",{id:`${e}-error`,className:"mt-1 text-xs text-red-500 flex items-center gap-1",role:"alert",children:[t.jsx(v,{className:"w-3 h-3"}),s]})]}),K=()=>t.jsxs("div",{className:"p-3 bg-green-50 dark:bg-green-900/20 rounded-lg mb-4 flex items-start gap-2 shadow-sm",role:"alert",children:[t.jsx(w,{className:"w-5 h-5 text-green-600 dark:text-green-400 flex-shrink-0 mt-0.5"}),t.jsx("span",{className:"text-green-700 dark:text-green-300",children:"Task created successfully!"})]}),W=({progress:e})=>t.jsxs("div",{className:"mb-4","aria-live":"polite",children:[t.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5 dark:bg-gray-700",children:t.jsx("div",{className:"bg-blue-600 h-2.5 rounded-full transition-all duration-300",style:{width:`${e}%`},role:"progressbar","aria-valuenow":e,"aria-valuemin":0,"aria-valuemax":100})}),t.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:["Uploading files... ",e,"%"]})]}),H=({file:e,onRemove:r})=>{return t.jsxs("div",{className:"flex items-center justify-between p-3 bg-white dark:bg-gray-700 rounded-lg border border-gray-200 dark:border-gray-600 hover:border-blue-300 dark:hover:border-blue-500 transition-all duration-200 group",children:[t.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[t.jsx("span",{className:"text-2xl flex-shrink-0",children:(e=>{var t;const r=null==(t=e.split(".").pop())?void 0:t.toLowerCase();return["jpg","jpeg","png","gif","svg","webp"].includes(r||"")?"ğŸ–¼ï¸":["pdf"].includes(r||"")?"ğŸ“„":["doc","docx"].includes(r||"")?"ğŸ“":["xls","xlsx"].includes(r||"")?"ğŸ“Š":["zip","rar","7z"].includes(r||"")?"ğŸ—œï¸":"ğŸ“"})(e.name)}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-200 truncate",children:e.name}),t.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:(a=e.size,a<1024?a+" B":a<1048576?(a/1024).toFixed(1)+" KB":(a/1048576).toFixed(1)+" MB")})]})]}),t.jsx("button",{type:"button",onClick:r,className:"flex-shrink-0 p-1.5 text-gray-400 hover:text-red-500 dark:hover:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-all duration-200 opacity-0 group-hover:opacity-100","aria-label":"Remove file",children:t.jsx(N,{className:"w-4 h-4"})})]});var a},Q=({url:e,onRemove:r})=>t.jsxs("div",{className:"flex items-center justify-between py-2 px-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800",children:[t.jsxs("div",{className:"flex items-center gap-2 truncate max-w-[85%]",children:[t.jsx(k,{className:"w-4 h-4 text-blue-500 dark:text-blue-400 flex-shrink-0"}),t.jsxs("div",{className:"flex flex-col min-w-0",children:[t.jsx("span",{className:"text-sm text-blue-700 dark:text-blue-300 truncate",children:l(e)}),t.jsx("span",{className:"text-xs text-blue-600 dark:text-blue-400 truncate",children:e})]})]}),t.jsxs("div",{className:"flex items-center gap-1 ml-2",children:[t.jsx("button",{type:"button",onClick:()=>window.open(e,"_blank","noopener,noreferrer"),className:"text-blue-500 hover:text-blue-600 dark:text-blue-400 dark:hover:text-blue-300 p-1 rounded-full hover:bg-blue-100 dark:hover:bg-blue-800 touch-manipulation","aria-label":"Open Google Drive link",children:t.jsx(n,{className:"w-4 h-4"})}),t.jsx("button",{type:"button",onClick:r,className:"text-gray-500 hover:text-red-500 dark:text-gray-400 dark:hover:text-red-400 p-1 rounded-full hover:bg-gray-200 dark:hover:bg-gray-600 touch-manipulation","aria-label":"Remove Google Drive link",children:t.jsx(N,{className:"w-4 h-4"})})]})]});function Z({onSubmit:r,sectionId:l,isSectionAdmin:n=!1,isSubmitting:i=!1}){const[u,x]=e.useReducer(q,B(l)),{taskDetails:g,errors:p,files:h,fileUrls:b,googleDriveLinks:y,currentGoogleDriveLink:v,isSubmitting:w,success:N,uploadProgress:D}=u,S=e.useRef(),C=e.useRef(!0),E=e.useRef(),T=e.useRef(null);e.useEffect((()=>(C.current=!0,()=>{C.current=!1,x({type:"SET_SUBMITTING",isSubmitting:!1}),S.current&&clearTimeout(S.current),E.current&&E.current.abort(),b.forEach((e=>{e&&!e.startsWith("placeholder-")&&URL.revokeObjectURL(e)}))})),[b,x]);const R=e.useCallback((()=>/iPhone|iPad|iPod|Android|webOS|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||window.innerWidth<768),[]);e.useEffect((()=>{if(R()&&T.current){const e=T.current;e.addEventListener("focus",(()=>{e.classList.add("mobile-date-focused")})),e.addEventListener("blur",(()=>{e.classList.remove("mobile-date-focused")}))}}),[R]);const L=e.useCallback((()=>{const e={};let t=!0;if(g.name.trim()||(e.name="Task name is required",t=!1),g.dueDate){const r=new Date(g.dueDate),a=new Date;a.setHours(0,0,0,0),r<a&&(e.dueDate="Due date cannot be in the past",t=!1)}else e.dueDate="Due date is required",t=!1;return g.description.trim()||(e.description="Description is required",t=!1),x({type:"SET_ERRORS",errors:e}),t}),[g]),$=e.useCallback((e=>{const{name:t,value:r}=e.target;x({type:"SET_TASK_FIELD",field:t,value:r}),p[t]&&x({type:"CLEAR_ERROR",field:t})}),[p]),_=e.useCallback((e=>{var t;if(!(null==(t=e.target.files)?void 0:t.length))return;const r=Array.from(e.target.files),a=r.filter((e=>e.size>52428800));if(a.length>0)x({type:"SET_ERRORS",errors:{...p,files:`Some files exceed the 50MB size limit: ${a.map((e=>e.name)).join(", ")}`}});else{if(R()){const e=r.map((e=>`placeholder-${e.name}-${Date.now()}`));x({type:"ADD_FILES",newFiles:r,newUrls:e})}else{const e=r.map((e=>URL.createObjectURL(e)));x({type:"ADD_FILES",newFiles:r,newUrls:e})}p.files&&x({type:"CLEAR_ERROR",field:"files"})}}),[p,R]),A=e.useCallback((e=>{b[e]&&!b[e].startsWith("placeholder-")&&URL.revokeObjectURL(b[e]),x({type:"REMOVE_FILE",index:e})}),[b]),I=e.useCallback((e=>{const t=e.target.value;x({type:"SET_CURRENT_GOOGLE_DRIVE_LINK",link:t}),p.googleDriveLinks&&x({type:"CLEAR_ERROR",field:"googleDriveLinks"})}),[p.googleDriveLinks]),U=e.useCallback((()=>{const e=v.trim();if(!e)return void x({type:"SET_ERRORS",errors:{...p,googleDriveLinks:"Please enter a Google Drive link"}});if(!a(e))return void x({type:"SET_ERRORS",errors:{...p,googleDriveLinks:"Please enter a valid Google Drive URL"}});const t=s(e);y.includes(t)?x({type:"SET_ERRORS",errors:{...p,googleDriveLinks:"This Google Drive link has already been added"}}):x({type:"ADD_GOOGLE_DRIVE_LINK",link:t})}),[v,y,p]),O=e.useCallback((e=>{x({type:"REMOVE_GOOGLE_DRIVE_LINK",index:e})}),[]),P=e.useCallback((e=>{"Enter"===e.key&&(e.preventDefault(),U())}),[U]),F=e.useCallback((()=>(new Date).toISOString().split("T")[0]),[]),G=e.useCallback((async e=>{if(e.preventDefault(),!w&&(S.current&&clearTimeout(S.current),E.current=new AbortController,L())){x({type:"SET_SUBMITTING",isSubmitting:!0}),x({type:"SET_UPLOAD_PROGRESS",progress:0}),S.current=setTimeout((()=>{var e;C.current&&(x({type:"SET_SUBMITTING",isSubmitting:!1}),x({type:"SET_ERRORS",errors:{name:"Submission timed out. Please try again with smaller files or check your connection."}}),null==(e=E.current)||e.abort())}),45e3);try{let e=g.description;const t=R();h.length>0&&(e+="\n\n**Attachments:**\n",t?(h.filter((e=>e.size>0&&e.name&&"string"==typeof e.name)).forEach((t=>{e+=`- [${t.name}](attachment:${t.name})\n`})),e+="\n\x3c!-- mobile-uploads --\x3e\n"):h.forEach((t=>{const r=URL.createObjectURL(t);e+=`- [${t.name}](${r})\n`}))),n&&l&&(e+=`\n\n*This task is assigned to section ID: ${l}*`);const a={...g,description:e,sectionId:l};if(t&&h.length>0){const e=h.filter((e=>e.name&&e.size>0));a._mobileFiles=e,n&&l&&(a._isSectionAdminMobile=!0,a._sectionId=l,a.sectionId=l),a._mobileTimestamp=Date.now()}await r(a),S.current&&clearTimeout(S.current),C.current&&(x({type:"SET_SUBMITTING",isSubmitting:!1}),x({type:"RESET_FORM",sectionId:l}),x({type:"SET_SUCCESS",success:!0}),setTimeout((()=>{C.current&&x({type:"SET_SUCCESS",success:!1})}),3e3))}catch(t){S.current&&clearTimeout(S.current),C.current&&(x({type:"SET_ERRORS",errors:{name:`Failed to create task: ${t instanceof Error?t.message:"Unknown error"}`}}),x({type:"SET_SUBMITTING",isSubmitting:!1}),x({type:"SET_UPLOAD_PROGRESS",progress:0}))}}}),[L,g,h,R,n,l,r]);return t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-md overflow-hidden border border-gray-100 dark:border-gray-700",children:[t.jsx("div",{className:"px-4 sm:px-6 py-4 border-b border-gray-200 dark:border-gray-700 flex items-center bg-gradient-to-r from-blue-50 to-white dark:from-gray-800 dark:to-gray-750",children:t.jsxs("h3",{className:"text-lg sm:text-xl font-semibold text-gray-800 dark:text-white flex items-center",children:[t.jsx(d,{className:"w-5 h-5 mr-2 text-blue-600 dark:text-blue-400"}),"Create New Task",n&&l&&t.jsx("span",{className:"ml-2 text-xs sm:text-sm text-green-600 dark:text-green-400 font-normal px-2 py-0.5 bg-green-100 dark:bg-green-900/30 rounded-full",children:"Section Task"})]})}),t.jsxs("form",{onSubmit:G,className:"p-4 sm:p-6 space-y-5 sm:space-y-6",children:[N&&t.jsx(K,{}),w&&D>0&&D<100&&t.jsx(W,{progress:D}),t.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-5",children:[t.jsx("div",{className:"col-span-1 sm:col-span-2",children:t.jsx(V,{id:"name",label:"Task Name",required:!0,error:p.name,children:t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 pointer-events-none",children:t.jsx(d,{className:"w-5 h-5"})}),t.jsx("input",{type:"text",id:"name",name:"name",value:g.name,onChange:$,className:`w-full pl-10 pr-4 py-3 border ${p.name?"border-red-500 dark:border-red-500":"border-gray-300 dark:border-gray-600"} rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white text-sm sm:text-base touch-manipulation`,placeholder:"Enter task name","aria-required":"true","aria-invalid":!!p.name,"aria-describedby":p.name?"name-error":void 0,autoComplete:"off"})]})})}),t.jsx("div",{children:t.jsx(V,{id:"category",label:"Category",error:p.category,children:t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 pointer-events-none",children:t.jsx(o,{className:"w-5 h-5"})}),t.jsxs("select",{id:"category",name:"category",value:g.category,onChange:$,className:"w-full pl-10 pr-4 py-3 border border-gray-300 dark:border-gray-600 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white appearance-none text-sm sm:text-base touch-manipulation",children:[t.jsx("option",{value:"task",children:"Task"}),t.jsx("option",{value:"assignment",children:"Assignment"}),t.jsx("option",{value:"project",children:"Project"}),t.jsx("option",{value:"quiz",children:"Quiz"}),t.jsx("option",{value:"midterm",children:"Midterm"}),t.jsx("option",{value:"final-exam",children:"Final Exam"}),t.jsx("option",{value:"lab-report",children:"Lab Report"}),t.jsx("option",{value:"lab-performance",children:"Lab Performance"}),t.jsx("option",{value:"lab-final",children:"Lab Final"}),t.jsx("option",{value:"presentation",children:"Presentation"}),t.jsx("option",{value:"blc",children:"BLC"}),t.jsx("option",{value:"documents",children:"Documents"}),t.jsx("option",{value:"groups",children:"Groups"}),t.jsx("option",{value:"others",children:"Others"})]})]})})}),t.jsx("div",{children:t.jsx(V,{id:"dueDate",label:"Due Date",required:!0,error:p.dueDate,children:t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 pointer-events-none",children:t.jsx(c,{className:"w-5 h-5"})}),t.jsx("input",{type:"date",id:"dueDate",name:"dueDate",ref:T,value:g.dueDate,onChange:$,min:F(),className:`w-full pl-10 pr-4 py-3 border ${p.dueDate?"border-red-500 dark:border-red-500":"border-gray-300 dark:border-gray-600"} rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white text-sm sm:text-base touch-manipulation mobile-date-input`,"aria-required":"true","aria-invalid":!!p.dueDate,"aria-describedby":p.dueDate?"dueDate-error":void 0})]})})}),t.jsx("div",{className:"col-span-1 sm:col-span-2",children:t.jsx(V,{id:"description",label:"Description",required:!0,error:p.description,children:t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute left-3 top-3 text-gray-400 pointer-events-none",children:t.jsx(m,{className:"w-5 h-5"})}),t.jsx("textarea",{id:"description",name:"description",value:g.description,onChange:$,rows:4,className:`w-full pl-10 pr-4 py-2 border ${p.description?"border-red-500 dark:border-red-500":"border-gray-300 dark:border-gray-600"} rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white text-sm sm:text-base touch-manipulation`,placeholder:"Enter task description","aria-required":"true","aria-invalid":!!p.description,"aria-describedby":p.description?"description-error":void 0})]})})}),t.jsx("div",{className:"col-span-1 sm:col-span-2",children:t.jsxs(V,{id:"files",label:"Attachments",error:p.files,children:[t.jsx("div",{className:"flex items-center justify-center w-full",children:t.jsxs("label",{htmlFor:"file-upload",className:"w-full flex flex-col items-center justify-center px-6 py-8 bg-gradient-to-br from-white to-gray-50 dark:from-gray-800 dark:to-gray-750 text-gray-600 dark:text-gray-400 rounded-xl border-2 border-dashed border-gray-300 dark:border-gray-600 cursor-pointer hover:border-blue-400 dark:hover:border-blue-500 hover:bg-blue-50 dark:hover:bg-gray-700/50 transition-all duration-200 touch-manipulation group","aria-label":"Upload files - tap to select files",children:[t.jsxs("div",{className:"flex flex-col items-center space-y-3",children:[t.jsx("div",{className:"p-3 bg-blue-100 dark:bg-blue-900/30 rounded-full group-hover:scale-110 transition-transform duration-200",children:t.jsx(f,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"})}),t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:R()?"Tap to select files":"Click to upload or drag & drop"}),t.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"PDF, DOC, Images, etc. (Max 50MB per file)"})]})]}),t.jsx("input",{id:"file-upload",type:"file",className:"hidden",onChange:_,multiple:!0,accept:"image/*,application/pdf,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,text/plain,application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","aria-label":"File upload"})]})}),b.length>0&&t.jsxs("div",{className:"mt-4 space-y-2 max-h-48 overflow-y-auto pr-1",children:[t.jsx("div",{className:"flex items-center justify-between mb-2",children:t.jsxs("p",{className:"text-xs font-semibold text-gray-600 dark:text-gray-400",children:["Attached Files (",h.length,")"]})}),h.map(((e,r)=>t.jsx(H,{file:e,onRemove:()=>A(r)},`${e.name}-${r}`)))]})]})}),n&&t.jsx("div",{className:"col-span-1 sm:col-span-2",children:t.jsx(V,{id:"googleDriveLinks",label:"Google Drive Links",error:p.googleDriveLinks,children:t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex gap-2",children:[t.jsxs("div",{className:"relative flex-1",children:[t.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 pointer-events-none",children:t.jsx(k,{className:"w-5 h-5"})}),t.jsx("input",{type:"url",id:"googleDriveLink",value:v,onChange:I,onKeyPress:P,placeholder:"Paste Google Drive link here...",className:`w-full pl-10 pr-4 py-3 border ${p.googleDriveLinks?"border-red-500 dark:border-red-500":"border-gray-300 dark:border-gray-600"} rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white text-sm sm:text-base touch-manipulation`,"aria-describedby":p.googleDriveLinks?"googleDriveLinks-error":void 0})]}),t.jsx("button",{type:"button",onClick:U,disabled:!v.trim(),className:"px-4 py-3 rounded-xl font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-900 touch-manipulation "+(v.trim()?"bg-blue-600 hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600 text-white":"bg-gray-300 dark:bg-gray-600 text-gray-500 dark:text-gray-400 cursor-not-allowed"),"aria-label":"Add Google Drive link",children:t.jsx(j,{className:"w-5 h-5"})})]}),t.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[t.jsx("p",{children:"Supported: Google Drive files, folders, Docs, Sheets, Slides, and Forms"}),t.jsx("p",{children:"Only section administrators can attach Google Drive links"})]}),y.length>0&&t.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto pr-1",children:y.map(((e,r)=>t.jsx(Q,{url:e,onRemove:()=>O(r)},`${e}-${r}`)))})]})})})]}),t.jsx("div",{className:"flex justify-end pt-2",children:t.jsx("button",{type:"submit",disabled:w||i,className:`px-4 py-2 rounded-md text-white font-medium shadow-sm \n              ${w||i?"bg-blue-400 dark:bg-blue-600 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600"}\n              transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 dark:focus:ring-offset-gray-900 w-full sm:w-auto`,children:w||i?"Creating...":"Create Task"})})]})]})}function X({task:a,onClose:s,onUpdate:l}){const[d,m]=e.useState({name:a.name||"",category:a.category||"task",dueDate:a.dueDate||"",description:(e=>{if(!e)return"";let t=e.replace(/(?:^- |\n- )?\[([^\]]+)\]\(([^)]+)\)/g,((e,t,r)=>r.includes("supabase.co/storage")||r.includes("task-attachments")||t.match(/\.[a-zA-Z0-9]+$/)?"":e));return t=t.replace(/\n*\*\*Attachments:\*\*\n*((?:- \[.*?\]\(.*?\)\n*)*)/g,""),t=t.replace(/\n*\*\*Links:\*\*\n*((?:- \[.*?\]\(.*?\)\n*)*)/g,""),t=t.replace(/\*This task is assigned to section ID: [a-f0-9-]+\*/g,""),t=t.replace(/\n{3,}/g,"\n\n").replace(/^\n+|\n+$/g,"").trim(),t})(a.description||""),status:a.status||"my-tasks"}),[u,x]=e.useState((e=>{if(!e)return[];const t=[],r=/(?:^- |\n- )?\[([^\]]+)\]\(([^)]+)\)/g;let a;for(;null!==(a=r.exec(e));){const[,e,r]=a;if(r.includes("supabase.co/storage")||r.includes("task-attachments")||e.match(/\.[a-zA-Z0-9]+$/)){const a=r.match(/task-files\/([^?]+)/),s=a?a[1]:void 0;t.push({name:e,url:r,path:s})}}return t})(a.description||"")),[g,p]=e.useState([]),[h,b]=e.useState({}),[y,k]=e.useState(!1),j=e.useRef(null);e.useEffect((()=>{const e=e=>{"Escape"===e.key&&s()};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)}),[s]);const v=e=>{const{name:t,value:r}=e.target;m((e=>({...e,[t]:r})))},w=async e=>{const t=e.name.split(".").pop(),a=`${"undefined"!=typeof crypto&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){const t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))}.${t}`,s=`task-files/${a}`,{data:l,error:n}=await r.storage.from("task-attachments").upload(s,e,{cacheControl:"3600",upsert:!1,contentType:e.type});if(n)throw new Error(`Upload failed: ${n.message}`);if(!l)throw new Error("Upload completed but no data returned");const{data:{publicUrl:i}}=r.storage.from("task-attachments").getPublicUrl(s);return{url:i,path:a}};return t.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:t.jsxs("div",{className:"bg-white dark:bg-gray-900 rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto border border-gray-200 dark:border-gray-700",onClick:e=>e.stopPropagation(),children:[t.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-10 h-10 bg-blue-100 dark:bg-blue-900/30 rounded-xl flex items-center justify-center",children:t.jsx(D,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"})}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Edit Task"}),t.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Update task information"})]})]}),t.jsx("button",{onClick:s,className:"w-8 h-8 rounded-lg bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 flex items-center justify-center transition-colors",children:t.jsx(N,{className:"w-4 h-4 text-gray-600 dark:text-gray-400"})})]}),t.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),d.name.trim()&&d.dueDate&&d.description.trim()){k(!0);try{const e=[];for(const a of g)try{b((e=>({...e,[a.name]:25})));const{url:t,path:r}=await w(a);e.push({name:a.name,url:t,path:r}),b((e=>({...e,[a.name]:100})))}catch(t){throw b((e=>({...e,[a.name]:0}))),new Error(`Failed to upload ${a.name}: ${t instanceof Error?t.message:"Unknown error"}`)}let r=d.description.trim();const n=[...u,...e.map((e=>({name:e.name,url:e.url})))];n.length>0&&(r+="\n\n**Attachments:**\n",n.forEach((e=>{r+=`- [${e.name}](${e.url})\n`}))),a.sectionId&&(r+=`\n\n*This task is assigned to section ID: ${a.sectionId}*`);const i={...d,description:r};await l(a.id,i),s()}catch(t){alert(`Error: ${t instanceof Error?t.message:"Unknown error occurred"}`)}finally{k(!1),b({})}}},className:"p-6 space-y-5",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Task Name *"}),t.jsx("input",{type:"text",name:"name",value:d.name,onChange:v,className:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:"Enter task name",required:!0})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Category *"}),t.jsxs("div",{className:"relative",children:[t.jsx(o,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),t.jsx("select",{name:"category",value:d.category,onChange:v,className:"w-full pl-10 pr-4 py-3 bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all appearance-none",required:!0,children:[{value:"assignment",label:"Assignment"},{value:"blc",label:"BLC"},{value:"documents",label:"Documents"},{value:"final-exam",label:"Final Exam"},{value:"groups",label:"Groups"},{value:"lab-final",label:"Lab Final"},{value:"lab-performance",label:"Lab Performance"},{value:"lab-report",label:"Lab Report"},{value:"midterm",label:"Midterm"},{value:"presentation",label:"Presentation"},{value:"project",label:"Project"},{value:"quiz",label:"Quiz"},{value:"task",label:"Task"},{value:"others",label:"Others"}].map((e=>t.jsx("option",{value:e.value,children:e.label},e.value)))})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Due Date *"}),t.jsxs("div",{className:"relative",children:[t.jsx(c,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),t.jsx("input",{type:"date",name:"dueDate",value:d.dueDate,onChange:v,className:"w-full pl-10 pr-4 py-3 bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",required:!0})]})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Status"}),t.jsx("div",{className:"flex gap-2",children:[{value:"my-tasks",label:"To Do"},{value:"in-progress",label:"In Progress"},{value:"completed",label:"Completed"}].map((e=>t.jsx("button",{type:"button",onClick:()=>m((t=>({...t,status:e.value}))),className:"flex-1 py-2.5 px-4 rounded-lg text-sm font-medium transition-all "+(d.status===e.value?"bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 border-2 border-blue-200 dark:border-blue-700":"bg-gray-50 dark:bg-gray-800 text-gray-600 dark:text-gray-400 border-2 border-gray-200 dark:border-gray-700 hover:bg-gray-100 dark:hover:bg-gray-700"),children:e.label},e.value)))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Description *"}),t.jsx("textarea",{name:"description",value:d.description,onChange:v,rows:4,className:"w-full px-4 py-3 bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all resize-none",placeholder:"Describe the task details...",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(i,{className:"w-4 h-4"}),"Attachments",u.length+g.length>0&&t.jsxs("span",{className:"text-xs bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 px-2 py-1 rounded-full",children:[u.length+g.length," file",u.length+g.length!==1?"s":""]})]})}),t.jsxs("div",{className:"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-xl p-6 text-center hover:border-blue-400 dark:hover:border-blue-500 transition-colors cursor-pointer",onClick:()=>{var e;null==(e=j.current)||e.click()},onDragOver:e=>{e.preventDefault(),e.stopPropagation()},onDragEnter:e=>{e.preventDefault(),e.stopPropagation()},onDragLeave:e=>{e.preventDefault(),e.stopPropagation()},onDrop:e=>{e.preventDefault(),e.stopPropagation();const t=Array.from(e.dataTransfer.files);if(0===t.length)return;const r=t.filter((e=>!(e.size>10485760&&(alert(`File "${e.name}" is too large. Maximum size is 10MB.`),1))));if(r.length>0){p((e=>[...e,...r]));const e={};r.forEach((t=>{e[t.name]=0})),b((t=>({...t,...e})))}},children:[t.jsx("input",{ref:j,type:"file",multiple:!0,onChange:e=>{const t=e.target.files;if(!t||0===t.length)return;const r=Array.from(t).filter((e=>!(e.size>10485760&&(alert(`File "${e.name}" is too large. Maximum size is 10MB.`),1))));if(r.length>0){p((e=>[...e,...r]));const e={};r.forEach((t=>{e[t.name]=0})),b((t=>({...t,...e})))}e.target.value=""},className:"hidden",accept:".pdf,.doc,.docx,.txt,.jpg,.jpeg,.png,.gif,.zip,.rar"}),t.jsx(f,{className:"w-8 h-8 text-gray-400 mx-auto mb-2"}),t.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:[t.jsx("span",{className:"text-blue-600 dark:text-blue-400 font-medium hover:underline",children:"Click to upload"})," or drag and drop"]}),t.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500",children:"PDF, DOC, TXT, Images up to 10MB"}),g.length>0&&t.jsxs("div",{className:"mt-3 text-xs text-green-600 dark:text-green-400",children:[g.length," file",1!==g.length?"s":""," ready to upload"]})]}),u.length>0&&t.jsxs("div",{className:"mt-3 space-y-2",children:[t.jsx("h4",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Current Attachments"}),u.map(((e,a)=>t.jsxs("div",{className:"flex items-center justify-between p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-700",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-8 h-8 bg-blue-100 dark:bg-blue-900/30 rounded-lg flex items-center justify-center",children:t.jsx(D,{className:"w-4 h-4 text-blue-600 dark:text-blue-400"})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white truncate max-w-[200px]",children:e.name}),t.jsx("p",{className:"text-xs text-blue-600 dark:text-blue-400",children:"Existing file"})]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{type:"button",onClick:()=>window.open(e.url,"_blank"),className:"w-8 h-8 rounded-lg bg-blue-100 dark:bg-blue-900/30 hover:bg-blue-200 dark:hover:bg-blue-900/50 flex items-center justify-center transition-colors",title:"View file",children:t.jsx(n,{className:"w-4 h-4 text-blue-600 dark:text-blue-400"})}),t.jsx("button",{type:"button",onClick:e=>{e.preventDefault(),e.stopPropagation(),(async e=>{const t=u[e];if(t)try{t.path&&await(async e=>{if(!e)return;const{error:t}=await r.storage.from("task-attachments").remove([`task-files/${e}`]);if(t)throw t})(t.path),x((t=>t.filter(((t,r)=>r!==e))))}catch(a){x((t=>t.filter(((t,r)=>r!==e))))}})(a)},className:"w-8 h-8 rounded-lg bg-red-100 dark:bg-red-900/30 hover:bg-red-200 dark:hover:bg-red-900/50 flex items-center justify-center transition-colors",title:"Remove file",disabled:y,children:t.jsx(S,{className:"w-4 h-4 text-red-600 dark:text-red-400"})})]})]},`existing-${e.name}-${a}`)))]}),g.length>0&&t.jsxs("div",{className:"mt-3 space-y-2",children:[t.jsx("h4",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"New Attachments"}),g.map(((e,r)=>t.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 dark:bg-green-900/20 rounded-lg border border-green-200 dark:border-green-700",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-8 h-8 bg-green-100 dark:bg-green-900/30 rounded-lg flex items-center justify-center",children:t.jsx(D,{className:"w-4 h-4 text-green-600 dark:text-green-400"})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white truncate",children:e.name}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("p",{className:"text-xs text-green-600 dark:text-green-400",children:[(e.size/1024).toFixed(1)," KB â€¢ New"]}),void 0!==h[e.name]&&t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("div",{className:"w-16 h-1 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:t.jsx("div",{className:"h-full bg-green-500 transition-all duration-300",style:{width:`${h[e.name]||0}%`}})}),t.jsxs("span",{className:"text-xs text-green-600 dark:text-green-400",children:[Math.round(h[e.name]||0),"%"]})]})]})]})]}),t.jsx("button",{type:"button",onClick:e=>{var t;e.preventDefault(),e.stopPropagation(),t=r,p((e=>e.filter(((e,r)=>r!==t))))},className:"w-8 h-8 rounded-lg bg-red-100 dark:bg-red-900/30 hover:bg-red-200 dark:hover:bg-red-900/50 flex items-center justify-center transition-colors",disabled:y,children:t.jsx(S,{className:"w-4 h-4 text-red-600 dark:text-red-400"})})]},`new-${e.name}-${e.size}-${r}`)))]})]}),t.jsxs("div",{className:"flex gap-3 pt-4",children:[t.jsx("button",{type:"button",onClick:s,className:"flex-1 py-3 px-4 bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300 rounded-xl hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors font-medium",disabled:y,children:"Cancel"}),t.jsx("button",{type:"submit",disabled:y||!d.name.trim()||!d.dueDate||!d.description.trim(),className:"flex-1 py-3 px-4 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-300 dark:disabled:bg-gray-700 text-white rounded-xl transition-colors font-medium flex items-center justify-center gap-2",children:y?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),g.length>0?"Uploading & Saving...":"Saving..."]}):t.jsxs(t.Fragment,{children:[t.jsx(C,{className:"w-4 h-4"}),"Save Changes"]})})]})]})]})})}function Y({tasks:r,onDeleteTask:a,onUpdateTask:s,isSectionAdmin:l=!1,viewMode:n="table",selectedTaskIds:i=[],onToggleSelection:o=()=>{},onSelectAll:c=()=>{},sortBy:m="dueDate",sortOrder:h="asc",onSort:b=()=>{}}){const[y,f]=e.useState(null);e.useState(null);const[k,j]=e.useState(!1);e.useState(null),e.useState(null);const[v,N]=e.useState(null);e.useRef(null),e.useEffect((()=>{const e=()=>{j(window.innerWidth<768)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]);const D=e=>{switch(e){case"completed":return"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400";case"in-progress":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400";default:return"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400"}},C=e=>{switch(e){case"completed":return t.jsx(w,{className:"w-3 h-3"});case"in-progress":return t.jsx(A,{className:"w-3 h-3"});default:return t.jsx(d,{className:"w-3 h-3"})}},I=e=>{switch(e){case"completed":return"Completed";case"in-progress":return"In Progress";default:return"To Do"}},U=e=>{switch(e){case"high":return t.jsx("span",{className:"px-2 py-0.5 text-xs rounded-full bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400",children:"High"});case"medium":return t.jsx("span",{className:"px-2 py-0.5 text-xs rounded-full bg-orange-100 text-orange-800 dark:bg-orange-900/30 dark:text-orange-400",children:"Medium"});case"low":return t.jsx("span",{className:"px-2 py-0.5 text-xs rounded-full bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400",children:"Low"});default:return null}},O=e=>m!==e?null:"asc"===h?t.jsx(g,{className:"w-3.5 h-3.5 ml-1 inline-block"}):t.jsx(p,{className:"w-3.5 h-3.5 ml-1 inline-block"}),P=async e=>{const t=e.description.replace(/\*\*Attachments:\*\*[\s\S]*?(?=\n\n|$)/g,"").trim(),r=`\nğŸ“‹ TASK: ${e.name}\nğŸ“… Due Date: ${T(e.dueDate)}\nğŸ·ï¸ Category: ${e.category}\n\nğŸ“ Description:\n${t}\n\nğŸŒ View: https://nesttask.vercel.app/\n    `.trim();try{await navigator.clipboard.writeText(r),N(e.id),setTimeout((()=>N(null)),2e3)}catch(a){}};return 0===r.length?t.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm p-8 text-center",children:t.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No tasks available"})}):t.jsxs(t.Fragment,{children:["table"===n?t.jsx("div",{className:"relative overflow-hidden rounded-lg",children:t.jsx("div",{className:"overflow-x-auto -mx-4 sm:mx-0",children:t.jsx("div",{className:"inline-block min-w-full align-middle",children:t.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[t.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800/50",children:t.jsxs("tr",{children:[t.jsx("th",{className:"w-12 sm:w-8 px-2 sm:px-4 py-3",children:t.jsx("div",{className:"flex items-center justify-center",children:t.jsx("button",{onClick:c,className:"p-1 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-700","aria-label":"Select all tasks",children:i.length>0&&i.length===r.length?t.jsx(R,{className:"w-4 h-4 sm:w-5 sm:h-5 text-blue-500 dark:text-blue-400"}):t.jsx(u,{className:"w-4 h-4 sm:w-5 sm:h-5 text-gray-400 dark:text-gray-500"})})})}),t.jsx("th",{className:"px-2 sm:px-4 py-3 text-left",children:t.jsxs("button",{onClick:()=>b("name"),className:"flex items-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider hover:text-gray-700 dark:hover:text-gray-200",children:[t.jsx("span",{className:"hidden sm:inline",children:"Task "}),"Name",O("name")]})}),t.jsx("th",{className:"hidden sm:table-cell px-4 py-3 text-left",children:t.jsxs("button",{onClick:()=>b("category"),className:"flex items-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider hover:text-gray-700 dark:hover:text-gray-200",children:["Category",O("category")]})}),t.jsx("th",{className:"px-2 sm:px-4 py-3 text-left",children:t.jsxs("button",{onClick:()=>b("dueDate"),className:"flex items-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider hover:text-gray-700 dark:hover:text-gray-200",children:[t.jsx("span",{className:"hidden sm:inline",children:"Due "}),"Date",O("dueDate")]})}),t.jsx("th",{className:"px-2 sm:px-4 py-3 text-left",children:t.jsxs("button",{onClick:()=>b("status"),className:"flex items-center text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider hover:text-gray-700 dark:hover:text-gray-200",children:["Status",O("status")]})}),t.jsx("th",{className:"px-2 sm:px-4 py-3 text-right",children:t.jsx("span",{className:"sr-only",children:"Actions"})})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:r.map((e=>t.jsxs("tr",{className:"group hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors "+(i.includes(e.id)?"bg-blue-50 dark:bg-blue-900/20":""),children:[t.jsx("td",{className:"w-12 sm:w-8 px-2 sm:px-4 py-2",children:t.jsx("div",{className:"flex items-center justify-center",children:t.jsx("button",{onClick:()=>o(e.id),className:"p-1 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-700",children:i.includes(e.id)?t.jsx(R,{className:"w-4 h-4 sm:w-5 sm:h-5 text-blue-500 dark:text-blue-400"}):t.jsx(u,{className:"w-4 h-4 sm:w-5 sm:h-5 text-gray-400 dark:text-gray-500"})})})}),t.jsx("td",{className:"px-2 sm:px-4 py-2",children:t.jsxs("div",{className:"max-w-xs sm:max-w-sm",children:[t.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white truncate",children:e.name}),t.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 line-clamp-1 sm:hidden",children:e.category.replace(/-/g," ")})]})}),t.jsxs("td",{className:"hidden sm:table-cell px-4 py-2",children:[t.jsx("div",{className:"text-sm capitalize text-gray-900 dark:text-white",children:e.category.replace(/-/g," ")}),e.priority&&t.jsx("div",{className:"mt-1",children:U(e.priority)})]}),t.jsx("td",{className:"px-2 sm:px-4 py-2",children:t.jsxs("span",{className:"text-xs sm:text-sm flex items-center gap-1 "+(E(e.dueDate,e.status)?"text-red-600 dark:text-red-400":"text-gray-600 dark:text-gray-400"),children:[E(e.dueDate,e.status)&&t.jsx(L,{className:"w-3 h-3 sm:w-3.5 sm:h-3.5"}),t.jsx("span",{className:"whitespace-nowrap",children:T(e.dueDate)})]})}),t.jsx("td",{className:"px-2 sm:px-4 py-2",children:t.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium ${D(e.status)}`,children:[C(e.status),t.jsx("span",{className:"hidden xs:inline",children:I(e.status)})]})}),t.jsx("td",{className:"px-2 sm:px-4 py-2 text-right",children:t.jsxs("div",{className:"flex items-center justify-end gap-1 sm:gap-2",children:[t.jsx("button",{onClick:()=>P(e),className:"p-1 sm:p-1.5 rounded-lg transition-colors duration-200 "+(v===e.id?"bg-green-100 text-green-600 dark:bg-green-900/30 dark:text-green-400":"hover:bg-gray-100 text-gray-500 dark:text-gray-400 dark:hover:bg-gray-700"),title:"Copy task details",children:v===e.id?t.jsx(x,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"}):t.jsx($,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"})}),t.jsx("button",{onClick:()=>f(e),className:"p-1 sm:p-1.5 rounded-lg transition-colors duration-200 hover:bg-blue-100 text-blue-600 dark:text-blue-400 dark:hover:bg-blue-900/30",title:"Edit task",children:t.jsx(_,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"})}),t.jsx("button",{onClick:()=>s(e.id,{status:"completed"===e.status?"my-tasks":"completed"}),className:"p-1 sm:p-1.5 rounded-lg transition-colors duration-200 "+("completed"===e.status?"bg-green-100 text-green-600 dark:bg-green-900/30 dark:text-green-400":"hover:bg-gray-100 text-gray-500 dark:text-gray-400 dark:hover:bg-gray-700"),title:"completed"===e.status?"Mark as incomplete":"Mark as complete",children:t.jsx(w,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"})}),t.jsx("button",{onClick:()=>a(e.id),className:"p-1 sm:p-1.5 hover:bg-red-100 text-red-600 dark:hover:bg-red-900/30 dark:text-red-400 rounded-lg transition-colors duration-200",title:"Delete task",children:t.jsx(S,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"})})]})})]},e.id)))})]})})})}):t.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 p-4",children:r.map((e=>t.jsxs("div",{className:"group bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-4 hover:shadow-md transition-all "+(i.includes(e.id)?"ring-2 ring-blue-500 dark:ring-blue-400":""),children:[t.jsx("div",{className:"flex items-start justify-between",children:t.jsxs("div",{className:"flex-1",children:[t.jsx("h3",{className:"text-sm font-medium text-gray-900 dark:text-white line-clamp-2",children:e.name}),t.jsx("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400 line-clamp-2",children:e.description})]})}),t.jsxs("div",{className:"mt-4 flex flex-wrap items-center gap-2 text-xs",children:[t.jsx("span",{className:"px-2 py-1 rounded-md bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300",children:e.category}),t.jsx("span",{className:"px-2 py-1 rounded-md "+(E(e.dueDate)&&"completed"!==e.status?"bg-red-100 text-red-600 dark:bg-red-900/30 dark:text-red-400":"bg-gray-100 text-gray-600 dark:bg-gray-700 dark:text-gray-300"),children:T(e.dueDate)})]}),t.jsxs("div",{className:"mt-4 flex items-center justify-end gap-2",children:[t.jsx("button",{onClick:()=>P(e),className:"p-1 sm:p-1.5 rounded-lg transition-colors duration-200 "+(v===e.id?"bg-green-100 text-green-600 dark:bg-green-900/30 dark:text-green-400":"hover:bg-gray-100 text-gray-500 dark:text-gray-400 dark:hover:bg-gray-700"),title:"Copy task details",children:v===e.id?t.jsx(x,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"}):t.jsx($,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"})}),t.jsx("button",{onClick:()=>f(e),className:"p-1 sm:p-1.5 rounded-lg transition-colors duration-200 hover:bg-blue-100 text-blue-600 dark:text-blue-400 dark:hover:bg-blue-900/30",title:"Edit task",children:t.jsx(_,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"})}),t.jsx("button",{onClick:()=>s(e.id,{status:"completed"===e.status?"my-tasks":"completed"}),className:"p-1 sm:p-1.5 rounded-lg transition-colors duration-200 "+("completed"===e.status?"bg-green-100 text-green-600 dark:bg-green-900/30 dark:text-green-400":"hover:bg-gray-100 text-gray-500 dark:text-gray-400 dark:hover:bg-gray-700"),title:"completed"===e.status?"Mark as incomplete":"Mark as complete",children:t.jsx(w,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"})}),t.jsx("button",{onClick:()=>a(e.id),className:"p-1 sm:p-1.5 hover:bg-red-100 text-red-600 dark:hover:bg-red-900/30 dark:text-red-400 rounded-lg transition-colors duration-200",title:"Delete task",children:t.jsx(S,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"})})]})]},e.id)))}),y&&t.jsx(X,{task:y,onClose:()=>f(null),onUpdate:async(e,t)=>{try{await s(e,t),f(null)}catch(r){}},isSectionAdmin:l})]})}function J({tasks:r,onCreateTask:a,onDeleteTask:s,onUpdateTask:l,showTaskForm:n=!1,sectionId:i,isSectionAdmin:d=!1,isLoading:o=!1,isCreatingTask:c=!1,onTaskCreateStart:m,onTaskCreateEnd:u,onRefresh:x}){const[g,p]=e.useState(!0),[f,k]=e.useState(!1),[v,w]=e.useState("table"),[D,C]=e.useState({category:"all",status:"all",search:"",startDate:"",endDate:""}),[E,T]=e.useState({by:"createdAt",order:"desc"}),[L,$]=e.useState([]),[_,A]=e.useState(!1),[B,q]=e.useState([]),[V,K]=e.useState(0),W=e.useRef(null),[H,Q]=e.useState(""),X=e.useRef(!1),J=e.useRef([]);e.useEffect((()=>{p(!0)}),[n]),e.useEffect((()=>{if(!X.current&&r!==J.current){const e=Date.now();e-V>100&&(q(r),K(e),J.current=r)}}),[r,V]),e.useEffect((()=>(W.current&&window.clearTimeout(W.current),W.current=window.setTimeout((()=>{Q(D.search)}),300),()=>{W.current&&window.clearTimeout(W.current)})),[D.search]);const ee=e.useMemo((()=>B.filter((e=>{if("all"!==D.category&&e.category!==D.category)return!1;if("all"!==D.status&&e.status!==D.status)return!1;if(D.startDate&&new Date(e.dueDate)<new Date(D.startDate))return!1;if(D.endDate){const t=new Date(D.endDate);if(t.setHours(23,59,59,999),new Date(e.dueDate)>t)return!1}if(H){const t=H.toLowerCase();return e.name.toLowerCase().includes(t)||e.description.toLowerCase().includes(t)||e.category.toLowerCase().includes(t)}return!0}))),[B,D.category,D.status,D.startDate,D.endDate,H]),te=e.useMemo((()=>[...ee].sort(((e,t)=>{let r=0;switch(E.by){case"dueDate":r=new Date(e.dueDate).getTime()-new Date(t.dueDate).getTime();break;case"name":r=e.name.localeCompare(t.name);break;case"category":r=e.category.localeCompare(t.category);break;case"createdAt":r=(e.createdAt?new Date(e.createdAt).getTime():Date.now())-(t.createdAt?new Date(t.createdAt).getTime():Date.now());break;case"priority":const a={high:3,medium:2,low:1},s=e.priority||"medium",l=t.priority||"medium";r=(a[s]||0)-(a[l]||0)}return"asc"===E.order?r:-r}))),[ee,E.by,E.order]),re=e.useCallback((async e=>{if(!X.current){X.current=!0;try{null==m||m();const t={...e};if(d&&i){const e={...t,sectionId:i};await a(e,i)}else await a(t);C({category:"all",status:"all",startDate:"",endDate:"",search:""}),I("Task created successfully")}catch(t){U(`Failed to create task: ${t.message||"Please try again."}`)}finally{X.current=!1,null==u||u()}}}),[d,a,i,m,u]),ae=e.useCallback((async e=>{if(!X.current){X.current=!0;try{await s(e),q((t=>t.filter((t=>t.id!==e)))),I("Task deleted successfully")}catch(t){U(`Error deleting task: ${t.message||"Please try again."}`)}finally{X.current=!1}}}),[s]),se=e.useCallback((async(e,t)=>{if(!X.current){X.current=!0;try{await l(e,t),q((r=>r.map((r=>r.id===e?{...r,...t,updatedAt:(new Date).toISOString()}:r)))),I("Task updated successfully")}catch(r){U(`Error updating task: ${r.message||"Please try again."}`)}finally{X.current=!1}}}),[l]),le=async e=>{if(0!==L.length&&!_){A(!0);try{let r=0;const a=[];for(const s of L)try{await l(s,{status:e,updatedAt:(new Date).toISOString()}),r++,q((t=>t.map((t=>t.id===s?{...t,status:e,updatedAt:(new Date).toISOString()}:t))))}catch(t){a.push(`Task ${s}: ${t.message}`)}r>0&&I(`Updated ${r} tasks to ${e}`),a.length>0&&U(`Failed to update ${a.length} tasks`),$([])}catch(t){U(`Error updating task status: ${t.message||"Please try again."}`)}finally{A(!1)}}};return t.jsxs("div",{className:"space-y-4",children:[g&&t.jsx("div",{children:t.jsx(Z,{onSubmit:re,sectionId:i,isSectionAdmin:d,isSubmitting:c})}),t.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm",children:t.jsx("div",{className:"p-3 sm:p-4 border-b border-gray-200 dark:border-gray-700",children:t.jsxs("div",{className:"flex flex-col space-y-3 sm:space-y-0 sm:flex-row sm:items-center sm:justify-between",children:[t.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[t.jsx("button",{className:"inline-flex items-center justify-center px-3 sm:px-4 py-1.5 sm:py-2 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors duration-200",onClick:()=>p(!g),disabled:o,children:g?t.jsxs(t.Fragment,{children:[t.jsx(O,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4 mr-1"}),t.jsx("span",{className:"hidden xs:inline",children:"Hide Form"}),t.jsx("span",{className:"xs:hidden",children:"Hide"})]}):t.jsxs(t.Fragment,{children:[t.jsx(j,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4 mr-1"}),t.jsx("span",{className:"hidden xs:inline",children:"Create Task"}),t.jsx("span",{className:"xs:hidden",children:"Create"})]})}),t.jsxs("button",{className:`\n                  inline-flex items-center justify-center px-3 sm:px-4 py-1.5 sm:py-2 text-sm font-medium rounded-lg transition-colors duration-200\n                  ${o?"bg-gray-100 text-gray-400 cursor-not-allowed dark:bg-gray-700 dark:text-gray-500":f?"bg-blue-50 text-blue-600 dark:bg-blue-900/30 dark:text-blue-400":"bg-gray-100 text-gray-700 hover:bg-gray-200 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700"}\n                `,onClick:()=>k(!f),disabled:o,children:[t.jsx(P,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4 mr-1"}),t.jsx("span",{className:"hidden xs:inline",children:"Filters"})]}),t.jsxs("div",{className:"inline-flex rounded-lg border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800",children:[t.jsx("button",{className:"px-2 sm:px-3 py-1.5 sm:py-2 rounded-l-lg transition-colors duration-200 "+("table"===v?"bg-blue-50 text-blue-600 dark:bg-blue-900/30 dark:text-blue-400":"text-gray-600 hover:bg-gray-50 dark:text-gray-400 dark:hover:bg-gray-700"),onClick:()=>w("table"),title:"Table view",children:t.jsx(h,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"})}),t.jsx("button",{className:"px-2 sm:px-3 py-1.5 sm:py-2 rounded-r-lg transition-colors duration-200 "+("grid"===v?"bg-blue-50 text-blue-600 dark:bg-blue-900/30 dark:text-blue-400":"text-gray-600 hover:bg-gray-50 dark:text-gray-400 dark:hover:bg-gray-700"),onClick:()=>w("grid"),title:"Grid view",children:t.jsx(b,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"})})]}),t.jsxs("button",{className:"inline-flex items-center justify-center px-3 sm:px-4 py-1.5 sm:py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",onClick:()=>{try{const e=["Name","Category","Due Date","Status","Description"],t=te.map((e=>[`"${e.name.replace(/"/g,'""')}"`,`"${e.category.replace(/"/g,'""')}"`,`"${new Date(e.dueDate).toLocaleDateString()}"`,`"${"my-tasks"===e.status?"To Do":"in-progress"===e.status?"In Progress":"Completed"}"`,`"${e.description.replace(/"/g,'""')}"`])),r=[e.join(","),...t.map((e=>e.join(",")))].join("\n"),a=new Blob([r],{type:"text/csv;charset=utf-8;"}),s=URL.createObjectURL(a),l=document.createElement("a");l.setAttribute("href",s),l.setAttribute("download",`tasks_export_${i?`section_${i}_`:""}${(new Date).toISOString().split("T")[0]}.csv`),l.style.visibility="hidden",document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(s),I("Tasks exported successfully")}catch(e){U("Failed to export tasks. Please try again.")}},disabled:o||0===te.length,title:"Export to CSV",children:[t.jsx(F,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4 mr-1"}),t.jsx("span",{className:"hidden xs:inline",children:"Export"})]}),x&&t.jsxs("button",{className:"inline-flex items-center justify-center px-3 sm:px-4 py-1.5 sm:py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",onClick:x,disabled:o,title:"Refresh tasks",children:[t.jsx(G,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4 mr-1 "+(o?"animate-spin":"")}),t.jsx("span",{className:"hidden xs:inline",children:"Refresh"})]})]}),t.jsx("div",{className:"relative w-full sm:w-auto sm:min-w-[200px] md:min-w-[240px]",children:t.jsxs("div",{className:"flex items-center w-full px-3 py-1.5 sm:py-2 bg-gray-50 border border-gray-200 rounded-lg dark:bg-gray-800 dark:border-gray-700 focus-within:border-blue-500 dark:focus-within:border-blue-400 transition-colors duration-200",children:[t.jsx(M,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4 text-gray-400 dark:text-gray-500"}),t.jsx("input",{type:"text",placeholder:"Search tasks...",value:D.search,onChange:e=>C({...D,search:e.target.value}),className:"w-full ml-2 text-sm bg-transparent border-none outline-none focus:ring-0 text-gray-700 dark:text-gray-300 placeholder-gray-500 dark:placeholder-gray-400"}),D.search&&t.jsx("button",{onClick:()=>C({...D,search:""}),className:"p-0.5 sm:p-1 ml-1 text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200",children:t.jsx(N,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4"})})]})})]})})}),f&&t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm p-3 sm:p-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3 sm:mb-4",children:[t.jsx("h3",{className:"text-xs sm:text-sm font-medium text-gray-700 dark:text-gray-300",children:"Filter Tasks"}),t.jsx("div",{className:"flex items-center gap-2",children:t.jsxs("button",{onClick:()=>{C({category:"all",status:"all",startDate:"",endDate:"",search:""}),Q(""),T({by:"createdAt",order:"desc"})},className:"text-xs flex items-center gap-1 text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 py-1 px-2",children:[t.jsx(y,{className:"w-3 h-3 sm:w-3.5 sm:h-3.5"}),"Reset"]})})]}),t.jsxs("div",{className:"grid grid-cols-1 xs:grid-cols-2 md:grid-cols-4 gap-3 text-sm",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Status"}),t.jsxs("select",{value:D.status,onChange:e=>C({...D,status:e.target.value}),className:"w-full px-2 sm:px-3 py-1.5 sm:py-2 border dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white text-xs sm:text-sm",children:[t.jsx("option",{value:"all",children:"All Statuses"}),t.jsx("option",{value:"my-tasks",children:"To Do"}),t.jsx("option",{value:"in-progress",children:"In Progress"}),t.jsx("option",{value:"completed",children:"Completed"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Category"}),t.jsxs("select",{value:D.category,onChange:e=>C({...D,category:e.target.value}),className:"w-full px-2 sm:px-3 py-1.5 sm:py-2 border dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white text-xs sm:text-sm",children:[t.jsx("option",{value:"all",children:"All Categories"}),t.jsx("option",{value:"assignment",children:"Assignment"}),t.jsx("option",{value:"blc",children:"BLC"}),t.jsx("option",{value:"documents",children:"Documents"}),t.jsx("option",{value:"final-exam",children:"Final Exam"}),t.jsx("option",{value:"groups",children:"Groups"}),t.jsx("option",{value:"lab-final",children:"Lab Final"}),t.jsx("option",{value:"lab-performance",children:"Lab Performance"}),t.jsx("option",{value:"lab-report",children:"Lab Report"}),t.jsx("option",{value:"midterm",children:"Midterm"}),t.jsx("option",{value:"presentation",children:"Presentation"}),t.jsx("option",{value:"project",children:"Project"}),t.jsx("option",{value:"quiz",children:"Quiz"}),t.jsx("option",{value:"task",children:"Task"}),t.jsx("option",{value:"others",children:"Others"})]})]}),t.jsxs("div",{className:"xs:col-span-2",children:[t.jsx("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Date Range"}),t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.jsx("div",{children:t.jsx("input",{type:"date",value:D.startDate,onChange:e=>C({...D,startDate:e.target.value}),className:"w-full px-2 sm:px-3 py-1.5 sm:py-2 border dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white text-xs sm:text-sm",placeholder:"Start date"})}),t.jsx("div",{children:t.jsx("input",{type:"date",value:D.endDate,onChange:e=>C({...D,endDate:e.target.value}),className:"w-full px-2 sm:px-3 py-1.5 sm:py-2 border dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white text-xs sm:text-sm",placeholder:"End date"})})]})]})]})]}),L.length>0&&t.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-xl p-2 sm:p-3 flex flex-wrap items-center justify-between gap-2 sm:gap-3",children:[t.jsx("div",{className:"flex items-center",children:t.jsxs("span",{className:"text-xs sm:text-sm font-medium text-blue-700 dark:text-blue-300",children:[L.length," ",1===L.length?"task":"tasks"," selected"]})}),t.jsxs("div",{className:"flex flex-wrap items-center gap-1 sm:gap-2",children:[t.jsxs("button",{onClick:()=>le("completed"),disabled:_,className:"px-2 py-1 sm:px-2.5 sm:py-1.5 text-xs bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:bg-green-300 disabled:cursor-not-allowed flex items-center gap-1",children:[t.jsx(R,{className:"w-3 h-3 sm:w-3.5 sm:h-3.5"}),t.jsx("span",{className:"hidden xs:inline",children:"Complete"})]}),t.jsxs("button",{onClick:()=>le("in-progress"),disabled:_,className:"px-2 py-1 sm:px-2.5 sm:py-1.5 text-xs bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 disabled:bg-yellow-300 disabled:cursor-not-allowed flex items-center gap-1",children:[t.jsx(R,{className:"w-3 h-3 sm:w-3.5 sm:h-3.5"}),t.jsx("span",{className:"hidden xs:inline",children:"Progress"})]}),t.jsxs("button",{onClick:async()=>{if(L.length&&!_)try{A(!0);let t=0;const r=[];for(const a of L)try{await s(a),t++,q((e=>e.filter((e=>e.id!==a))))}catch(e){r.push(`Task ${a}: ${e.message}`)}t>0&&I(`${t} tasks deleted successfully`),r.length>0&&U(`Failed to delete ${r.length} tasks`),$([])}catch(e){U(`Error deleting tasks: ${e.message||"Please try again."}`)}finally{A(!1)}},disabled:_,className:"px-2 py-1 sm:px-2.5 sm:py-1.5 text-xs bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:bg-red-300 disabled:cursor-not-allowed flex items-center gap-1",children:[t.jsx(S,{className:"w-3 h-3 sm:w-3.5 sm:h-3.5"}),t.jsx("span",{className:"hidden xs:inline",children:"Delete"})]}),t.jsx("button",{onClick:()=>$([]),disabled:_,className:"px-2 py-1 sm:px-2.5 sm:py-1.5 text-xs bg-gray-600 text-white rounded-lg hover:bg-gray-700 disabled:bg-gray-300 disabled:cursor-not-allowed",children:"Cancel"})]})]}),o?t.jsx("div",{className:"p-8 flex justify-center items-center",children:t.jsx(z,{className:"w-8 h-8 text-blue-500 animate-spin"})}):t.jsxs(t.Fragment,{children:[t.jsx(Y,{tasks:te,onDeleteTask:ae,onUpdateTask:se,isSectionAdmin:d,viewMode:v,selectedTaskIds:L,onToggleSelection:e=>{$((t=>t.includes(e)?t.filter((t=>t!==e)):[...t,e]))},onSelectAll:()=>{$((e=>e.length===te.length?[]:te.map((e=>e.id))))},sortBy:E.by,sortOrder:E.order,onSort:e=>{"createdAt"!==e&&"dueDate"!==e&&"name"!==e&&"category"!==e&&"priority"!==e||T((t=>({by:e,order:t.by===e&&"asc"===t.order?"desc":"asc"})))}}),0===te.length&&!o&&t.jsx("div",{className:"p-8 text-center",children:t.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"No tasks found. Try adjusting your filters or create a new task."})})]})]})}export{J as TaskManager};
