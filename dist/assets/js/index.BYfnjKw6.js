const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/AdminLayout.BiK4buWm.js","assets/js/react-vendor.BQ9wcLSU.js","assets/js/charts.DuHk9BWv.js","assets/js/vendor.Vy3uO1vB.js","assets/js/useAuth.CtCVOCLk.js","assets/js/dataCache.DP4PyhNH.js","assets/js/authErrors.BDay5vyW.js","assets/js/capacitor-vendor.WkpnXCg6.js","assets/js/useTasks.DV_soWGW.js","assets/js/telegram.service.CKSqE0Xu.js","assets/js/dateUtils.8XYiGfWV.js","assets/js/icons.B5_ZQj31.js","assets/js/useTheme.CGN4hm2q.js","assets/js/LoadingScreen.DY9CiPqQ.js","assets/js/ionic-vendor.ClmuHuJk.js","assets/css/ionic-vendor.5aKpPXL6.css","assets/js/supabase-vendor.nnmAzafq.js","assets/js/DashboardPage.BVuxkvGN.js","assets/js/App.qyglq_sS.js","assets/js/AuthPage.BWeeohxg.js","assets/js/AuthSubmitButton.Ak0RWPSY.js","assets/js/framer-vendor.DjTtDeWL.js","assets/js/date-utils.CA8GdWm1.js","assets/js/ResetPasswordPage.zCYyIbvv.js","assets/js/linkParser.CRNpH1Sh.js","assets/js/googleDriveUtils.DgFtRDYK.js","assets/js/UsersPage.nQ8FJlra.js","assets/js/TasksPage.CBZ7owM7.js","assets/js/TaskManagementPage.D0BCGuQG.js","assets/js/AnnouncementsPage.BatnPwKE.js","assets/js/LectureSlidesPage.C1I2KnAu.js","assets/js/SuperAdminPage.DRynA0GL.js"])))=>i.map(i=>d[i]);
import{C as e,P as t,_ as n}from"./capacitor-vendor.WkpnXCg6.js";import{j as s,r as a,d as i,e as r,f as o}from"./react-vendor.BQ9wcLSU.js";import"./ionic-vendor.ClmuHuJk.js";import{c as l}from"./supabase-vendor.nnmAzafq.js";import"./charts.DuHk9BWv.js";import"./vendor.Vy3uO1vB.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const d=()=>s.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-white dark:bg-gray-900 z-50",children:s.jsxs("div",{className:"w-8 h-8 relative",children:[s.jsx("div",{className:"absolute inset-0 border-2 border-gray-200 dark:border-gray-700 rounded-full"}),s.jsx("div",{className:"absolute inset-0 border-t-2 border-blue-600 rounded-full animate-spin"})]})});Boolean("undefined"!=typeof window&&(window.location.hostname.includes("stackblitz.io")||window.location.hostname.includes(".webcontainer.io")));const c=l("https://nglfbbdoyyfslzyjarqs.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5nbGZiYmRveXlmc2x6eWphcnFzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njc1OTgyMTQsImV4cCI6MjA4MzE3NDIxNH0.3sXujO3rtin57rTcHpXHi6Zfi9XJCEX3-mmcnnB8cJE",{auth:{persistSession:!0,detectSessionInUrl:!0,flowType:"pkce",storage:localStorage,storageKey:"nesttask_supabase_auth"},global:{headers:{"X-Client-Info":"nesttask@1.0.0","Cache-Control":"no-cache",Pragma:"no-cache"}},db:{schema:"public"},realtime:{params:{eventsPerSecond:10}}});let u=0,m=!1,p=null,h=0,f=Date.now(),j=!1;async function _(){if(!j){j=!0;try{const{data:{session:e},error:t}=await c.auth.getSession();if(t)return;if(!e)return;const n=e.expires_at;if(n){if(1e3*n-Date.now()<=3e5){const{error:e}=await c.auth.refreshSession()}}}catch(e){}finally{j=!1}}}async function w(e=!1){return f=Date.now(),Date.now()-h>3e5&&(e=!0),!(!m||e)||p||(p=(async()=>{try{if(u>=3)return!0;u++;const{data:e,error:t}=await c.auth.getSession();if(t)return!1;if(!e.session)return!0;const{error:n}=await c.from("tasks").select("count",{count:"exact",head:!0});return n?"PGRST301"!==n.code&&!n.message.includes("JWT")||(await c.auth.signOut(),!1):(m=!0,h=Date.now(),!0)}catch(e){return!0}finally{setTimeout((()=>{p=null}),2e3)}})(),p)}"undefined"!=typeof document&&(document.addEventListener("visibilitychange",(async()=>{if("visible"===document.visibilityState){const e=Date.now(),t=e-f;await _(),t>12e4&&(p=null,m=!1),f=e,window.dispatchEvent(new CustomEvent("supabase-visibility-refresh"))}})),window.addEventListener("online",(async()=>{await _(),window.dispatchEvent(new CustomEvent("supabase-network-reconnect"))}))),setTimeout((()=>{w().catch(console.error)}),1e3);let g=null,x=!1,v=[];function b(){const e=g;return g=null,e}function y(e){var t;const n=null==(t=e.notification)?void 0:t.data,s=null==n?void 0:n.taskId,a=function(e){return e&&e.route&&"string"==typeof e.route?e.route:null}(n);if(s&&"string"==typeof s)return g=s,window.dispatchEvent(new CustomEvent("open-task-from-notification",{detail:{taskId:s,data:n,actionId:e.actionId,notification:e.notification}})),void setTimeout((()=>{window.dispatchEvent(new CustomEvent("open-task-from-notification",{detail:{taskId:s,data:n,actionId:e.actionId,notification:e.notification}}))}),500);if(a){const e=document.getElementById("root");e&&e.children.length>0&&setTimeout((()=>{window.location.href=a}),150)}}function k(e){}"requestIdleCallback"in window&&requestIdleCallback((()=>{const e=window.location.pathname;e.startsWith("/admin")||e.startsWith("/superadmin")?(n((()=>import("./AdminLayout.BiK4buWm.js")),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16])),n((()=>import("./DashboardPage.BVuxkvGN.js")),__vite__mapDeps([17,7,1,2,3]))):(n((()=>import("./App.qyglq_sS.js").then((e=>e.A))),__vite__mapDeps([18,7,1,2,3,4,5,6,8,9,10,19,20,11,14,15,16,12,21,22,23,24,25])),n((()=>import("./AuthPage.BWeeohxg.js")),__vite__mapDeps([19,1,2,3,20,11,6,5,7,14,15,16])))}),{timeout:2e3});const E=a.lazy((()=>n((()=>import("./App.qyglq_sS.js").then((e=>e.A))),__vite__mapDeps([18,7,1,2,3,4,5,6,8,9,10,19,20,11,14,15,16,12,21,22,23,24,25])))),P=a.lazy((()=>n((()=>import("./ResetPasswordPage.zCYyIbvv.js")),__vite__mapDeps([23,1,2,3,20,11,6,7,14,15,16])).then((e=>({default:e.ResetPasswordPage}))))),I=a.lazy((()=>n((()=>import("./AuthPage.BWeeohxg.js")),__vite__mapDeps([19,1,2,3,20,11,6,5,7,14,15,16])).then((e=>({default:e.AuthPage}))))),S=a.lazy((()=>n((()=>import("./AdminLayout.BiK4buWm.js")),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16])).then((e=>({default:e.AdminLayout}))))),L=a.lazy((()=>n((()=>import("./DashboardPage.BVuxkvGN.js")),__vite__mapDeps([17,7,1,2,3])).then((e=>({default:e.DashboardPage}))))),A=a.lazy((()=>n((()=>import("./UsersPage.nQ8FJlra.js")),__vite__mapDeps([26,7,1,2,3])).then((e=>({default:e.UsersPage}))))),T=a.lazy((()=>n((()=>import("./TasksPage.CBZ7owM7.js")),__vite__mapDeps([27,7,1,2,3])).then((e=>({default:e.TasksPage}))))),D=a.lazy((()=>n((()=>import("./TaskManagementPage.D0BCGuQG.js")),__vite__mapDeps([28,7,1,2,3,4,5,6,14,15,16])).then((e=>({default:e.TaskManagementPage}))))),R=a.lazy((()=>n((()=>import("./AnnouncementsPage.BatnPwKE.js")),__vite__mapDeps([29,7,1,2,3,9,10,14,15,16])).then((e=>({default:e.AnnouncementsPage}))))),O=a.lazy((()=>n((()=>import("./LectureSlidesPage.C1I2KnAu.js")),__vite__mapDeps([30,7,1,2,3])).then((e=>({default:e.LectureSlidesPage}))))),z=a.lazy((()=>n((()=>import("./SuperAdminPage.DRynA0GL.js")),__vite__mapDeps([31,7,1,2,3])).then((e=>({default:e.SuperAdminPage}))))),V=a.lazy((()=>n((()=>import("./vendor.Vy3uO1vB.js").then((e=>e.av))),__vite__mapDeps([3,2,1])).then((e=>({default:e.Analytics}))))),C=!e.isNativePlatform(),N=({children:e})=>C?s.jsx(s.Fragment,{children:e}):null,W=i([{path:"/auth",loader:async()=>{const{data:{session:e}}=await c.auth.getSession();if(null==e?void 0:e.user){const{data:t}=await c.from("users").select("role").eq("id",e.user.id).single();return"super-admin"===(null==t?void 0:t.role)?Response.redirect("/superadmin/dashboard"):"admin"===(null==t?void 0:t.role)||"section_admin"===(null==t?void 0:t.role)?Response.redirect("/admin/dashboard"):Response.redirect("/")}return null},element:s.jsx(a.Suspense,{fallback:s.jsx(d,{}),children:s.jsx(I,{onLogin:async e=>{const{data:t,error:n}=await c.auth.signInWithPassword({email:e.email,password:e.password});if(n)throw n;if(t.user){const{data:e}=await c.from("users").select("role").eq("id",t.user.id).single();"super-admin"===(null==e?void 0:e.role)?window.location.href="/superadmin/dashboard":"admin"===(null==e?void 0:e.role)||"section_admin"===(null==e?void 0:e.role)?window.location.href="/admin/dashboard":window.location.href="/"}},onSignup:async e=>{const{error:t}=await c.auth.signUp({email:e.email,password:e.password,options:{data:{name:e.name}}});if(t)throw t},onForgotPassword:async e=>{const{error:t}=await c.auth.resetPasswordForEmail(e);if(t)throw t}})})},{path:"/reset-password",element:s.jsx(a.Suspense,{fallback:s.jsx(d,{}),children:s.jsx(P,{})})},{path:"/admin",element:s.jsx(a.Suspense,{fallback:s.jsx(d,{}),children:s.jsx(S,{})}),children:[{path:"dashboard",element:s.jsx(a.Suspense,{fallback:s.jsx(d,{}),children:s.jsx(L,{})})},{path:"users",element:s.jsx(a.Suspense,{fallback:s.jsx(d,{}),children:s.jsx(A,{})})},{path:"tasks",element:s.jsx(a.Suspense,{fallback:s.jsx(d,{}),children:s.jsx(T,{})})},{path:"task-management",element:s.jsx(a.Suspense,{fallback:s.jsx(d,{}),children:s.jsx(D,{})})},{path:"announcements",element:s.jsx(a.Suspense,{fallback:s.jsx(d,{}),children:s.jsx(R,{})})},{path:"lecture-slides",element:s.jsx(a.Suspense,{fallback:s.jsx(d,{}),children:s.jsx(O,{})})},{path:"super-admin",element:s.jsx(a.Suspense,{fallback:s.jsx(d,{}),children:s.jsx(z,{})})}]},{path:"/superadmin/dashboard",element:s.jsx(a.Suspense,{fallback:s.jsx(d,{}),children:s.jsx(z,{})})},{path:"/superadmin/overview",element:s.jsx(a.Suspense,{fallback:s.jsx(d,{}),children:s.jsx(z,{})})},{path:"/superadmin/admins",element:s.jsx(a.Suspense,{fallback:s.jsx(d,{}),children:s.jsx(z,{})})},{path:"/superadmin/sectionadmins",element:s.jsx(a.Suspense,{fallback:s.jsx(d,{}),children:s.jsx(z,{})})},{path:"/superadmin/analytics",element:s.jsx(a.Suspense,{fallback:s.jsx(d,{}),children:s.jsx(z,{})})},{path:"/superadmin/logs",element:s.jsx(a.Suspense,{fallback:s.jsx(d,{}),children:s.jsx(z,{})})},{path:"/superadmin/security",element:s.jsx(a.Suspense,{fallback:s.jsx(d,{}),children:s.jsx(z,{})})},{path:"*",element:s.jsx(a.Suspense,{fallback:s.jsx(d,{}),children:s.jsx(E,{})})}]);!async function(){if(!x&&e.isNativePlatform())try{const e=await t.addListener("pushNotificationActionPerformed",y);v.push((()=>e.remove()));const n=await t.addListener("pushNotificationReceived",k);v.push((()=>n.remove())),x=!0}catch(n){}}(),function(){try{const e=new URL("https://nglfbbdoyyfslzyjarqs.supabase.co"),t=document.createElement("link");t.rel="dns-prefetch",t.href=e.origin,document.head.appendChild(t)}catch(n){}const t=document.getElementById("root");t&&(r(t).render(s.jsx(a.StrictMode,{children:s.jsxs(a.Suspense,{fallback:s.jsx(d,{}),children:[s.jsx(o,{router:W}),C&&s.jsx(N,{children:s.jsx(a.Suspense,{fallback:null,children:s.jsx(V,{})})})]})})),!e.isNativePlatform()&&"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((()=>{setTimeout((()=>{"undefined"!=typeof window&&window.Capacitor||("serviceWorker"in navigator&&navigator.serviceWorker.controller&&setInterval((()=>{navigator.serviceWorker.getRegistration().then((e=>{e&&e.update()}))}),36e5),window.addEventListener("beforeinstallprompt",(e=>{e.preventDefault()})),window.addEventListener("appinstalled",(()=>{})),"serviceWorker"in navigator&&navigator.serviceWorker.addEventListener("controllerchange",(()=>{navigator.serviceWorker.controller})))}),500)})).catch((()=>{})))}();export{b as g,c as s,w as t};
